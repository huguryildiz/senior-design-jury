import{r as i,a as lt,R as is}from"./react-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Dt={exports:{}},qe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var os=i,ls=Symbol.for("react.element"),cs=Symbol.for("react.fragment"),ds=Object.prototype.hasOwnProperty,us=os.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ms={key:!0,ref:!0,__self:!0,__source:!0};function $t(t,s,r){var a,n={},l=null,o=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(o=s.ref);for(a in s)ds.call(s,a)&&!ms.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:ls,type:t,key:l,ref:o,props:n,_owner:us.current}}qe.Fragment=cs;qe.jsx=$t;qe.jsxs=$t;Dt.exports=qe;var e=Dt.exports,st={},pt=lt;st.createRoot=pt.createRoot,st.hydrateRoot=pt.hydrateRoot;const ye={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 â€” Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},Y=[{id:1,name:"Group 1",desc:"GÃ¶ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf Ãœnal","AyÃ§a Naz DedeoÄŸlu","Onur Mesci","Ã‡aÄŸan ErdoÄŸan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla Ã–zer","Bertan Ãœnver","Ada TatlÄ±","Nesibe AydÄ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren GermeÃ§"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis â€” Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine Ã‡aylan","Selimhan Kaynar","Abdulkadir SazlÄ±","Alp Efe Ä°pek"]},{id:6,name:"Group 6",desc:"AKKE â€” Smart Command and Control Glove",students:["Åževval KurtulmuÅŸ","Abdullah Esin","Berk Ã‡akmak","Ã–mer Efe Dikici"]}],te=[{id:"technical",label:"Technical Content",shortLabel:"Technical",color:"#F59E0B",mudek:["1.2","2","3.1","3.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",color:"#22C55E",mudek:["9.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",color:"#3B82F6",mudek:["9.1"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",color:"#EF4444",mudek:["8.1","8.2"],max:10,rubric:[{range:"9â€“10",level:"Excellent",min:9,max:10,desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7â€“8",level:"Good",min:7,max:8,desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4â€“6",level:"Developing",min:4,max:6,desc:"Uneven participation. Some members are passive or unprepared."},{range:"0â€“3",level:"Insufficient",min:0,max:3,desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}],xt=70,hs={Excellent:{bg:"#DCFCE7",text:"#16A34A"},Good:{bg:"#F7FEE7",text:"#65A30D"},Developing:{bg:"#FEF9C3",text:"#CA8A04"},Insufficient:{bg:"#FEE2E2",text:"#DC2626"}},ps={"1.1":{en:"Knowledge in mathematics, natural sciences, fundamental engineering, computational methods, and discipline-specific topics.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konularda bilgi."},"1.2":{en:"Ability to apply knowledge of mathematics, natural sciences, fundamental engineering, computation, and discipline-specific topics to solve complex engineering problems.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konulardaki bilgileri, karmaÅŸÄ±k mÃ¼hendislik problemlerinin Ã§Ã¶zÃ¼mÃ¼nde kullanabilme becerisi."},2:{en:"Ability to identify, formulate, and analyse complex engineering problems using fundamental science, mathematics, and engineering knowledge, with consideration of relevant UN Sustainable Development Goals.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerini, temel bilim, matematik ve mÃ¼hendislik bilgilerini kullanarak ve ele alÄ±nan problemle ilgili BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ±nÄ± gÃ¶zetarak tanÄ±mlama, formÃ¼le etme ve analiz becerisi."},"3.1":{en:"Ability to design creative solutions to complex engineering problems.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerine yaratÄ±cÄ± Ã§Ã¶zÃ¼mler tasarlama becerisi."},"3.2":{en:"Ability to design complex systems, processes, devices, or products under realistic constraints and conditions, meeting current and future requirements.",tr:"KarmaÅŸÄ±k sistemleri, sÃ¼reÃ§leri, cihazlarÄ± veya Ã¼rÃ¼nleri gerÃ§ekÃ§i kÄ±sÄ±tlarÄ± ve koÅŸullarÄ± gÃ¶zetarak, mevcut ve gelecekteki gereksinimleri karÅŸÄ±layacak biÃ§imde tasarlama becerisi."},4:{en:"Ability to select and use appropriate techniques, resources, and modern engineering and IT tools â€” including estimation and modelling â€” for the analysis and solution of complex engineering problems, with awareness of their limitations.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin analizi ve Ã§Ã¶zÃ¼mÃ¼ne yÃ¶nelik, tahmin ve modelleme de dahil olmak Ã¼zere, uygun teknikleri, kaynaklarÄ± ve modern mÃ¼hendislik ve biliÅŸim araÃ§larÄ±nÄ±, sÄ±nÄ±rlamalarÄ±nÄ±n da farkÄ±nda olarak seÃ§me ve kullanma becerisi."},5:{en:"Ability to use research methods for investigating complex engineering problems, including literature review, experiment design, experimentation, data collection, and analysis and interpretation of results.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin incelenmesi iÃ§in literatÃ¼r araÅŸtÄ±rmasÄ±, deney tasarlama, deney yapma, veri toplama, sonuÃ§larÄ± analiz etme ve yorumlama dahil, araÅŸtÄ±rma yÃ¶ntemlerini kullanma becerisi."},"6.1":{en:"Knowledge of the impacts of engineering applications on society, health and safety, economy, sustainability, and the environment within the scope of UN Sustainable Development Goals.",tr:"MÃ¼hendislik uygulamalarÄ±nÄ±n BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ± kapsamÄ±nda, topluma, saÄŸlÄ±k ve gÃ¼venliÄŸe, ekonomiye, sÃ¼rdÃ¼rÃ¼lebilirlik ve Ã§evreye etkileri hakkÄ±nda bilgi."},"6.2":{en:"Awareness of the legal consequences of engineering solutions.",tr:"MÃ¼hendislik Ã§Ã¶zÃ¼mlerinin hukuksal sonuÃ§larÄ± konusunda farkÄ±ndalÄ±k."},"7.1":{en:"Knowledge of acting in accordance with engineering professional principles and ethical responsibility.",tr:"MÃ¼hendislik meslek ilkelerine uygun davranma, etik sorumluluk hakkÄ±nda bilgi."},"7.2":{en:"Awareness of non-discrimination, impartiality, and inclusivity of diversity.",tr:"HiÃ§bir konuda ayrÄ±mcÄ±lÄ±k yapmadan, tarafsÄ±z davranma ve Ã§eÅŸitliliÄŸi kapsayÄ±cÄ± olma konularÄ±nda farkÄ±ndalÄ±k."},"8.1":{en:"Ability to work effectively as a team member or leader in intra-disciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak disiplin iÃ§i takÄ±m Ã§alÄ±ÅŸmalarÄ±nda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"8.2":{en:"Ability to work effectively as a team member or leader in multidisciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak Ã§ok disiplinli takÄ±mlarda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"9.1":{en:"Ability to communicate effectively on technical topics orally, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda sÃ¶zlÃ¼ etkin iletiÅŸim kurma becerisi."},"9.2":{en:"Ability to communicate effectively on technical topics in writing, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda yazÄ±lÄ± etkin iletiÅŸim kurma becerisi."},"10.1":{en:"Knowledge of business practices such as project management and economic feasibility analysis.",tr:"Proje yÃ¶netimi ve ekonomik yapÄ±labilirlik analizi gibi iÅŸ hayatÄ±ndaki uygulamalar hakkÄ±nda bilgi."},"10.2":{en:"Awareness of entrepreneurship and innovation.",tr:"GiriÅŸimcilik ve yenilikÃ§ilik hakkÄ±nda farkÄ±ndalÄ±k."},11:{en:"Lifelong learning skills including independent and continuous learning, adaptation to new and emerging technologies, and critical thinking about technological change.",tr:"BaÄŸÄ±msÄ±z ve sÃ¼rekli Ã¶ÄŸrenebilme, yeni ve geliÅŸmekte olan teknolojilere uyum saÄŸlayabilme ve teknolojik deÄŸiÅŸimlerle ilgili sorgulayÄ±cÄ± dÃ¼ÅŸÃ¼nebilmeyi kapsayan yaÅŸam boyu Ã¶ÄŸrenme becerisi."}};te.reduce((t,s)=>t+(Number(s.max)||0),0);const Pt=ye==null?void 0:ye.scriptUrl,ct=ye==null?void 0:ye.apiSecret;function ft(t,s){const r=t.trim().toLowerCase()+"__"+s.trim().toLowerCase();let a=5381;for(let n=0;n<r.length;n++)a=(a<<5)+a^r.charCodeAt(n),a=a>>>0;return a.toString(16).padStart(8,"0")}let dt="";function jt(t){dt=t}function He(){return dt}function gt(){dt=""}async function Ne(t){const s=He();try{await fetch(Pt,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,token:s})})}catch{}}async function Le(t){const s=new URLSearchParams(t).toString(),r=await fetch(`${Pt}?${s}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=(await r.text()).trim();if(a.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script â€” check your deployment URL.");try{return JSON.parse(a)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function Tt(t){return Le({...t,token:He()})}function Ae(t,s,r,a,n,l,o){var g,x,p,c;return{juryName:t,juryDept:s,jurorId:r,timestamp:new Date().toISOString(),projectId:l.id,projectName:l.name,technical:((g=a[l.id])==null?void 0:g.technical)??"",design:((x=a[l.id])==null?void 0:x.design)??"",delivery:((p=a[l.id])==null?void 0:p.delivery)??"",teamwork:((c=a[l.id])==null?void 0:c.teamwork)??"",total:xs(a,l.id),comments:n[l.id]||"",status:o}}function xs(t,s){return te.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}async function Qe(t){return Le({action:"checkPin",jurorId:t,secret:ct})}async function fs(t,s,r){return Le({action:"createPin",jurorId:t,juryName:s.trim(),juryDept:r.trim(),secret:ct})}async function js(t,s){return Le({action:"verifyPin",jurorId:t,pin:String(s).trim(),secret:ct})}async function vt(){const t=await Tt({action:"myscores"});if(t.status==="unauthorized"){const s=new Error("unauthorized");throw s.unauthorized=!0,s}return t.status!=="ok"?null:t.rows||[]}async function bt(){return Tt({action:"ping"})}const yt=1500,gs="LOCKED__",_t=t=>`${gs}${t}`,Ie=t=>{if(!(!t||typeof window>"u"))try{window.localStorage.setItem(_t(t),"1")}catch{}},Se=t=>{if(!(!t||typeof window>"u"))try{window.localStorage.removeItem(_t(t))}catch{}},kt=(t,s)=>s==="locked",Pe=()=>Object.fromEntries(Y.map(t=>[t.id,Object.fromEntries(te.map(s=>[s.id,""]))])),Te=()=>Object.fromEntries(Y.map(t=>[t.id,""])),Nt=()=>Object.fromEntries(Y.map(t=>[t.id,Object.fromEntries(te.map(s=>[s.id,!1]))])),vs=()=>Object.fromEntries(Y.map(t=>[t.id,Object.fromEntries(te.map(s=>[s.id,!0]))])),Ce=(t,s)=>te.every(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""}),wt=t=>Y.every(s=>Ce(t,s.id)),Rt=t=>Y.reduce((s,r)=>s+te.reduce((a,n)=>{var l;return a+(((l=t[r.id])==null?void 0:l[n.id])!==""?1:0)},0),0),bs=(t,s)=>te.some(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""});function Xe(t){const s=Pe(),r=Te();return(t||[]).forEach(a=>{const n=Number(a.projectId);n&&(s[n]={...s[n],technical:a.technical??"",design:a.design??"",delivery:a.delivery??"",teamwork:a.teamwork??""},r[n]=a.comments??"")}),{scores:s,comments:r}}function ys(){const[t,s]=i.useState(""),[r,a]=i.useState(""),n=i.useRef("");i.useEffect(()=>{n.current=t.trim()&&r.trim()?ft(t,r):""},[t,r]);const[l,o]=i.useState("info"),[g,x]=i.useState(0),[p,c]=i.useState(Pe),[m,d]=i.useState(Te),[f,b]=i.useState(Nt),[y,h]=i.useState({}),[w,j]=i.useState(!1),[N,E]=i.useState(null),[O,k]=i.useState(null),[v,A]=i.useState(null),[B,Q]=i.useState("idle"),[M,W]=i.useState("idle"),[X,K]=i.useState(""),[I,D]=i.useState(""),[T,L]=i.useState(null),[q,se]=i.useState(!1),[ue,me]=i.useState(""),ne=i.useRef(!1),ce=i.useRef({});ce.current={juryName:t,juryDept:r,scores:p,comments:m,groupSynced:y,current:g};const re=i.useRef({jid:"",done:!1}),ae=i.useRef(p),he=i.useRef(m),fe=i.useCallback(C=>{const{juryName:$,juryDept:F}=ce.current,P=n.current,J=ae.current,U=he.current;if(!$.trim()||!P||!He()||!bs(J,C))return;const ge=Y.find(as=>as.id===C);if(!ge)return;const Oe=Ce(J,C)?"group_submitted":"in_progress",rs=Ae($,F,P,J,U,ge,Oe);Q("saving"),Ne({rows:[rs]}),setTimeout(()=>Q("saved"),500),setTimeout(()=>Q("idle"),2500)},[]),ve=i.useCallback(C=>{var P;const{current:$}=ce.current,F=(P=Y[$])==null?void 0:P.id;F!==void 0&&fe(F),x(C)},[fe]);i.useEffect(()=>{if(l!=="eval"||w)return;const C={};Y.forEach($=>{!y[$.id]&&Ce(p,$.id)&&(C[$.id]=!0)}),Object.keys(C).length>0&&h($=>({...$,...C}))},[p,l,y,w]),i.useEffect(()=>{if(l!=="eval"||ne.current||w||!Y.every($=>y[$.id]))return;ne.current=!0;const C=setTimeout(()=>{const{juryName:$,juryDept:F,scores:P,comments:J}=ce.current,U=n.current;Ne({rows:Y.map(ge=>Ae($,F,U,P,J,ge,"all_submitted"))}),E({...P}),k({...J}),o("done")},800);return()=>clearTimeout(C)},[y,l,w]);const Ee=i.useCallback((C,$,F)=>{const P={...ae.current,[C]:{...ae.current[C],[$]:F}};ae.current=P,c(P),b(J=>({...J,[C]:{...J[C],[$]:!0}})),F===""&&y[C]&&h(J=>({...J,[C]:!1}))},[y]),pe=i.useCallback((C,$)=>{var J;const F=te.find(U=>U.id===$),P=(J=ae.current[C])==null?void 0:J[$];if(b(U=>({...U,[C]:{...U[C],[$]:!0}})),P!==""&&P!==void 0){const U=parseInt(P,10),ge=Number.isFinite(U)?Math.min(Math.max(U,0),F.max):0;if(String(ge)!==String(P)){const Oe={...ae.current,[C]:{...ae.current[C],[$]:ge}};ae.current=Oe,c(Oe)}}fe(C)},[fe]),S=i.useCallback((C,$)=>{const F={...he.current,[C]:$};he.current=F,d(F)},[]),z=i.useCallback(C=>{fe(C)},[fe]),V=i.useCallback((C,$)=>{const{juryName:F,juryDept:P}=ce.current,J=n.current;Ne({rows:Y.map(U=>Ae(F,P,J,C,$,U,"all_submitted"))}),E({...C}),k({...$}),j(!1),ne.current=!0,o("done")},[]),G=i.useCallback(async()=>{const{juryName:C,juryDept:$}=ce.current,F=n.current,P=N||p,J=O||m;F&&Ne({action:"resetJuror"}),ae.current=P,he.current=J,c(P),d(J),j(!0),ne.current=!1,h(Object.fromEntries(Y.map(U=>[U.id,!0]))),o("eval"),setTimeout(()=>{F&&Ne({rows:Y.map(U=>Ae(C,$,F,P,J,U,"group_submitted"))})},yt)},[N,O,p,m]),Z=i.useCallback(()=>{if(!wt(p)){b(vs());const C=Y.findIndex($=>!Ce(p,$.id));C>=0&&x(C);return}V(p,m)},[p,m,V]),le=i.useCallback(C=>{gt(),me(C||"Your session has expired. Please enter your PIN again."),se(!0)},[]),ie=i.useCallback(()=>{se(!1),me(""),K("");const C=n.current;re.current={jid:C,done:!1},W("entering"),o("pin")},[]);i.useEffect(()=>{if(l!=="pin"||M!=="entering")return;const C=n.current;if(!C)return;const $=re.current;if($.jid===C&&$.done)return;let F=!1;return A({loading:!0}),(async()=>{try{const P=await Qe(C);if(F)return;P.locked||P.status==="locked"?(Ie(C),W("locked"),L(0),K("")):P.status==="ok"&&Se(C),typeof P.attemptsLeft=="number"&&L(P.attemptsLeft)}catch{}finally{F||A(null),re.current={jid:C,done:!0}}})(),()=>{F=!0}},[l,M]);const u=i.useCallback(async()=>{A({loading:!0});let C=[];try{C=await vt()||[]}catch(J){if(J.unauthorized){le("Your session has expired. Please enter your PIN again.");return}}const $=Y.length,F=C.filter(J=>J.status==="group_submitted"||J.status==="all_submitted").length,P=C.length>=$&&C.every(J=>J.status==="all_submitted");A({rows:C,filledCount:F,totalCount:$,allSubmitted:P})},[le]);i.useEffect(()=>{if(l!=="eval")return;const C=setInterval(async()=>{try{(await bt()).status==="unauthorized"&&le("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(C)},[l,le]),i.useEffect(()=>{if(l!=="eval")return;async function C(){if(document.visibilityState==="visible")try{(await bt()).status==="unauthorized"&&le("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",C),()=>document.removeEventListener("visibilitychange",C)},[l,le]);const _=i.useCallback(()=>{const C=v;if(C){if(A(null),C.allSubmitted){const{scores:$,comments:F}=Xe(C.rows);ae.current=$,he.current=F,c($),d(F),E($),k(F),h(Object.fromEntries(Y.map(P=>[P.id,!0]))),ne.current=!0,o("done");return}if(C.rows.length>0){const{scores:$,comments:F}=Xe(C.rows),P=Object.fromEntries(C.rows.filter(U=>U.status==="group_submitted"||U.status==="all_submitted").map(U=>[Number(U.projectId),!0]));ae.current=$,he.current=F,c($),d(F),h(P);const J=Y.findIndex(U=>!Ce($,U.id));x(J>=0?J:0),ne.current=!1}o("eval")}},[v]),R=i.useCallback(()=>{const C=Pe(),$=Te();ae.current=C,he.current=$,A(null),c(C),d($),h({}),x(0),ne.current=!1,j(!1),o("eval")},[]),H=i.useCallback(async()=>{const{juryName:C,juryDept:$}=ce.current,F=n.current;let P=Pe(),J=Te();try{const U=await vt();if(U!=null&&U.length){const ge=Xe(U);P=ge.scores,J=ge.comments}}catch{}F&&Ne({action:"resetJuror"}),ae.current=P,he.current=J,c(P),d(J),E(P),k(J),j(!0),ne.current=!1,h(Object.fromEntries(Y.map(U=>[U.id,!0]))),o("eval"),setTimeout(()=>{F&&Ne({rows:Y.map(U=>Ae(C,$,F,P,J,U,"group_submitted"))})},yt)},[]),oe=i.useCallback(async()=>{const{juryName:C,juryDept:$}=ce.current;if(!C.trim()||!$.trim())return;const F=ft(C,$);if(n.current=F,L(null),kt(F,M)){A(null),W("locked"),K(""),L(0),o("pin"),re.current={jid:F,done:!0};return}if(A({loading:!0}),He()){try{const P=await Qe(F);if(P.locked||P.status==="locked"){Ie(F),A(null),W("locked"),K(""),L(0),o("pin"),re.current={jid:F,done:!0};return}typeof P.attemptsLeft=="number"&&L(P.attemptsLeft),P.status==="ok"&&Se(F),re.current={jid:F,done:!0}}catch{re.current={jid:F,done:!0}}await u();return}try{const P=await Qe(F);if(P.locked||P.status==="locked"){Ie(F),A(null),W("locked"),K(""),L(0),o("pin"),re.current={jid:F,done:!0};return}if(typeof P.attemptsLeft=="number"&&L(P.attemptsLeft),P.status!=="ok"){A(null),K("Could not reach the server. Please try again."),W("entering"),o("pin"),re.current={jid:F,done:!0};return}if(P.exists)Se(F),A(null),W("entering"),K(""),typeof P.attemptsLeft=="number"&&L(P.attemptsLeft),o("pin"),re.current={jid:F,done:!0};else{const J=await fs(F,C,$);J.status==="ok"?(Se(F),A(null),jt(J.token),D(J.pin),W("new"),o("pin"),L(null),re.current={jid:F,done:!0}):(A(null),K("Could not create a PIN. Please try again."),W("entering"),o("pin"),re.current={jid:F,done:!0})}}catch{A(null),K("Connection error. Please check your network and try again."),W("entering"),o("pin")}},[u,M]),ee=i.useCallback(async C=>{const $=n.current;if(kt($,M)){W("locked"),L(0),K("");return}A({loading:!0});try{const F=await js($,C);if(F.locked||F.status==="locked"){Ie($),A(null),W("locked"),L(0),K("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(F.valid){Se($),jt(F.token||""),W("idle"),K(""),typeof F.attemptsLeft=="number"&&L(F.attemptsLeft),await u();return}A(null);const P=typeof F.attemptsLeft=="number"?F.attemptsLeft:null;P!==null&&L(P),P!==null&&P<=0?(Ie($),W("locked"),K("Too many failed attempts. Please contact the admin.")):K(P!==null?`Incorrect PIN. ${P} attempt${P!==1?"s":""} remaining.`:"Incorrect PIN. Please try again.")}catch{A(null),K("Could not verify PIN. Please try again.")}},[u,M]),xe=i.useCallback(async()=>{await u()},[u,M]),je=i.useCallback(()=>{const C=Pe(),$=Te(),F=n.current;ae.current=C,he.current=$,s(""),a(""),o("info"),x(0),c(C),d($),b(Nt()),h({}),A(null),j(!1),E(null),k(null),Q("idle"),W("idle"),K(""),D(""),L(null),ne.current=!1,n.current="",gt(),Se(F),re.current={jid:"",done:!1}},[]),ke=Y[g],Be=Y.length*te.length,We=Math.round(Rt(p)/Be*100),ns=wt(p);return{juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,jurorId:n.current,step:l,setStep:o,current:g,handleNavigate:ve,scores:p,comments:m,touched:f,handleScore:Ee,handleScoreBlur:pe,handleCommentChange:S,handleCommentBlur:z,project:ke,progressPct:We,allComplete:ns,groupSynced:y,editMode:w,doneScores:N,doneComments:O,sheetProgress:v,saveStatus:B,pinStep:M,pinError:X,newPin:I,attemptsLeft:T,handlePinSubmit:ee,handlePinAcknowledge:xe,sessionKicked:q,kickedMsg:ue,handleKickedAcknowledge:ie,handleStart:oe,handleConfirmFromSheet:_,handleStartFresh:R,handleResubmit:H,handleEditScores:G,handleFinalSubmit:Z,resetAll:je}}function ut(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function ks(){return e.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]})}function Ns(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function St(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M22 2l-9.6 9.6"}),e.jsx("path",{d:"M16.5 8.5l3 3"}),e.jsx("path",{d:"M19 6l3 3"})]})}function Ge(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}function Bt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"9"}),e.jsx("path",{d:"M12 8v4"}),e.jsx("path",{d:"M12 16h.01"})]})}function ws(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7-10-7-10-7z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function Ss(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3l18 18"}),e.jsx("path",{d:"M10.6 10.6a3 3 0 0 0 4.2 4.2"}),e.jsx("path",{d:"M9.6 5.5A10.8 10.8 0 0 1 12 5c6.5 0 10 7 10 7a17.2 17.2 0 0 1-3.3 4.4"}),e.jsx("path",{d:"M6.3 6.3C3.4 8.1 2 12 2 12s3.5 7 10 7a11 11 0 0 0 4.7-1"})]})}function nt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18 21a8 8 0 0 0-16 0"}),e.jsx("circle",{cx:"10",cy:"8",r:"5"}),e.jsx("path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3"})]})}function Wt(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m16 11 2 2 4-4"}),e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"})]})}function Cs(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 21a8 8 0 0 1 13.292-6"}),e.jsx("circle",{cx:"10",cy:"8",r:"5"}),e.jsx("path",{d:"m16 19 2 2 4-4"})]})}function Ot(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"}),e.jsx("path",{d:"M8 10v4"}),e.jsx("path",{d:"M12 10v2"}),e.jsx("path",{d:"M16 10v6"})]})}function Ls(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function Ms(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function zt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3.85 8.62a4 4 0 1 1 7.29-5.17"}),e.jsx("path",{d:"M3.85 15.38a4 4 0 1 0 7.29 5.17"}),e.jsx("path",{d:"M20.15 8.62a4 4 0 1 0-7.29-5.17"}),e.jsx("path",{d:"M20.15 15.38a4 4 0 1 1-7.29 5.17"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function rt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function Ht(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]})}function Ke(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 2h14"}),e.jsx("path",{d:"M5 22h14"}),e.jsx("path",{d:"M7 2c0 6 10 6 10 10s-10 4-10 10"}),e.jsx("path",{d:"M17 2c0 6-10 6-10 10s10 4 10 10"})]})}function Je(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7 21H3v-4L17 3z"}),e.jsx("path",{d:"m15 5 4 4"})]})}function Es(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 6 2 2 4-4"}),e.jsx("path",{d:"m3 12 2 2 4-4"}),e.jsx("path",{d:"m3 18 2 2 4-4"}),e.jsx("path",{d:"M11 6h10"}),e.jsx("path",{d:"M11 12h10"}),e.jsx("path",{d:"M11 18h10"})]})}function we(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 3H2l8 9v7l4 2v-9l8-9z"})})}function Gt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 3v12"}),e.jsx("path",{d:"m7 10 5 5 5-5"}),e.jsx("path",{d:"M5 21h14"})]})}function Kt(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]})}function As(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m5 12 7-7 7 7"}),e.jsx("path",{d:"M12 19V5"})]})}function Is(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"m19 12-7 7-7-7"})]})}function Jt(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"4",height:"6",rx:"2"}),e.jsx("path",{d:"M5 14v6"}),e.jsx("path",{d:"M4 20h2"}),e.jsx("path",{d:"M17 3v18"}),e.jsx("path",{d:"m13 17 4 4 4-4"})]})}function qt(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 4v6"}),e.jsx("path",{d:"M4 4h2"}),e.jsx("rect",{x:"3",y:"13",width:"4",height:"6",rx:"2"}),e.jsx("path",{d:"M17 3v18"}),e.jsx("path",{d:"m13 17 4 4 4-4"})]})}function Ue(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}function Ct(){return e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"9"})})}function Fs(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"}),e.jsx("path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"}),e.jsx("path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18"}),e.jsx("path",{d:"M4 22h16"}),e.jsx("path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"}),e.jsx("path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6"})]})}function Ut(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"M7 14l4-4 3 3 5-6"})]})}function Ye(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"2",width:"6",height:"4",rx:"1"}),e.jsx("path",{d:"M9 4H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2"})]})}function Ds(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]})}function $s(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 10v6"}),e.jsx("path",{d:"M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})}function Yt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7"}),e.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function Vt(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 6l12 12M18 6l-12 12"})})}function at(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M5 12l4 4 10-10"})})}function Ps(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 2v6h-6"}),e.jsx("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),e.jsx("path",{d:"M3 22v-6h6"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]})}function Qt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function Ts(){return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"m5 12 6-6"}),e.jsx("path",{d:"m5 12 6 6"})]})}function Xt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function Re(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function _s({juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,onStart:n,onBack:l}){const o=t.trim().length>0&&r.trim().length>0;return e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:"premium-card",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(Cs,{})}),e.jsx("div",{className:"premium-title",children:"Jury Information"}),e.jsx("div",{className:"premium-subtitle",children:"EE 492 â€” Senior Project Evaluation"})]}),e.jsxs("div",{className:"premium-info-strip",children:[e.jsx("span",{className:"info-strip-icon","aria-hidden":"true",children:e.jsx(Ue,{})}),e.jsx("span",{children:"Your information will be securely recorded and cannot be changed after you begin."})]}),e.jsxs("div",{className:"info-form",children:[e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:t,onChange:g=>s(g.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0,className:"premium-input"})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department or Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:g=>a(g.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:g=>{g.key==="Enter"&&o&&n()},className:"premium-input"})]})]}),e.jsx("div",{className:"premium-helper",children:"Your evaluation is saved automatically."}),e.jsx("button",{className:"premium-btn-primary",disabled:!o,onClick:n,children:"Start Evaluation â†’"}),e.jsxs("button",{className:"premium-btn-link",onClick:l,type:"button",children:[e.jsx(Ts,{}),"Back to Home"]})]})})}function mt({open:t,label:s="Loading",minDuration:r=400}){const[a,n]=i.useState(!!t),l=i.useRef(0),o=i.useRef(null);return i.useEffect(()=>{if(t){o.current&&(clearTimeout(o.current),o.current=null),l.current=Date.now(),n(!0);return}if(!t&&a){const g=Date.now()-l.current,x=Math.max(0,r-g);x===0?n(!1):o.current=setTimeout(()=>{n(!1),o.current=null},x)}},[t,r,a]),i.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),a?e.jsx("div",{className:"loader-overlay",role:"status","aria-live":"polite",children:e.jsxs("div",{className:"loader-card",children:[e.jsxs("svg",{className:"loader-icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 2v4"}),e.jsx("path",{d:"m16.2 7.8 2.9-2.9"}),e.jsx("path",{d:"M18 12h4"}),e.jsx("path",{d:"m16.2 16.2 2.9 2.9"}),e.jsx("path",{d:"M12 18v4"}),e.jsx("path",{d:"m4.9 19.1 2.9-2.9"}),e.jsx("path",{d:"M2 12h4"}),e.jsx("path",{d:"m4.9 4.9 2.9 2.9"})]}),e.jsxs("span",{className:"loader-text",children:[s,e.jsx("span",{className:"loader-dot",children:"."}),e.jsx("span",{className:"loader-dot",children:"."}),e.jsx("span",{className:"loader-dot",children:"."})]})]})}):null}function Rs({onSubmit:t,pinError:s}){const[r,a]=i.useState(["","","",""]),n=[i.useRef(null),i.useRef(null),i.useRef(null),i.useRef(null)];i.useEffect(()=>{s&&(a(["","","",""]),setTimeout(()=>{var c;return(c=n[0].current)==null?void 0:c.focus()},50))},[s]);function l(c,m){var b;const d=m.replace(/\D/g,"").slice(-1),f=[...r];f[c]=d,a(f),d&&c<3&&((b=n[c+1].current)==null||b.focus())}function o(c,m){var d,f,b;if(m.key==="Backspace")if(r[c]===""&&c>0){const y=[...r];y[c-1]="",a(y),(d=n[c-1].current)==null||d.focus()}else{const y=[...r];y[c]="",a(y)}if(m.key==="ArrowLeft"&&c>0&&((f=n[c-1].current)==null||f.focus()),m.key==="ArrowRight"&&c<3&&((b=n[c+1].current)==null||b.focus()),m.key==="Enter"){const y=r.join("");y.length===4&&t(y)}}function g(c){var d;const m=c.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(m.length===4){const f=m.split("");a(f),(d=n[3].current)==null||d.focus()}c.preventDefault()}function x(){const c=r.join("");c.length===4&&t(c)}const p=r.every(c=>c!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((c,m)=>e.jsx("input",{ref:n[m],type:"password",inputMode:"numeric",maxLength:1,value:c,autoFocus:m===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:d=>l(m,d.target.value),onKeyDown:d=>o(m,d),onPaste:m===0?g:void 0,className:`pin-box${s?" pin-box--error":""}`},m))}),e.jsx("button",{className:"premium-btn-primary pin-ok-btn",onClick:x,disabled:!p,children:"Verify PIN â†’"})]})}function Ze({open:t}){return e.jsx(mt,{open:t,minDuration:400})}function Bs({pinStep:t,pinError:s,newPin:r,attemptsLeft:a,onPinSubmit:n,onPinAcknowledge:l}){const[o,g]=i.useState(!1),[x,p]=i.useState(!1),[c,m]=i.useState({open:!1,stage:"idle"}),d=i.useRef({seq:0,start:0,active:!1}),f=i.useRef(s),b=i.useRef(t),y=i.useRef(0),h=async()=>{var A;const v=String(r||"");if(v){try{if((A=navigator==null?void 0:navigator.clipboard)!=null&&A.writeText&&window.isSecureContext){await navigator.clipboard.writeText(v),g(!0),setTimeout(()=>g(!1),1200);return}}catch{}try{const B=document.createElement("textarea");B.value=v,B.setAttribute("readonly",""),B.style.position="fixed",B.style.top="-9999px",B.style.left="-9999px",B.style.opacity="0",document.body.appendChild(B),B.select(),B.setSelectionRange(0,B.value.length);const Q=document.execCommand("copy");if(document.body.removeChild(B),!Q)return;g(!0),setTimeout(()=>g(!1),1200)}catch{}}},w=Number.isFinite(a)?a:null;i.useEffect(()=>{if(!s)return;p(!1);const v=requestAnimationFrame(()=>p(!0)),A=setTimeout(()=>p(!1),260);return()=>{cancelAnimationFrame(v),clearTimeout(A)}},[s,a]),i.useEffect(()=>{f.current=s},[s]),i.useEffect(()=>{b.current=t},[t]),i.useEffect(()=>{if(!c.open){document.body.classList.remove("auth-overlay-open");return}const v=document.body.style.overflow;return document.body.style.overflow="hidden",document.body.classList.add("auth-overlay-open"),()=>{document.body.style.overflow=v,document.body.classList.remove("auth-overlay-open")}},[c.open]);const j=(v,A=!0)=>{y.current=Date.now(),m({open:A,stage:v})},N=()=>{const v=d.current.seq+1;return d.current={seq:v,start:Date.now(),active:!0},document.body.classList.add("auth-overlay-open"),j("checking",!0),v},E=v=>{d.current.seq===v&&(d.current.active=!1,j("idle",!1))};if(t==="new"){const v=e.jsx(Ze,{open:c.open});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:"premium-card",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(St,{})}),e.jsx("div",{className:"premium-title",children:"Secure Access PIN"})]}),e.jsx("p",{className:"premium-body",children:"This 4-digit PIN protects your evaluation session. Youâ€™ll need it when signing in from another device."}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((A,B)=>e.jsx("span",{className:"pin-digit",children:A},B))}),e.jsxs("button",{className:"premium-btn-secondary",onClick:h,type:"button",children:[e.jsx(Ye,{}),o?"Copied":"Copy PIN"]}),e.jsxs("div",{className:"premium-info-strip",children:[e.jsx("span",{className:"info-strip-icon","aria-hidden":"true",children:e.jsx(Ns,{})}),e.jsx("span",{children:"Keep your PIN private. If you lose it, contact the administrator to reset access."})]}),e.jsx("button",{className:"premium-btn-primary",onClick:l,children:"Iâ€™ve saved my PIN â€”               Continue â†’"})]})}),v]})}if(t==="locked"){const v=e.jsx(Ze,{open:c.open});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:"premium-card",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(Ge,{})}),e.jsx("div",{className:"premium-title",children:"Too many attempts"}),e.jsx("div",{className:"premium-subtitle",children:"This session is locked for security."})]}),e.jsxs("div",{className:"premium-info-strip",children:[e.jsx("span",{className:"info-strip-icon","aria-hidden":"true",children:e.jsx(Ge,{})}),e.jsx("span",{children:"Contact the administrator to reset your access."})]}),e.jsx("button",{className:"premium-btn-link",type:"button",onClick:()=>{window.location.href="/senior-design-jury/"},children:"â†               Return to Home"})]})}),v]})}const O=e.jsx(Ze,{open:c.open}),k=async v=>{if(d.current.active||b.current==="locked")return;const A=f.current,B=N(),Q=y.current||Date.now();try{await Promise.resolve(n(v))}catch{}const M=Date.now()-Q,W=Math.max(0,800-M);if(await new Promise(X=>setTimeout(X,W)),d.current.seq===B){if(b.current==="entering"||b.current==="locked"){E(B);return}if(f.current&&f.current!==A){E(B);return}b.current!=="entering"&&(j("verified",!0),await new Promise(X=>setTimeout(X,650)),d.current.seq!==B)||E(B)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:`premium-card${x?" premium-card--shake":""}`,children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(St,{})}),e.jsx("div",{className:"premium-title",children:"Enter your access PIN"}),e.jsx("div",{className:"premium-subtitle",children:"Enter your 4-digit PIN to continue."})]}),!s&&e.jsxs("div",{className:"premium-helper",children:["Attempts remaining: ",w!==null?w:"â€¦"]}),s&&e.jsxs("div",{className:`premium-error-banner${w!==null&&w<=1?" is-critical":""}`,children:[e.jsx(Bt,{}),e.jsxs("div",{children:[e.jsx("div",{className:"premium-error-title",children:"Incorrect PIN"}),e.jsx("div",{className:"premium-error-detail",children:w!==null?`Please try again. ${w} attempts left.`:"Please try again."})]})]}),e.jsx(Rs,{onSubmit:k,pinError:s})]})}),O]})}function Ws(t){return t===0?"#e2e8f0":t<34?"linear-gradient(90deg,#ef4444,#f97316)":t<67?"linear-gradient(90deg,#f97316,#eab308)":t<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function Os({saveStatus:t}){return t==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"â³ Savingâ€¦"}):t==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"âœ“ Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"â— Auto-saving"})}function zs({juryName:t,juryDept:s,current:r,onNavigate:a,scores:n,comments:l,touched:o,groupSynced:g,editMode:x,progressPct:p,allComplete:c,saveStatus:m,handleScore:d,handleScoreBlur:f,handleCommentChange:b,handleCommentBlur:y,handleFinalSubmit:h,onGoHome:w}){var Q;const[j,N]=i.useState(!1),[E,O]=i.useState(null),k=Y[r],v=(M,W)=>{const X=te.filter(I=>{var D;return((D=n[M.id])==null?void 0:D[I.id])!==""}).length;return`${Ce(n,M.id)?"âœ…":"âš ï¸"} ${M.name} (${X}/${te.length})`},A=()=>{r>0&&a(r-1)},B=()=>{r<Y.length-1&&a(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"ðŸ‘¤"}),e.jsxs("span",{className:"eval-identity-text",children:[t,s&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",s,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(Os,{saveStatus:m})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>N(!0),"aria-label":"Home",children:e.jsx(ut,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:k.name}),e.jsx("span",{className:"eval-project-name",children:k.desc})]}),((Q=k.students)==null?void 0:Q.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["ðŸ‘¥ ",k.students.join(" Â· ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:A,disabled:r===0,"aria-label":"Previous group",children:e.jsx(Qt,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:M=>a(Number(M.target.value)),children:Y.map((M,W)=>e.jsx("option",{value:W,children:v(M)},M.id))}),e.jsx("button",{className:"group-nav-btn",onClick:B,disabled:r===Y.length-1,"aria-label":"Next group",children:e.jsx(Xt,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${p}%`,background:Ws(p)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(p),"%"]})]})})]}),j&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>N(!1),children:e.jsxs("div",{className:"back-menu",onClick:M=>M.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{N(!1),w()},children:"ðŸ  Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>N(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[g[k.id]&&!x&&e.jsx("div",{className:"group-done-banner",children:"âœ… All scores saved for this group."}),x&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["âœï¸ Edit mode â€” adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),te.map(M=>{var I,D;const W=((I=n[k.id])==null?void 0:I[M.id])??"",X=((D=o[k.id])==null?void 0:D[M.id])&&W==="",K=(parseInt(W,10)||0)/M.max*100;return e.jsxs("div",{className:`crit-card${X?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:M.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",M.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>O(E===M.id?null:M.id),children:E===M.id?"Hide Rubric â–²":"Show Rubric â–¼"})]}),E===M.id&&e.jsx("div",{className:"rubric-table",children:M.rubric.map(T=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:T.range}),e.jsx("div",{className:"rubric-level",children:T.level}),e.jsx("div",{className:"rubric-desc",children:T.desc})]},T.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:M.max,value:W,onChange:T=>d(k.id,M.id,T.target.value),onBlur:()=>f(k.id,M.id),placeholder:"â€”",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${K}%`}})}),e.jsx("span",{className:"score-pct",children:W!==""?`${W} / ${M.max}`:`â€” / ${M.max}`})]}),X&&e.jsx("div",{className:"required-hint",children:"Required"})]},M.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:l[k.id]||"",onChange:M=>b(k.id,M.target.value),onBlur:()=>y(k.id),placeholder:"Any additional feedback about this groupâ€¦",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const M=te.reduce((W,X)=>{var K;return W+(parseInt((K=n[k.id])==null?void 0:K[X.id],10)||0)},0);return e.jsxs("span",{className:`total-score${M>=80?" high":M>=60?" mid":""}`,children:[M," / 100"]})})()]}),x&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:c?1:.65},onClick:h,children:c?"âœ… Submit Final":`âš ï¸ Submit Final (${Rt(n)} / ${Y.length*te.length} filled)`})]})]})}function Hs(t,s){return te.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}function Gs({doneScores:t,scores:s,onEditScores:r,onBack:a}){const n=t||s,[l,o]=i.useState(new Set);function g(x){o(p=>{const c=new Set(p);return c.has(x)?c.delete(x):c.add(x),c})}return e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:"premium-card",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(zt,{})}),e.jsx("div",{className:"premium-title",children:"Thank You!"}),e.jsx("div",{className:"premium-subtitle",children:"Your evaluations have been recordedâ€”thank you for your feedback."})]}),e.jsx("div",{className:"done-summary",children:Y.map(x=>{var d,f;const p=l.has(x.id),c=`done-group-panel-${x.id}`,m=!!x.desc||((d=x.students)==null?void 0:d.length)>0;return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:m?0:-1,"aria-expanded":p,"aria-controls":c,onClick:()=>{m&&g(x.id)},onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&m&&(b.preventDefault(),g(x.id))},style:{cursor:m?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:x.name}),m&&e.jsx("span",{className:`group-accordion-chevron${p?" open":""}`,children:e.jsx(Re,{})})]})}),e.jsx("div",{className:"done-row-right",children:e.jsxs("span",{className:"done-score",children:[e.jsx("span",{className:"done-score-main",children:Hs(n,x.id)}),e.jsx("span",{className:"done-score-max",children:" / 100"})]})})]}),e.jsx("div",{id:c,className:`group-accordion-panel${p?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[x.desc&&e.jsx("span",{className:"done-row-desc",children:x.desc}),((f=x.students)==null?void 0:f.length)>0&&e.jsxs("span",{className:"done-row-students",children:["ðŸ‘¥ ",x.students.join(" Â· ")]})]})})]},x.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"premium-btn-secondary",onClick:r,children:"âœï¸ Edit Scores"}),e.jsxs("button",{className:"premium-btn-primary",onClick:a,children:[e.jsx(ut,{})," Back to Home"]})]})]})})}function Ks(t){return t==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:t==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:t==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"â€”",color:"#64748b",bg:"#f1f5f9"}}function ze({progress:t,onConfirm:s,onFresh:r}){var c,m;if(!t)return null;const a=typeof document<"u"&&((m=(c=document.body)==null?void 0:c.classList)==null?void 0:m.contains("auth-overlay-open")),n=t.loading&&!a,{rows:l,filledCount:o,totalCount:g,allSubmitted:x}=t,p=l&&l.length>0;return e.jsxs(e.Fragment,{children:[e.jsx(mt,{open:n,minDuration:400}),!t.loading&&e.jsx("div",{className:"premium-overlay spd-overlay",children:e.jsxs("div",{className:"premium-card spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon spd-icon-state","aria-hidden":"true",children:x?e.jsx(zt,{}):p?e.jsx(ks,{}):e.jsx(Ye,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:x?"All evaluations submitted":p?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[o," / ",g," groups completed on server"]})]})]}),p&&e.jsx("div",{className:"spd-list",children:Y.map(d=>{const f=l.find(h=>Number(h.projectId)===d.id),b=Ks(f==null?void 0:f.status),y=(f==null?void 0:f.total)??"â€”";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:d.name}),e.jsx("span",{className:"spd-row-total",children:y!=="â€”"?`${y}/100`:"â€”"}),e.jsx("span",{className:"spd-chip",style:{color:b.color,background:b.bg},children:b.label})]},d.id)})}),!p&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"premium-btn-primary",onClick:s,children:x?"View / Edit My Scores":p?"Continue from here":"Start Evaluation"}),p&&!x&&e.jsx("button",{className:"premium-btn-secondary",onClick:r,children:"Start Fresh"})]})]})})]})}function Js({onBack:t}){const{step:s,juryName:r,setJuryName:a,juryDept:n,setJuryDept:l,current:o,handleNavigate:g,scores:x,comments:p,touched:c,groupSynced:m,editMode:d,progressPct:f,allComplete:b,doneScores:y,doneComments:h,sheetProgress:w,saveStatus:j,pinStep:N,pinError:E,newPin:O,attemptsLeft:k,handleScore:v,handleScoreBlur:A,handleCommentChange:B,handleCommentBlur:Q,handleStart:M,handleConfirmFromSheet:W,handleStartFresh:X,handleResubmit:K,handleEditScores:I,handleFinalSubmit:D,handlePinSubmit:T,handlePinAcknowledge:L,sessionKicked:q,kickedMsg:se,handleKickedAcknowledge:ue,resetAll:me}=ys();return q?e.jsx("div",{className:"premium-overlay",children:e.jsxs("div",{className:"premium-card compact",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(Ge,{})}),e.jsx("div",{className:"premium-title",children:"Session Ended"}),e.jsx("div",{className:"premium-subtitle",children:se})]}),e.jsx("button",{className:"premium-btn-primary",onClick:ue,children:"Sign in again"})]})}):s==="done"?e.jsxs(e.Fragment,{children:[e.jsx(Gs,{doneScores:y,doneComments:h,scores:x,comments:p,onEditScores:I,onBack:()=>{me(),t()}}),e.jsx(ze,{progress:w,onConfirm:W,onFresh:X})]}):s==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{pinStep:N,pinError:E,newPin:O,attemptsLeft:k,juryName:r,onPinSubmit:T,onPinAcknowledge:L}),e.jsx(ze,{progress:w,onConfirm:W,onFresh:X})]}):s==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(zs,{juryName:r,juryDept:n,current:o,onNavigate:g,scores:x,comments:p,touched:c,groupSynced:m,editMode:d,progressPct:f,allComplete:b,saveStatus:j,handleScore:v,handleScoreBlur:A,handleCommentChange:B,handleCommentBlur:Q,handleFinalSubmit:D,onGoHome:t}),e.jsx(ze,{progress:w,onConfirm:W,onFresh:X})]}):e.jsxs(e.Fragment,{children:[e.jsx(_s,{juryName:r,setJuryName:a,juryDept:n,setJuryDept:l,onStart:M,onBack:t}),e.jsx(ze,{progress:w,onConfirm:W,onFresh:X})]})}const qs="modulepreload",Us=function(t){return"/senior-design-jury/"+t},Lt={},Ys=function(s,r,a){if(!r||r.length===0)return s();const n=document.getElementsByTagName("link");return Promise.all(r.map(l=>{if(l=Us(l),l in Lt)return;Lt[l]=!0;const o=l.endsWith(".css"),g=o?'[rel="stylesheet"]':"";if(!!a)for(let c=n.length-1;c>=0;c--){const m=n[c];if(m.href===l&&(!o||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${g}`))return;const p=document.createElement("link");if(p.rel=o?"stylesheet":qs,o||(p.as="script",p.crossOrigin=""),p.href=l,document.head.appendChild(p),o)return new Promise((c,m)=>{p.addEventListener("load",c),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>s()).catch(l=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l})},Vs=new Map(Y.map((t,s)=>typeof t=="string"?[s+1,{desc:"",students:[]}]:[t.id??s+1,{desc:t.desc??"",students:t.students??[]}]));function Qs(t){const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:0}function Ve(t){if(!t)return 0;const s=String(t).trim().replace(/\s*,\s*/g,", "),r=Date.parse(s);if(Number.isFinite(r))return r;const a=s.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(a)return new Date(+a[3],+a[2]-1,+a[1],+a[4],+a[5],+(a[6]||0)).getTime()||0;const n=s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let l=+(n[4]||0);const o=(n[7]||"").toUpperCase();return o==="PM"&&l<12&&(l+=12),o==="AM"&&l===12&&(l=0),new Date(+n[3],+n[1]-1,+n[2],l,+(n[5]||0),+(n[6]||0)).getTime()||0}function it(t){if(!t)return"â€”";const s=Ve(t);if(!s)return String(t);const r=new Date(s),a=n=>String(n).padStart(2,"0");return`${a(r.getDate())}/${a(r.getMonth()+1)}/${r.getFullYear()} ${a(r.getHours())}:${a(r.getMinutes())}`}function be(t,s){const r=Number(t),a=Number(s);return Number.isFinite(r)&&Number.isFinite(a)?r-a:String(t??"").toLowerCase()<String(s??"").toLowerCase()?-1:1}function Zt(t){let s=2166136261;for(let r=0;r<t.length;r++)s^=t.charCodeAt(r),s=Math.imul(s,16777619);return s>>>0}function es(t,s,r){s/=100,r/=100;const a=o=>(o+t/30)%12,n=s*Math.min(r,1-r),l=o=>Math.round(255*(r-n*Math.max(-1,Math.min(a(o)-3,Math.min(9-a(o),1))))).toString(16).padStart(2,"0");return`#${l(0)}${l(8)}${l(4)}`}const Xs=t=>es(Zt(t||"?")%360,55,95),Zs=t=>es(Zt(t||"?")%360,65,55);function Fe(t){return t===""||t===null||t===void 0||typeof t=="string"&&t.trim()===""||typeof t=="number"&&!Number.isFinite(t)?"":t}async function en(t){const s=await Ys(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],a=t.map(p=>{const c=Vs.get(p.projectId)||{desc:"",students:[]};return[p.juryName??"",p.juryDept??"",p.timestamp??"",p.projectName??"",c.desc,c.students.join(" Â· "),Fe(p.technical),Fe(p.design),Fe(p.delivery),Fe(p.teamwork),Fe(p.total),p.comments??""]}),n=s.utils.aoa_to_sheet([r,...a]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(p=>({wch:p}));const l=s.utils.book_new();s.utils.book_append_sheet(l,n,"Jury Evaluations");const o=new Date,g=o.toISOString().slice(0,10),x=`${String(o.getHours()).padStart(2,"0")}-${String(o.getMinutes()).padStart(2,"0")}`;s.writeFile(l,`jury_export_${g}_${x}.xlsx`)}const tn=t=>t.reduce((s,r)=>s+te.filter(a=>r[a.id]>0).length,0),sn=t=>{const s=Y.length*te.length;return s===0?0:Math.round(tn(t)/s*100)};function nn(t){const s={all_submitted:3,group_submitted:2,in_progress:1},r=(t||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:Ve(n==null?void 0:n.timestamp)})),a=new Map;for(const n of r){const l=String(n.juryName??"").trim().toLowerCase(),o=String(n.juryDept??"").trim().toLowerCase(),g=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!l||!g)continue;const x=`${l}__${o}__${g}`,p=a.get(x);if(!p){a.set(x,n);continue}if((n.tsMs||0)>(p.tsMs||0)){a.set(x,n);continue}(n.tsMs||0)===(p.tsMs||0)&&(s[n.status]||0)>(s[p.status]||0)&&a.set(x,n)}return[...a.values()].sort((n,l)=>(l.tsMs||0)-(n.tsMs||0))}function ts(t,s,r){i.useEffect(()=>{if(!t)return;const a=n=>{const l=Array.isArray(s)?s:[s];for(const o of l){const g=(o==null?void 0:o.current)??o;if(g&&(g===n.target||g.contains&&g.contains(n.target)))return}r==null||r()};return document.addEventListener("pointerdown",a,{capture:!0}),()=>document.removeEventListener("pointerdown",a,{capture:!0})},[t,s,r])}function _e({status:t,editingFlag:s,variant:r,icon:a,children:n}){return r||a||n?e.jsxs("span",{className:`status-badge${r?` ${r}`:""}`,children:[a,n]}):s==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(Je,{}),"Editing"]}):t==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(at,{}),"Submitted"]}):t==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(at,{}),"Submitted"]}):t==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(Ke,{}),"In Progress"]}):null}const rn="/senior-design-jury/assets/1st-place-medal-cb397e4c.svg",an="/senior-design-jury/assets/2nd-place-medal-9ec5b4d1.svg",on="/senior-design-jury/assets/3rd-place-medal-7ad05fc8.svg",ln=te.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),cn=[rn,an,on];function dn({ranked:t,submittedData:s}){const[r,a]=i.useState(new Set);function n(l){a(o=>{const g=new Set(o);return g.has(l)?g.delete(l):g.add(l),g})}return s.length===0?e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."}):e.jsxs("div",{className:"summary-page",children:[e.jsxs("div",{className:"summary-note",children:[e.jsx(Ue,{}),"The scores shown are ",e.jsx("strong",{children:"average (Î£)"})," group scores from ",e.jsx("strong",{children:"completed"})," evaluations."]}),e.jsx("div",{className:"rank-list",children:t.map((l,o)=>{var O,k;const g=l.id??o+1,x=`Group ${g}`,p=(l.name||"").trim(),c=(l.desc||"").trim(),m=!p||p===x,d=m?c||x:p,b=m?c:c&&c!==d?c:"",y=!m&&d&&d!==x,h=`summary-${g}-${o}`,w=r.has(h),j=y||!!b||((O=l.students)==null?void 0:O.length)>0,N=o<3,E=`summary-group-panel-${h}`;return e.jsxs("div",{className:`rank-card rank-${o+1} ${N?`rank-top${o+1}`:"rank-rest"}`,children:[N&&e.jsx("span",{className:`rank-accent rank-${o+1}`,"aria-hidden":"true"}),N?e.jsxs("div",{className:`rank-badge rank-medal-wrap rank-${o+1}`,"aria-hidden":"true",children:[e.jsx("span",{className:"rank-medal-ring","aria-hidden":"true"}),e.jsx("img",{className:"rank-medal",src:cn[o],alt:`${o+1} place medal`})]}):e.jsx("div",{className:"rank-badge rank-num",children:o+1}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"group-card-wrap",children:[e.jsxs("div",{className:"group-card-header",children:[e.jsxs("div",{className:"group-card-left",children:[e.jsxs("button",{className:"group-card-toggle group-accordion-header",tabIndex:j?0:-1,"aria-expanded":j?w:void 0,"aria-controls":j?E:void 0,type:"button",onClick:()=>{j&&n(h)},onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&j&&(v.preventDefault(),n(h))},style:{cursor:j?"pointer":"default"},children:[e.jsx("span",{className:"group-card-name",children:x}),j&&e.jsx("span",{className:`group-accordion-chevron${w?" open":""}`,children:e.jsx(Re,{})})]}),e.jsxs("span",{className:`eval-badge${N?" full":" partial"}`,children:[e.jsx(nt,{}),l.count]})]}),e.jsxs("div",{className:"group-card-score",children:[e.jsx("small",{className:"group-card-score-label sigma",children:"Î£"}),e.jsx("span",{className:"group-card-score-value avg-score",children:l.totalAvg.toFixed(2)})]})]}),e.jsx("div",{id:E,className:`group-accordion-panel${w?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner group-card-accordion-inner",children:[y&&e.jsx("div",{className:"group-card-full-title",children:d}),b&&e.jsxs("div",{className:"group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ot,{})}),e.jsx("span",{className:"group-card-desc-text",children:b})]}),((k=l.students)==null?void 0:k.length)>0&&e.jsxs("div",{className:"group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(nt,{})}),e.jsx("span",{className:"group-card-students-text",children:l.students.join(" Â· ")})]})]})})]}),e.jsx("div",{className:"rank-bars",children:ln.map(v=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:v.shortLabel||v.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(l.avg[v.id]||0)/v.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(l.avg[v.id]||0).toFixed(2)})]},v.id))})]})]},l.id??`${l.name}-${o}`)})})]})}const un=["9.1","9.2","1.2","2","3.1","3.2","8.1","8.2"],de=te.map(t=>({key:t.id,code:t.mudek.join("/"),label:t.shortLabel,max:t.max,color:t.color}));function ss(t){if(t.length<2)return 0;const s=t.reduce((r,a)=>r+a,0)/t.length;return Math.sqrt(t.reduce((r,a)=>r+(a-s)**2,0)/t.length)}function ht(t){return t.length?t.reduce((s,r)=>s+r,0)/t.length:0}function et(t,s){if(!t.length)return 0;const r=(t.length-1)*s,a=Math.floor(r),n=r-a;return t[a+1]===void 0?t[a]:t[a]+n*(t[a+1]-t[a])}function mn(t,s){return t.map(r=>Number(r[s])).filter(r=>Number.isFinite(r))}function Mt(t){const[s,r]=String(t).split("."),a=parseInt(s,10),n=parseInt(r??"0",10);return{major:Number.isFinite(a)?a:0,minor:Number.isFinite(n)?n:0}}function hn(t,s){const r=Mt(t),a=Mt(s);return r.major!==a.major?r.major-a.major:r.minor!==a.minor?r.minor-a.minor:String(t).localeCompare(String(s))}function Me({msg:t}){return e.jsx("div",{className:"chart-empty",children:t||"Not enough data yet."})}function pn({codes:t}){const[s,r]=i.useState("en"),[a,n]=i.useState(""),[l,o]=i.useState(()=>typeof window<"u"&&window.matchMedia("(max-width: 640px)").matches),[g,x]=i.useState(()=>!(typeof window<"u"&&window.matchMedia("(max-width: 640px)").matches));i.useEffect(()=>{if(typeof window>"u")return;const f=window.matchMedia("(max-width: 640px)"),b=()=>o(f.matches);return b(),f.addEventListener?f.addEventListener("change",b):f.addListener(b),()=>{f.addEventListener?f.removeEventListener("change",b):f.removeListener(b)}},[]),i.useEffect(()=>{x(!l)},[l]);const p=(t||[]).map(f=>({code:f,...ps[f]||{}})).filter(f=>f.code&&(f.en||f.tr)).sort((f,b)=>hn(f.code,b.code)),c=a.trim().toLowerCase(),m=c?p.filter(f=>{const b=(f.en||"").toLowerCase(),y=(f.tr||"").toLowerCase();return(f.code||"").toLowerCase().includes(c)||b.includes(c)||y.includes(c)}):p,d=f=>{const b=f.en||"",y=f.tr||"";return s==="tr"?e.jsx("div",{className:"mudek-outcome-text",children:y||b}):e.jsx("div",{className:"mudek-outcome-text",children:b||y})};return e.jsxs("div",{className:"mudek-outcomes",children:[e.jsxs("div",{className:"mudek-outcomes-controls",children:[e.jsxs("label",{className:"mudek-search","aria-label":"Search outcomes",children:[e.jsx("span",{className:"mudek-search-icon","aria-hidden":"true",children:e.jsx(Yt,{})}),e.jsx("input",{value:a,onChange:f=>n(f.target.value),placeholder:"Search by code or text"})]}),e.jsx("button",{type:"button",className:"mudek-lang-toggle",onClick:()=>r(f=>f==="en"?"tr":"en"),"aria-label":s==="en"?"Switch to Turkish":"Switch to English",title:s==="en"?"TÃ¼rkÃ§e":"English",children:e.jsx("span",{"aria-hidden":"true",children:s==="en"?"ðŸ‡¬ðŸ‡§":"ðŸ‡¹ðŸ‡·"})}),c&&e.jsxs("span",{className:"mudek-results-count",children:[m.length," results"]})]}),m.length===0&&e.jsx("div",{className:"mudek-empty",children:"No outcomes match your search."}),e.jsx("div",{className:"mudek-table-scroll",children:e.jsxs("div",{className:`mudek-outcomes-table${l&&!g?" compact":""}${l&&g?" expanded":""}`,children:[e.jsxs("div",{className:"mudek-outcomes-head",children:[e.jsx("div",{className:"mudek-col-code",children:s==="tr"?"Kod":"Code"}),e.jsx("div",{className:"mudek-col-outcome",children:s==="tr"?"Ã‡Ä±ktÄ±":"Outcome"})]}),e.jsx("div",{className:"mudek-outcomes-body",children:(l&&!g?m.slice(0,5):m).map(f=>e.jsxs("div",{className:"mudek-outcomes-row",children:[e.jsx("div",{className:"mudek-col-code",children:e.jsx("span",{className:"mudek-code",children:f.code})}),e.jsx("div",{className:"mudek-col-outcome",children:d(f)})]},f.code))})]})}),l&&m.length>5&&e.jsx("button",{type:"button",className:"mudek-outcomes-toggle",onClick:()=>x(f=>!f),children:g?"Collapse â†‘":"Show all outcomes â†“"})]})}function xn(){return e.jsx("div",{className:"mudek-rubric-list",children:te.map(t=>{const s=hs;return e.jsxs("div",{className:"mudek-rubric-criterion",children:[e.jsxs("div",{className:"mudek-rubric-criterion-title",children:[t.label,e.jsxs("span",{className:"mudek-rubric-criterion-meta",children:["(",t.mudek.join(", "),") Â· max ",t.max," pts"]})]}),e.jsx("div",{className:"mudek-table-scroll",children:e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Range"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"Description"})]})}),e.jsx("tbody",{children:t.rubric.map(r=>{const a=s[r.level]||{};return e.jsxs("tr",{children:[e.jsx("td",{"data-label":"Range",children:r.range}),e.jsx("td",{"data-label":"Level",children:e.jsx("span",{className:"mudek-band-badge",style:{background:a.bg,color:a.text},children:r.level})}),e.jsx("td",{"data-label":"Description",children:r.desc})]},r.level)})})]})})]},t.id)})})}function fn({outcomeCodes:t=un}){const[s,r]=i.useState(!1),[a,n]=i.useState("outcomes"),l=i.useRef(null),o=i.useRef(null);return i.useEffect(()=>{if(!s)return;function g(x){l.current&&!l.current.contains(x.target)&&r(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[s]),i.useEffect(()=>{if(!s)return;function g(x){var p;x.key==="Escape"&&(r(!1),(p=o.current)==null||p.focus())}return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[s]),e.jsxs("div",{className:"mudek-badge-wrap",ref:l,children:[e.jsxs("button",{ref:o,className:"mudek-badge",onClick:()=>r(g=>!g),"aria-label":"MÃœDEK outcome mapping","aria-expanded":s,children:[e.jsx($s,{}),e.jsx("span",{children:"MÃœDEK"}),e.jsx("span",{className:`mudek-chevron${s?" open":""}`,"aria-hidden":"true",children:e.jsx(Re,{})})]}),s&&e.jsxs("div",{className:"mudek-dropdown",role:"dialog","aria-label":"MÃœDEK outcome mapping",children:[e.jsxs("div",{className:"mudek-dropdown-header",children:[e.jsx("span",{children:"MÃœDEK Outcome Mapping"}),e.jsx("button",{className:"mudek-dropdown-close",onClick:()=>{var g;r(!1),(g=o.current)==null||g.focus()},"aria-label":"Close",children:"âœ•"})]}),e.jsxs("div",{className:"mudek-tabs",children:[e.jsx("button",{className:`mudek-tab-btn${a==="outcomes"?" active":""}`,onClick:()=>n("outcomes"),children:"MÃœDEK Outcomes"}),e.jsx("button",{className:`mudek-tab-btn${a==="rubric"?" active":""}`,onClick:()=>n("rubric"),children:"Rubric Bands"})]}),e.jsxs("div",{className:"mudek-dropdown-body",children:[a==="outcomes"&&e.jsx(pn,{codes:t}),a==="rubric"&&e.jsx(xn,{})]}),e.jsx("div",{className:"mudek-dropdown-footer",children:"â„¹ This chart provides evidence for the outcomes above."})]})]})}function jn({data:t}){const s=t||[];if(!s.length)return e.jsx(Me,{});const r=de.map(h=>{const w=mn(s,h.key),j=w.length?ht(w):0,N=h.max>0?j/h.max*100:0,E=w.length>1?ss(w)/h.max*100:0;return{...h,avgRaw:j,pct:N,sd:E,n:w.length}}),a=38,n=22,l=34,o=8,g=22,x=20,p=160,c=r.length,m=l+c*a+(c-1)*n+o,d=g+p+x,f=h=>l+h*(a+n),b=h=>f(h)+a/2,y=h=>g+p*(1-Math.max(0,Math.min(100,h))/100);return e.jsxs("div",{className:"chart-card chart-compact-equal chart-fill-card dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Programme-Level Outcome Averages"}),e.jsx("div",{className:"chart-note",children:"Grand mean Â±1 SD normalized score per outcome across all groups and jurors."})]})}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${m} ${d}`,preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"100%",display:"block"},children:[[0,25,50,75,100].map(h=>{const w=y(h);return e.jsxs("g",{children:[e.jsx("line",{x1:l,y1:w,x2:m-o,y2:w,stroke:h===0?"#cbd5e1":"#e2e8f0",strokeWidth:h===0?1.2:1}),e.jsx("text",{className:"chart-y-tick",x:l-4,y:w+3.5,textAnchor:"end",fontSize:"7",fill:"#94a3b8",children:h})]},h)}),e.jsx("text",{className:"chart-y-label",x:"10",y:g+p/2,transform:`rotate(-90 10 ${g+p/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((h,w)=>{const j=f(w),N=b(w),E=y(h.pct),O=p-(E-g),k=y(h.pct+h.sd),v=y(Math.max(0,h.pct-h.sd));return e.jsxs("g",{children:[e.jsxs("title",{children:[h.label," (",h.code,")",`
`,"Grand mean: ",h.pct.toFixed(1),"%",`
`,"SD: Â±",h.sd.toFixed(1),"%",`
`,"N evaluations: ",h.n]}),e.jsx("rect",{x:j,y:g,width:a,height:p,rx:"3",fill:"#f1f5f9"}),O>0&&e.jsx("rect",{x:j,y:E,width:a,height:O,rx:"3",fill:h.color}),h.sd>0&&e.jsxs(e.Fragment,{children:[e.jsxs("g",{stroke:"#ffffff",strokeWidth:"3.2",strokeLinecap:"round",opacity:"0.65",children:[e.jsx("line",{x1:N,y1:k,x2:N,y2:v}),e.jsx("line",{x1:N-7,y1:k,x2:N+7,y2:k}),e.jsx("line",{x1:N-7,y1:v,x2:N+7,y2:v})]}),e.jsxs("g",{stroke:"#6b7280",strokeWidth:"1.2",strokeLinecap:"round",opacity:"0.75",children:[e.jsx("line",{x1:N,y1:k,x2:N,y2:v}),e.jsx("line",{x1:N-7,y1:k,x2:N+7,y2:k}),e.jsx("line",{x1:N-7,y1:v,x2:N+7,y2:v}),e.jsx("circle",{cx:N,cy:k,r:"1.6",fill:"#6b7280",stroke:"none"}),e.jsx("circle",{cx:N,cy:v,r:"1.6",fill:"#6b7280",stroke:"none"})]})]}),e.jsx("text",{className:"chart-bar-value",x:N,y:E+O/2+3,textAnchor:"middle",fontSize:"9",fill:"#ffffff",stroke:"rgba(15,23,42,0.35)",strokeWidth:"0.8",fontWeight:"700",style:{paintOrder:"stroke"},children:h.pct.toFixed(1)}),e.jsx("text",{className:"chart-x-label",x:N,y:g+p+13,textAnchor:"middle",fontSize:"8.5",fill:"#374151",fontWeight:"500",children:h.label})]},h.key)})]})})]})}function gn({stats:t}){const s=t.filter(m=>m.count>0);if(!s.length)return e.jsx(Me,{});const r=14,a=4,n=de.length*(r+a)+12,l=8,o=130,g=28,x=s.length*n+g+10,p=o+l,c=l+(o-xt/100*o);return e.jsxs("div",{className:"chart-card chart-compact-equal",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Outcome Achievement by Group"}),e.jsx("div",{className:"chart-note",children:"Compares each group's normalized score across all four MÃœDEK-mapped criteria."})]})}),e.jsx("div",{className:"chart-svg-wrap",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${x} ${p+36}`,style:{width:"100%",height:"auto",display:"block"},children:[e.jsx("text",{x:"10",y:l+o/2,transform:`rotate(-90 10 ${l+o/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),[0,25,50,75,100].map(m=>{const d=l+(o-m/100*o);return e.jsxs("g",{children:[e.jsx("line",{x1:g,y1:d,x2:x,y2:d,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:g-4,y:d+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:m})]},m)}),e.jsx("g",{children:e.jsx("line",{x1:g,y1:c,x2:x,y2:c,stroke:"#6B7280",strokeWidth:"1",strokeDasharray:"3,3"})}),s.map((m,d)=>{const f=g+d*n+4;return e.jsxs("g",{children:[de.map((b,y)=>{const h=(m.avg[b.key]||0)/b.max*100,w=h/100*o,j=f+y*(r+a);return e.jsxs("g",{children:[e.jsxs("title",{children:[m.name," Â· ",b.label,": ",h.toFixed(1),"%"]}),e.jsx("rect",{x:j,y:l+(o-w),width:r,height:w,fill:b.color,rx:"2",opacity:"0.85"})]},b.key)}),e.jsx("text",{x:f+de.length*(r+a)/2-a/2,y:l+o+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:m.name})]},m.id)})]})}),e.jsxs("div",{className:"chart-legend",children:[de.map(m=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:m.color}}),m.label]},m.key)),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-line","aria-hidden":"true"}),"Reference (",xt,"%)"]})]})]})}function vn({stats:t}){var w;const s=t.filter(j=>j.count>0),[r,a]=i.useState(((w=s[0])==null?void 0:w.id)??null);if(!s.length)return e.jsx(Me,{});const n=s.find(j=>j.id===(r??s[0].id))??s[0],l=de.length,o=130,g=120,x=82,p=j=>Math.PI*2*j/l-Math.PI/2,c=(j,N)=>({x:o+N*Math.cos(p(j)),y:g+N*Math.sin(p(j))}),m=de.map(j=>(n.avg[j.key]||0)/j.max*100),d=de.map(j=>{const N=s.map(E=>(E.avg[j.key]||0)/j.max*100);return ht(N)}),f=m.map((j,N)=>c(N,j/100*x)),b=d.map((j,N)=>c(N,j/100*x)),y=f.map((j,N)=>`${N===0?"M":"L"}${j.x.toFixed(1)},${j.y.toFixed(1)}`).join(" ")+" Z",h=b.map((j,N)=>`${N===0?"M":"L"}${j.x.toFixed(1)},${j.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Competency Profile per Group"}),e.jsx("div",{className:"chart-note",children:"Shows whether a group's competency development is balanced or skewed across all four outcomes."})]})}),s.length>1&&e.jsx("select",{className:"radar-group-select",value:r??s[0].id,onChange:j=>a(Number(j.target.value)),children:s.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:"0 0 260 240",preserveAspectRatio:"xMidYMid meet",style:{width:"100%",maxWidth:280,height:"100%",display:"block"},children:[[.25,.5,.75,1].map(j=>{const E=de.map((O,k)=>c(k,j*x)).map((O,k)=>`${k===0?"M":"L"}${O.x.toFixed(1)},${O.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:E,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},j)}),[.25,.5,.75,1].map(j=>{const N=c(0,j*x);return e.jsxs("text",{x:N.x.toFixed(1),y:(N.y-6).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:[Math.round(j*100),"%"]},`tick-${j}`)}),de.map((j,N)=>{const E=c(N,x);return e.jsx("line",{x1:o,y1:g,x2:E.x.toFixed(1),y2:E.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},N)}),e.jsx("path",{d:h,fill:"none",stroke:"#9CA3AF",strokeWidth:"1.5",strokeDasharray:"4,3"}),e.jsx("path",{d:y,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.2",strokeLinejoin:"round"}),f.map((j,N)=>e.jsxs("g",{children:[e.jsxs("title",{children:[de[N].label,": ",m[N].toFixed(1),"%",`
`,"Cohort avg: ",d[N].toFixed(1),"%"]}),e.jsx("circle",{cx:j.x.toFixed(1),cy:j.y.toFixed(1),r:"3.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.2"})]},N)),de.map((j,N)=>{const E=c(N,x+16);return e.jsx("text",{x:E.x.toFixed(1),y:E.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"9",fill:"#334155",fontWeight:"700",children:j.label},j.key)})]})}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#3b82f6"}}),n.name]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#9CA3AF"}}),"Cohort Average (dashed)"]})]})]})}function bn({data:t}){const s=t||[];if(!s.length)return e.jsx(Me,{});const r=de.map(v=>{const A=s.map(L=>Number(L[v.key])).filter(L=>Number.isFinite(L)&&L>0).map(L=>L/v.max*100).sort((L,q)=>L-q);if(!A.length)return{...v,empty:!0};const B=et(A,.25),Q=et(A,.5),M=et(A,.75),W=M-B,X=B-1.5*W,K=M+1.5*W,I=A.find(L=>L>=X)??A[0],D=[...A].reverse().find(L=>L<=K)??A[A.length-1],T=A.filter(L=>L<X||L>K);return{...v,q1:B,med:Q,q3:M,whiskerMin:I,whiskerMax:D,outliers:T}}),a=320,n=36,l=10,o=6,g=160,x=g+o+20,p=(a-n-l)/r.length,c=18,m=r.flatMap(v=>v.empty?[]:[v.whiskerMin,v.whiskerMax,...v.outliers]),d=m.length?Math.min(...m):0,f=m.length?Math.max(...m):100,b=Math.max(5,f-d),y=Math.min(10,b*.12),h=Math.max(0,d-y),w=Math.min(100,f+y),j=v=>o+(g-(v-h)/Math.max(1,w-h)*g),N=b<=10?2:b<=20?5:b<=40?10:b<=70?20:25,E=Math.ceil(h/N)*N,O=Math.floor(w/N)*N,k=[];for(let v=E;v<=O;v+=N)k.push(v);return k.length<2&&(k.length=0,k.push(Math.round(h),Math.round((h+w)/2),Math.round(w))),e.jsxs("div",{className:"chart-card chart-equal-bottom dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Score Distribution by Criterion"}),e.jsx("div",{className:"chart-note",children:"Reveals inter-juror spread for each criterion â€” evidence of measurement reliability."})]})}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${a} ${x}`,style:{width:"100%",height:"100%",display:"block"},children:[k.map(v=>{const A=j(v);return e.jsxs("g",{children:[e.jsx("line",{x1:n,y1:A,x2:a-l,y2:A,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:n-4,y:A+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:Math.round(v)})]},v)}),e.jsx("line",{x1:n,y1:o,x2:n,y2:o+g,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:"10",y:o+g/2,transform:`rotate(-90 10 ${o+g/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((v,A)=>{const B=n+A*p+p/2;if(v.empty)return e.jsx("text",{x:B,y:o+g+16,fontSize:"9",textAnchor:"middle",fill:"#94a3b8",children:v.label},v.key);const Q=j(v.q1),M=j(v.q3),W=j(v.med);return e.jsxs("g",{children:[e.jsx("rect",{x:B-c/2,y:M,width:c,height:Math.max(2,Q-M),fill:"rgba(59,130,246,0.18)",stroke:v.color,strokeWidth:"1.6"}),e.jsx("line",{x1:B-c/2,y1:W,x2:B+c/2,y2:W,stroke:v.color,strokeWidth:"2.2"}),e.jsx("text",{x:B,y:o+g+16,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:v.label})]},v.key)})]})}),e.jsxs("div",{className:"chart-legend boxplot-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-box"}),"IQR band (Q1â€“Q3)"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-median"}),"Median"]})]})]})}function yn({stats:t,data:s}){const r=t.filter(d=>d.count>0),a=s||[];if(!r.length||!a.length)return e.jsx(Me,{});const n=de.map(d=>r.map(f=>{const b=a.filter(w=>w.projectId===f.id).map(w=>Number(w[d.key])).filter(w=>Number.isFinite(w));if(b.length<2)return{cv:null,m:null,sd:null,n:b.length};const y=ht(b);if(!y)return{cv:null,m:y,sd:null,n:b.length};const h=ss(b);return{cv:h/y*100,m:y,sd:h,n:b.length}})),l=d=>d===null?{fill:"#f1f5f9",text:"#94a3b8"}:d<10?{fill:"#dcfce7",text:"#166534"}:d<15?{fill:"#bbf7d0",text:"#166534"}:d<25?{fill:"#fef08a",text:"#92400e"}:{fill:"#fecaca",text:"#991b1b"},o=100,g=26,x=96,p=48,c=o+r.length*x,m=g+de.length*p+10;return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Juror Consistency Heatmap"}),e.jsx("div",{className:"chart-note",children:"Identifies which group Ã— criterion combinations have poor juror agreement, guiding rubric improvement."})]})}),e.jsxs("div",{className:"cv-formula-block",children:[e.jsx("span",{className:"cv-formula-pill","aria-label":"CV equals sigma divided by x bar times 100",children:e.jsx("math",{xmlns:"http://www.w3.org/1998/Math/MathML",className:"cv-formula-math",children:e.jsxs("mrow",{children:[e.jsx("mi",{children:"CV"}),e.jsx("mo",{children:"="}),e.jsxs("mrow",{children:[e.jsx("mo",{children:"("}),e.jsxs("mfrac",{children:[e.jsx("mi",{children:"Ïƒ"}),e.jsx("mi",{children:"Î¼"})]}),e.jsx("mo",{children:")"})]}),e.jsx("mo",{children:"Ã—"}),e.jsx("mn",{children:"100"})]})})}),e.jsx("span",{className:"cv-formula-legend",children:"Ïƒ = std. deviation Â Â·Â  Î¼ = mean score Â Â·Â  CV = juror disagreement %"})]}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${c} ${m}`,style:{width:"100%",maxWidth:c,height:"100%",display:"block"},children:[r.map((d,f)=>e.jsx("text",{x:o+f*x+x/2,y:16,textAnchor:"middle",fontSize:"11",fill:"#475569",fontWeight:"600",children:d.name},d.id)),de.map((d,f)=>e.jsxs("g",{children:[e.jsx("text",{x:o-10,y:g+f*p+p/2+6,textAnchor:"end",fontSize:"12",fill:"#475569",fontWeight:"600",children:d.label}),r.map((b,y)=>{const h=n[f][y],w=h.cv,j=o+y*x,N=g+f*p,E=l(w),O=[`${b.name} Â· ${d.label}`,`CV: ${w===null?"N/A":Math.round(w)+"%"}`,h.m!==null?`Mean: ${(h.m/d.max*100).toFixed(1)}%`:"",h.sd!==null?`SD: ${h.sd.toFixed(2)}`:"",`N jurors: ${h.n}`].filter(Boolean).join(`
`);return e.jsxs("g",{children:[e.jsx("title",{children:O}),e.jsx("rect",{x:j+3,y:N+3,width:x-6,height:p-6,rx:"12",fill:E.fill,stroke:"rgba(148,163,184,0.25)"}),e.jsx("text",{x:j+x/2,y:N+p/2+6,textAnchor:"middle",fontSize:"12",fill:E.text,fontWeight:"700",children:w===null?"N/A":`${Math.round(w)}%`})]},`${d.key}-${b.id}`)})]},d.key))]})}),e.jsxs("div",{className:"heatmap-legend",children:[e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#dcfce7",borderColor:"#bbf7d0"}}),"<10% CV (excellent)"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#bbf7d0",borderColor:"#86efac"}}),"10â€“15% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fef08a",borderColor:"#fde047"}}),"15â€“25% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fecaca",borderColor:"#fca5a5"}}),">25% CV (poor)"]})]})]})}function kn({data:t}){const s=t||[];if(!s.length)return e.jsx(Me,{});const r=[{key:"insufficient",label:"Insufficient",color:"#ef4444"},{key:"developing",label:"Developing",color:"#f59e0b"},{key:"good",label:"Good",color:"#a3e635"},{key:"excellent",label:"Excellent",color:"#22c55e"}],a=(h,w)=>{if(!Number.isFinite(h))return null;for(const j of w)if(h>=j.min&&h<=j.max)return j.level.toLowerCase();return null},n=de.map(h=>{const w=te.find(k=>k.id===h.key),j=s.map(k=>Number(k[h.key])).filter(k=>Number.isFinite(k)),N={excellent:0,good:0,developing:0,insufficient:0};j.forEach(k=>{const v=a(k,w.rubric);v&&(N[v]+=1)});const E=j.length||1,O=r.map(k=>({...k,pct:N[k.key]/E*100,count:N[k.key]}));return{...h,pct:O,total:j.length}}),l=r.map(h=>({...h,anyPresent:n.some(w=>{var j;return((j=w.pct.find(N=>N.key===h.key))==null?void 0:j.pct)>0})})),o=340,g=32,x=10,p=8,c=28,m=180,d=p+m+c,f=(o-g-x)/n.length,b=Math.min(44,f*.65),y=h=>h/100*m;return e.jsxs("div",{className:"chart-card chart-equal-bottom dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Achievement Level Distribution"}),e.jsx("div",{className:"chart-note",children:"% of evaluations per rubric band â€” directly maps to MÃœDEK continuous improvement evidence."})]})}),e.jsx("div",{className:"chart-svg-fill rubric-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${o} ${d}`,style:{width:"100%",height:"auto",display:"block"},children:[[0,25,50,75,100].map(h=>{const w=p+m-y(h);return e.jsxs("g",{children:[e.jsx("line",{x1:g,y1:w,x2:o-x,y2:w,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsxs("text",{x:g-4,y:w+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:[h,"%"]})]},h)}),n.map((h,w)=>{const j=g+w*f+f/2,N=j-b/2;let E=0;return e.jsxs("g",{children:[h.pct.map(O=>{if(O.pct<=0)return null;const k=y(O.pct),v=p+m-E-k;E+=k;const A=k>=16;return e.jsxs("g",{children:[e.jsxs("title",{children:[h.label," Â· ",O.label,`
`,"Count: ",O.count," evaluation",O.count!==1?"s":"",`
`,"Share: ",O.pct.toFixed(0),"%"]}),e.jsx("rect",{x:N,y:v,width:b,height:k,fill:O.color}),A&&e.jsxs("text",{x:j,y:v+k/2+4,textAnchor:"middle",fontSize:"9",fill:"#fff",fontWeight:"700",children:[O.pct.toFixed(0),"%"]})]},O.key)}),e.jsx("text",{x:j,y:p+m+16,textAnchor:"middle",fontSize:"9",fill:"#475569",fontWeight:"600",children:h.label})]},h.key)})]})}),e.jsx("div",{className:"chart-legend rubric-legend",children:[...l].reverse().map(h=>e.jsxs("span",{className:"legend-item",style:h.anyPresent?void 0:{opacity:.35,textDecoration:"line-through"},children:[e.jsx("span",{className:"legend-dot",style:{background:h.color}}),h.label]},h.key))})]})}function Nn(t){return t?t.toLocaleString("tr-TR",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," Â·"):"â€”"}function wn(){return e.jsxs("div",{className:"dashboard-loading",children:[e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]}),e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]})]})}function Sn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#FCA5A5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("p",{className:"dashboard-state-title",children:"Could not load data"}),e.jsx("span",{className:"dashboard-state-sub",children:"Check your connection and refresh the page."})]})}function Cn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#D1D5DB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),e.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("p",{className:"dashboard-state-title",children:"No data available"}),e.jsx("span",{className:"dashboard-state-sub",children:"Evaluations will appear here once jurors submit their scores."})]})}function Ln({dashboardStats:t,submittedData:s,lastRefresh:r,loading:a,error:n}){const l=i.useRef(null),[o,g]=i.useState(!1),x=i.useRef(null);async function p(){if(o||!l.current)return;g(!0);const m=l.current,d=m.querySelector(".dashboard-toolbar"),f=m.querySelector(".print-header"),b=m.querySelectorAll(".mudek-badge-wrap"),y=(d==null?void 0:d.style.display)??"",h=(f==null?void 0:f.style.display)??"",w=[];b.forEach(E=>w.push(E.style.visibility??""));const j=()=>{d&&(d.style.display=y),f&&(f.style.display=h),b.forEach((E,O)=>{E.style.visibility=w[O]||""}),m.classList.remove("print-mode"),g(!1),x.current=null};x.current=j,d&&(d.style.display="none"),f&&(f.style.display="block"),b.forEach(E=>E.style.visibility="hidden"),m.classList.add("print-mode");const N=()=>j();window.addEventListener("afterprint",N,{once:!0}),requestAnimationFrame(()=>{setTimeout(()=>{window.print()},50)})}i.useEffect(()=>()=>{x.current&&x.current()},[]);const c=Nn(r);return a?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(wn,{})}):n?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(Sn,{})}):!s||s.length===0?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(Cn,{})}):e.jsxs("div",{className:"dashboard-print-wrap",ref:l,children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:ye.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[ye.courseName," â€” ",ye.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report Â Â·Â  ",c,"Â Â·Â  ",s.length," final submission",s.length!==1?"s":"","Â Â·Â  ",t.length," group",t.length!==1?"s":""]})]}),e.jsxs("div",{className:"dashboard-toolbar no-print",children:[e.jsx("div",{className:"dashboard-toolbar-left",children:e.jsx(fn,{})}),e.jsx("span",{className:"dashboard-toolbar-divider","aria-hidden":"true"}),e.jsxs("button",{className:"pdf-export-btn",onClick:p,disabled:o,children:[e.jsx(Gt,{}),o?"Preparing PDFâ€¦":"Export PDF"]})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Outcome Distribution"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"1",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-1",children:e.jsx(gn,{stats:t})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Programme Overview"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"2",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-2",children:e.jsx(jn,{data:s})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-3",children:e.jsx(vn,{stats:t})})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Juror Consistency"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"3",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-4",children:e.jsx(yn,{stats:t,data:s})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Criterion Analysis"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"4",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-5",children:e.jsx(bn,{data:s})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-6",children:e.jsx(kn,{data:s})})]})]})}const Et=Y.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function De(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(t);return Number.isFinite(s)?s:""}const Mn=[{key:"in_progress",label:"In Progress"},{key:"editing",label:"Editing"},{key:"submitted",label:"Submitted"}],At=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}];function It(t){return t.jurorId?t.jurorId:`${(t.juryName||"").trim().toLowerCase()}__${(t.juryDept||"").trim().toLowerCase()}`}function En({open:t,anchorRect:s,anchorEl:r,onClose:a,className:n,contentKey:l,mode:o="anchor",children:g}){const x=i.useRef(null),[p,c]=i.useState({left:0,top:0,visibility:"hidden"});return ts(t,[x,r],a),i.useLayoutEffect(()=>{if(!t||!x.current)return;const m=x.current,d=()=>{if(o==="center"){c({left:"50%",top:"50%",transform:"translate(-50%, -50%)",visibility:"visible"});return}if(!s)return;const f=8,b=m.offsetWidth,y=m.offsetHeight,h=window.innerWidth,w=window.innerHeight;let j=s.left;j=Math.min(j,h-b-f),j=Math.max(f,j);let N=s.bottom+6;if(N+y+f>w){const E=s.top-y-6;E>=f?N=E:N=Math.max(f,w-y-f)}c({left:j,top:N,transform:"none",visibility:"visible"})};return d(),window.addEventListener("resize",d),window.addEventListener("orientationchange",d),()=>{window.removeEventListener("resize",d),window.removeEventListener("orientationchange",d)}},[t,s,l,o]),!t||o!=="center"&&!s?null:lt.createPortal(e.jsx("div",{ref:x,className:n,style:p,role:"dialog","aria-modal":"true",onClick:m=>m.stopPropagation(),onPointerDown:m=>m.stopPropagation(),onTouchStart:m=>m.stopPropagation(),children:g}),document.body)}function An({data:t,jurors:s}){const[r,a]=i.useState("ALL"),[n,l]=i.useState("ALL"),[o,g]=i.useState("ALL"),[x,p]=i.useState(new Set),[c,m]=i.useState(""),[d,f]=i.useState(""),[b,y]=i.useState(null),[h,w]=i.useState(""),[j,N]=i.useState("tsMs"),[E,O]=i.useState("desc"),[k,v]=i.useState(null),[A,B]=i.useState(null),[Q,M]=i.useState(null),[W,X]=i.useState(()=>typeof window<"u"&&window.matchMedia("(max-width: 480px)").matches),K=i.useMemo(()=>Et.map(u=>({id:u.id,label:`Group ${u.id}`,name:u.name})).sort((u,_)=>u.id-_.id),[]),I=i.useMemo(()=>{const u=new Map;return s.forEach(_=>{const R=String((_==null?void 0:_.dept)??"").trim();R&&u.set(R.toLowerCase(),R)}),Array.from(u.entries()).sort((_,R)=>_[1].localeCompare(R[1])).map(([_,R])=>({key:_,label:R}))},[s]);i.useEffect(()=>{if(!W||k!=="timestamp")return;const u=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=u}},[k,W]),i.useEffect(()=>{if(typeof window>"u")return;const u=window.matchMedia("(max-width: 480px)"),_=()=>X(u.matches);return _(),u.addEventListener?u.addEventListener("change",_):u.addListener(_),()=>{u.addEventListener?u.removeEventListener("change",_):u.removeListener(_)}},[]);function D(u,_,R){if(u<2e3||u>2100||_<1||_>12||R<1)return!1;const H=new Date(u,_,0).getDate();return R<=H}function T(u){if(!u)return null;if(/^\d{4}-\d{2}-\d{2}$/.test(u)){const[_,R,H]=u.split("-").map(Number);return D(_,R,H)?new Date(_,R-1,H).getTime():null}if(/^\d{2}\/\d{2}\/\d{4}$/.test(u)){const[_,R,H]=u.split("/").map(Number);return D(H,R,_)?new Date(H,R-1,_).getTime():null}return null}const L=i.useMemo(()=>c?T(c):null,[c]),q=i.useMemo(()=>d?T(d):null,[d]),se=i.useMemo(()=>L===null||q===null?!1:L>q,[L,q]);i.useEffect(()=>{y(c&&L===null||d&&q===null?"Invalid date format.":se?"The 'From' date cannot be later than the 'To' date.":null)},[c,d,L,q,se]);const ue=i.useMemo(()=>{let u=0;return r!=="ALL"&&(u+=1),n!=="ALL"&&(u+=1),o!=="ALL"&&(u+=1),x.size>0&&(u+=1),(c||d)&&(u+=1),h&&(u+=1),u},[r,n,o,x,c,d,h]),me=ue>0,ne=r!=="ALL"||k==="juror",ce=n!=="ALL"||k==="dept",re=o!=="ALL"||k==="group",ae=!!c||!!d||k==="timestamp",he=x.size>0||k==="status",fe=!!h||k==="comments";function ve(){a("ALL"),l("ALL"),g("ALL"),p(new Set),m(""),f(""),y(null),w(""),N("tsMs"),O("desc"),v(null),B(null)}function Ee(u){p(_=>{const R=new Set(_);return R.has(u)?R.delete(u):R.add(u),R})}function pe(){v(null),B(null),M(null)}function S(u,_){var oe,ee;const R=(ee=(oe=_==null?void 0:_.currentTarget)==null?void 0:oe.getBoundingClientRect)==null?void 0:ee.call(oe),H=(_==null?void 0:_.currentTarget)??null;v(xe=>{const je=xe===u?null:u;return je&&R&&(B(R),M(H)),je||(B(null),M(null)),je})}function z(u){return u===""||u===null||u===void 0||typeof u=="string"&&u.trim()===""?!0:typeof u=="number"?!Number.isFinite(u):!1}const V=i.useMemo(()=>{const u=L??0,_=q??1/0,R=Number.isFinite(_)?_+24*60*60*1e3-1:_;let H=t.slice();if(r!=="ALL"&&(H=H.filter(ee=>It(ee)===r)),o!=="ALL"&&(H=H.filter(ee=>String(ee.projectId)===o)),n!=="ALL"){const ee=n.toLowerCase();H=H.filter(xe=>String(xe.juryDept??"").trim().toLowerCase()===ee)}if(x.size>0&&(H=H.filter(ee=>{const xe=ee.editingFlag==="editing"||ee.status==="editing",je=ee.status==="group_submitted"||ee.status==="all_submitted",ke=ee.status==="in_progress";return!!(x.has("editing")&&xe||x.has("submitted")&&je||x.has("in_progress")&&ke)})),(c||d)&&((!c||L!==null)&&(!d||q!==null)&&!se)&&(H=H.filter(ee=>{const xe=ee.tsMs||Ve(ee.timestamp);return xe>=u&&xe<=R})),h){const ee=h.toLowerCase();H=H.filter(xe=>(xe.comments||"").toLowerCase().includes(ee))}return H.sort((ee,xe)=>{const je=ee[j],ke=xe[j],Be=z(je),We=z(ke);return Be&&We?0:Be?1:We?-1:E==="asc"?be(je,ke):be(ke,je)}),H},[t,r,o,n,x,c,d,h,j,E]);function G(u){j===u?O(_=>_==="asc"?"desc":"asc"):(N(u),O("desc"))}const Z=i.useMemo(()=>new Set(At.map(({key:u})=>u)),[]),le=u=>j!==u?e.jsx(Kt,{}):Z.has(u)?E==="asc"?e.jsx(Jt,{}):e.jsx(qt,{}):E==="asc"?e.jsx(As,{}):e.jsx(Is,{}),ie=(()=>{if(k==="juror")return{className:"col-filter-popover col-filter-popover-portal",contentKey:r,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:u=>{a(u.target.value),pe()},className:ne?"filter-input-active":"",children:[e.jsx("option",{value:"ALL",children:"All jurors"}),s.map(u=>e.jsxs("option",{value:u.key,children:[u.name,u.dept?` (${u.dept})`:""]},u.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),pe()},children:"Clear"})]})};if(k==="dept")return{className:"col-filter-popover col-filter-popover-portal",contentKey:n,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:u=>{l(u.target.value),pe()},className:ce?"filter-input-active":"",children:[e.jsx("option",{value:"ALL",children:"All departments"}),I.map(u=>e.jsx("option",{value:u.key,children:u.label},u.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{l("ALL"),pe()},children:"Clear"})]})};if(k==="group")return{className:"col-filter-popover col-filter-popover-portal",contentKey:o,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:o,onChange:u=>{g(u.target.value),pe()},className:re?"filter-input-active":"",children:[e.jsx("option",{value:"ALL",children:"All groups"}),K.map(u=>e.jsx("option",{value:String(u.id),children:u.label},u.id))]}),o!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{g("ALL"),pe()},children:"Clear"})]})};if(k==="timestamp"){const u=H=>{m(H)},_=H=>{f(H)},R=()=>{if(c&&L===null||d&&q===null){y("Invalid date format.");return}y(se?"The 'From' date cannot be later than the 'To' date.":null)};return{className:`col-filter-popover col-filter-popover-portal col-filter-popover-timestamp${W?" is-centered":""}`,contentKey:`${c}|${d}`,mode:W?"center":"anchor",content:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",placeholder:"YYYY-MM-DD",value:c,onChange:H=>u(H.target.value),onBlur:R,className:`timestamp-date-input ${b?"is-invalid ":""}${ae?"filter-input-active":""}`,"aria-invalid":!!b})]}),e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"To"}),e.jsx("input",{type:"date",placeholder:"YYYY-MM-DD",value:d,onChange:H=>_(H.target.value),onBlur:R,className:`timestamp-date-input ${b?"is-invalid ":""}${ae?"filter-input-active":""}`,"aria-invalid":!!b})]}),b&&e.jsx("div",{className:"timestamp-error",role:"alert",children:b}),W?e.jsxs("div",{className:"timestamp-actions",children:[(c||d)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{m(""),f("")},children:"Clear"}),e.jsx("button",{className:"timestamp-done-btn",onClick:pe,disabled:!!b,children:"Done"})]}):(c||d)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{m(""),f("")},children:"Clear"})]})}}return k==="status"?{className:"col-filter-popover col-filter-popover-portal col-filter-popover-status",contentKey:Array.from(x).sort().join("|"),content:e.jsxs(e.Fragment,{children:[Mn.map(({key:u,label:_})=>e.jsxs("label",{className:"status-option",children:[e.jsx("input",{type:"checkbox",checked:x.has(u),onChange:()=>Ee(u)}),_]},u)),x.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{p(new Set),pe()},children:"Clear"})]})}:k==="comments"?{className:"col-filter-popover col-filter-popover-portal",contentKey:h,content:e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:"Search commentsâ€¦",value:h,onChange:u=>w(u.target.value),className:fe?"filter-input-active":""}),h&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{w(""),pe()},children:"Clear"})]})}:null})();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:V.length})," row",V.length!==1?"s":""]}),me&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"filters-active-pill",children:["Filters: ",ue]}),e.jsx("button",{type:"button",className:"filters-clear-btn",onClick:ve,"aria-label":"Clear filters",title:"Clear filters",children:e.jsx(Vt,{})})]}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{en(V)},children:[e.jsx(Gt,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]})]}),e.jsx(En,{open:!!ie,anchorRect:A,anchorEl:Q,onClose:pe,className:ie==null?void 0:ie.className,contentKey:ie==null?void 0:ie.contentKey,mode:ie==null?void 0:ie.mode,children:ie==null?void 0:ie.content}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`col-sort-label details-col-label${ne?" filtered":""}`,onClick:()=>G("juryName"),children:"Juror"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${ne?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("juror",u)},title:"Filter by juror",children:e.jsx(we,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`col-sort-label details-col-label${ce?" filtered":""}`,onClick:()=>G("juryDept"),children:"Department"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${ce?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("dept",u)},title:"Filter by department",children:e.jsx(we,{})})]})}),e.jsx("th",{style:{position:"relative",whiteSpace:"nowrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`col-sort-label details-col-label${re?" filtered":""}`,onClick:()=>G("projectId"),children:"Group"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${re?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("group",u)},title:"Filter by group",children:e.jsx(we,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`col-sort-label details-col-label${ae?" filtered":""}`,onClick:()=>G("tsMs"),children:"Timestamp"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${ae?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("timestamp",u)},title:"Filter by date",children:e.jsx(we,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`col-sort-label details-col-label${he?" filtered":""}`,onClick:()=>G("status"),children:"Status"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${he?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("status",u)},title:"Filter by status",children:e.jsx(we,{})})]})}),At.map(({key:u,label:_})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>G(u),children:e.jsxs("span",{className:`col-sort-label details-col-label${j===u?" filtered":""}`,children:[_," ",e.jsx("span",{className:`sort-icon${j===u?" icon-active-box":""}`,children:le(u)})]})},u)),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:`details-col-label${fe?" filtered":""}`,children:"Comments"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${fe?" active filter-icon-active":""}`,onClick:u=>{u.preventDefault(),u.stopPropagation(),S("comments",u)},title:"Filter by comments",children:e.jsx(we,{})})]})})]})}),e.jsxs("tbody",{children:[V.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),V.map((u,_)=>{Et.find(H=>H.id===u.projectId);const R=u.status==="in_progress";return e.jsxs("tr",{className:_%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:u.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:u.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsx("div",{className:"cell-group-wrap",title:`Group ${u.projectId}`,style:{cursor:"default"},children:e.jsxs("strong",{className:"cell-group-title",children:["Group ",u.projectId]})})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:it(u.timestamp)}),e.jsx("td",{children:e.jsx(_e,{status:u.status,editingFlag:u.editingFlag})}),e.jsx("td",{style:{color:R?"#94a3b8":void 0},children:De(u.technical)}),e.jsx("td",{style:{color:R?"#94a3b8":void 0},children:De(u.design)}),e.jsx("td",{style:{color:R?"#94a3b8":void 0},children:De(u.delivery)}),e.jsx("td",{style:{color:R?"#94a3b8":void 0},children:De(u.teamwork)}),e.jsx("td",{style:{color:R?"#94a3b8":void 0},children:e.jsx("strong",{children:De(u.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:u.comments})]},`${It(u)}-${u.projectId}-${_}`)})]})]})})]})}const Ft=Y.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function In({jurorStats:t,onPinReset:s}){const[r,a]=i.useState(""),[n,l]=i.useState(""),[o,g]=i.useState(new Set);i.useEffect(()=>{const c=setTimeout(()=>l(r),200);return()=>clearTimeout(c)},[r]);function x(c){g(m=>{const d=new Set(m);return d.has(c)?d.delete(c):d.add(c),d})}const p=i.useMemo(()=>{const c=t.slice().sort((d,f)=>be(d.jury,f.jury)),m=n.trim().toLowerCase();return m?c.filter(d=>{var f;return d.jury.toLowerCase().includes(m)||(d.dept||((f=d.latestRow)==null?void 0:f.juryDept)||"").toLowerCase().includes(m)}):c},[t,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("span",{className:"juror-search-icon","aria-hidden":"true",children:e.jsx(Yt,{})}),e.jsx("input",{className:"juror-search-input",value:r,onChange:c=>a(c.target.value),placeholder:"Search by name or departmentâ€¦"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>a(""),"aria-label":"Clear search",title:"Clear search",children:e.jsx(Vt,{})})]})}),p.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:p.map(c=>{const{key:m,jury:d,rows:f,overall:b,latestRow:y}=c,h=sn(f),w=h===100?"#22c55e":h>66?"#84cc16":h>33?"#eab308":h>0?"#f97316":"#e2e8f0",j=f.some(k=>k.editingFlag==="editing"),N=Ft.map(k=>{const v=f.find(B=>B.projectId===k.id),A=(v==null?void 0:v.status)==="group_submitted"||(v==null?void 0:v.status)==="all_submitted"?"submitted":(v==null?void 0:v.status)||"not_started";return{id:k.id,status:A}}),E=N.length>0&&N.every(k=>k.status==="submitted"),O=j?"juror-card-editing":b==="all_submitted"?"juror-card-all-submitted":b==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${O}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:[e.jsx("span",{className:"juror-name-icon","aria-hidden":"true",children:e.jsx(Wt,{})}),e.jsxs("span",{className:"juror-name-text",children:[d,(y==null?void 0:y.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",y.juryDept,")"]})]})]}),e.jsx("div",{className:"juror-header-actions",children:j?e.jsx(_e,{status:b,editingFlag:"editing"}):E?e.jsx(_e,{variant:"completed",icon:e.jsx(rt,{}),children:"Completed"}):e.jsx(_e,{status:b})})]}),e.jsxs("div",{className:"juror-meta",children:[(y==null?void 0:y.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:it(y==null?void 0:y.timestamp)})]}),s&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${d}`,onClick:()=>s(d,(y==null?void 0:y.juryDept)||"",(y==null?void 0:y.jurorId)||""),children:"ðŸ”‘ Reset PIN"})]})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${h}%`,background:w}})}),e.jsxs("span",{className:"juror-progress-label",children:[h,"%"]})]}),e.jsx("div",{className:"juror-projects",children:f.slice().sort((k,v)=>k.projectId-v.projectId).map(k=>{var W,X;const v=Ft.find(K=>K.id===k.projectId),A=`${m}-${k.projectId}`,B=o.has(A),Q=`juror-group-panel-${A}`,M=!!(v!=null&&v.desc)||((W=v==null?void 0:v.students)==null?void 0:W.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:M?0:-1,"aria-expanded":B,"aria-controls":Q,onClick:()=>{M&&x(A)},onKeyDown:K=>{(K.key==="Enter"||K.key===" ")&&M&&(K.preventDefault(),x(A))},style:{cursor:M?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(v==null?void 0:v.name)||`Group ${k.projectId}`}),M&&e.jsx("span",{className:`group-accordion-chevron${B?" open":""}`,children:e.jsx(Re,{})})]})}),e.jsxs("div",{className:"juror-row-right",children:[k.timestamp&&e.jsxs("span",{className:"juror-row-ts",children:[e.jsx("span",{className:"juror-row-ts-icon","aria-hidden":"true",children:e.jsx(Ht,{})}),it(k.timestamp)]}),e.jsx(_e,{status:k.status,editingFlag:k.editingFlag}),(k.status==="all_submitted"||k.status==="group_submitted")&&e.jsx("span",{className:"juror-score",title:"/ 100","aria-label":`${k.total} / 100`,children:k.total})]})]}),e.jsx("div",{id:Q,className:`group-accordion-panel${B?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(v==null?void 0:v.desc)&&e.jsxs("span",{className:"juror-row-desc group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ot,{})}),e.jsx("span",{className:"group-card-desc-text",children:v.desc})]}),((X=v==null?void 0:v.students)==null?void 0:X.length)>0&&e.jsxs("span",{className:"juror-row-students group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(nt,{})}),e.jsx("span",{className:"group-card-students-text",children:v.students.join(" Â· ")})]})]})})]},A)})})]},m)})})]})}function Fn({open:t,anchorRect:s,anchorEl:r,onClose:a,className:n,contentKey:l,mode:o="anchor",children:g}){const x=i.useRef(null),[p,c]=i.useState({left:0,top:0,visibility:"hidden"});return ts(t,[x,r],a),i.useLayoutEffect(()=>{if(!t||!x.current)return;const m=x.current,d=()=>{if(o==="center"){c({left:"50%",top:"50%",transform:"translate(-50%, -50%)",visibility:"visible"});return}if(!s)return;const f=8,b=m.offsetWidth,y=m.offsetHeight,h=window.innerWidth,w=window.innerHeight;let j=s.left;j=Math.min(j,h-b-f),j=Math.max(f,j);let N=s.bottom+6;if(N+y+f>w){const E=s.top-y-6;E>=f?N=E:N=Math.max(f,w-y-f)}c({left:j,top:N,transform:"none",visibility:"visible"})};return d(),window.addEventListener("resize",d),window.addEventListener("orientationchange",d),()=>{window.removeEventListener("resize",d),window.removeEventListener("orientationchange",d)}},[t,s,l,o]),!t||o!=="center"&&!s?null:lt.createPortal(e.jsx("div",{ref:x,className:n,style:p,role:"dialog","aria-modal":"true",onClick:m=>m.stopPropagation(),onPointerDown:m=>m.stopPropagation(),onTouchStart:m=>m.stopPropagation(),children:g}),document.body)}const Dn=t=>t?t.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="group_submitted"?{background:"#ecfdf3",color:"#16a34a",fontWeight:600}:t.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},$n=t=>t?t.status==="all_submitted"||t.status==="group_submitted"?t.total:t.status==="in_progress"?"":"â€”":"â€”";function Pn({data:t,jurors:s,groups:r}){const[a,n]=i.useState(null),[l,o]=i.useState("desc"),[g,x]=i.useState("asc"),[p,c]=i.useState("juror"),[m,d]=i.useState(""),[f,b]=i.useState(null),[y,h]=i.useState(null),[w,j]=i.useState(null),N=!!m||f==="juror";function E(){b(null),h(null),j(null)}function O(I,D){var q,se;const T=(se=(q=D==null?void 0:D.currentTarget)==null?void 0:q.getBoundingClientRect)==null?void 0:se.call(q),L=(D==null?void 0:D.currentTarget)??null;b(ue=>{const me=ue===I?null:I;return me&&T&&(h(T),j(L)),me||(h(null),j(null)),me})}const k=i.useMemo(()=>{const I={};return t.forEach(D=>{const T=D.jurorId?D.jurorId:`${(D.juryName||"").trim().toLowerCase()}__${(D.juryDept||"").trim().toLowerCase()}`;I[T]||(I[T]={}),I[T][D.projectId]={total:D.total,status:D.status,editingFlag:D.editingFlag}}),I},[t]);function v(I){a!==I?(n(I),o("desc"),c("group")):l==="desc"?(o("asc"),c("group")):(n(null),o("desc"),c("group"))}const A=I=>p!=="group"||a!==I?e.jsx(Kt,{}):l==="desc"?e.jsx(qt,{}):e.jsx(Jt,{});function B(){p!=="juror"?(c("juror"),x("asc")):x(I=>I==="asc"?"desc":"asc")}const Q=i.useMemo(()=>{let I=s.slice().sort((D,T)=>be(D.name,T.name));if(m){const D=m.toLowerCase();I=I.filter(T=>T.name.toLowerCase().includes(D))}return p==="juror"&&(I=I.slice().sort((D,T)=>g==="asc"?be(D.name,T.name):be(T.name,D.name))),p==="group"&&a!==null&&(I=[...I].sort((D,T)=>{var ne,ce;const L=(ne=k[D.key])==null?void 0:ne[a],q=(ce=k[T.key])==null?void 0:ce[a],se=(L==null?void 0:L.status)==="all_submitted"?Number(L.total):null,ue=(q==null?void 0:q.status)==="all_submitted"?Number(q.total):null;if(se===null&&ue===null)return be(D.name,T.name);if(se===null)return 1;if(ue===null)return-1;const me=l==="desc"?ue-se:se-ue;return me!==0?me:be(D.name,T.name)})),I},[s,m,a,l,p,g,k]),M=I=>{const D=r.map(T=>{var se;const L=(se=k[I])==null?void 0:se[T.id];return{status:(L==null?void 0:L.status)==="group_submitted"||(L==null?void 0:L.status)==="all_submitted"?"submitted":(L==null?void 0:L.status)||"not_started",editing:(L==null?void 0:L.editingFlag)==="editing"}});return D.every(T=>T.status==="not_started")?"not_started":D.some(T=>T.editing)?"editing":D.every(T=>T.status==="submitted")?"completed":D.some(T=>T.status==="in_progress")?"in_progress":D.some(T=>T.status==="submitted")?"submitted":"not_started"},W={completed:"Completed",submitted:"Submitted",in_progress:"In Progress",editing:"Editing",not_started:"Not Started"},X={completed:e.jsx(rt,{}),submitted:e.jsx(at,{}),in_progress:e.jsx(Ke,{}),editing:e.jsx(Je,{}),not_started:e.jsx(Ct,{})},K=i.useMemo(()=>r.map(I=>{const D=Q.map(T=>{var L;return(L=k[T.key])==null?void 0:L[I.id]}).filter(T=>(T==null?void 0:T.status)==="all_submitted").map(T=>T.total);return D.length?(D.reduce((T,L)=>T+L,0)/D.length).toFixed(2):null}),[Q,r,k]);return s.length?e.jsxs("div",{className:"matrix-wrap",children:[e.jsxs("div",{className:"matrix-subtitle",children:[e.jsx("div",{className:"matrix-legend-row legend-scroll-row",children:e.jsxs("div",{className:"matrix-legend-scroll","aria-label":"Cells legend",children:[e.jsx("span",{className:"matrix-legend-label",children:"Cells"}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot completed-dot"}),"Completed"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]})}),e.jsx("div",{className:"matrix-legend-row matrix-icon-legend legend-scroll-row",children:e.jsxs("div",{className:"matrix-legend-scroll","aria-label":"Juror legend",children:[e.jsx("span",{className:"matrix-legend-label",children:"Juror"}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon completed",children:e.jsx(rt,{})}),"Completed"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon editing",children:e.jsx(Je,{})}),"Editing"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon in_progress",children:e.jsx(Ke,{})}),"In Progress"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon not_started",children:e.jsx(Ct,{})}),"Not Started"]})]})}),Q.length<s.length&&e.jsxs("span",{className:"matrix-legend-count",children:["Showing ",Q.length,"/",s.length," jurors"]})]}),e.jsx("div",{className:"matrix-scroll-wrap",children:e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"matrix-corner",children:e.jsxs("div",{className:"matrix-corner-head",children:[e.jsx("span",{className:`col-sort-label${N?" filtered":""}`,onClick:B,children:"Juror / Group"}),e.jsx("button",{type:"button",className:`col-filter-hotspot${N?" active filter-icon-active":""}`,onClick:I=>{I.preventDefault(),I.stopPropagation(),O("juror",I)},title:"Filter jurors",children:e.jsx(we,{})})]})}),r.map(I=>{const D=a===I.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${D?" active":""}`,onClick:()=>v(I.id),title:`Sort by ${I.label}`,children:[e.jsx("strong",{children:I.label}),e.jsx("span",{className:"sort-icon",children:A(I.id)})]})},I.id)})]})}),e.jsx("tbody",{children:Q.map(I=>e.jsxs("tr",{children:[e.jsx("td",{className:"matrix-juror",children:(()=>{const D=M(I.key),T=I.dept?`${I.name} (${I.dept})`:I.name;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`matrix-status-icon ${D}`,title:W[D],"aria-hidden":"true",children:X[D]}),e.jsx("span",{className:"matrix-juror-name",title:T,children:e.jsxs("span",{className:"matrix-juror-name-scroll",children:[I.name,I.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",I.dept,")"]})]})})]})})()}),r.map(D=>{var L;const T=((L=k[I.key])==null?void 0:L[D.id])??null;return e.jsx("td",{style:Dn(T),children:$n(T)},D.id)})]},I.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),K.map((I,D)=>e.jsx("td",{className:"matrix-avg-cell",children:I!==null?I:"â€”"},r[D].id))]})})]})})}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(Ue,{})," Averages include only ",e.jsx("strong",{children:"completed"})," submissions."]}),e.jsxs(Fn,{open:f==="juror",anchorRect:y,anchorEl:w,onClose:E,className:"col-filter-popover col-filter-popover-portal",contentKey:m,children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror nameâ€¦",value:m,onChange:I=>d(I.target.value),className:N?"filter-input-active":""}),m&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{d(""),E()},children:"Clear"})]})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const ot=Y.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]}),Tn=te.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),tt=ot.length;function $e(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:""}const _n=[{id:"summary",label:"Summary",icon:Fs},{id:"dashboard",label:"Dashboard",icon:Ut},{id:"detail",label:"Details",icon:Ye},{id:"jurors",label:"Jurors",icon:Wt},{id:"matrix",label:"Matrix",icon:Ds}];function Rn({metrics:t,id:s}){const{completedJurors:r,totalJurors:a,completedEvaluations:n,totalEvaluations:l,inProgressJurors:o,editingJurors:g}=t,x=Number.isFinite(a)?Math.max(0,a):0,p=Number.isFinite(r)?Math.min(Math.max(0,r),x):0,c=Number.isFinite(o)?Math.max(0,o):0,m=Number.isFinite(g)?Math.max(0,g):0,d=Number.isFinite(l)?Math.max(0,l):0,f=Number.isFinite(n)?Math.min(Math.max(0,n),d):0,b=x===0&&p===0&&c===0&&m===0,y=b?"empty":c===0&&m===0?"completed":"inprogress",h=d===0?"empty":f===d?"completed":"inprogress",w=N=>b?"â€”":N,j=d===0?"â€”":`${f}/${d}`;return e.jsxs("div",{id:s,className:"results-status-bar",role:"group","aria-label":"Results status metrics",children:[e.jsxs("span",{className:`status-chip status-chip--${y}`,"aria-label":`Jurors: total ${x}, completed ${p}, in progress ${c}, editing ${m}`,children:[e.jsxs("span",{className:"status-block",children:[e.jsx(Ls,{}),e.jsx("span",{className:"status-value",children:w(x)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-block",children:[e.jsx(Ms,{}),e.jsx("span",{className:"status-value",children:w(p)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-block",children:[e.jsx(Ke,{}),e.jsx("span",{className:"status-value",children:w(c)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-block",children:[e.jsx(Je,{}),e.jsx("span",{className:"status-value",children:w(m)})]})]}),e.jsx("span",{className:`status-chip status-chip--${h}`,"aria-label":`Evaluated: ${f} out of ${d}`,children:e.jsxs("span",{className:"status-block",children:[e.jsx(Es,{}),e.jsx("span",{className:"status-value",children:j})]})})]})}function Bn({adminPass:t,onBack:s,onAuthError:r,onInitialLoadDone:a}){const[n,l]=i.useState([]),[o,g]=i.useState(!0),[x,p]=i.useState(""),[c,m]=i.useState(""),[d,f]=i.useState(!0),[b,y]=i.useState("summary"),[h,w]=i.useState(null),[j,N]=i.useState(!1),[E,O]=i.useState(!1),[k,v]=i.useState(!1),A=i.useRef(null),[B,Q]=i.useState(null),[M,W]=i.useState(""),X=i.useRef(!1),K=i.useRef(t);i.useEffect(()=>{K.current=t},[t]);const I=async()=>{g(!0),p("");try{const S=K.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!S){l([]),m("Enter the admin password to load results.");return}const z=await Le({action:"export",pass:S});if((z==null?void 0:z.status)==="unauthorized"){if(l([]),r){r("Invalid password");return}m("Incorrect password.");return}if((z==null?void 0:z.status)!=="ok"||!Array.isArray(z==null?void 0:z.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",S)}catch{}const V=z.rows.map(G=>({juryName:String(G["Juror Name"]??G["Your Name"]??""),juryDept:String(G["Department / Institution"]??G.Department??""),timestamp:G.Timestamp||"",tsMs:Ve(G.Timestamp||""),projectId:Qs(G["Group No"]),projectName:String(G["Group Name"]??""),jurorId:String(G["Juror ID"]??""),technical:$e(G["Technical (30)"]),design:$e(G["Written (30)"]),delivery:$e(G["Oral (30)"]),teamwork:$e(G["Teamwork (10)"]),total:$e(G["Total (100)"]),comments:G.Comments||"",status:String(G.Status??"all_submitted"),editingFlag:String(G.EditingFlag??"")}));l(nn(V)),w(new Date),m(""),X.current||(X.current=!0,a==null||a())}catch(S){if(r){r("Connection error â€” try again.");return}p("Could not load data: "+S.message),l([])}finally{g(!1)}};i.useEffect(()=>{I()},[]),i.useEffect(()=>{},[]);const D=()=>{const S=A.current;if(!S)return;const z=S.scrollWidth-S.clientWidth,V=z>2;if(N(V),!V){O(!1),v(!1);return}const G=S.scrollLeft>4,Z=S.scrollLeft<z-4;O(G),v(Z)};i.useEffect(()=>(D(),window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)),[b,d]),i.useEffect(()=>(B?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[B]);const T=async(S,z,V)=>{Q({juryName:S,juryDept:z}),W("loading");try{const G=K.current||sessionStorage.getItem("ee492_admin_pass")||"",Z=await Le({action:"resetPin",jurorId:V.trim(),pass:G});W(Z.status==="ok"?"ok":"error")}catch{W("error")}setTimeout(()=>{Q(null),W("")},3e3)},L=S=>S.jurorId?S.jurorId:`${(S.juryName||"").trim().toLowerCase()}__${(S.juryDept||"").trim().toLowerCase()}`,q=i.useMemo(()=>{const S=new Map;return n.forEach(z=>{if(!z.juryName)return;const V=L(z);S.has(V)||S.set(V,{key:V,name:z.juryName.trim(),dept:z.juryDept.trim(),jurorId:z.jurorId})}),[...S.values()].sort((z,V)=>be(z.name,V.name))},[n]),se=i.useMemo(()=>ot.map(S=>({id:S.id,label:`Group ${S.id}`,desc:S.desc||""})).sort((S,z)=>S.id-z.id),[]),ue=i.useMemo(()=>{const S=new Map;return q.forEach(({key:z,dept:V})=>S.set(z,V)),S},[q]),me=i.useMemo(()=>{const S=new Map;return q.forEach(({key:z,name:V})=>S.set(z,{bg:Xs(V),dot:Zs(V)})),S},[q]),ne=i.useMemo(()=>n.filter(S=>S.status==="all_submitted"),[n]),ce=i.useMemo(()=>n.filter(S=>S.status==="group_submitted"||S.status==="all_submitted"),[n]),re=i.useMemo(()=>ot.map(S=>{const z=ne.filter(Z=>Z.projectId===S.id);if(!z.length)return{id:S.id,name:S.name,desc:S.desc,students:S.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const V={};Tn.forEach(Z=>{V[Z.id]=z.reduce((le,ie)=>le+(ie[Z.id]||0),0)/z.length});const G=z.map(Z=>Z.total);return{id:S.id,name:S.name,desc:S.desc,students:S.students,count:z.length,avg:V,totalAvg:G.reduce((Z,le)=>Z+le,0)/G.length,totalMin:Math.min(...G),totalMax:Math.max(...G)}}),[ne]),ae=i.useMemo(()=>re.map(S=>({...S,name:`Group ${S.id}`})),[re]),he=i.useMemo(()=>[...re].sort((S,z)=>z.totalAvg-S.totalAvg),[re]),fe=i.useMemo(()=>q.map(({key:S,name:z,dept:V,jurorId:G})=>{const Z=n.filter(oe=>L(oe)===S),le=Z.filter(oe=>oe.status==="group_submitted"||oe.status==="all_submitted"),ie=Z.filter(oe=>oe.status==="all_submitted"),u=Z.filter(oe=>oe.status==="in_progress"),_=Z.reduce((oe,ee)=>ee.tsMs>oe?ee.tsMs:oe,0),R=Z.find(oe=>oe.tsMs===_)||Z[0],H=ie.length===tt?"all_submitted":le.length>0||u.length>0?"in_progress":"not_started";return{key:S,jury:z,dept:V,jurorId:G,rows:Z,submitted:le,completed:le,finalSubmitted:ie,inProgress:u,latestTs:_,latestRow:R,overall:H}}),[q,n]);n.filter(S=>S.status==="in_progress").length,fe.filter(S=>S.rows.some(z=>z.editingFlag==="editing")).length;const ve=i.useMemo(()=>{const S=q.length,z=ce.length,V=S*tt,G=new Map;n.forEach(R=>{if(R.status!=="all_submitted")return;const H=L(R);G.has(H)||G.set(H,new Set),G.get(H).add(R.projectId)});const Z=q.filter(R=>{var H;return(((H=G.get(R.key))==null?void 0:H.size)||0)>=tt}).length,le=new Set(n.filter(R=>R.status==="editing"||R.editingFlag==="editing").map(R=>L(R))),u=new Set(n.filter(R=>R.status==="in_progress").map(R=>L(R)).filter(R=>!le.has(R))).size,_=le.size;return{completedJurors:Z,totalJurors:S,completedEvaluations:z,totalEvaluations:V,inProgressJurors:u,editingJurors:_}},[n,ne,ce,q,L]);i.useEffect(()=>{if(h)try{sessionStorage.setItem("ee492_home_meta",JSON.stringify({totalJurors:ve.totalJurors,completedJurors:ve.completedJurors,lastUpdated:h.toISOString()}))}catch{}},[ve.totalJurors,ve.completedJurors,h]);const Ee=h?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric"}).format(h):"",pe=h?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(h):"";return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("div",{className:"form-header-main",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("button",{className:"back-btn",onClick:s,"aria-label":"Back to home",children:e.jsx(ut,{})}),e.jsx("div",{className:"header-title",children:e.jsxs("div",{className:"results-title-row",children:[e.jsx("h2",{children:"Results Panel"}),e.jsx("button",{className:"results-toggle",type:"button","aria-label":d?"Hide status metrics":"Show status metrics","aria-expanded":d,"aria-controls":"results-status-bar",onClick:()=>f(S=>!S),children:e.jsx("span",{className:`results-toggle-icon${d?" open":""}`,"aria-hidden":"true",children:e.jsx(Re,{})})})]})})]}),e.jsxs("div",{className:"header-right",children:[h&&e.jsxs("span",{className:"last-updated",children:[e.jsx(Ht,{}),e.jsxs("span",{className:"last-updated-text",children:[e.jsx("span",{className:"last-updated-date",children:Ee}),e.jsx("span",{className:"last-updated-time",children:pe})]})]}),e.jsx("button",{className:`refresh-btn${o?" is-loading":""}`,onClick:I,"aria-label":"Refresh",title:"Refresh",children:e.jsx(Ps,{})})]})]}),d&&e.jsx(Rn,{id:"results-status-bar",metrics:ve}),e.jsxs("div",{className:"tab-bar-wrap",children:[e.jsx("div",{className:"tab-bar",ref:A,onScroll:D,children:_n.map(S=>e.jsxs("button",{className:`tab ${b===S.id?"active":""}`,onClick:()=>y(S.id),children:[e.jsx(S.icon,{}),S.label]},S.id))}),j&&e.jsxs("div",{className:"tab-hints","aria-hidden":"true",children:[e.jsx("span",{className:`tab-fade left${E?"":" is-hidden"}`}),e.jsx("span",{className:`tab-fade right${k?"":" is-hidden"}`}),e.jsx("span",{className:`tab-hint left${E?"":" is-hidden"}`,children:e.jsx(Qt,{})}),e.jsx("span",{className:`tab-hint right${k?"":" is-hidden"}`,children:e.jsx(Xt,{})})]})]})]}),o&&e.jsx("div",{className:"loading",children:"Loading dataâ€¦"}),x&&e.jsx("div",{className:"error-msg",children:x}),c&&e.jsx("div",{className:"error-msg",children:c}),B&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${M}`,children:[M==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"ðŸ”‘"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:B.juryName}),"â€¦"]})]}),M==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon ok",children:"âœ…"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:B.juryName})," will receive a new PIN on next login."]})]}),M==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon error",children:"âŒ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:B.juryName}),"."]})]})]})}),!o&&!x&&!c&&e.jsxs("div",{className:"admin-body",children:[b==="summary"&&e.jsx(dn,{ranked:he,submittedData:ne}),b==="dashboard"&&e.jsx(Ln,{dashboardStats:ae,submittedData:ne,lastRefresh:h,loading:o,error:x}),b==="detail"&&e.jsx(An,{data:n,jurors:q,jurorColorMap:me}),b==="jurors"&&e.jsx(In,{jurorStats:fe,jurors:q,onPinReset:T}),b==="matrix"&&e.jsx(Pn,{data:n,jurors:q,groups:se,jurorDeptMap:ue})]})]})}const Wn="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function On(){const[t,s]=i.useState("home"),r=i.useRef(""),[a,n]=i.useState(!1),[l,o]=i.useState(!1),[g,x]=i.useState(""),[p,c]=i.useState(""),[m,d]=i.useState(!1);function f(){const y=g.trim();if(!y){c("Please enter the admin password.");return}r.current=y,x(""),c(""),o(!0),n(!0)}function b(y){n(!1),o(!1),r.current="",c(y||"Authentication failed.")}return t==="jury"?e.jsx(Js,{onBack:()=>s("home")}):t==="admin"?a?e.jsxs(e.Fragment,{children:[l&&e.jsx(mt,{open:l,minDuration:400}),e.jsx(Bn,{adminPass:r.current,onAuthError:b,onInitialLoadDone:()=>o(!1),onBack:()=>{s("home"),n(!1),o(!1),c(""),r.current=""}})]}):e.jsx("div",{className:"premium-screen",children:e.jsxs("div",{className:"premium-card",children:[e.jsxs("div",{className:"premium-header",children:[e.jsx("div",{className:"premium-icon-square","aria-hidden":"true",children:e.jsx(Ge,{})}),e.jsx("div",{className:"premium-title",children:"Results Panel"}),e.jsx("div",{className:"premium-subtitle",children:"Enter the admin password to view results"})]}),e.jsxs("div",{className:"premium-input-wrap",children:[e.jsx("input",{type:m?"text":"password",placeholder:"Admin password",value:g,onChange:y=>{x(y.target.value),p&&c("")},onKeyDown:y=>{y.key==="Enter"&&f()},autoComplete:"current-password",autoFocus:!0,className:"premium-input"}),e.jsx("button",{type:"button",className:"premium-input-toggle",onClick:()=>d(y=>!y),"aria-label":m?"Hide password":"Show password",title:m?"Hide password":"Show password",children:m?e.jsx(Ss,{}):e.jsx(ws,{})})]}),p&&e.jsxs("div",{className:"premium-error-banner",role:"alert",children:[e.jsx(Bt,{}),e.jsx("span",{children:p})]}),e.jsx("button",{className:"premium-btn-primary",onClick:f,disabled:l,children:"Login"}),e.jsx("button",{className:"premium-btn-link",onClick:()=>{s("home"),c("")},children:"â† Back to Home"}),e.jsx("div",{className:"premium-helper",children:"Admin Access â€¢ Restricted"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:Wn,alt:"TED University",loading:"eager"})}),e.jsx("h1",{children:"Senior Project Jury Portal"}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big home-primary-btn",onClick:()=>s("jury"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx(Ye,{})}),"Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big home-secondary-btn",onClick:()=>s("admin"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx(Ut,{})}),"View Results"]})]}),e.jsxs("div",{className:"home-info",children:[e.jsx("span",{className:"home-info-icon","aria-hidden":"true",children:e.jsx(Ue,{})}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["Â© 2026 Â· Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})," ","Â· v1.0"]})]})]})}st.createRoot(document.getElementById("root")).render(e.jsx(is.StrictMode,{children:e.jsx(On,{})}));
