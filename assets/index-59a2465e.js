import{r as c,a as $t,R as Tt}from"./react-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var rt={exports:{}},Le={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rt=c,Bt=Symbol.for("react.element"),zt=Symbol.for("react.fragment"),Wt=Object.prototype.hasOwnProperty,Ot=Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gt={key:!0,ref:!0,__self:!0,__source:!0};function it(t,s,r){var i,n={},a=null,l=null;r!==void 0&&(a=""+r),s.key!==void 0&&(a=""+s.key),s.ref!==void 0&&(l=s.ref);for(i in s)Wt.call(s,i)&&!Gt.hasOwnProperty(i)&&(n[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return{$$typeof:Bt,type:t,key:a,ref:l,props:n,_owner:Ot.current}}Le.Fragment=zt;Le.jsx=it;Le.jsxs=it;rt.exports=Le;var e=rt.exports,De={},Ge=$t;De.createRoot=Ge.createRoot,De.hydrateRoot=Ge.hydrateRoot;const ie={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 â€” Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},K=[{id:1,name:"Group 1",desc:"GÃ¶ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf Ãœnal","AyÃ§a Naz DedeoÄŸlu","Onur Mesci","Ã‡aÄŸan ErdoÄŸan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla Ã–zer","Bertan Ãœnver","Ada TatlÄ±","Nesibe AydÄ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren GermeÃ§"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis â€” Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine Ã‡aylan","Selimhan Kaynar","Abdulkadir SazlÄ±","Alp Efe Ä°pek"]},{id:6,name:"Group 6",desc:"AKKE â€” Smart Command and Control Glove",students:["Åževval KurtulmuÅŸ","Abdullah Esin","Berk Ã‡akmak","Ã–mer Efe Dikici"]}],Y=[{id:"technical",label:"Technical Content",shortLabel:"Technical",color:"#F59E0B",mudek:["1.2","2","3.1","3.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",color:"#22C55E",mudek:["9.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",color:"#3B82F6",mudek:["9.1"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",color:"#EF4444",mudek:["8.1","8.2"],max:10,rubric:[{range:"9â€“10",level:"Excellent",min:9,max:10,desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7â€“8",level:"Good",min:7,max:8,desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4â€“6",level:"Developing",min:4,max:6,desc:"Uneven participation. Some members are passive or unprepared."},{range:"0â€“3",level:"Insufficient",min:0,max:3,desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}],Ke=70,Kt={Excellent:{bg:"#DCFCE7",text:"#16A34A"},Good:{bg:"#F7FEE7",text:"#65A30D"},Developing:{bg:"#FEF9C3",text:"#CA8A04"},Insufficient:{bg:"#FEE2E2",text:"#DC2626"}},Jt={"1.1":{en:"Knowledge in mathematics, natural sciences, fundamental engineering, computational methods, and discipline-specific topics.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konularda bilgi."},"1.2":{en:"Ability to apply knowledge of mathematics, natural sciences, fundamental engineering, computation, and discipline-specific topics to solve complex engineering problems.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konulardaki bilgileri, karmaÅŸÄ±k mÃ¼hendislik problemlerinin Ã§Ã¶zÃ¼mÃ¼nde kullanabilme becerisi."},2:{en:"Ability to identify, formulate, and analyse complex engineering problems using fundamental science, mathematics, and engineering knowledge, with consideration of relevant UN Sustainable Development Goals.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerini, temel bilim, matematik ve mÃ¼hendislik bilgilerini kullanarak ve ele alÄ±nan problemle ilgili BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ±nÄ± gÃ¶zetarak tanÄ±mlama, formÃ¼le etme ve analiz becerisi."},"3.1":{en:"Ability to design creative solutions to complex engineering problems.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerine yaratÄ±cÄ± Ã§Ã¶zÃ¼mler tasarlama becerisi."},"3.2":{en:"Ability to design complex systems, processes, devices, or products under realistic constraints and conditions, meeting current and future requirements.",tr:"KarmaÅŸÄ±k sistemleri, sÃ¼reÃ§leri, cihazlarÄ± veya Ã¼rÃ¼nleri gerÃ§ekÃ§i kÄ±sÄ±tlarÄ± ve koÅŸullarÄ± gÃ¶zetarak, mevcut ve gelecekteki gereksinimleri karÅŸÄ±layacak biÃ§imde tasarlama becerisi."},4:{en:"Ability to select and use appropriate techniques, resources, and modern engineering and IT tools â€” including estimation and modelling â€” for the analysis and solution of complex engineering problems, with awareness of their limitations.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin analizi ve Ã§Ã¶zÃ¼mÃ¼ne yÃ¶nelik, tahmin ve modelleme de dahil olmak Ã¼zere, uygun teknikleri, kaynaklarÄ± ve modern mÃ¼hendislik ve biliÅŸim araÃ§larÄ±nÄ±, sÄ±nÄ±rlamalarÄ±nÄ±n da farkÄ±nda olarak seÃ§me ve kullanma becerisi."},5:{en:"Ability to use research methods for investigating complex engineering problems, including literature review, experiment design, experimentation, data collection, and analysis and interpretation of results.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin incelenmesi iÃ§in literatÃ¼r araÅŸtÄ±rmasÄ±, deney tasarlama, deney yapma, veri toplama, sonuÃ§larÄ± analiz etme ve yorumlama dahil, araÅŸtÄ±rma yÃ¶ntemlerini kullanma becerisi."},"6.1":{en:"Knowledge of the impacts of engineering applications on society, health and safety, economy, sustainability, and the environment within the scope of UN Sustainable Development Goals.",tr:"MÃ¼hendislik uygulamalarÄ±nÄ±n BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ± kapsamÄ±nda, topluma, saÄŸlÄ±k ve gÃ¼venliÄŸe, ekonomiye, sÃ¼rdÃ¼rÃ¼lebilirlik ve Ã§evreye etkileri hakkÄ±nda bilgi."},"6.2":{en:"Awareness of the legal consequences of engineering solutions.",tr:"MÃ¼hendislik Ã§Ã¶zÃ¼mlerinin hukuksal sonuÃ§larÄ± konusunda farkÄ±ndalÄ±k."},"7.1":{en:"Knowledge of acting in accordance with engineering professional principles and ethical responsibility.",tr:"MÃ¼hendislik meslek ilkelerine uygun davranma, etik sorumluluk hakkÄ±nda bilgi."},"7.2":{en:"Awareness of non-discrimination, impartiality, and inclusivity of diversity.",tr:"HiÃ§bir konuda ayrÄ±mcÄ±lÄ±k yapmadan, tarafsÄ±z davranma ve Ã§eÅŸitliliÄŸi kapsayÄ±cÄ± olma konularÄ±nda farkÄ±ndalÄ±k."},"8.1":{en:"Ability to work effectively as a team member or leader in intra-disciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak disiplin iÃ§i takÄ±m Ã§alÄ±ÅŸmalarÄ±nda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"8.2":{en:"Ability to work effectively as a team member or leader in multidisciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak Ã§ok disiplinli takÄ±mlarda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"9.1":{en:"Ability to communicate effectively on technical topics orally, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda sÃ¶zlÃ¼ etkin iletiÅŸim kurma becerisi."},"9.2":{en:"Ability to communicate effectively on technical topics in writing, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda yazÄ±lÄ± etkin iletiÅŸim kurma becerisi."},"10.1":{en:"Knowledge of business practices such as project management and economic feasibility analysis.",tr:"Proje yÃ¶netimi ve ekonomik yapÄ±labilirlik analizi gibi iÅŸ hayatÄ±ndaki uygulamalar hakkÄ±nda bilgi."},"10.2":{en:"Awareness of entrepreneurship and innovation.",tr:"GiriÅŸimcilik ve yenilikÃ§ilik hakkÄ±nda farkÄ±ndalÄ±k."},11:{en:"Lifelong learning skills including independent and continuous learning, adaptation to new and emerging technologies, and critical thinking about technological change.",tr:"BaÄŸÄ±msÄ±z ve sÃ¼rekli Ã¶ÄŸrenebilme, yeni ve geliÅŸmekte olan teknolojilere uyum saÄŸlayabilme ve teknolojik deÄŸiÅŸimlerle ilgili sorgulayÄ±cÄ± dÃ¼ÅŸÃ¼nebilmeyi kapsayan yaÅŸam boyu Ã¶ÄŸrenme becerisi."}};Y.reduce((t,s)=>t+(Number(s.max)||0),0);const at=ie==null?void 0:ie.scriptUrl,Re=ie==null?void 0:ie.apiSecret;function Je(t,s){const r=t.trim().toLowerCase()+"__"+s.trim().toLowerCase();let i=5381;for(let n=0;n<r.length;n++)i=(i<<5)+i^r.charCodeAt(n),i=i>>>0;return i.toString(16).padStart(8,"0")}let Be="";function He(t){Be=t}function Ce(){return Be}function qe(){Be=""}async function ae(t){const s=Ce();try{await fetch(at,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,token:s})})}catch{}}async function he(t){const s=new URLSearchParams(t).toString(),r=await fetch(`${at}?${s}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const i=(await r.text()).trim();if(i.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script â€” check your deployment URL.");try{return JSON.parse(i)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function lt(t){return he({...t,token:Ce()})}function je(t,s,r,i,n,a,l){var h,p,u,o;return{juryName:t,juryDept:s,jurorId:r,timestamp:new Date().toISOString(),projectId:a.id,projectName:a.name,technical:((h=i[a.id])==null?void 0:h.technical)??"",design:((p=i[a.id])==null?void 0:p.design)??"",delivery:((u=i[a.id])==null?void 0:u.delivery)??"",teamwork:((o=i[a.id])==null?void 0:o.teamwork)??"",total:Ht(i,a.id),comments:n[a.id]||"",status:l}}function Ht(t,s){return Y.reduce((r,i)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[i.id],10)||0)},0)}async function qt(t){return he({action:"checkPin",jurorId:t,secret:Re})}async function Ut(t,s,r){return he({action:"createPin",jurorId:t,juryName:s.trim(),juryDept:r.trim(),secret:Re})}async function Yt(t,s){return he({action:"verifyPin",jurorId:t,pin:String(s).trim(),secret:Re})}async function Ue(){const t=await lt({action:"myscores"});if(t.status==="unauthorized"){const s=new Error("unauthorized");throw s.unauthorized=!0,s}return t.status!=="ok"?null:t.rows||[]}async function Ye(){return lt({action:"ping"})}const Ve=1500,be=()=>Object.fromEntries(K.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,""]))])),ye=()=>Object.fromEntries(K.map(t=>[t.id,""])),Qe=()=>Object.fromEntries(K.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,!1]))])),Vt=()=>Object.fromEntries(K.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,!0]))])),me=(t,s)=>Y.every(r=>{var i;return((i=t[s])==null?void 0:i[r.id])!==""}),Xe=t=>K.every(s=>me(t,s.id)),ot=t=>K.reduce((s,r)=>s+Y.reduce((i,n)=>{var a;return i+(((a=t[r.id])==null?void 0:a[n.id])!==""?1:0)},0),0),Qt=(t,s)=>Y.some(r=>{var i;return((i=t[s])==null?void 0:i[r.id])!==""});function Ae(t){const s=be(),r=ye();return(t||[]).forEach(i=>{const n=Number(i.projectId);n&&(s[n]={...s[n],technical:i.technical??"",design:i.design??"",delivery:i.delivery??"",teamwork:i.teamwork??""},r[n]=i.comments??"")}),{scores:s,comments:r}}function Xt(){const[t,s]=c.useState(""),[r,i]=c.useState(""),n=c.useRef("");c.useEffect(()=>{n.current=t.trim()&&r.trim()?Je(t,r):""},[t,r]);const[a,l]=c.useState("info"),[h,p]=c.useState(0),[u,o]=c.useState(be),[g,f]=c.useState(ye),[C,N]=c.useState(Qe),[S,x]=c.useState({}),[M,v]=c.useState(!1),[k,b]=c.useState(null),[y,m]=c.useState(null),[j,I]=c.useState(null),[J,H]=c.useState("idle"),[L,_]=c.useState("idle"),[q,z]=c.useState(""),[X,d]=c.useState(""),[R,F]=c.useState(3),[U,Z]=c.useState(!1),[w,P]=c.useState(""),O=c.useRef(!1),$=c.useRef({});$.current={juryName:t,juryDept:r,scores:u,comments:g,groupSynced:S,current:h};const W=c.useRef(u),V=c.useRef(g),se=c.useCallback(E=>{const{juryName:A,juryDept:D}=$.current,T=n.current,B=W.current,G=V.current;if(!A.trim()||!T||!Ce()||!Qt(B,E))return;const re=K.find(_t=>_t.id===E);if(!re)return;const we=me(B,E)?"group_submitted":"in_progress",Dt=je(A,D,T,B,G,re,we);H("saving"),ae({rows:[Dt]}),setTimeout(()=>H("saved"),500),setTimeout(()=>H("idle"),2500)},[]),oe=c.useCallback(E=>{var T;const{current:A}=$.current,D=(T=K[A])==null?void 0:T.id;D!==void 0&&se(D),p(E)},[se]);c.useEffect(()=>{if(a!=="eval"||M)return;const E={};K.forEach(A=>{!S[A.id]&&me(u,A.id)&&(E[A.id]=!0)}),Object.keys(E).length>0&&x(A=>({...A,...E}))},[u,a,S,M]),c.useEffect(()=>{if(a!=="eval"||O.current||M||!K.every(A=>S[A.id]))return;O.current=!0;const E=setTimeout(()=>{const{juryName:A,juryDept:D,scores:T,comments:B}=$.current,G=n.current;ae({rows:K.map(re=>je(A,D,G,T,B,re,"all_submitted"))}),b({...T}),m({...B}),l("done")},800);return()=>clearTimeout(E)},[S,a,M]);const ce=c.useCallback((E,A,D)=>{const T={...W.current,[E]:{...W.current[E],[A]:D}};W.current=T,o(T),N(B=>({...B,[E]:{...B[E],[A]:!0}})),D===""&&S[E]&&x(B=>({...B,[E]:!1}))},[S]),Q=c.useCallback((E,A)=>{var B;const D=Y.find(G=>G.id===A),T=(B=W.current[E])==null?void 0:B[A];if(N(G=>({...G,[E]:{...G[E],[A]:!0}})),T!==""&&T!==void 0){const G=parseInt(T,10),re=Number.isFinite(G)?Math.min(Math.max(G,0),D.max):0;if(String(re)!==String(T)){const we={...W.current,[E]:{...W.current[E],[A]:re}};W.current=we,o(we)}}se(E)},[se]),ne=c.useCallback((E,A)=>{const D={...V.current,[E]:A};V.current=D,f(D)},[]),te=c.useCallback(E=>{se(E)},[se]),xe=c.useCallback((E,A)=>{const{juryName:D,juryDept:T}=$.current,B=n.current;ae({rows:K.map(G=>je(D,T,B,E,A,G,"all_submitted"))}),b({...E}),m({...A}),v(!1),O.current=!0,l("done")},[]),bt=c.useCallback(async()=>{const{juryName:E,juryDept:A}=$.current,D=n.current,T=k||u,B=y||g;D&&ae({action:"resetJuror"}),W.current=T,V.current=B,o(T),f(B),v(!0),O.current=!1,x(Object.fromEntries(K.map(G=>[G.id,!0]))),l("eval"),setTimeout(()=>{D&&ae({rows:K.map(G=>je(E,A,D,T,B,G,"group_submitted"))})},Ve)},[k,y,u,g]),yt=c.useCallback(()=>{if(!Xe(u)){N(Vt());const E=K.findIndex(A=>!me(u,A.id));E>=0&&p(E);return}xe(u,g)},[u,g,xe]),de=c.useCallback(E=>{qe(),P(E||"Your session has expired. Please enter your PIN again."),Z(!0)},[]),kt=c.useCallback(()=>{Z(!1),P(""),z(""),_("entering"),l("pin")},[]),ue=c.useCallback(async()=>{I({loading:!0});let E=[];try{E=await Ue()||[]}catch(B){if(B.unauthorized){de("Your session has expired. Please enter your PIN again.");return}}const A=K.length,D=E.filter(B=>B.status==="group_submitted"||B.status==="all_submitted").length,T=E.length>=A&&E.every(B=>B.status==="all_submitted");I({rows:E,filledCount:D,totalCount:A,allSubmitted:T})},[de]);c.useEffect(()=>{if(a!=="eval")return;const E=setInterval(async()=>{try{(await Ye()).status==="unauthorized"&&de("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(E)},[a,de]),c.useEffect(()=>{if(a!=="eval")return;async function E(){if(document.visibilityState==="visible")try{(await Ye()).status==="unauthorized"&&de("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",E),()=>document.removeEventListener("visibilitychange",E)},[a,de]);const Nt=c.useCallback(()=>{const E=j;if(E){if(I(null),E.allSubmitted){const{scores:A,comments:D}=Ae(E.rows);W.current=A,V.current=D,o(A),f(D),b(A),m(D),x(Object.fromEntries(K.map(T=>[T.id,!0]))),O.current=!0,l("done");return}if(E.rows.length>0){const{scores:A,comments:D}=Ae(E.rows),T=Object.fromEntries(E.rows.filter(G=>G.status==="group_submitted"||G.status==="all_submitted").map(G=>[Number(G.projectId),!0]));W.current=A,V.current=D,o(A),f(D),x(T);const B=K.findIndex(G=>!me(A,G.id));p(B>=0?B:0),O.current=!1}l("eval")}},[j]),wt=c.useCallback(()=>{const E=be(),A=ye();W.current=E,V.current=A,I(null),o(E),f(A),x({}),p(0),O.current=!1,v(!1),l("eval")},[]),St=c.useCallback(async()=>{const{juryName:E,juryDept:A}=$.current,D=n.current;let T=be(),B=ye();try{const G=await Ue();if(G!=null&&G.length){const re=Ae(G);T=re.scores,B=re.comments}}catch{}D&&ae({action:"resetJuror"}),W.current=T,V.current=B,o(T),f(B),b(T),m(B),v(!0),O.current=!1,x(Object.fromEntries(K.map(G=>[G.id,!0]))),l("eval"),setTimeout(()=>{D&&ae({rows:K.map(G=>je(E,A,D,T,B,G,"group_submitted"))})},Ve)},[]),Ct=c.useCallback(async()=>{const{juryName:E,juryDept:A}=$.current;if(!E.trim()||!A.trim())return;const D=Je(E,A);if(n.current=D,I({loading:!0}),Ce()){await ue();return}try{const T=await qt(D);if(T.status!=="ok"){I(null),z("Could not reach the server. Please try again."),_("entering"),l("pin");return}if(T.exists)I(null),_("entering"),z(""),F(3),l("pin");else{const B=await Ut(D,E,A);B.status==="ok"?(I(null),He(B.token),d(B.pin),_("new"),l("pin")):(I(null),z("Could not create a PIN. Please try again."),_("entering"),l("pin"))}}catch{I(null),z("Connection error. Please check your network and try again."),_("entering"),l("pin")}},[ue]),Lt=c.useCallback(async E=>{const A=n.current;I({loading:!0});try{const D=await Yt(A,E);if(D.locked){I(null),_("locked"),z("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(D.valid){He(D.token||""),_("idle"),z(""),await ue();return}I(null);const T=typeof D.attemptsLeft=="number"?D.attemptsLeft:R-1;F(T),T<=0?(_("locked"),z("Too many failed attempts. Please contact the admin.")):z(`Incorrect PIN. ${T} attempt${T!==1?"s":""} remaining.`)}catch{I(null),z("Could not verify PIN. Please try again.")}},[R,ue]),Mt=c.useCallback(async()=>{await ue()},[ue]),Et=c.useCallback(()=>{const E=be(),A=ye();W.current=E,V.current=A,s(""),i(""),l("info"),p(0),o(E),f(A),N(Qe()),x({}),I(null),v(!1),b(null),m(null),H("idle"),_("idle"),z(""),d(""),F(3),O.current=!1,n.current="",qe()},[]),At=K[h],It=K.length*Y.length,Ft=Math.round(ot(u)/It*100),Pt=Xe(u);return{juryName:t,setJuryName:s,juryDept:r,setJuryDept:i,jurorId:n.current,step:a,setStep:l,current:h,handleNavigate:oe,scores:u,comments:g,touched:C,handleScore:ce,handleScoreBlur:Q,handleCommentChange:ne,handleCommentBlur:te,project:At,progressPct:Ft,allComplete:Pt,groupSynced:S,editMode:M,doneScores:k,doneComments:y,sheetProgress:j,saveStatus:J,pinStep:L,pinError:q,newPin:X,attemptsLeft:R,handlePinSubmit:Lt,handlePinAcknowledge:Mt,sessionKicked:U,kickedMsg:w,handleKickedAcknowledge:kt,handleStart:Ct,handleConfirmFromSheet:Nt,handleStartFresh:wt,handleResubmit:St,handleEditScores:bt,handleFinalSubmit:yt,resetAll:Et}}function Me(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function Ze(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function Zt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}function es(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function ts(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function ct(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function ss(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]})}function ze(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 2h14"}),e.jsx("path",{d:"M5 22h14"}),e.jsx("path",{d:"M7 2c0 6 10 6 10 10s-10 4-10 10"}),e.jsx("path",{d:"M17 2c0 6-10 6-10 10s10 4 10 10"})]})}function We(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7 21H3v-4L17 3z"}),e.jsx("path",{d:"m15 5 4 4"})]})}function ns(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 6 2 2 4-4"}),e.jsx("path",{d:"m3 12 2 2 4-4"}),e.jsx("path",{d:"m3 18 2 2 4-4"}),e.jsx("path",{d:"M11 6h10"}),e.jsx("path",{d:"M11 12h10"}),e.jsx("path",{d:"M11 18h10"})]})}function le(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 3H2l8 9v7l4 2v-9l8-9z"})})}function dt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 3v12"}),e.jsx("path",{d:"m7 10 5 5 5-5"}),e.jsx("path",{d:"M5 21h14"})]})}function ut(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]})}function mt(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m5 12 7-7 7 7"}),e.jsx("path",{d:"M12 19V5"})]})}function ht(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"m19 12-7 7-7-7"})]})}function pt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}function rs(){return e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"9"})})}function is(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M8 4h8v3a4 4 0 0 1-8 0V4z"}),e.jsx("path",{d:"M5 6h3v2a4 4 0 0 1-3 3"}),e.jsx("path",{d:"M19 6h-3v2a4 4 0 0 0 3 3"}),e.jsx("path",{d:"M12 11v4"}),e.jsx("path",{d:"M8 19h8"}),e.jsx("path",{d:"M10 15h4"})]})}function as(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"M7 14l4-4 3 3 5-6"})]})}function ls(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"2",width:"6",height:"4",rx:"1"}),e.jsx("path",{d:"M9 4H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2"})]})}function os(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]})}function cs(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 10v6"}),e.jsx("path",{d:"M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})}function _e(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M5 12l4 4 10-10"})})}function ds(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 2v6h-6"}),e.jsx("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),e.jsx("path",{d:"M3 22v-6h6"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]})}function us(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function xt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function jt(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function ms({juryName:t,setJuryName:s,juryDept:r,setJuryDept:i,onStart:n,onBack:a}){const l=t.trim().length>0&&r.trim().length>0;return e.jsxs("div",{className:"form-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:a,"aria-label":"Back to home",children:e.jsx(Me,{})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Evaluation Form"}),e.jsx("p",{children:"EE 491/492 â€” Senior Project Poster Day"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:"Jury Member Information"}),e.jsx("div",{className:"identity-warning",children:"âš ï¸ Please enter your name and department carefully. Once you begin the evaluation, these cannot be changed."}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:t,onChange:h=>s(h.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department / Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:h=>i(h.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:h=>{h.key==="Enter"&&l&&n()}})]}),e.jsx("p",{className:"draft-device-note",children:"â„¹ï¸ Scores save automatically when you fill in each field or navigate between groups. Your PIN lets you continue from any device."}),e.jsx("button",{className:"btn-primary",disabled:!l,onClick:n,children:"Start Evaluation â†’"})]})]})}function hs({onSubmit:t,pinError:s}){const[r,i]=c.useState(["","","",""]),n=[c.useRef(null),c.useRef(null),c.useRef(null),c.useRef(null)];c.useEffect(()=>{s&&(i(["","","",""]),setTimeout(()=>{var o;return(o=n[0].current)==null?void 0:o.focus()},50))},[s]);function a(o,g){var N;const f=g.replace(/\D/g,"").slice(-1),C=[...r];C[o]=f,i(C),f&&o<3&&((N=n[o+1].current)==null||N.focus())}function l(o,g){var f,C,N;if(g.key==="Backspace")if(r[o]===""&&o>0){const S=[...r];S[o-1]="",i(S),(f=n[o-1].current)==null||f.focus()}else{const S=[...r];S[o]="",i(S)}if(g.key==="ArrowLeft"&&o>0&&((C=n[o-1].current)==null||C.focus()),g.key==="ArrowRight"&&o<3&&((N=n[o+1].current)==null||N.focus()),g.key==="Enter"){const S=r.join("");S.length===4&&t(S)}}function h(o){var f;const g=o.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(g.length===4){const C=g.split("");i(C),(f=n[3].current)==null||f.focus()}o.preventDefault()}function p(){const o=r.join("");o.length===4&&t(o)}const u=r.every(o=>o!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((o,g)=>e.jsx("input",{ref:n[g],type:"password",inputMode:"numeric",maxLength:1,value:o,autoFocus:g===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:f=>a(g,f.target.value),onKeyDown:f=>l(g,f),onPaste:g===0?h:void 0,className:"pin-box"},g))}),e.jsx("button",{className:"btn-primary pin-ok-btn",onClick:p,disabled:!u,children:"OK â†’"})]})}function ps({pinStep:t,pinError:s,newPin:r,attemptsLeft:i,juryName:n,onPinSubmit:a,onPinAcknowledge:l}){return t==="new"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Ze,{})}),e.jsx("h3",{children:"Your Access PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome, ",e.jsx("strong",{children:n}),"! A 4-digit PIN has been assigned to protect your evaluations. Please save it â€” you will need it every time you log in from a new device or browser tab."]}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((h,p)=>e.jsx("span",{className:"pin-digit",children:h},p))}),e.jsx("p",{className:"pin-hint",children:"ðŸ”’ Keep this PIN private. If you lose it, contact the admin to reset it."}),e.jsx("button",{className:"btn-primary",onClick:l,children:"I've saved my PIN â€” Continue â†’"})]})}):t==="locked"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap lock-icon",children:"ðŸ”’"}),e.jsx("h3",{children:"Account Locked"}),e.jsx("p",{className:"pin-error-msg",children:s})]})}):e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Ze,{})}),e.jsx("h3",{children:"Enter Your PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome back, ",e.jsx("strong",{children:n}),". Enter your 4-digit PIN and press OK to continue."]}),e.jsx(hs,{onSubmit:a,pinError:s}),s&&e.jsx("div",{className:"pin-error-msg",children:s})]})})}function xs(t){return t===0?"#e2e8f0":t<34?"linear-gradient(90deg,#ef4444,#f97316)":t<67?"linear-gradient(90deg,#f97316,#eab308)":t<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function js({saveStatus:t}){return t==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"â³ Savingâ€¦"}):t==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"âœ“ Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"â— Auto-saving"})}function gs({juryName:t,juryDept:s,current:r,onNavigate:i,scores:n,comments:a,touched:l,groupSynced:h,editMode:p,progressPct:u,allComplete:o,saveStatus:g,handleScore:f,handleScoreBlur:C,handleCommentChange:N,handleCommentBlur:S,handleFinalSubmit:x,onGoHome:M}){var H;const[v,k]=c.useState(!1),[b,y]=c.useState(null),m=K[r],j=(L,_)=>{const q=Y.filter(X=>{var d;return((d=n[L.id])==null?void 0:d[X.id])!==""}).length;return`${me(n,L.id)?"âœ…":"âš ï¸"} ${L.name} (${q}/${Y.length})`},I=()=>{r>0&&i(r-1)},J=()=>{r<K.length-1&&i(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"ðŸ‘¤"}),e.jsxs("span",{className:"eval-identity-text",children:[t,s&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",s,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(js,{saveStatus:g})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>k(!0),"aria-label":"Home",children:e.jsx(Me,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:m.name}),e.jsx("span",{className:"eval-project-name",children:m.desc})]}),((H=m.students)==null?void 0:H.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["ðŸ‘¥ ",m.students.join(" Â· ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:I,disabled:r===0,"aria-label":"Previous group",children:e.jsx(us,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:L=>i(Number(L.target.value)),children:K.map((L,_)=>e.jsx("option",{value:_,children:j(L)},L.id))}),e.jsx("button",{className:"group-nav-btn",onClick:J,disabled:r===K.length-1,"aria-label":"Next group",children:e.jsx(xt,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${u}%`,background:xs(u)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(u),"%"]})]})})]}),v&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>k(!1),children:e.jsxs("div",{className:"back-menu",onClick:L=>L.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{k(!1),M()},children:"ðŸ  Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>k(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[h[m.id]&&!p&&e.jsx("div",{className:"group-done-banner",children:"âœ… All scores saved for this group."}),p&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["âœï¸ Edit mode â€” adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),Y.map(L=>{var X,d;const _=((X=n[m.id])==null?void 0:X[L.id])??"",q=((d=l[m.id])==null?void 0:d[L.id])&&_==="",z=(parseInt(_,10)||0)/L.max*100;return e.jsxs("div",{className:`crit-card${q?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:L.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",L.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>y(b===L.id?null:L.id),children:b===L.id?"Hide Rubric â–²":"Show Rubric â–¼"})]}),b===L.id&&e.jsx("div",{className:"rubric-table",children:L.rubric.map(R=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:R.range}),e.jsx("div",{className:"rubric-level",children:R.level}),e.jsx("div",{className:"rubric-desc",children:R.desc})]},R.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:L.max,value:_,onChange:R=>f(m.id,L.id,R.target.value),onBlur:()=>C(m.id,L.id),placeholder:"â€”",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${z}%`}})}),e.jsx("span",{className:"score-pct",children:_!==""?`${_} / ${L.max}`:`â€” / ${L.max}`})]}),q&&e.jsx("div",{className:"required-hint",children:"Required"})]},L.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:a[m.id]||"",onChange:L=>N(m.id,L.target.value),onBlur:()=>S(m.id),placeholder:"Any additional feedback about this groupâ€¦",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const L=Y.reduce((_,q)=>{var z;return _+(parseInt((z=n[m.id])==null?void 0:z[q.id],10)||0)},0);return e.jsxs("span",{className:`total-score${L>=80?" high":L>=60?" mid":""}`,children:[L," / 100"]})})()]}),p&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:o?1:.65},onClick:x,children:o?"âœ… Submit Final":`âš ï¸ Submit Final (${ot(n)} / ${K.length*Y.length} filled)`})]})]})}function fs(t,s){return Y.reduce((r,i)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[i.id],10)||0)},0)}function vs({doneScores:t,scores:s,onEditScores:r,onBack:i}){const n=t||s,[a,l]=c.useState(new Set);function h(p){l(u=>{const o=new Set(u);return o.has(p)?o.delete(p):o.add(p),o})}return e.jsx("div",{className:"done-screen",children:e.jsxs("div",{className:"done-card",children:[e.jsx("div",{className:"done-icon",children:"ðŸŽ‰"}),e.jsx("h2",{children:"Thank You!"}),e.jsx("p",{className:"done-subtitle",children:"Your evaluations have been recordedâ€”thank you for your feedback."}),e.jsx("div",{className:"done-summary",children:K.map(p=>{var f,C;const u=a.has(p.id),o=`done-group-panel-${p.id}`,g=!!p.desc||((f=p.students)==null?void 0:f.length)>0;return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:g?0:-1,"aria-expanded":u,"aria-controls":o,onClick:()=>{g&&h(p.id)},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&g&&(N.preventDefault(),h(p.id))},style:{cursor:g?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:p.name}),g&&e.jsx("span",{className:`group-accordion-chevron${u?" open":""}`,children:e.jsx(jt,{})})]})}),e.jsx("div",{className:"done-row-right",children:e.jsxs("span",{className:"done-score",children:[e.jsx("span",{className:"done-score-main",children:fs(n,p.id)}),e.jsx("span",{className:"done-score-max",children:" / 100"})]})})]}),e.jsx("div",{id:o,className:`group-accordion-panel${u?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[p.desc&&e.jsx("span",{className:"done-row-desc",children:p.desc}),((C=p.students)==null?void 0:C.length)>0&&e.jsxs("span",{className:"done-row-students",children:["ðŸ‘¥ ",p.students.join(" Â· ")]})]})})]},p.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:r,children:"âœï¸ Edit Scores"}),e.jsxs("button",{className:"btn-primary",onClick:i,children:[e.jsx(Me,{})," Back to Home"]})]})]})})}function bs(t){return t==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:t==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:t==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"â€”",color:"#64748b",bg:"#f1f5f9"}}function Se({progress:t,onConfirm:s,onFresh:r}){if(!t)return null;if(t.loading)return e.jsx("div",{className:"spd-overlay",children:e.jsx("div",{className:"spd-card",children:e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:"â³"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:"Checking your progressâ€¦"}),e.jsx("div",{className:"spd-sub",children:"Connecting to server"})]})]})})});const{rows:i,filledCount:n,totalCount:a,allSubmitted:l}=t,h=i&&i.length>0;return e.jsx("div",{className:"spd-overlay",children:e.jsxs("div",{className:"spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:l?"âœ…":h?"â˜ï¸":"ðŸ“‹"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:l?"All evaluations submitted":h?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[n," / ",a," groups completed on server"]})]})]}),h&&e.jsx("div",{className:"spd-list",children:K.map(p=>{const u=i.find(f=>Number(f.projectId)===p.id),o=bs(u==null?void 0:u.status),g=(u==null?void 0:u.total)??"â€”";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:p.name}),e.jsx("span",{className:"spd-row-total",children:g!=="â€”"?`${g}/100`:"â€”"}),e.jsx("span",{className:"spd-chip",style:{color:o.color,background:o.bg},children:o.label})]},p.id)})}),!h&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"btn-primary",onClick:s,children:l?"View / Edit My Scores":h?"Continue from here":"Start Evaluation"}),h&&!l&&e.jsx("button",{className:"btn-secondary",onClick:r,children:"Start Fresh"})]})]})})}function ys({onBack:t}){const{step:s,juryName:r,setJuryName:i,juryDept:n,setJuryDept:a,current:l,handleNavigate:h,scores:p,comments:u,touched:o,groupSynced:g,editMode:f,progressPct:C,allComplete:N,doneScores:S,doneComments:x,sheetProgress:M,saveStatus:v,pinStep:k,pinError:b,newPin:y,attemptsLeft:m,handleScore:j,handleScoreBlur:I,handleCommentChange:J,handleCommentBlur:H,handleStart:L,handleConfirmFromSheet:_,handleStartFresh:q,handleResubmit:z,handleEditScores:X,handleFinalSubmit:d,handlePinSubmit:R,handlePinAcknowledge:F,sessionKicked:U,kickedMsg:Z,handleKickedAcknowledge:w,resetAll:P}=Xt();return U?e.jsx("div",{className:"kicked-overlay",children:e.jsxs("div",{className:"kicked-card",children:[e.jsx("div",{className:"kicked-icon",children:"ðŸ”"}),e.jsx("div",{className:"kicked-title",children:"Session Ended"}),e.jsx("div",{className:"kicked-body",children:Z}),e.jsx("button",{className:"btn-primary",onClick:w,children:"Sign in again"})]})}):s==="done"?e.jsxs(e.Fragment,{children:[e.jsx(vs,{doneScores:S,doneComments:x,scores:p,comments:u,onEditScores:X,onBack:()=>{P(),t()}}),e.jsx(Se,{progress:M,onConfirm:_,onFresh:q})]}):s==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(ps,{pinStep:k,pinError:b,newPin:y,attemptsLeft:m,juryName:r,onPinSubmit:R,onPinAcknowledge:F}),e.jsx(Se,{progress:M,onConfirm:_,onFresh:q})]}):s==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(gs,{juryName:r,juryDept:n,current:l,onNavigate:h,scores:p,comments:u,touched:o,groupSynced:g,editMode:f,progressPct:C,allComplete:N,saveStatus:v,handleScore:j,handleScoreBlur:I,handleCommentChange:J,handleCommentBlur:H,handleFinalSubmit:d,onGoHome:t}),e.jsx(Se,{progress:M,onConfirm:_,onFresh:q})]}):e.jsxs(e.Fragment,{children:[e.jsx(ms,{juryName:r,setJuryName:i,juryDept:n,setJuryDept:a,onStart:L,onBack:t}),e.jsx(Se,{progress:M,onConfirm:_,onFresh:q})]})}const ks="modulepreload",Ns=function(t){return"/senior-design-jury/"+t},et={},ws=function(s,r,i){if(!r||r.length===0)return s();const n=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=Ns(a),a in et)return;et[a]=!0;const l=a.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(!!i)for(let o=n.length-1;o>=0;o--){const g=n[o];if(g.href===a&&(!l||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${h}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":ks,l||(u.as="script",u.crossOrigin=""),u.href=a,document.head.appendChild(u),l)return new Promise((o,g)=>{u.addEventListener("load",o),u.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>s()).catch(a=>{const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a})},Ss=new Map(K.map((t,s)=>typeof t=="string"?[s+1,{desc:"",students:[]}]:[t.id??s+1,{desc:t.desc??"",students:t.students??[]}]));function Cs(t){const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:0}function Ee(t){if(!t)return 0;const s=String(t).trim().replace(/\s*,\s*/g,", "),r=Date.parse(s);if(Number.isFinite(r))return r;const i=s.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(i)return new Date(+i[3],+i[2]-1,+i[1],+i[4],+i[5],+(i[6]||0)).getTime()||0;const n=s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let a=+(n[4]||0);const l=(n[7]||"").toUpperCase();return l==="PM"&&a<12&&(a+=12),l==="AM"&&a===12&&(a=0),new Date(+n[3],+n[1]-1,+n[2],a,+(n[5]||0),+(n[6]||0)).getTime()||0}function $e(t){if(!t)return"â€”";const s=Ee(t);if(!s)return String(t);const r=new Date(s),i=n=>String(n).padStart(2,"0");return`${i(r.getDate())}/${i(r.getMonth()+1)}/${r.getFullYear()} ${i(r.getHours())}:${i(r.getMinutes())}`}function Ne(t,s){const r=Number(t),i=Number(s);return Number.isFinite(r)&&Number.isFinite(i)?r-i:String(t??"").toLowerCase()<String(s??"").toLowerCase()?-1:1}function gt(t){let s=2166136261;for(let r=0;r<t.length;r++)s^=t.charCodeAt(r),s=Math.imul(s,16777619);return s>>>0}function ft(t,s,r){s/=100,r/=100;const i=l=>(l+t/30)%12,n=s*Math.min(r,1-r),a=l=>Math.round(255*(r-n*Math.max(-1,Math.min(i(l)-3,Math.min(9-i(l),1))))).toString(16).padStart(2,"0");return`#${a(0)}${a(8)}${a(4)}`}const Ls=t=>ft(gt(t||"?")%360,55,95),Ms=t=>ft(gt(t||"?")%360,65,55);function ge(t){return t===""||t===null||t===void 0||typeof t=="string"&&t.trim()===""||typeof t=="number"&&!Number.isFinite(t)?"":t}async function Es(t){const s=await ws(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],i=t.map(u=>{const o=Ss.get(u.projectId)||{desc:"",students:[]};return[u.juryName??"",u.juryDept??"",u.timestamp??"",u.projectName??"",o.desc,o.students.join(" Â· "),ge(u.technical),ge(u.design),ge(u.delivery),ge(u.teamwork),ge(u.total),u.comments??""]}),n=s.utils.aoa_to_sheet([r,...i]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(u=>({wch:u}));const a=s.utils.book_new();s.utils.book_append_sheet(a,n,"Jury Evaluations");const l=new Date,h=l.toISOString().slice(0,10),p=`${String(l.getHours()).padStart(2,"0")}-${String(l.getMinutes()).padStart(2,"0")}`;s.writeFile(a,`jury_export_${h}_${p}.xlsx`)}const As=t=>t.reduce((s,r)=>s+Y.filter(i=>r[i.id]>0).length,0),Is=t=>{const s=K.length*Y.length;return s===0?0:Math.round(As(t)/s*100)};function Fs(t){const s={all_submitted:3,group_submitted:2,in_progress:1},r=(t||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:Ee(n==null?void 0:n.timestamp)})),i=new Map;for(const n of r){const a=String(n.juryName??"").trim().toLowerCase(),l=String(n.juryDept??"").trim().toLowerCase(),h=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!a||!h)continue;const p=`${a}__${l}__${h}`,u=i.get(p);if(!u){i.set(p,n);continue}if((n.tsMs||0)>(u.tsMs||0)){i.set(p,n);continue}(n.tsMs||0)===(u.tsMs||0)&&(s[n.status]||0)>(s[u.status]||0)&&i.set(p,n)}return[...i.values()].sort((n,a)=>(a.tsMs||0)-(n.tsMs||0))}function ke({status:t,editingFlag:s,variant:r,icon:i,children:n}){return r||i||n?e.jsxs("span",{className:`status-badge${r?` ${r}`:""}`,children:[i,n]}):s==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(We,{}),"Editing"]}):t==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(_e,{}),"Submitted"]}):t==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(_e,{}),"Submitted"]}):t==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(ze,{}),"In Progress"]}):null}const Ps="/senior-design-jury/assets/1st-place-medal-cb397e4c.svg",Ds="/senior-design-jury/assets/2nd-place-medal-9ec5b4d1.svg",_s="/senior-design-jury/assets/3rd-place-medal-7ad05fc8.svg",$s=Y.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Ie=t=>[{bg:"#F59E0B",fg:"#0B1220",ring:"#FCD34D"},{bg:"#94A3B8",fg:"#0B1220",ring:"#CBD5E1"},{bg:"#B45309",fg:"#FFF7ED",ring:"#FDBA74"}][t]??{bg:"#475569",fg:"#F1F5F9",ring:"#94A3B8"},Ts=[Ps,Ds,_s],Rs=t=>{const s=Ts[t];return s?e.jsx("img",{className:"rank-medal",src:s,alt:`${t+1} place medal`}):String(t+1)};function Bs({ranked:t,submittedData:s}){const[r,i]=c.useState(new Set);function n(a){i(l=>{const h=new Set(l);return h.has(a)?h.delete(a):h.add(a),h})}return s.length===0?e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"summary-note",children:[e.jsx(pt,{}),"Rankings include only ",e.jsx("strong",{children:"completed"})," submissions."]}),e.jsx("div",{className:"rank-list",children:t.map((a,l)=>{var f,C;const h=a.id??l+1,p=`summary-${h}-${l}`,u=r.has(p),o=!!a.desc||((f=a.students)==null?void 0:f.length)>0,g=`summary-group-panel-${p}`;return e.jsxs("div",{className:"rank-card",style:l<3?{background:"#ECFDF5",boxShadow:"0 0 0 1px #BBF7D0, 0 8px 22px rgba(34,197,94,0.18)",border:"1px solid #86EFAC"}:void 0,children:[e.jsx("div",{className:"rank-num",style:{width:52,height:52,borderRadius:999,display:"grid",placeItems:"center",fontSize:l<3?22:18,fontWeight:800,background:l<3?"transparent":Ie(l).bg,color:Ie(l).fg,boxShadow:l<3?"0 0 0 5px rgba(34,197,94,0.25)":"0 6px 18px rgba(15,23,42,0.12)",border:l<3?"none":`3px solid ${Ie(l).ring}`,overflow:"hidden",padding:0},children:Rs(l)}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"group-card-wrap",children:[e.jsxs("button",{className:"group-card-header group-accordion-header",tabIndex:o?0:-1,"aria-expanded":u,"aria-controls":g,type:"button",onClick:()=>{o&&n(p)},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&o&&(N.preventDefault(),n(p))},style:{cursor:o?"pointer":"default"},children:[e.jsxs("div",{className:"group-card-title",children:[e.jsxs("span",{className:"group-card-name",children:["Group ",h]}),o&&e.jsx("span",{className:`group-accordion-chevron${u?" open":""}`,children:"â–¾"})]}),e.jsxs("div",{className:"group-card-score",children:[e.jsx("small",{className:"group-card-score-label",children:"avg."}),e.jsx("span",{className:"group-card-score-value",children:a.totalAvg.toFixed(2)})]})]}),e.jsx("div",{id:g,className:`group-accordion-panel${u?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner group-card-accordion-inner",children:[a.desc&&e.jsx("div",{className:"group-card-desc",children:a.desc}),((C=a.students)==null?void 0:C.length)>0&&e.jsxs("div",{className:"group-card-students",children:["ðŸ‘¥ ",a.students.join(" Â· ")]})]})}),e.jsxs("span",{className:"rank-eval-count",children:["(",a.count," evaluation",a.count!==1?"s":"",")"]})]}),e.jsx("div",{className:"rank-bars",children:$s.map(N=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:N.shortLabel||N.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(a.avg[N.id]||0)/N.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(a.avg[N.id]||0).toFixed(2)})]},N.id))})]})]},a.id??`${a.name}-${l}`)})})]})}const zs=["9.1","9.2","1.2","2","3.1","3.2","8.1","8.2"],ee=Y.map(t=>({key:t.id,code:t.mudek.join("/"),label:t.shortLabel,max:t.max,color:t.color}));function vt(t){if(t.length<2)return 0;const s=t.reduce((r,i)=>r+i,0)/t.length;return Math.sqrt(t.reduce((r,i)=>r+(i-s)**2,0)/t.length)}function Oe(t){return t.length?t.reduce((s,r)=>s+r,0)/t.length:0}function Fe(t,s){if(!t.length)return 0;const r=(t.length-1)*s,i=Math.floor(r),n=r-i;return t[i+1]===void 0?t[i]:t[i]+n*(t[i+1]-t[i])}function Ws(t,s){return t.map(r=>Number(r[s])).filter(r=>Number.isFinite(r))}function pe({msg:t}){return e.jsx("div",{className:"chart-empty",children:t||"Not enough data yet."})}function Os({codes:t}){return e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"mudek-table-code",children:"Code"}),e.jsx("th",{children:"Outcome (EN) â€” hover for Turkish"})]})}),e.jsx("tbody",{children:t.map(s=>{const r=Jt[s];return r?e.jsxs("tr",{title:r.tr,children:[e.jsx("td",{className:"mudek-table-code-cell",children:s}),e.jsx("td",{children:r.en})]},s):null})})]})}function Gs(){return e.jsx("div",{className:"mudek-rubric-list",children:Y.map(t=>{const s=Kt;return e.jsxs("div",{className:"mudek-rubric-criterion",children:[e.jsxs("div",{className:"mudek-rubric-criterion-title",children:[t.label,e.jsxs("span",{className:"mudek-rubric-criterion-meta",children:["(",t.mudek.join(", "),") Â· max ",t.max," pts"]})]}),e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Range"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"Descriptor"})]})}),e.jsx("tbody",{children:t.rubric.map(r=>{const i=s[r.level]||{};return e.jsxs("tr",{children:[e.jsx("td",{children:r.range}),e.jsx("td",{children:e.jsx("span",{className:"mudek-band-badge",style:{background:i.bg,color:i.text},children:r.level})}),e.jsx("td",{children:r.desc})]},r.level)})})]})]},t.id)})})}function Ks({outcomeCodes:t=zs}){const[s,r]=c.useState(!1),[i,n]=c.useState("outcomes"),a=c.useRef(null),l=c.useRef(null);return c.useEffect(()=>{if(!s)return;function h(p){a.current&&!a.current.contains(p.target)&&r(!1)}return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[s]),c.useEffect(()=>{if(!s)return;function h(p){var u;p.key==="Escape"&&(r(!1),(u=l.current)==null||u.focus())}return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[s]),e.jsxs("div",{className:"mudek-badge-wrap",ref:a,children:[e.jsxs("button",{ref:l,className:"mudek-badge",onClick:()=>r(h=>!h),"aria-label":"MÅ¨DEK outcome mapping","aria-expanded":s,children:[e.jsx(cs,{}),e.jsx("span",{children:"MÅ¨DEK"}),e.jsx("span",{className:`mudek-chevron${s?" open":""}`,"aria-hidden":"true",children:e.jsx(jt,{})})]}),s&&e.jsxs("div",{className:"mudek-dropdown",role:"dialog","aria-label":"MÅ¨DEK outcome mapping",children:[e.jsxs("div",{className:"mudek-dropdown-header",children:[e.jsx("span",{children:"MÅ¨DEK Outcome Mapping"}),e.jsx("button",{className:"mudek-dropdown-close",onClick:()=>{var h;r(!1),(h=l.current)==null||h.focus()},"aria-label":"Close",children:"âœ•"})]}),e.jsxs("div",{className:"mudek-tabs",children:[e.jsx("button",{className:`mudek-tab-btn${i==="outcomes"?" active":""}`,onClick:()=>n("outcomes"),children:"MÅ¨DEK Outcomes"}),e.jsx("button",{className:`mudek-tab-btn${i==="rubric"?" active":""}`,onClick:()=>n("rubric"),children:"Rubric Bands"})]}),e.jsxs("div",{className:"mudek-dropdown-body",children:[i==="outcomes"&&e.jsx(Os,{codes:t}),i==="rubric"&&e.jsx(Gs,{})]}),e.jsx("div",{className:"mudek-dropdown-footer",children:"â„¹ This chart provides evidence for the outcomes above."})]})]})}function Js({data:t}){const s=t||[];if(!s.length)return e.jsx(pe,{});const r=ee.map(x=>{const M=Ws(s,x.key),v=M.length?Oe(M):0,k=x.max>0?v/x.max*100:0,b=M.length>1?vt(M)/x.max*100:0;return{...x,avgRaw:v,pct:k,sd:b,n:M.length}}),i=38,n=22,a=34,l=8,h=22,p=20,u=160,o=r.length,g=a+o*i+(o-1)*n+l,f=h+u+p,C=x=>a+x*(i+n),N=x=>C(x)+i/2,S=x=>h+u*(1-Math.max(0,Math.min(100,x))/100);return e.jsxs("div",{className:"chart-card chart-compact-equal chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Programme-Level Outcome Averages"}),e.jsx("div",{className:"chart-note",children:"Grand mean Â±1 SD normalized score per outcome across all groups and jurors."})]})}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${g} ${f}`,preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"100%",display:"block"},children:[[0,25,50,75,100].map(x=>{const M=S(x);return e.jsxs("g",{children:[e.jsx("line",{x1:a,y1:M,x2:g-l,y2:M,stroke:x===0?"#cbd5e1":"#e2e8f0",strokeWidth:x===0?1.2:1}),e.jsx("text",{x:a-4,y:M+3.5,textAnchor:"end",fontSize:"7",fill:"#94a3b8",children:x})]},x)}),e.jsx("text",{x:"10",y:h+u/2,transform:`rotate(-90 10 ${h+u/2})`,fontSize:"8",fill:"#64748b",textAnchor:"middle",children:"Normalized (%)"}),r.map((x,M)=>{const v=C(M),k=N(M),b=S(x.pct),y=u-(b-h),m=S(x.pct+x.sd),j=S(Math.max(0,x.pct-x.sd));return e.jsxs("g",{children:[e.jsxs("title",{children:[x.label," (",x.code,")",`
`,"Grand mean: ",x.pct.toFixed(1),"%",`
`,"SD: Â±",x.sd.toFixed(1),"%",`
`,"N evaluations: ",x.n]}),e.jsx("rect",{x:v,y:h,width:i,height:u,rx:"3",fill:"#f1f5f9"}),y>0&&e.jsx("rect",{x:v,y:b,width:i,height:y,rx:"3",fill:x.color}),x.sd>0&&e.jsxs(e.Fragment,{children:[e.jsxs("g",{stroke:"#ffffff",strokeWidth:"3.2",strokeLinecap:"round",opacity:"0.65",children:[e.jsx("line",{x1:k,y1:m,x2:k,y2:j}),e.jsx("line",{x1:k-7,y1:m,x2:k+7,y2:m}),e.jsx("line",{x1:k-7,y1:j,x2:k+7,y2:j})]}),e.jsxs("g",{stroke:"#6b7280",strokeWidth:"1.2",strokeLinecap:"round",opacity:"0.75",children:[e.jsx("line",{x1:k,y1:m,x2:k,y2:j}),e.jsx("line",{x1:k-7,y1:m,x2:k+7,y2:m}),e.jsx("line",{x1:k-7,y1:j,x2:k+7,y2:j}),e.jsx("circle",{cx:k,cy:m,r:"1.6",fill:"#6b7280",stroke:"none"}),e.jsx("circle",{cx:k,cy:j,r:"1.6",fill:"#6b7280",stroke:"none"})]})]}),e.jsx("text",{x:k,y:b+y/2+3,textAnchor:"middle",fontSize:"9",fill:"#ffffff",stroke:"rgba(15,23,42,0.35)",strokeWidth:"0.8",fontWeight:"700",style:{paintOrder:"stroke"},children:x.pct.toFixed(1)}),e.jsx("text",{x:k,y:h+u+13,textAnchor:"middle",fontSize:"8.5",fill:"#374151",fontWeight:"500",children:x.label})]},x.key)})]})})]})}function Hs({stats:t}){const s=t.filter(g=>g.count>0);if(!s.length)return e.jsx(pe,{});const r=14,i=4,n=ee.length*(r+i)+12,a=8,l=130,h=28,p=s.length*n+h+10,u=l+a,o=a+(l-Ke/100*l);return e.jsxs("div",{className:"chart-card chart-compact-equal",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Outcome Achievement by Group"}),e.jsx("div",{className:"chart-note",children:"Compares each group's normalized score across all four MÅ¨DEK-mapped criteria."})]})}),e.jsx("div",{className:"chart-svg-wrap",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${p} ${u+36}`,style:{width:"100%",height:"auto",display:"block"},children:[e.jsx("text",{x:"10",y:a+l/2,transform:`rotate(-90 10 ${a+l/2})`,fontSize:"8",fill:"#64748b",textAnchor:"middle",children:"Normalized (%)"}),[0,25,50,75,100].map(g=>{const f=a+(l-g/100*l);return e.jsxs("g",{children:[e.jsx("line",{x1:h,y1:f,x2:p,y2:f,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:h-4,y:f+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:g})]},g)}),e.jsx("g",{children:e.jsx("line",{x1:h,y1:o,x2:p,y2:o,stroke:"#6B7280",strokeWidth:"1",strokeDasharray:"3,3"})}),s.map((g,f)=>{const C=h+f*n+4;return e.jsxs("g",{children:[ee.map((N,S)=>{const x=(g.avg[N.key]||0)/N.max*100,M=x/100*l,v=C+S*(r+i);return e.jsxs("g",{children:[e.jsxs("title",{children:[g.name," Â· ",N.label,": ",x.toFixed(1),"%"]}),e.jsx("rect",{x:v,y:a+(l-M),width:r,height:M,fill:N.color,rx:"2",opacity:"0.85"})]},N.key)}),e.jsx("text",{x:C+ee.length*(r+i)/2-i/2,y:a+l+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:g.name})]},g.id)})]})}),e.jsxs("div",{className:"chart-legend",children:[ee.map(g=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:g.color}}),g.label]},g.key)),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-line","aria-hidden":"true"}),"Reference (",Ke,"%)"]})]})]})}function qs({stats:t}){var M;const s=t.filter(v=>v.count>0),[r,i]=c.useState(((M=s[0])==null?void 0:M.id)??null);if(!s.length)return e.jsx(pe,{});const n=s.find(v=>v.id===(r??s[0].id))??s[0],a=ee.length,l=130,h=120,p=82,u=v=>Math.PI*2*v/a-Math.PI/2,o=(v,k)=>({x:l+k*Math.cos(u(v)),y:h+k*Math.sin(u(v))}),g=ee.map(v=>(n.avg[v.key]||0)/v.max*100),f=ee.map(v=>{const k=s.map(b=>(b.avg[v.key]||0)/v.max*100);return Oe(k)}),C=g.map((v,k)=>o(k,v/100*p)),N=f.map((v,k)=>o(k,v/100*p)),S=C.map((v,k)=>`${k===0?"M":"L"}${v.x.toFixed(1)},${v.y.toFixed(1)}`).join(" ")+" Z",x=N.map((v,k)=>`${k===0?"M":"L"}${v.x.toFixed(1)},${v.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Competency Profile per Group"}),e.jsx("div",{className:"chart-note",children:"Shows whether a group's competency development is balanced or skewed across all four outcomes."})]})}),s.length>1&&e.jsx("select",{className:"radar-group-select",value:r??s[0].id,onChange:v=>i(Number(v.target.value)),children:s.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:"0 0 260 240",preserveAspectRatio:"xMidYMid meet",style:{width:"100%",maxWidth:280,height:"100%",display:"block"},children:[[.25,.5,.75,1].map(v=>{const b=ee.map((y,m)=>o(m,v*p)).map((y,m)=>`${m===0?"M":"L"}${y.x.toFixed(1)},${y.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:b,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},v)}),[.25,.5,.75,1].map(v=>{const k=o(0,v*p);return e.jsxs("text",{x:k.x.toFixed(1),y:(k.y-6).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:[Math.round(v*100),"%"]},`tick-${v}`)}),ee.map((v,k)=>{const b=o(k,p);return e.jsx("line",{x1:l,y1:h,x2:b.x.toFixed(1),y2:b.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},k)}),e.jsx("path",{d:x,fill:"none",stroke:"#9CA3AF",strokeWidth:"1.5",strokeDasharray:"4,3"}),e.jsx("path",{d:S,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.2",strokeLinejoin:"round"}),C.map((v,k)=>e.jsxs("g",{children:[e.jsxs("title",{children:[ee[k].label,": ",g[k].toFixed(1),"%",`
`,"Cohort avg: ",f[k].toFixed(1),"%"]}),e.jsx("circle",{cx:v.x.toFixed(1),cy:v.y.toFixed(1),r:"3.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.2"})]},k)),ee.map((v,k)=>{const b=o(k,p+16);return e.jsx("text",{x:b.x.toFixed(1),y:b.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"9",fill:"#334155",fontWeight:"700",children:v.label},v.key)})]})}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#3b82f6"}}),n.name]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#9CA3AF"}}),"Cohort Average (dashed)"]})]})]})}function Us({data:t}){const s=t||[];if(!s.length)return e.jsx(pe,{});const r=ee.map(j=>{const I=s.map(F=>Number(F[j.key])).filter(F=>Number.isFinite(F)&&F>0).map(F=>F/j.max*100).sort((F,U)=>F-U);if(!I.length)return{...j,empty:!0};const J=Fe(I,.25),H=Fe(I,.5),L=Fe(I,.75),_=L-J,q=J-1.5*_,z=L+1.5*_,X=I.find(F=>F>=q)??I[0],d=[...I].reverse().find(F=>F<=z)??I[I.length-1],R=I.filter(F=>F<q||F>z);return{...j,q1:J,med:H,q3:L,whiskerMin:X,whiskerMax:d,outliers:R}}),i=320,n=36,a=10,l=6,h=160,p=h+l+20,u=(i-n-a)/r.length,o=18,g=r.flatMap(j=>j.empty?[]:[j.whiskerMin,j.whiskerMax,...j.outliers]),f=g.length?Math.min(...g):0,C=g.length?Math.max(...g):100,N=Math.max(5,C-f),S=Math.min(10,N*.12),x=Math.max(0,f-S),M=Math.min(100,C+S),v=j=>l+(h-(j-x)/Math.max(1,M-x)*h),k=N<=10?2:N<=20?5:N<=40?10:N<=70?20:25,b=Math.ceil(x/k)*k,y=Math.floor(M/k)*k,m=[];for(let j=b;j<=y;j+=k)m.push(j);return m.length<2&&(m.length=0,m.push(Math.round(x),Math.round((x+M)/2),Math.round(M))),e.jsxs("div",{className:"chart-card chart-equal-bottom",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Score Distribution by Criterion"}),e.jsx("div",{className:"chart-note",children:"Reveals inter-juror spread for each criterion â€” evidence of measurement reliability."})]})}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${i} ${p}`,style:{width:"100%",height:"100%",display:"block"},children:[m.map(j=>{const I=v(j);return e.jsxs("g",{children:[e.jsx("line",{x1:n,y1:I,x2:i-a,y2:I,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:n-4,y:I+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:Math.round(j)})]},j)}),e.jsx("line",{x1:n,y1:l,x2:n,y2:l+h,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:"10",y:l+h/2,transform:`rotate(-90 10 ${l+h/2})`,fontSize:"8",fill:"#64748b",textAnchor:"middle",children:"Normalized (%)"}),r.map((j,I)=>{const J=n+I*u+u/2;if(j.empty)return e.jsx("text",{x:J,y:l+h+16,fontSize:"9",textAnchor:"middle",fill:"#94a3b8",children:j.label},j.key);const H=v(j.q1),L=v(j.q3),_=v(j.med);return e.jsxs("g",{children:[e.jsx("rect",{x:J-o/2,y:L,width:o,height:Math.max(2,H-L),fill:"rgba(59,130,246,0.18)",stroke:j.color,strokeWidth:"1.6"}),e.jsx("line",{x1:J-o/2,y1:_,x2:J+o/2,y2:_,stroke:j.color,strokeWidth:"2.2"}),e.jsx("text",{x:J,y:l+h+16,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:j.label})]},j.key)})]})}),e.jsxs("div",{className:"chart-legend boxplot-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-box"}),"IQR band (Q1â€“Q3)"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-median"}),"Median"]})]})]})}function Ys({stats:t,data:s}){const r=t.filter(f=>f.count>0),i=s||[];if(!r.length||!i.length)return e.jsx(pe,{});const n=ee.map(f=>r.map(C=>{const N=i.filter(M=>M.projectId===C.id).map(M=>Number(M[f.key])).filter(M=>Number.isFinite(M));if(N.length<2)return{cv:null,m:null,sd:null,n:N.length};const S=Oe(N);if(!S)return{cv:null,m:S,sd:null,n:N.length};const x=vt(N);return{cv:x/S*100,m:S,sd:x,n:N.length}})),a=f=>f===null?{fill:"#f1f5f9",text:"#94a3b8"}:f<10?{fill:"#dcfce7",text:"#166534"}:f<15?{fill:"#bbf7d0",text:"#166534"}:f<25?{fill:"#fef08a",text:"#92400e"}:{fill:"#fecaca",text:"#991b1b"},l=100,h=26,p=96,u=48,o=l+r.length*p,g=h+ee.length*u+10;return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Juror Consistency Heatmap"}),e.jsx("div",{className:"chart-note",children:"Identifies which group Ã— criterion combinations have poor juror agreement, guiding rubric improvement."})]})}),e.jsxs("div",{className:"cv-formula-block",children:[e.jsx("span",{className:"cv-formula-pill","aria-label":"CV equals sigma divided by x bar times 100",children:e.jsx("math",{xmlns:"http://www.w3.org/1998/Math/MathML",className:"cv-formula-math",children:e.jsxs("mrow",{children:[e.jsx("mi",{children:"CV"}),e.jsx("mo",{children:"="}),e.jsxs("mrow",{children:[e.jsx("mo",{children:"("}),e.jsxs("mfrac",{children:[e.jsx("mi",{children:"Ïƒ"}),e.jsx("mi",{children:"Î¼"})]}),e.jsx("mo",{children:")"})]}),e.jsx("mo",{children:"Ã—"}),e.jsx("mn",{children:"100"})]})})}),e.jsx("span",{className:"cv-formula-legend",children:"Ïƒ = std. deviation Â Â·Â  Î¼ = mean score Â Â·Â  CV = juror disagreement %"})]}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${o} ${g}`,style:{width:"100%",maxWidth:o,height:"100%",display:"block"},children:[r.map((f,C)=>e.jsx("text",{x:l+C*p+p/2,y:16,textAnchor:"middle",fontSize:"11",fill:"#475569",fontWeight:"600",children:f.name},f.id)),ee.map((f,C)=>e.jsxs("g",{children:[e.jsx("text",{x:l-10,y:h+C*u+u/2+6,textAnchor:"end",fontSize:"12",fill:"#475569",fontWeight:"600",children:f.label}),r.map((N,S)=>{const x=n[C][S],M=x.cv,v=l+S*p,k=h+C*u,b=a(M),y=[`${N.name} Â· ${f.label}`,`CV: ${M===null?"N/A":Math.round(M)+"%"}`,x.m!==null?`Mean: ${(x.m/f.max*100).toFixed(1)}%`:"",x.sd!==null?`SD: ${x.sd.toFixed(2)}`:"",`N jurors: ${x.n}`].filter(Boolean).join(`
`);return e.jsxs("g",{children:[e.jsx("title",{children:y}),e.jsx("rect",{x:v+3,y:k+3,width:p-6,height:u-6,rx:"12",fill:b.fill,stroke:"rgba(148,163,184,0.25)"}),e.jsx("text",{x:v+p/2,y:k+u/2+6,textAnchor:"middle",fontSize:"12",fill:b.text,fontWeight:"700",children:M===null?"N/A":`${Math.round(M)}%`})]},`${f.key}-${N.id}`)})]},f.key))]})}),e.jsxs("div",{className:"heatmap-legend",children:[e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#dcfce7",borderColor:"#bbf7d0"}}),"<10% CV (excellent)"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#bbf7d0",borderColor:"#86efac"}}),"10â€“15% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fef08a",borderColor:"#fde047"}}),"15â€“25% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fecaca",borderColor:"#fca5a5"}}),">25% CV (poor)"]})]})]})}function Vs({data:t}){const s=t||[];if(!s.length)return e.jsx(pe,{});const r=[{key:"insufficient",label:"Insufficient",color:"#ef4444"},{key:"developing",label:"Developing",color:"#f59e0b"},{key:"good",label:"Good",color:"#a3e635"},{key:"excellent",label:"Excellent",color:"#22c55e"}],i=(x,M)=>{if(!Number.isFinite(x))return null;for(const v of M)if(x>=v.min&&x<=v.max)return v.level.toLowerCase();return null},n=ee.map(x=>{const M=Y.find(m=>m.id===x.key),v=s.map(m=>Number(m[x.key])).filter(m=>Number.isFinite(m)),k={excellent:0,good:0,developing:0,insufficient:0};v.forEach(m=>{const j=i(m,M.rubric);j&&(k[j]+=1)});const b=v.length||1,y=r.map(m=>({...m,pct:k[m.key]/b*100,count:k[m.key]}));return{...x,pct:y,total:v.length}}),a=r.map(x=>({...x,anyPresent:n.some(M=>{var v;return((v=M.pct.find(k=>k.key===x.key))==null?void 0:v.pct)>0})})),l=340,h=32,p=10,u=8,o=28,g=180,f=u+g+o,C=(l-h-p)/n.length,N=Math.min(44,C*.65),S=x=>x/100*g;return e.jsxs("div",{className:"chart-card chart-equal-bottom",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Achievement Level Distribution"}),e.jsx("div",{className:"chart-note",children:"% of evaluations per rubric band â€” directly maps to MÅ¨DEK continuous improvement evidence."})]})}),e.jsx("div",{className:"chart-svg-fill rubric-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${l} ${f}`,style:{width:"100%",height:"auto",display:"block"},children:[[0,25,50,75,100].map(x=>{const M=u+g-S(x);return e.jsxs("g",{children:[e.jsx("line",{x1:h,y1:M,x2:l-p,y2:M,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsxs("text",{x:h-4,y:M+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:[x,"%"]})]},x)}),n.map((x,M)=>{const v=h+M*C+C/2,k=v-N/2;let b=0;return e.jsxs("g",{children:[x.pct.map(y=>{if(y.pct<=0)return null;const m=S(y.pct),j=u+g-b-m;b+=m;const I=m>=16;return e.jsxs("g",{children:[e.jsxs("title",{children:[x.label," Â· ",y.label,`
`,"Count: ",y.count," evaluation",y.count!==1?"s":"",`
`,"Share: ",y.pct.toFixed(0),"%"]}),e.jsx("rect",{x:k,y:j,width:N,height:m,fill:y.color}),I&&e.jsxs("text",{x:v,y:j+m/2+4,textAnchor:"middle",fontSize:"9",fill:"#fff",fontWeight:"700",children:[y.pct.toFixed(0),"%"]})]},y.key)}),e.jsx("text",{x:v,y:u+g+16,textAnchor:"middle",fontSize:"9",fill:"#475569",fontWeight:"600",children:x.label})]},x.key)})]})}),e.jsx("div",{className:"chart-legend rubric-legend",children:[...a].reverse().map(x=>e.jsxs("span",{className:"legend-item",style:x.anyPresent?void 0:{opacity:.35,textDecoration:"line-through"},children:[e.jsx("span",{className:"legend-dot",style:{background:x.color}}),x.label]},x.key))})]})}function Qs(t){return t?t.toLocaleString("tr-TR",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," Â·"):"â€”"}function Xs(){return e.jsxs("div",{className:"dashboard-loading",children:[e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]}),e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]})]})}function Zs(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#FCA5A5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("p",{className:"dashboard-state-title",children:"Could not load data"}),e.jsx("span",{className:"dashboard-state-sub",children:"Check your connection and refresh the page."})]})}function en(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#D1D5DB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),e.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("p",{className:"dashboard-state-title",children:"No data available"}),e.jsx("span",{className:"dashboard-state-sub",children:"Evaluations will appear here once jurors submit their scores."})]})}function tn({dashboardStats:t,submittedData:s,lastRefresh:r,loading:i,error:n}){const a=c.useRef(null),[l,h]=c.useState(!1),p=c.useRef(null);async function u(){if(l||!a.current)return;h(!0);const g=a.current,f=g.querySelector(".dashboard-toolbar"),C=g.querySelector(".print-header"),N=g.querySelectorAll(".mudek-badge-wrap"),S=(f==null?void 0:f.style.display)??"",x=(C==null?void 0:C.style.display)??"",M=[];N.forEach(b=>M.push(b.style.visibility??""));const v=()=>{f&&(f.style.display=S),C&&(C.style.display=x),N.forEach((b,y)=>{b.style.visibility=M[y]||""}),g.classList.remove("print-mode"),h(!1),p.current=null};p.current=v,f&&(f.style.display="none"),C&&(C.style.display="block"),N.forEach(b=>b.style.visibility="hidden"),g.classList.add("print-mode");const k=()=>v();window.addEventListener("afterprint",k,{once:!0}),requestAnimationFrame(()=>{setTimeout(()=>{window.print()},50)})}c.useEffect(()=>()=>{p.current&&p.current()},[]);const o=Qs(r);return i?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(Xs,{})}):n?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(Zs,{})}):!s||s.length===0?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(en,{})}):e.jsxs("div",{className:"dashboard-print-wrap",ref:a,children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:ie.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[ie.courseName," â€” ",ie.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report Â Â·Â  ",o,"Â Â·Â  ",s.length," final submission",s.length!==1?"s":"","Â Â·Â  ",t.length," group",t.length!==1?"s":""]})]}),e.jsxs("div",{className:"dashboard-toolbar no-print",children:[e.jsx("div",{className:"dashboard-toolbar-left",children:e.jsx(Ks,{})}),e.jsxs("button",{className:"pdf-export-btn",onClick:u,disabled:l,children:[e.jsx(dt,{}),l?"Preparing PDFâ€¦":"Export PDF"]})]}),e.jsx("div",{className:"dashboard-grid",children:e.jsx("div",{className:"chart-span-2",id:"chart-1",children:e.jsx(Hs,{stats:t})})}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx("div",{id:"chart-2",children:e.jsx(Js,{data:s})}),e.jsx("div",{id:"chart-3",children:e.jsx(qs,{stats:t})})]}),e.jsx("div",{className:"dashboard-grid",children:e.jsx("div",{className:"chart-span-2",id:"chart-4",children:e.jsx(Ys,{stats:t,data:s})})}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx("div",{id:"chart-5",children:e.jsx(Us,{data:s})}),e.jsx("div",{id:"chart-6",children:e.jsx(Vs,{data:s})})]})]})}const tt=K.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function fe(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(t);return Number.isFinite(s)?s:""}const sn=[{key:"in_progress",label:"In Progress"},{key:"group_submitted",label:"Submitted"},{key:"all_submitted",label:"Final"},{key:"editing",label:"Editing"}],nn=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}];function st(t){return t.jurorId?t.jurorId:`${(t.juryName||"").trim().toLowerCase()}__${(t.juryDept||"").trim().toLowerCase()}`}function rn({data:t,jurors:s}){const[r,i]=c.useState("ALL"),[n,a]=c.useState("ALL"),[l,h]=c.useState("ALL"),[p,u]=c.useState(new Set),[o,g]=c.useState(""),[f,C]=c.useState(""),[N,S]=c.useState(""),[x,M]=c.useState("tsMs"),[v,k]=c.useState("desc"),[b,y]=c.useState(null),m=c.useMemo(()=>tt.map(d=>({id:d.id,label:`Group ${d.id}`,name:d.name})).sort((d,R)=>d.id-R.id),[]),j=c.useMemo(()=>{const d=new Map;return s.forEach(R=>{const F=String((R==null?void 0:R.dept)??"").trim();F&&d.set(F.toLowerCase(),F)}),Array.from(d.entries()).sort((R,F)=>R[1].localeCompare(F[1])).map(([R,F])=>({key:R,label:F}))},[s]),I=c.useMemo(()=>r!=="ALL"||n!=="ALL"||l!=="ALL"||p.size>0||o||f||N,[r,n,l,p,o,f,N]);function J(){i("ALL"),a("ALL"),h("ALL"),u(new Set),g(""),C(""),S(""),M("tsMs"),k("desc"),y(null)}function H(d){u(R=>{const F=new Set(R);return F.has(d)?F.delete(d):F.add(d),F})}function L(d){y(R=>R===d?null:d)}function _(d){return d===""||d===null||d===void 0||typeof d=="string"&&d.trim()===""?!0:typeof d=="number"?!Number.isFinite(d):!1}const q=c.useMemo(()=>{const d=o?new Date(o).getTime():0,R=f?new Date(f+"T23:59:59").getTime():1/0;let F=t.slice();if(r!=="ALL"&&(F=F.filter(U=>st(U)===r)),l!=="ALL"&&(F=F.filter(U=>String(U.projectId)===l)),n!=="ALL"){const U=n.toLowerCase();F=F.filter(Z=>String(Z.juryDept??"").trim().toLowerCase()===U)}if(p.size>0&&(F=F.filter(U=>{const Z=U.editingFlag==="editing",w=U.status==="group_submitted"||U.status==="all_submitted",P=U.status==="in_progress";return Z?!!(p.has("editing")||p.has("in_progress")&&P||p.has("group_submitted")&&w):p.has("group_submitted")&&w||p.has("in_progress")&&P?!0:p.has(U.status)})),(o||f)&&(F=F.filter(U=>{const Z=U.tsMs||Ee(U.timestamp);return Z>=d&&Z<=R})),N){const U=N.toLowerCase();F=F.filter(Z=>(Z.comments||"").toLowerCase().includes(U))}return F.sort((U,Z)=>{const w=U[x],P=Z[x],O=_(w),$=_(P);return O&&$?0:O?1:$?-1:v==="asc"?Ne(w,P):Ne(P,w)}),F},[t,r,l,n,p,o,f,N,x,v]);function z(d){x===d?k(R=>R==="asc"?"desc":"asc"):(M(d),k("desc"))}const X=d=>x!==d?e.jsx(ut,{}):v==="asc"?e.jsx(mt,{}):e.jsx(ht,{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:q.length})," row",q.length!==1?"s":""]}),I&&e.jsx("button",{className:"filter-reset",onClick:J,children:"âœ• Clear Filters"}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{Es(q)},children:[e.jsx(dt,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]})]}),b!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>y(null)}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>z("juryName"),children:"Juror"}),e.jsx("div",{className:`col-filter-hotspot${r!=="ALL"?" active":""}`,onClick:d=>{d.stopPropagation(),L("juror")},title:"Filter by juror",children:e.jsx(le,{})})]}),b==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:d=>{i(d.target.value),y(null)},children:[e.jsx("option",{value:"ALL",children:"All jurors"}),s.map(d=>e.jsxs("option",{value:d.key,children:[d.name,d.dept?` (${d.dept})`:""]},d.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{i("ALL"),y(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>z("juryDept"),children:"Department"}),e.jsx("div",{className:`col-filter-hotspot${n?" active":""}`,onClick:d=>{d.stopPropagation(),L("dept")},title:"Filter by department",children:e.jsx(le,{})})]}),b==="dept"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:d=>{a(d.target.value),y(null)},children:[e.jsx("option",{value:"ALL",children:"All departments"}),j.map(d=>e.jsx("option",{value:d.key,children:d.label},d.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),y(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative",whiteSpace:"nowrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>z("projectId"),children:"Group"}),e.jsx("div",{className:`col-filter-hotspot${l!=="ALL"?" active":""}`,onClick:d=>{d.stopPropagation(),L("group")},title:"Filter by group",children:e.jsx(le,{})})]}),b==="group"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:l,onChange:d=>{h(d.target.value),y(null)},children:[e.jsx("option",{value:"ALL",children:"All groups"}),m.map(d=>e.jsx("option",{value:String(d.id),children:d.label},d.id))]}),l!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{h("ALL"),y(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>z("tsMs"),children:"Timestamp"}),e.jsx("div",{className:`col-filter-hotspot${o||f?" active":""}`,onClick:d=>{d.stopPropagation(),L("timestamp")},title:"Filter by date",children:e.jsx(le,{})})]}),b==="timestamp"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),children:[e.jsx("label",{style:{fontSize:11},children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",value:o,onChange:d=>g(d.target.value)}),e.jsx("label",{style:{fontSize:11},children:"To"}),e.jsx("input",{type:"date",value:f,onChange:d=>C(d.target.value)}),(o||f)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{g(""),C(""),y(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Status"}),e.jsx("div",{className:`col-filter-hotspot${p.size>0?" active":""}`,onClick:d=>{d.stopPropagation(),L("status")},title:"Filter by status",children:e.jsx(le,{})})]}),b==="status"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),children:[sn.map(({key:d,label:R})=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:p.has(d),onChange:()=>H(d),style:{width:"auto"}}),R]},d)),p.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{u(new Set),y(null)},children:"Clear"})]})]}),nn.map(({key:d,label:R})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>z(d),children:e.jsxs("span",{className:"col-sort-label",children:[R," ",e.jsx("span",{className:"sort-icon",children:X(d)})]})},d)),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Comments"}),e.jsx("div",{className:`col-filter-hotspot${N?" active":""}`,onClick:d=>{d.stopPropagation(),L("comments")},title:"Filter by comments",children:e.jsx(le,{})})]}),b==="comments"&&e.jsxs("div",{className:"col-filter-popover",onClick:d=>d.stopPropagation(),style:{left:"auto",right:0},children:[e.jsx("input",{autoFocus:!0,placeholder:"Search commentsâ€¦",value:N,onChange:d=>S(d.target.value)}),N&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{S(""),y(null)},children:"Clear"})]})]})]})}),e.jsxs("tbody",{children:[q.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),q.map((d,R)=>{tt.find(U=>U.id===d.projectId);const F=d.status==="in_progress";return e.jsxs("tr",{className:R%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:d.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:d.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsx("div",{className:"cell-group-wrap",title:`Group ${d.projectId}`,style:{cursor:"default"},children:e.jsxs("strong",{className:"cell-group-title",children:["Group ",d.projectId]})})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:$e(d.timestamp)}),e.jsx("td",{children:e.jsx(ke,{status:d.status,editingFlag:d.editingFlag})}),e.jsx("td",{style:{color:F?"#94a3b8":void 0},children:fe(d.technical)}),e.jsx("td",{style:{color:F?"#94a3b8":void 0},children:fe(d.design)}),e.jsx("td",{style:{color:F?"#94a3b8":void 0},children:fe(d.delivery)}),e.jsx("td",{style:{color:F?"#94a3b8":void 0},children:fe(d.teamwork)}),e.jsx("td",{style:{color:F?"#94a3b8":void 0},children:e.jsx("strong",{children:fe(d.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:d.comments})]},`${st(d)}-${d.projectId}-${R}`)})]})]})})]})}const nt=K.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function an({jurorStats:t,onPinReset:s}){const[r,i]=c.useState(""),[n,a]=c.useState(""),[l,h]=c.useState(new Set);c.useEffect(()=>{const o=setTimeout(()=>a(r),200);return()=>clearTimeout(o)},[r]);function p(o){h(g=>{const f=new Set(g);return f.has(o)?f.delete(o):f.add(o),f})}const u=c.useMemo(()=>{const o=n.trim().toLowerCase();return o?t.filter(g=>{var f;return g.jury.toLowerCase().includes(o)||(g.dept||((f=g.latestRow)==null?void 0:f.juryDept)||"").toLowerCase().includes(o)}):t},[t,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("input",{className:"juror-search-input",value:r,onChange:o=>i(o.target.value),placeholder:"ðŸ” Search by name or departmentâ€¦"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>i(""),children:"âœ•"})]})}),u.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:u.map(o=>{const{key:g,jury:f,rows:C,overall:N,latestRow:S}=o,x=Is(C),M=x===100?"#22c55e":x>66?"#84cc16":x>33?"#eab308":x>0?"#f97316":"#e2e8f0",v=C.some(m=>m.editingFlag==="editing"),k=nt.map(m=>{const j=C.find(J=>J.projectId===m.id),I=(j==null?void 0:j.status)==="group_submitted"||(j==null?void 0:j.status)==="all_submitted"?"submitted":(j==null?void 0:j.status)||"not_started";return{id:m.id,status:I}}),b=k.length>0&&k.every(m=>m.status==="submitted"),y=v?"juror-card-editing":N==="all_submitted"?"juror-card-all-submitted":N==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${y}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:["ðŸ‘¤ ",f,(S==null?void 0:S.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",S.juryDept,")"]})]}),e.jsx("div",{className:"juror-header-actions",children:v?e.jsx(ke,{status:N,editingFlag:"editing"}):b?e.jsx(ke,{variant:"completed",icon:e.jsx(ct,{}),children:"Completed"}):e.jsx(ke,{status:N})})]}),e.jsxs("div",{className:"juror-meta",children:[(S==null?void 0:S.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:$e(S==null?void 0:S.timestamp)})]}),s&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${f}`,onClick:()=>s(f,(S==null?void 0:S.juryDept)||"",(S==null?void 0:S.jurorId)||""),children:"ðŸ”‘ Reset PIN"})]})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${x}%`,background:M}})}),e.jsxs("span",{className:"juror-progress-label",children:[x,"%"]})]}),e.jsx("div",{className:"juror-projects",children:C.slice().sort((m,j)=>m.projectId-j.projectId).map(m=>{var _,q;const j=nt.find(z=>z.id===m.projectId),I=`${g}-${m.projectId}`,J=l.has(I),H=`juror-group-panel-${I}`,L=!!(j!=null&&j.desc)||((_=j==null?void 0:j.students)==null?void 0:_.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:L?0:-1,"aria-expanded":J,"aria-controls":H,onClick:()=>{L&&p(I)},onKeyDown:z=>{(z.key==="Enter"||z.key===" ")&&L&&(z.preventDefault(),p(I))},style:{cursor:L?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(j==null?void 0:j.name)||`Group ${m.projectId}`}),L&&e.jsx("span",{className:`group-accordion-chevron${J?" open":""}`,children:"â–¾"})]})}),e.jsxs("div",{className:"juror-row-right",children:[m.timestamp&&e.jsx("span",{className:"juror-row-ts",children:$e(m.timestamp)}),e.jsx(ke,{status:m.status,editingFlag:m.editingFlag}),(m.status==="all_submitted"||m.status==="group_submitted")&&e.jsx("span",{className:"juror-score",title:"/ 100","aria-label":`${m.total} / 100`,children:m.total})]})]}),e.jsx("div",{id:H,className:`group-accordion-panel${J?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(j==null?void 0:j.desc)&&e.jsx("span",{className:"juror-row-desc",children:j.desc}),((q=j==null?void 0:j.students)==null?void 0:q.length)>0&&e.jsxs("span",{className:"juror-row-students",children:["ðŸ‘¥ ",j.students.join(" Â· ")]})]})})]},I)})})]},g)})})]})}const ln=t=>t?t.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="group_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},on=t=>t?t.status==="all_submitted"||t.status==="group_submitted"?t.total:t.status==="in_progress"?"":"â€”":"â€”";function cn({data:t,jurors:s,groups:r}){const[i,n]=c.useState(null),[a,l]=c.useState("desc"),[h,p]=c.useState(""),[u,o]=c.useState(null),g=c.useMemo(()=>{const b={};return t.forEach(y=>{const m=y.jurorId?y.jurorId:`${(y.juryName||"").trim().toLowerCase()}__${(y.juryDept||"").trim().toLowerCase()}`;b[m]||(b[m]={}),b[m][y.projectId]={total:y.total,status:y.status,editingFlag:y.editingFlag}}),b},[t]);function f(b){i!==b?(n(b),l("desc")):a==="desc"?l("asc"):(n(null),l("desc"))}const C=b=>i!==b?e.jsx(ut,{}):a==="desc"?e.jsx(ht,{}):e.jsx(mt,{});function N(){p(""),o(null)}const S=c.useMemo(()=>{let b=s.slice();if(h){const y=h.toLowerCase();b=b.filter(m=>m.name.toLowerCase().includes(y))}return i!==null&&(b=[...b].sort((y,m)=>{var _,q;const j=(_=g[y.key])==null?void 0:_[i],I=(q=g[m.key])==null?void 0:q[i],J=(j==null?void 0:j.status)==="all_submitted"?Number(j.total):null,H=(I==null?void 0:I.status)==="all_submitted"?Number(I.total):null;if(J===null&&H===null)return Ne(y.name,m.name);if(J===null)return 1;if(H===null)return-1;const L=a==="desc"?H-J:J-H;return L!==0?L:Ne(y.name,m.name)})),b},[s,h,i,a,g]),x=b=>{const y=r.map(m=>{var J;const j=(J=g[b])==null?void 0:J[m.id];return{status:(j==null?void 0:j.status)==="group_submitted"||(j==null?void 0:j.status)==="all_submitted"?"submitted":(j==null?void 0:j.status)||"not_started",editing:(j==null?void 0:j.editingFlag)==="editing"}});return y.every(m=>m.status==="not_started")?"not_started":y.some(m=>m.editing)?"editing":y.every(m=>m.status==="submitted")?"completed":y.some(m=>m.status==="in_progress")?"in_progress":y.some(m=>m.status==="submitted")?"submitted":"not_started"},M={completed:"Completed",submitted:"Submitted",in_progress:"In Progress",editing:"Editing",not_started:"Not Started"},v={completed:e.jsx(ct,{}),submitted:e.jsx(_e,{}),in_progress:e.jsx(ze,{}),editing:e.jsx(We,{}),not_started:e.jsx(rs,{})},k=c.useMemo(()=>r.map(b=>{const y=S.map(m=>{var j;return(j=g[m.key])==null?void 0:j[b.id]}).filter(m=>(m==null?void 0:m.status)==="all_submitted").map(m=>m.total);return y.length?(y.reduce((m,j)=>m+j,0)/y.length).toFixed(2):null}),[S,r,g]);return s.length?e.jsxs("div",{className:"matrix-wrap",children:[(h||S.length<s.length)&&e.jsxs("div",{className:"matrix-controls",children:[h&&e.jsx("button",{className:"matrix-clear-filters",onClick:N,children:"âœ• Clear Filters"}),S.length<s.length&&e.jsxs("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:600},children:["Showing ",S.length,"/",s.length," jurors"]})]}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(pt,{})," Averages include only ",e.jsx("strong",{children:"completed"})," submissions."]}),e.jsxs("p",{className:"matrix-subtitle",children:[e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]}),u!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>o(null)}),e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"matrix-corner",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:["Juror / Group",e.jsx("button",{className:`col-filter-hotspot${h?" active":""}`,onClick:b=>{b.stopPropagation(),o(y=>y==="juror"?null:"juror")},title:"Filter jurors",children:e.jsx(le,{})})]}),u==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:b=>b.stopPropagation(),children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror nameâ€¦",value:h,onChange:b=>p(b.target.value)}),h&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{p(""),o(null)},children:"Clear"})]})]}),r.map(b=>{const y=i===b.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${y?" active":""}`,onClick:()=>f(b.id),title:`Sort by ${b.label}`,children:[e.jsx("strong",{children:b.label}),e.jsx("span",{className:"sort-icon",children:C(b.id)})]})},b.id)})]})}),e.jsx("tbody",{children:S.map(b=>e.jsxs("tr",{children:[e.jsxs("td",{className:"matrix-juror",children:[(()=>{const y=x(b.key);return e.jsx("span",{className:`matrix-status-icon ${y}`,title:M[y],"aria-hidden":"true",children:v[y]})})(),b.name,b.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",b.dept,")"]})]}),r.map(y=>{var j;const m=((j=g[b.key])==null?void 0:j[y.id])??null;return e.jsx("td",{style:ln(m),children:on(m)},y.id)})]},b.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),k.map((b,y)=>e.jsx("td",{className:"matrix-avg-cell",children:b!==null?b:"â€”"},r[y].id))]})})]})})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const Te=K.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]}),dn=Y.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Pe=Te.length,un=2*60*1e3;function ve(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:""}const mn=[{id:"summary",label:"Summary",icon:is},{id:"dashboard",label:"Dashboard",icon:as},{id:"detail",label:"Details",icon:ls},{id:"jurors",label:"Jurors",icon:Zt},{id:"matrix",label:"Matrix",icon:os}];function hn({metrics:t,id:s}){const{completedJurors:r,totalJurors:i,completedEvaluations:n,totalEvaluations:a,inProgressJurors:l,editingJurors:h}=t;return e.jsxs("div",{id:s,className:"results-status-bar",role:"group","aria-label":"Results status metrics",children:[e.jsxs("span",{className:"status-chip status-jurors",children:[e.jsx(es,{}),e.jsx("span",{className:"status-label",children:"Jurors"}),e.jsx("span",{className:"status-value",children:i}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown",children:[e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(ts,{}),r]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(ze,{}),l]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(We,{}),h]})]})]}),e.jsxs("span",{className:"status-chip status-evaluated",children:[e.jsx(ns,{}),e.jsx("span",{className:"status-label",children:"Evaluated"}),e.jsxs("span",{className:"status-value",children:[n,"/",a]})]})]})}function pn({adminPass:t,onBack:s,onAuthError:r,onInitialLoadDone:i}){const[n,a]=c.useState([]),[l,h]=c.useState(!0),[p,u]=c.useState(""),[o,g]=c.useState(""),[f,C]=c.useState(!0),[N,S]=c.useState("summary"),[x,M]=c.useState(null),[v,k]=c.useState(null),[b,y]=c.useState(""),m=c.useRef(!1),j=c.useRef(t);c.useEffect(()=>{j.current=t},[t]);const I=async()=>{h(!0),u("");try{const w=j.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!w){a([]),g("Enter the admin password to load results.");return}const P=await he({action:"export",pass:w});if((P==null?void 0:P.status)==="unauthorized"){if(a([]),r){r("Invalid password");return}g("Incorrect password.");return}if((P==null?void 0:P.status)!=="ok"||!Array.isArray(P==null?void 0:P.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",w)}catch{}const O=P.rows.map($=>({juryName:String($["Juror Name"]??$["Your Name"]??""),juryDept:String($["Department / Institution"]??$.Department??""),timestamp:$.Timestamp||"",tsMs:Ee($.Timestamp||""),projectId:Cs($["Group No"]),projectName:String($["Group Name"]??""),jurorId:String($["Juror ID"]??""),technical:ve($["Technical (30)"]),design:ve($["Written (30)"]),delivery:ve($["Oral (30)"]),teamwork:ve($["Teamwork (10)"]),total:ve($["Total (100)"]),comments:$.Comments||"",status:String($.Status??"all_submitted"),editingFlag:String($.EditingFlag??"")}));a(Fs(O)),M(new Date),g(""),m.current||(m.current=!0,i==null||i())}catch(w){if(r){r("Connection error â€” try again.");return}u("Could not load data: "+w.message),a([])}finally{h(!1)}};c.useEffect(()=>{I()},[]),c.useEffect(()=>{const w=setInterval(I,un);return()=>clearInterval(w)},[]),c.useEffect(()=>(v?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[v]);const J=async(w,P,O)=>{k({juryName:w,juryDept:P}),y("loading");try{const $=j.current||sessionStorage.getItem("ee492_admin_pass")||"",W=await he({action:"resetPin",jurorId:O.trim(),pass:$});y(W.status==="ok"?"ok":"error")}catch{y("error")}setTimeout(()=>{k(null),y("")},3e3)},H=w=>w.jurorId?w.jurorId:`${(w.juryName||"").trim().toLowerCase()}__${(w.juryDept||"").trim().toLowerCase()}`,L=c.useMemo(()=>{const w=new Map;return n.forEach(P=>{if(!P.juryName)return;const O=H(P);w.has(O)||w.set(O,{key:O,name:P.juryName.trim(),dept:P.juryDept.trim(),jurorId:P.jurorId})}),[...w.values()].sort((P,O)=>Ne(P.name,O.name))},[n]),_=c.useMemo(()=>Te.map(w=>({id:w.id,label:`Group ${w.id}`,desc:w.desc||""})).sort((w,P)=>w.id-P.id),[]),q=c.useMemo(()=>{const w=new Map;return L.forEach(({key:P,dept:O})=>w.set(P,O)),w},[L]),z=c.useMemo(()=>{const w=new Map;return L.forEach(({key:P,name:O})=>w.set(P,{bg:Ls(O),dot:Ms(O)})),w},[L]),X=c.useMemo(()=>n.filter(w=>w.status==="all_submitted"),[n]);c.useMemo(()=>n.filter(w=>w.status==="group_submitted"||w.status==="all_submitted"),[n]);const d=c.useMemo(()=>Te.map(w=>{const P=X.filter(W=>W.projectId===w.id);if(!P.length)return{id:w.id,name:w.name,desc:w.desc,students:w.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const O={};dn.forEach(W=>{O[W.id]=P.reduce((V,se)=>V+(se[W.id]||0),0)/P.length});const $=P.map(W=>W.total);return{id:w.id,name:w.name,desc:w.desc,students:w.students,count:P.length,avg:O,totalAvg:$.reduce((W,V)=>W+V,0)/$.length,totalMin:Math.min(...$),totalMax:Math.max(...$)}}),[X]),R=c.useMemo(()=>d.map(w=>({...w,name:`Group ${w.id}`})),[d]),F=c.useMemo(()=>[...d].sort((w,P)=>P.totalAvg-w.totalAvg),[d]),U=c.useMemo(()=>L.map(({key:w,name:P,dept:O,jurorId:$})=>{const W=n.filter(te=>H(te)===w),V=W.filter(te=>te.status==="group_submitted"||te.status==="all_submitted"),se=W.filter(te=>te.status==="all_submitted"),oe=W.filter(te=>te.status==="in_progress"),ce=W.reduce((te,xe)=>xe.tsMs>te?xe.tsMs:te,0),Q=W.find(te=>te.tsMs===ce)||W[0],ne=se.length===Pe?"all_submitted":V.length>0||oe.length>0?"in_progress":"not_started";return{key:w,jury:P,dept:O,jurorId:$,rows:W,submitted:V,completed:V,finalSubmitted:se,inProgress:oe,latestTs:ce,latestRow:Q,overall:ne}}),[L,n]);n.filter(w=>w.status==="in_progress").length,U.filter(w=>w.rows.some(P=>P.editingFlag==="editing")).length;const Z=c.useMemo(()=>{const w=L.length,P=X.length,O=w*Pe,$=new Map;n.forEach(Q=>{if(Q.status!=="all_submitted")return;const ne=H(Q);$.has(ne)||$.set(ne,new Set),$.get(ne).add(Q.projectId)});const W=L.filter(Q=>{var ne;return(((ne=$.get(Q.key))==null?void 0:ne.size)||0)>=Pe}).length,V=new Set(n.filter(Q=>Q.status==="editing"||Q.editingFlag==="editing").map(Q=>H(Q))),oe=new Set(n.filter(Q=>Q.status==="in_progress").map(Q=>H(Q)).filter(Q=>!V.has(Q))).size,ce=V.size;return{completedJurors:W,totalJurors:w,completedEvaluations:P,totalEvaluations:O,inProgressJurors:oe,editingJurors:ce}},[n,X,L,H]);return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("div",{className:"form-header-main",children:[e.jsx("button",{className:"back-btn",onClick:s,"aria-label":"Back to home",children:e.jsx(Me,{})}),e.jsx("div",{children:e.jsxs("div",{className:"results-title-row",children:[e.jsx("h2",{children:"Results Panel"}),e.jsx("button",{className:"results-toggle",type:"button","aria-label":f?"Hide status metrics":"Show status metrics","aria-expanded":f,"aria-controls":"results-status-bar",onClick:()=>C(w=>!w),children:e.jsx("span",{className:`results-toggle-icon${f?" open":""}`,"aria-hidden":"true",children:"â–¾"})})]})}),e.jsxs("div",{className:"header-actions",children:[x&&e.jsxs("span",{className:"last-updated",children:[e.jsx(ss,{}),x.toLocaleString("tr-TR",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," Â·")]}),e.jsx("button",{className:"refresh-btn",onClick:I,"aria-label":"Refresh",title:"Refresh",children:e.jsx(ds,{})})]})]}),f&&e.jsx(hn,{id:"results-status-bar",metrics:Z}),e.jsxs("div",{className:"tab-bar-wrap",children:[e.jsx("div",{className:"tab-bar",children:mn.map(w=>e.jsxs("button",{className:`tab ${N===w.id?"active":""}`,onClick:()=>S(w.id),children:[e.jsx(w.icon,{}),w.label]},w.id))}),e.jsx("span",{className:"tab-scroll-hint","aria-hidden":"true",children:e.jsx(xt,{})})]})]}),l&&e.jsx("div",{className:"loading",children:"Loading dataâ€¦"}),p&&e.jsx("div",{className:"error-msg",children:p}),o&&e.jsx("div",{className:"error-msg",children:o}),v&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${b}`,children:[b==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"ðŸ”‘"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:v.juryName}),"â€¦"]})]}),b==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon ok",children:"âœ…"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:v.juryName})," will receive a new PIN on next login."]})]}),b==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon error",children:"âŒ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:v.juryName}),"."]})]})]})}),!l&&!p&&!o&&e.jsxs("div",{className:"admin-body",children:[N==="summary"&&e.jsx(Bs,{ranked:F,submittedData:X}),N==="dashboard"&&e.jsx(tn,{dashboardStats:R,submittedData:X,lastRefresh:x,loading:l,error:p}),N==="detail"&&e.jsx(rn,{data:n,jurors:L,jurorColorMap:z}),N==="jurors"&&e.jsx(an,{jurorStats:U,jurors:L,onPinReset:J}),N==="matrix"&&e.jsx(cn,{data:n,jurors:L,groups:_,jurorDeptMap:q})]})]})}const xn="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function jn(){const[t,s]=c.useState("home"),r=c.useRef(""),[i,n]=c.useState(!1),[a,l]=c.useState(!1),[h,p]=c.useState(""),[u,o]=c.useState("");function g(){const C=h.trim();if(!C){o("Please enter the admin password.");return}r.current=C,p(""),o(""),l(!0),n(!0)}function f(C){n(!1),l(!1),r.current="",o(C||"Authentication failed.")}return t==="jury"?e.jsx(ys,{onBack:()=>s("home")}):t==="admin"?i?e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"admin-checking-overlay",children:e.jsxs("div",{className:"admin-checking-card",children:[e.jsx("div",{className:"admin-checking-icon",children:"ðŸ”„"}),e.jsx("div",{className:"admin-checking-msg",children:"Checkingâ€¦"})]})}),e.jsx(pn,{adminPass:r.current,onAuthError:f,onInitialLoadDone:()=>l(!1),onBack:()=>{s("home"),n(!1),l(!1),o(""),r.current=""}})]}):e.jsx("div",{className:"lock-screen",children:e.jsxs("div",{className:"lock-card",children:[e.jsx("div",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("h2",{children:"Results Panel"}),e.jsx("p",{children:"Enter the admin password to view results"}),u&&e.jsx("div",{className:"login-error",children:u}),e.jsx("input",{type:"password",placeholder:"Password",value:h,onChange:C=>{p(C.target.value),u&&o("")},onKeyDown:C=>{C.key==="Enter"&&g()},autoFocus:!0}),e.jsx("button",{className:"btn-primary",onClick:g,disabled:a,children:"Login"}),e.jsx("button",{className:"btn-ghost",onClick:()=>{s("home"),o("")},children:"â† Back"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:xn,alt:"TED University",loading:"eager"})}),e.jsxs("h1",{children:["Senior Project",e.jsx("br",{}),"Jury Portal"]}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big",onClick:()=>s("jury"),children:[e.jsx("span",{children:"ðŸ“‹"})," Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big",onClick:()=>s("admin"),children:[e.jsx("span",{children:"ðŸ“Š"})," View Results"]})]}),e.jsxs("p",{className:"home-hint",children:[e.jsx("span",{className:"home-hint-ico",children:"â„¹ï¸"}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["Â© 2026 Â· Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})]})]})]})}De.createRoot(document.getElementById("root")).render(e.jsx(Tt.StrictMode,{children:e.jsx(jn,{})}));
