import{r as c,a as ps,R as Js}from"./react-b1791c80.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var js={exports:{}},Fe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qs=c,Us=Symbol.for("react.element"),Vs=Symbol.for("react.fragment"),Ys=Object.prototype.hasOwnProperty,Qs=qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xs={key:!0,ref:!0,__self:!0,__source:!0};function fs(s,t,r){var a,n={},o=null,i=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)Ys.call(t,a)&&!Xs.hasOwnProperty(a)&&(n[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Us,type:s,key:o,ref:i,props:n,_owner:Qs.current}}Fe.Fragment=Vs;Fe.jsx=fs;Fe.jsxs=fs;js.exports=Fe;var e=js.exports,Be={},Ze=ps;Be.createRoot=Ze.createRoot,Be.hydrateRoot=Ze.hydrateRoot;const ce={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 â€” Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},H=[{id:1,name:"Group 1",desc:"GÃ¶ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf Ãœnal","AyÃ§a Naz DedeoÄŸlu","Onur Mesci","Ã‡aÄŸan ErdoÄŸan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla Ã–zer","Bertan Ãœnver","Ada TatlÄ±","Nesibe AydÄ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren GermeÃ§"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis â€” Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine Ã‡aylan","Selimhan Kaynar","Abdulkadir SazlÄ±","Alp Efe Ä°pek"]},{id:6,name:"Group 6",desc:"AKKE â€” Smart Command and Control Glove",students:["Åževval KurtulmuÅŸ","Abdullah Esin","Berk Ã‡akmak","Ã–mer Efe Dikici"]}],Y=[{id:"technical",label:"Technical Content",shortLabel:"Technical",color:"#F59E0B",mudek:["1.2","2","3.1","3.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",color:"#22C55E",mudek:["9.2"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",color:"#3B82F6",mudek:["9.1"],max:30,rubric:[{range:"27â€“30",level:"Excellent",min:27,max:30,desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21â€“26",level:"Good",min:21,max:26,desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13â€“20",level:"Developing",min:13,max:20,desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0â€“12",level:"Insufficient",min:0,max:12,desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",color:"#EF4444",mudek:["8.1","8.2"],max:10,rubric:[{range:"9â€“10",level:"Excellent",min:9,max:10,desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7â€“8",level:"Good",min:7,max:8,desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4â€“6",level:"Developing",min:4,max:6,desc:"Uneven participation. Some members are passive or unprepared."},{range:"0â€“3",level:"Insufficient",min:0,max:3,desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}],es=70,Zs={Excellent:{bg:"#DCFCE7",text:"#16A34A"},Good:{bg:"#F7FEE7",text:"#65A30D"},Developing:{bg:"#FEF9C3",text:"#CA8A04"},Insufficient:{bg:"#FEE2E2",text:"#DC2626"}},et={"1.1":{en:"Knowledge in mathematics, natural sciences, fundamental engineering, computational methods, and discipline-specific topics.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konularda bilgi."},"1.2":{en:"Ability to apply knowledge of mathematics, natural sciences, fundamental engineering, computation, and discipline-specific topics to solve complex engineering problems.",tr:"Matematik, fen bilimleri, temel mÃ¼hendislik, bilgisayarla hesaplama ve ilgili mÃ¼hendislik disiplinine Ã¶zgÃ¼ konulardaki bilgileri, karmaÅŸÄ±k mÃ¼hendislik problemlerinin Ã§Ã¶zÃ¼mÃ¼nde kullanabilme becerisi."},2:{en:"Ability to identify, formulate, and analyse complex engineering problems using fundamental science, mathematics, and engineering knowledge, with consideration of relevant UN Sustainable Development Goals.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerini, temel bilim, matematik ve mÃ¼hendislik bilgilerini kullanarak ve ele alÄ±nan problemle ilgili BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ±nÄ± gÃ¶zetarak tanÄ±mlama, formÃ¼le etme ve analiz becerisi."},"3.1":{en:"Ability to design creative solutions to complex engineering problems.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerine yaratÄ±cÄ± Ã§Ã¶zÃ¼mler tasarlama becerisi."},"3.2":{en:"Ability to design complex systems, processes, devices, or products under realistic constraints and conditions, meeting current and future requirements.",tr:"KarmaÅŸÄ±k sistemleri, sÃ¼reÃ§leri, cihazlarÄ± veya Ã¼rÃ¼nleri gerÃ§ekÃ§i kÄ±sÄ±tlarÄ± ve koÅŸullarÄ± gÃ¶zetarak, mevcut ve gelecekteki gereksinimleri karÅŸÄ±layacak biÃ§imde tasarlama becerisi."},4:{en:"Ability to select and use appropriate techniques, resources, and modern engineering and IT tools â€” including estimation and modelling â€” for the analysis and solution of complex engineering problems, with awareness of their limitations.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin analizi ve Ã§Ã¶zÃ¼mÃ¼ne yÃ¶nelik, tahmin ve modelleme de dahil olmak Ã¼zere, uygun teknikleri, kaynaklarÄ± ve modern mÃ¼hendislik ve biliÅŸim araÃ§larÄ±nÄ±, sÄ±nÄ±rlamalarÄ±nÄ±n da farkÄ±nda olarak seÃ§me ve kullanma becerisi."},5:{en:"Ability to use research methods for investigating complex engineering problems, including literature review, experiment design, experimentation, data collection, and analysis and interpretation of results.",tr:"KarmaÅŸÄ±k mÃ¼hendislik problemlerinin incelenmesi iÃ§in literatÃ¼r araÅŸtÄ±rmasÄ±, deney tasarlama, deney yapma, veri toplama, sonuÃ§larÄ± analiz etme ve yorumlama dahil, araÅŸtÄ±rma yÃ¶ntemlerini kullanma becerisi."},"6.1":{en:"Knowledge of the impacts of engineering applications on society, health and safety, economy, sustainability, and the environment within the scope of UN Sustainable Development Goals.",tr:"MÃ¼hendislik uygulamalarÄ±nÄ±n BM SÃ¼rdÃ¼rÃ¼lebilir KalkÄ±nma AmaÃ§larÄ± kapsamÄ±nda, topluma, saÄŸlÄ±k ve gÃ¼venliÄŸe, ekonomiye, sÃ¼rdÃ¼rÃ¼lebilirlik ve Ã§evreye etkileri hakkÄ±nda bilgi."},"6.2":{en:"Awareness of the legal consequences of engineering solutions.",tr:"MÃ¼hendislik Ã§Ã¶zÃ¼mlerinin hukuksal sonuÃ§larÄ± konusunda farkÄ±ndalÄ±k."},"7.1":{en:"Knowledge of acting in accordance with engineering professional principles and ethical responsibility.",tr:"MÃ¼hendislik meslek ilkelerine uygun davranma, etik sorumluluk hakkÄ±nda bilgi."},"7.2":{en:"Awareness of non-discrimination, impartiality, and inclusivity of diversity.",tr:"HiÃ§bir konuda ayrÄ±mcÄ±lÄ±k yapmadan, tarafsÄ±z davranma ve Ã§eÅŸitliliÄŸi kapsayÄ±cÄ± olma konularÄ±nda farkÄ±ndalÄ±k."},"8.1":{en:"Ability to work effectively as a team member or leader in intra-disciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak disiplin iÃ§i takÄ±m Ã§alÄ±ÅŸmalarÄ±nda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"8.2":{en:"Ability to work effectively as a team member or leader in multidisciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak Ã§ok disiplinli takÄ±mlarda (yÃ¼z yÃ¼ze, uzaktan veya karma) takÄ±m Ã¼yesi veya lideri olarak etkin biÃ§imde Ã§alÄ±ÅŸabilme becerisi."},"9.1":{en:"Ability to communicate effectively on technical topics orally, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda sÃ¶zlÃ¼ etkin iletiÅŸim kurma becerisi."},"9.2":{en:"Ability to communicate effectively on technical topics in writing, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin Ã§eÅŸitli farklÄ±lÄ±klarÄ±nÄ± (eÄŸitim, dil, meslek gibi) dikkate alarak, teknik konularda yazÄ±lÄ± etkin iletiÅŸim kurma becerisi."},"10.1":{en:"Knowledge of business practices such as project management and economic feasibility analysis.",tr:"Proje yÃ¶netimi ve ekonomik yapÄ±labilirlik analizi gibi iÅŸ hayatÄ±ndaki uygulamalar hakkÄ±nda bilgi."},"10.2":{en:"Awareness of entrepreneurship and innovation.",tr:"GiriÅŸimcilik ve yenilikÃ§ilik hakkÄ±nda farkÄ±ndalÄ±k."},11:{en:"Lifelong learning skills including independent and continuous learning, adaptation to new and emerging technologies, and critical thinking about technological change.",tr:"BaÄŸÄ±msÄ±z ve sÃ¼rekli Ã¶ÄŸrenebilme, yeni ve geliÅŸmekte olan teknolojilere uyum saÄŸlayabilme ve teknolojik deÄŸiÅŸimlerle ilgili sorgulayÄ±cÄ± dÃ¼ÅŸÃ¼nebilmeyi kapsayan yaÅŸam boyu Ã¶ÄŸrenme becerisi."}};Y.reduce((s,t)=>s+(Number(t.max)||0),0);const gs=ce==null?void 0:ce.scriptUrl,Je=ce==null?void 0:ce.apiSecret;function ss(s,t){const r=s.trim().toLowerCase()+"__"+t.trim().toLowerCase();let a=5381;for(let n=0;n<r.length;n++)a=(a<<5)+a^r.charCodeAt(n),a=a>>>0;return a.toString(16).padStart(8,"0")}let qe="";function ts(s){qe=s}function Ae(){return qe}function ns(){qe=""}async function me(s){const t=Ae();try{await fetch(gs,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,token:t})})}catch{}}async function fe(s){const t=new URLSearchParams(s).toString(),r=await fetch(`${gs}?${t}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=(await r.text()).trim();if(a.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script â€” check your deployment URL.");try{return JSON.parse(a)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function vs(s){return fe({...s,token:Ae()})}function ve(s,t,r,a,n,o,i){var m,p,u,l;return{juryName:s,juryDept:t,jurorId:r,timestamp:new Date().toISOString(),projectId:o.id,projectName:o.name,technical:((m=a[o.id])==null?void 0:m.technical)??"",design:((p=a[o.id])==null?void 0:p.design)??"",delivery:((u=a[o.id])==null?void 0:u.delivery)??"",teamwork:((l=a[o.id])==null?void 0:l.teamwork)??"",total:st(a,o.id),comments:n[o.id]||"",status:i}}function st(s,t){return Y.reduce((r,a)=>{var n;return r+(parseInt((n=s[t])==null?void 0:n[a.id],10)||0)},0)}async function tt(s){return fe({action:"checkPin",jurorId:s,secret:Je})}async function nt(s,t,r){return fe({action:"createPin",jurorId:s,juryName:t.trim(),juryDept:r.trim(),secret:Je})}async function rt(s,t){return fe({action:"verifyPin",jurorId:s,pin:String(t).trim(),secret:Je})}async function rs(){const s=await vs({action:"myscores"});if(s.status==="unauthorized"){const t=new Error("unauthorized");throw t.unauthorized=!0,t}return s.status!=="ok"?null:s.rows||[]}async function as(){return vs({action:"ping"})}const is=1500,Ne=()=>Object.fromEntries(H.map(s=>[s.id,Object.fromEntries(Y.map(t=>[t.id,""]))])),we=()=>Object.fromEntries(H.map(s=>[s.id,""])),os=()=>Object.fromEntries(H.map(s=>[s.id,Object.fromEntries(Y.map(t=>[t.id,!1]))])),at=()=>Object.fromEntries(H.map(s=>[s.id,Object.fromEntries(Y.map(t=>[t.id,!0]))])),je=(s,t)=>Y.every(r=>{var a;return((a=s[t])==null?void 0:a[r.id])!==""}),ls=s=>H.every(t=>je(s,t.id)),bs=s=>H.reduce((t,r)=>t+Y.reduce((a,n)=>{var o;return a+(((o=s[r.id])==null?void 0:o[n.id])!==""?1:0)},0),0),it=(s,t)=>Y.some(r=>{var a;return((a=s[t])==null?void 0:a[r.id])!==""});function $e(s){const t=Ne(),r=we();return(s||[]).forEach(a=>{const n=Number(a.projectId);n&&(t[n]={...t[n],technical:a.technical??"",design:a.design??"",delivery:a.delivery??"",teamwork:a.teamwork??""},r[n]=a.comments??"")}),{scores:t,comments:r}}function ot(){const[s,t]=c.useState(""),[r,a]=c.useState(""),n=c.useRef("");c.useEffect(()=>{n.current=s.trim()&&r.trim()?ss(s,r):""},[s,r]);const[o,i]=c.useState("info"),[m,p]=c.useState(0),[u,l]=c.useState(Ne),[h,j]=c.useState(we),[M,N]=c.useState(os),[v,f]=c.useState({}),[C,g]=c.useState(!1),[k,P]=c.useState(null),[$,w]=c.useState(null),[y,D]=c.useState(null),[L,I]=c.useState("idle"),[b,A]=c.useState("idle"),[G,_]=c.useState(""),[ee,U]=c.useState(""),[V,J]=c.useState(3),[re,te]=c.useState(!1),[de,Q]=c.useState(""),d=c.useRef(!1),R=c.useRef({});R.current={juryName:s,juryDept:r,scores:u,comments:h,groupSynced:v,current:m};const x=c.useRef(u),S=c.useRef(h),W=c.useCallback(E=>{const{juryName:F,juryDept:T}=R.current,B=n.current,O=x.current,K=S.current;if(!F.trim()||!B||!Ae()||!it(O,E))return;const oe=H.find(Hs=>Hs.id===E);if(!oe)return;const Me=je(O,E)?"group_submitted":"in_progress",Ks=ve(F,T,B,O,K,oe,Me);I("saving"),me({rows:[Ks]}),setTimeout(()=>I("saved"),500),setTimeout(()=>I("idle"),2500)},[]),z=c.useCallback(E=>{var B;const{current:F}=R.current,T=(B=H[F])==null?void 0:B.id;T!==void 0&&W(T),p(E)},[W]);c.useEffect(()=>{if(o!=="eval"||C)return;const E={};H.forEach(F=>{!v[F.id]&&je(u,F.id)&&(E[F.id]=!0)}),Object.keys(E).length>0&&f(F=>({...F,...E}))},[u,o,v,C]),c.useEffect(()=>{if(o!=="eval"||d.current||C||!H.every(F=>v[F.id]))return;d.current=!0;const E=setTimeout(()=>{const{juryName:F,juryDept:T,scores:B,comments:O}=R.current,K=n.current;me({rows:H.map(oe=>ve(F,T,K,B,O,oe,"all_submitted"))}),P({...B}),w({...O}),i("done")},800);return()=>clearTimeout(E)},[v,o,C]);const q=c.useCallback((E,F,T)=>{const B={...x.current,[E]:{...x.current[E],[F]:T}};x.current=B,l(B),N(O=>({...O,[E]:{...O[E],[F]:!0}})),T===""&&v[E]&&f(O=>({...O,[E]:!1}))},[v]),ne=c.useCallback((E,F)=>{var O;const T=Y.find(K=>K.id===F),B=(O=x.current[E])==null?void 0:O[F];if(N(K=>({...K,[E]:{...K[E],[F]:!0}})),B!==""&&B!==void 0){const K=parseInt(B,10),oe=Number.isFinite(K)?Math.min(Math.max(K,0),T.max):0;if(String(oe)!==String(B)){const Me={...x.current,[E]:{...x.current[E],[F]:oe}};x.current=Me,l(Me)}}W(E)},[W]),ae=c.useCallback((E,F)=>{const T={...S.current,[E]:F};S.current=T,j(T)},[]),xe=c.useCallback(E=>{W(E)},[W]),ue=c.useCallback((E,F)=>{const{juryName:T,juryDept:B}=R.current,O=n.current;me({rows:H.map(K=>ve(T,B,O,E,F,K,"all_submitted"))}),P({...E}),w({...F}),g(!1),d.current=!0,i("done")},[]),X=c.useCallback(async()=>{const{juryName:E,juryDept:F}=R.current,T=n.current,B=k||u,O=$||h;T&&me({action:"resetJuror"}),x.current=B,S.current=O,l(B),j(O),g(!0),d.current=!1,f(Object.fromEntries(H.map(K=>[K.id,!0]))),i("eval"),setTimeout(()=>{T&&me({rows:H.map(K=>ve(E,F,T,B,O,K,"group_submitted"))})},is)},[k,$,u,h]),ie=c.useCallback(()=>{if(!ls(u)){N(at());const E=H.findIndex(F=>!je(u,F.id));E>=0&&p(E);return}ue(u,h)},[u,h,ue]),Z=c.useCallback(E=>{ns(),Q(E||"Your session has expired. Please enter your PIN again."),te(!0)},[]),Le=c.useCallback(()=>{te(!1),Q(""),_(""),A("entering"),i("pin")},[]),pe=c.useCallback(async()=>{D({loading:!0});let E=[];try{E=await rs()||[]}catch(O){if(O.unauthorized){Z("Your session has expired. Please enter your PIN again.");return}}const F=H.length,T=E.filter(O=>O.status==="group_submitted"||O.status==="all_submitted").length,B=E.length>=F&&E.every(O=>O.status==="all_submitted");D({rows:E,filledCount:T,totalCount:F,allSubmitted:B})},[Z]);c.useEffect(()=>{if(o!=="eval")return;const E=setInterval(async()=>{try{(await as()).status==="unauthorized"&&Z("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(E)},[o,Z]),c.useEffect(()=>{if(o!=="eval")return;async function E(){if(document.visibilityState==="visible")try{(await as()).status==="unauthorized"&&Z("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",E),()=>document.removeEventListener("visibilitychange",E)},[o,Z]);const Fs=c.useCallback(()=>{const E=y;if(E){if(D(null),E.allSubmitted){const{scores:F,comments:T}=$e(E.rows);x.current=F,S.current=T,l(F),j(T),P(F),w(T),f(Object.fromEntries(H.map(B=>[B.id,!0]))),d.current=!0,i("done");return}if(E.rows.length>0){const{scores:F,comments:T}=$e(E.rows),B=Object.fromEntries(E.rows.filter(K=>K.status==="group_submitted"||K.status==="all_submitted").map(K=>[Number(K.projectId),!0]));x.current=F,S.current=T,l(F),j(T),f(B);const O=H.findIndex(K=>!je(F,K.id));p(O>=0?O:0),d.current=!1}i("eval")}},[y]),Ds=c.useCallback(()=>{const E=Ne(),F=we();x.current=E,S.current=F,D(null),l(E),j(F),f({}),p(0),d.current=!1,g(!1),i("eval")},[]),_s=c.useCallback(async()=>{const{juryName:E,juryDept:F}=R.current,T=n.current;let B=Ne(),O=we();try{const K=await rs();if(K!=null&&K.length){const oe=$e(K);B=oe.scores,O=oe.comments}}catch{}T&&me({action:"resetJuror"}),x.current=B,S.current=O,l(B),j(O),P(B),w(O),g(!0),d.current=!1,f(Object.fromEntries(H.map(K=>[K.id,!0]))),i("eval"),setTimeout(()=>{T&&me({rows:H.map(K=>ve(E,F,T,B,O,K,"group_submitted"))})},is)},[]),$s=c.useCallback(async()=>{const{juryName:E,juryDept:F}=R.current;if(!E.trim()||!F.trim())return;const T=ss(E,F);if(n.current=T,D({loading:!0}),Ae()){await pe();return}try{const B=await tt(T);if(B.status!=="ok"){D(null),_("Could not reach the server. Please try again."),A("entering"),i("pin");return}if(B.exists)D(null),A("entering"),_(""),J(3),i("pin");else{const O=await nt(T,E,F);O.status==="ok"?(D(null),ts(O.token),U(O.pin),A("new"),i("pin")):(D(null),_("Could not create a PIN. Please try again."),A("entering"),i("pin"))}}catch{D(null),_("Connection error. Please check your network and try again."),A("entering"),i("pin")}},[pe]),Ts=c.useCallback(async E=>{const F=n.current;D({loading:!0});try{const T=await rt(F,E);if(T.locked){D(null),A("locked"),_("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(T.valid){ts(T.token||""),A("idle"),_(""),await pe();return}D(null);const B=typeof T.attemptsLeft=="number"?T.attemptsLeft:V-1;J(B),B<=0?(A("locked"),_("Too many failed attempts. Please contact the admin.")):_(`Incorrect PIN. ${B} attempt${B!==1?"s":""} remaining.`)}catch{D(null),_("Could not verify PIN. Please try again.")}},[V,pe]),Rs=c.useCallback(async()=>{await pe()},[pe]),Bs=c.useCallback(()=>{const E=Ne(),F=we();x.current=E,S.current=F,t(""),a(""),i("info"),p(0),l(E),j(F),N(os()),f({}),D(null),g(!1),P(null),w(null),I("idle"),A("idle"),_(""),U(""),J(3),d.current=!1,n.current="",ns()},[]),Ws=H[m],zs=H.length*Y.length,Os=Math.round(bs(u)/zs*100),Gs=ls(u);return{juryName:s,setJuryName:t,juryDept:r,setJuryDept:a,jurorId:n.current,step:o,setStep:i,current:m,handleNavigate:z,scores:u,comments:h,touched:M,handleScore:q,handleScoreBlur:ne,handleCommentChange:ae,handleCommentBlur:xe,project:Ws,progressPct:Os,allComplete:Gs,groupSynced:v,editMode:C,doneScores:k,doneComments:$,sheetProgress:y,saveStatus:L,pinStep:b,pinError:G,newPin:ee,attemptsLeft:V,handlePinSubmit:Ts,handlePinAcknowledge:Rs,sessionKicked:re,kickedMsg:de,handleKickedAcknowledge:Le,handleStart:$s,handleConfirmFromSheet:Fs,handleStartFresh:Ds,handleResubmit:_s,handleEditScores:X,handleFinalSubmit:ie,resetAll:Bs}}function De(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function lt(){return e.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]})}function cs(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function ys(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}function ks(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"9"}),e.jsx("path",{d:"M12 8v4"}),e.jsx("path",{d:"M12 16h.01"})]})}function ct(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7-10-7-10-7z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function dt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3l18 18"}),e.jsx("path",{d:"M10.6 10.6a3 3 0 0 0 4.2 4.2"}),e.jsx("path",{d:"M9.6 5.5A10.8 10.8 0 0 1 12 5c6.5 0 10 7 10 7a17.2 17.2 0 0 1-3.3 4.4"}),e.jsx("path",{d:"M6.3 6.3C3.4 8.1 2 12 2 12s3.5 7 10 7a11 11 0 0 0 4.7-1"})]})}function Ns(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18 21a8 8 0 0 0-16 0"}),e.jsx("circle",{cx:"10",cy:"8",r:"5"}),e.jsx("path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3"})]})}function ws(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m16 11 2 2 4-4"}),e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"})]})}function Ss(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"}),e.jsx("path",{d:"M8 10v4"}),e.jsx("path",{d:"M12 10v2"}),e.jsx("path",{d:"M16 10v6"})]})}function ut(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function mt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function ht(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3.85 8.62a4 4 0 1 1 7.29-5.17"}),e.jsx("path",{d:"M3.85 15.38a4 4 0 1 0 7.29 5.17"}),e.jsx("path",{d:"M20.15 8.62a4 4 0 1 0-7.29-5.17"}),e.jsx("path",{d:"M20.15 15.38a4 4 0 1 1-7.29 5.17"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function We(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function Ue(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]})}function Ce(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 2h14"}),e.jsx("path",{d:"M5 22h14"}),e.jsx("path",{d:"M7 2c0 6 10 6 10 10s-10 4-10 10"}),e.jsx("path",{d:"M17 2c0 6-10 6-10 10s10 4 10 10"})]})}function Ie(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7 21H3v-4L17 3z"}),e.jsx("path",{d:"m15 5 4 4"})]})}function xt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 6 2 2 4-4"}),e.jsx("path",{d:"m3 12 2 2 4-4"}),e.jsx("path",{d:"m3 18 2 2 4-4"}),e.jsx("path",{d:"M11 6h10"}),e.jsx("path",{d:"M11 12h10"}),e.jsx("path",{d:"M11 18h10"})]})}function he(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 3H2l8 9v7l4 2v-9l8-9z"})})}function Cs(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 3v12"}),e.jsx("path",{d:"m7 10 5 5 5-5"}),e.jsx("path",{d:"M5 21h14"})]})}function ze(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]})}function Oe(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m5 12 7-7 7 7"}),e.jsx("path",{d:"M12 19V5"})]})}function Ge(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"m19 12-7 7-7-7"})]})}function Ve(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}function ds(){return e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"9"})})}function pt(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"}),e.jsx("path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"}),e.jsx("path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18"}),e.jsx("path",{d:"M4 22h16"}),e.jsx("path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"}),e.jsx("path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6"})]})}function Ls(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"M7 14l4-4 3 3 5-6"})]})}function Ye(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"2",width:"6",height:"4",rx:"1"}),e.jsx("path",{d:"M9 4H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2"})]})}function jt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]})}function ft(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 10v6"}),e.jsx("path",{d:"M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})}function gt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7"}),e.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function Qe(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 6l12 12M18 6l-12 12"})})}function Pe(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M5 12l4 4 10-10"})})}function vt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 2v6h-6"}),e.jsx("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),e.jsx("path",{d:"M3 22v-6h6"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]})}function bt(){return e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})}function yt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function Ms(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function Es(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function kt({juryName:s,setJuryName:t,juryDept:r,setJuryDept:a,onStart:n,onBack:o}){const i=s.trim().length>0&&r.trim().length>0;return e.jsxs("div",{className:"form-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:o,"aria-label":"Back to home",children:e.jsx(De,{})}),e.jsxs("div",{className:"form-title-wrap",children:[e.jsx("div",{className:"form-title-row",children:e.jsx("h2",{children:"Evaluation Form"})}),e.jsx("p",{children:"EE 492 â€” Senior Project Poster Day"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:"Jury Member Information"}),e.jsxs("div",{className:"identity-warning",children:[e.jsx("span",{className:"warning-icon","aria-hidden":"true",children:e.jsx(ks,{})}),e.jsx("span",{children:"Please enter your name and department carefully. Once you begin the evaluation, these cannot be changed."})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:s,onChange:m=>t(m.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department / Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:m=>a(m.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:m=>{m.key==="Enter"&&i&&n()}})]}),e.jsx("p",{className:"draft-device-note",children:"â„¹ï¸ Scores save automatically as you fill each field or switch groups. Next, weâ€™ll authenticate your session and ask for your PIN so you can continue from any device."}),e.jsxs("div",{className:"trust-note",children:[e.jsx(ys,{}),"Authenticating session before PIN verification"]}),e.jsx("button",{className:"btn-primary",disabled:!i,onClick:n,children:"Start Evaluation â†’"})]})]})}function Nt({onSubmit:s,pinError:t}){const[r,a]=c.useState(["","","",""]),n=[c.useRef(null),c.useRef(null),c.useRef(null),c.useRef(null)];c.useEffect(()=>{t&&(a(["","","",""]),setTimeout(()=>{var l;return(l=n[0].current)==null?void 0:l.focus()},50))},[t]);function o(l,h){var N;const j=h.replace(/\D/g,"").slice(-1),M=[...r];M[l]=j,a(M),j&&l<3&&((N=n[l+1].current)==null||N.focus())}function i(l,h){var j,M,N;if(h.key==="Backspace")if(r[l]===""&&l>0){const v=[...r];v[l-1]="",a(v),(j=n[l-1].current)==null||j.focus()}else{const v=[...r];v[l]="",a(v)}if(h.key==="ArrowLeft"&&l>0&&((M=n[l-1].current)==null||M.focus()),h.key==="ArrowRight"&&l<3&&((N=n[l+1].current)==null||N.focus()),h.key==="Enter"){const v=r.join("");v.length===4&&s(v)}}function m(l){var j;const h=l.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(h.length===4){const M=h.split("");a(M),(j=n[3].current)==null||j.focus()}l.preventDefault()}function p(){const l=r.join("");l.length===4&&s(l)}const u=r.every(l=>l!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((l,h)=>e.jsx("input",{ref:n[h],type:"password",inputMode:"numeric",maxLength:1,value:l,autoFocus:h===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:j=>o(h,j.target.value),onKeyDown:j=>i(h,j),onPaste:h===0?m:void 0,className:"pin-box"},h))}),e.jsx("button",{className:"btn-primary pin-ok-btn",onClick:p,disabled:!u,children:"OK â†’"})]})}function wt({pinStep:s,pinError:t,newPin:r,attemptsLeft:a,juryName:n,onPinSubmit:o,onPinAcknowledge:i}){return s==="new"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(cs,{})}),e.jsx("h3",{children:"Your Access PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome, ",e.jsx("strong",{children:n}),"! A 4-digit PIN has been assigned to protect your evaluations. Please save it â€” you will need it every time you log in from a new device or browser tab."]}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((m,p)=>e.jsx("span",{className:"pin-digit",children:m},p))}),e.jsx("p",{className:"pin-hint",children:"ðŸ”’ Keep this PIN private. If you lose it, contact the admin to reset it."}),e.jsx("button",{className:"btn-primary",onClick:i,children:"I've saved my PIN â€” Continue â†’"})]})}):s==="locked"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap lock-icon",children:"ðŸ”’"}),e.jsx("h3",{children:"Account Locked"}),e.jsx("p",{className:"pin-error-msg",children:t})]})}):e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(cs,{})}),e.jsx("h3",{children:"Enter Your PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome back, ",e.jsx("strong",{children:n}),". Enter your 4-digit PIN and press OK to continue."]}),e.jsx(Nt,{onSubmit:o,pinError:t}),t&&e.jsx("div",{className:"pin-error-msg",children:t})]})})}function St(s){return s===0?"#e2e8f0":s<34?"linear-gradient(90deg,#ef4444,#f97316)":s<67?"linear-gradient(90deg,#f97316,#eab308)":s<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function Ct({saveStatus:s}){return s==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"â³ Savingâ€¦"}):s==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"âœ“ Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"â— Auto-saving"})}function Lt({juryName:s,juryDept:t,current:r,onNavigate:a,scores:n,comments:o,touched:i,groupSynced:m,editMode:p,progressPct:u,allComplete:l,saveStatus:h,handleScore:j,handleScoreBlur:M,handleCommentChange:N,handleCommentBlur:v,handleFinalSubmit:f,onGoHome:C}){var I;const[g,k]=c.useState(!1),[P,$]=c.useState(null),w=H[r],y=(b,A)=>{const G=Y.filter(ee=>{var U;return((U=n[b.id])==null?void 0:U[ee.id])!==""}).length;return`${je(n,b.id)?"âœ…":"âš ï¸"} ${b.name} (${G}/${Y.length})`},D=()=>{r>0&&a(r-1)},L=()=>{r<H.length-1&&a(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"ðŸ‘¤"}),e.jsxs("span",{className:"eval-identity-text",children:[s,t&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",t,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(Ct,{saveStatus:h})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>k(!0),"aria-label":"Home",children:e.jsx(De,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:w.name}),e.jsx("span",{className:"eval-project-name",children:w.desc})]}),((I=w.students)==null?void 0:I.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["ðŸ‘¥ ",w.students.join(" Â· ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:D,disabled:r===0,"aria-label":"Previous group",children:e.jsx(yt,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:b=>a(Number(b.target.value)),children:H.map((b,A)=>e.jsx("option",{value:A,children:y(b)},b.id))}),e.jsx("button",{className:"group-nav-btn",onClick:L,disabled:r===H.length-1,"aria-label":"Next group",children:e.jsx(Ms,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${u}%`,background:St(u)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(u),"%"]})]})})]}),g&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>k(!1),children:e.jsxs("div",{className:"back-menu",onClick:b=>b.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{k(!1),C()},children:"ðŸ  Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>k(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[m[w.id]&&!p&&e.jsx("div",{className:"group-done-banner",children:"âœ… All scores saved for this group."}),p&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["âœï¸ Edit mode â€” adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),Y.map(b=>{var ee,U;const A=((ee=n[w.id])==null?void 0:ee[b.id])??"",G=((U=i[w.id])==null?void 0:U[b.id])&&A==="",_=(parseInt(A,10)||0)/b.max*100;return e.jsxs("div",{className:`crit-card${G?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:b.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",b.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>$(P===b.id?null:b.id),children:P===b.id?"Hide Rubric â–²":"Show Rubric â–¼"})]}),P===b.id&&e.jsx("div",{className:"rubric-table",children:b.rubric.map(V=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:V.range}),e.jsx("div",{className:"rubric-level",children:V.level}),e.jsx("div",{className:"rubric-desc",children:V.desc})]},V.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:b.max,value:A,onChange:V=>j(w.id,b.id,V.target.value),onBlur:()=>M(w.id,b.id),placeholder:"â€”",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${_}%`}})}),e.jsx("span",{className:"score-pct",children:A!==""?`${A} / ${b.max}`:`â€” / ${b.max}`})]}),G&&e.jsx("div",{className:"required-hint",children:"Required"})]},b.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:o[w.id]||"",onChange:b=>N(w.id,b.target.value),onBlur:()=>v(w.id),placeholder:"Any additional feedback about this groupâ€¦",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const b=Y.reduce((A,G)=>{var _;return A+(parseInt((_=n[w.id])==null?void 0:_[G.id],10)||0)},0);return e.jsxs("span",{className:`total-score${b>=80?" high":b>=60?" mid":""}`,children:[b," / 100"]})})()]}),p&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:l?1:.65},onClick:f,children:l?"âœ… Submit Final":`âš ï¸ Submit Final (${bs(n)} / ${H.length*Y.length} filled)`})]})]})}function Mt(s,t){return Y.reduce((r,a)=>{var n;return r+(parseInt((n=s[t])==null?void 0:n[a.id],10)||0)},0)}function Et({doneScores:s,scores:t,onEditScores:r,onBack:a}){const n=s||t,[o,i]=c.useState(new Set);function m(p){i(u=>{const l=new Set(u);return l.has(p)?l.delete(p):l.add(p),l})}return e.jsx("div",{className:"done-screen",children:e.jsxs("div",{className:"done-card",children:[e.jsx("div",{className:"done-icon",children:"ðŸŽ‰"}),e.jsx("h2",{children:"Thank You!"}),e.jsx("p",{className:"done-subtitle",children:"Your evaluations have been recordedâ€”thank you for your feedback."}),e.jsx("div",{className:"done-summary",children:H.map(p=>{var j,M;const u=o.has(p.id),l=`done-group-panel-${p.id}`,h=!!p.desc||((j=p.students)==null?void 0:j.length)>0;return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:h?0:-1,"aria-expanded":u,"aria-controls":l,onClick:()=>{h&&m(p.id)},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&h&&(N.preventDefault(),m(p.id))},style:{cursor:h?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:p.name}),h&&e.jsx("span",{className:`group-accordion-chevron${u?" open":""}`,children:e.jsx(Es,{})})]})}),e.jsx("div",{className:"done-row-right",children:e.jsxs("span",{className:"done-score",children:[e.jsx("span",{className:"done-score-main",children:Mt(n,p.id)}),e.jsx("span",{className:"done-score-max",children:" / 100"})]})})]}),e.jsx("div",{id:l,className:`group-accordion-panel${u?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[p.desc&&e.jsx("span",{className:"done-row-desc",children:p.desc}),((M=p.students)==null?void 0:M.length)>0&&e.jsxs("span",{className:"done-row-students",children:["ðŸ‘¥ ",p.students.join(" Â· ")]})]})})]},p.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:r,children:"âœï¸ Edit Scores"}),e.jsxs("button",{className:"btn-primary",onClick:a,children:[e.jsx(De,{})," Back to Home"]})]})]})})}function At(s){return s==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:s==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:s==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"â€”",color:"#64748b",bg:"#f1f5f9"}}function Ee({progress:s,onConfirm:t,onFresh:r}){if(!s)return null;if(s.loading)return e.jsx("div",{className:"spd-overlay",children:e.jsx("div",{className:"spd-card",children:e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon spd-icon-animated","aria-hidden":"true",children:e.jsx(Ce,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:"Authenticating your sessionâ€¦"}),e.jsx("div",{className:"spd-sub",children:"Connecting to server"})]})]})})});const{rows:a,filledCount:n,totalCount:o,allSubmitted:i}=s,m=a&&a.length>0;return e.jsx("div",{className:"spd-overlay",children:e.jsxs("div",{className:"spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon spd-icon-state","aria-hidden":"true",children:i?e.jsx(ht,{}):m?e.jsx(lt,{}):e.jsx(Ye,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:i?"All evaluations submitted":m?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[n," / ",o," groups completed on server"]})]})]}),m&&e.jsx("div",{className:"spd-list",children:H.map(p=>{const u=a.find(j=>Number(j.projectId)===p.id),l=At(u==null?void 0:u.status),h=(u==null?void 0:u.total)??"â€”";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:p.name}),e.jsx("span",{className:"spd-row-total",children:h!=="â€”"?`${h}/100`:"â€”"}),e.jsx("span",{className:"spd-chip",style:{color:l.color,background:l.bg},children:l.label})]},p.id)})}),!m&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"btn-primary",onClick:t,children:i?"View / Edit My Scores":m?"Continue from here":"Start Evaluation"}),m&&!i&&e.jsx("button",{className:"btn-secondary",onClick:r,children:"Start Fresh"})]})]})})}function It({onBack:s}){const{step:t,juryName:r,setJuryName:a,juryDept:n,setJuryDept:o,current:i,handleNavigate:m,scores:p,comments:u,touched:l,groupSynced:h,editMode:j,progressPct:M,allComplete:N,doneScores:v,doneComments:f,sheetProgress:C,saveStatus:g,pinStep:k,pinError:P,newPin:$,attemptsLeft:w,handleScore:y,handleScoreBlur:D,handleCommentChange:L,handleCommentBlur:I,handleStart:b,handleConfirmFromSheet:A,handleStartFresh:G,handleResubmit:_,handleEditScores:ee,handleFinalSubmit:U,handlePinSubmit:V,handlePinAcknowledge:J,sessionKicked:re,kickedMsg:te,handleKickedAcknowledge:de,resetAll:Q}=ot();return re?e.jsx("div",{className:"kicked-overlay",children:e.jsxs("div",{className:"kicked-card",children:[e.jsx("div",{className:"kicked-icon",children:"ðŸ”"}),e.jsx("div",{className:"kicked-title",children:"Session Ended"}),e.jsx("div",{className:"kicked-body",children:te}),e.jsx("button",{className:"btn-primary",onClick:de,children:"Sign in again"})]})}):t==="done"?e.jsxs(e.Fragment,{children:[e.jsx(Et,{doneScores:v,doneComments:f,scores:p,comments:u,onEditScores:ee,onBack:()=>{Q(),s()}}),e.jsx(Ee,{progress:C,onConfirm:A,onFresh:G})]}):t==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(wt,{pinStep:k,pinError:P,newPin:$,attemptsLeft:w,juryName:r,onPinSubmit:V,onPinAcknowledge:J}),e.jsx(Ee,{progress:C,onConfirm:A,onFresh:G})]}):t==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{juryName:r,juryDept:n,current:i,onNavigate:m,scores:p,comments:u,touched:l,groupSynced:h,editMode:j,progressPct:M,allComplete:N,saveStatus:g,handleScore:y,handleScoreBlur:D,handleCommentChange:L,handleCommentBlur:I,handleFinalSubmit:U,onGoHome:s}),e.jsx(Ee,{progress:C,onConfirm:A,onFresh:G})]}):e.jsxs(e.Fragment,{children:[e.jsx(kt,{juryName:r,setJuryName:a,juryDept:n,setJuryDept:o,onStart:b,onBack:s}),e.jsx(Ee,{progress:C,onConfirm:A,onFresh:G})]})}const Pt="modulepreload",Ft=function(s){return"/senior-design-jury/"+s},us={},Dt=function(t,r,a){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=Ft(o),o in us)return;us[o]=!0;const i=o.endsWith(".css"),m=i?'[rel="stylesheet"]':"";if(!!a)for(let l=n.length-1;l>=0;l--){const h=n[l];if(h.href===o&&(!i||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${m}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":Pt,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((l,h)=>{u.addEventListener("load",l),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})},_t=new Map(H.map((s,t)=>typeof s=="string"?[t+1,{desc:"",students:[]}]:[s.id??t+1,{desc:s.desc??"",students:s.students??[]}]));function $t(s){const t=Number(String(s??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(t)?t:0}function _e(s){if(!s)return 0;const t=String(s).trim().replace(/\s*,\s*/g,", "),r=Date.parse(t);if(Number.isFinite(r))return r;const a=t.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(a)return new Date(+a[3],+a[2]-1,+a[1],+a[4],+a[5],+(a[6]||0)).getTime()||0;const n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let o=+(n[4]||0);const i=(n[7]||"").toUpperCase();return i==="PM"&&o<12&&(o+=12),i==="AM"&&o===12&&(o=0),new Date(+n[3],+n[1]-1,+n[2],o,+(n[5]||0),+(n[6]||0)).getTime()||0}function Ke(s){if(!s)return"â€”";const t=_e(s);if(!t)return String(s);const r=new Date(t),a=n=>String(n).padStart(2,"0");return`${a(r.getDate())}/${a(r.getMonth()+1)}/${r.getFullYear()} ${a(r.getHours())}:${a(r.getMinutes())}`}function le(s,t){const r=Number(s),a=Number(t);return Number.isFinite(r)&&Number.isFinite(a)?r-a:String(s??"").toLowerCase()<String(t??"").toLowerCase()?-1:1}function As(s){let t=2166136261;for(let r=0;r<s.length;r++)t^=s.charCodeAt(r),t=Math.imul(t,16777619);return t>>>0}function Is(s,t,r){t/=100,r/=100;const a=i=>(i+s/30)%12,n=t*Math.min(r,1-r),o=i=>Math.round(255*(r-n*Math.max(-1,Math.min(a(i)-3,Math.min(9-a(i),1))))).toString(16).padStart(2,"0");return`#${o(0)}${o(8)}${o(4)}`}const Tt=s=>Is(As(s||"?")%360,55,95),Rt=s=>Is(As(s||"?")%360,65,55);function be(s){return s===""||s===null||s===void 0||typeof s=="string"&&s.trim()===""||typeof s=="number"&&!Number.isFinite(s)?"":s}async function Bt(s){const t=await Dt(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],a=s.map(u=>{const l=_t.get(u.projectId)||{desc:"",students:[]};return[u.juryName??"",u.juryDept??"",u.timestamp??"",u.projectName??"",l.desc,l.students.join(" Â· "),be(u.technical),be(u.design),be(u.delivery),be(u.teamwork),be(u.total),u.comments??""]}),n=t.utils.aoa_to_sheet([r,...a]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(u=>({wch:u}));const o=t.utils.book_new();t.utils.book_append_sheet(o,n,"Jury Evaluations");const i=new Date,m=i.toISOString().slice(0,10),p=`${String(i.getHours()).padStart(2,"0")}-${String(i.getMinutes()).padStart(2,"0")}`;t.writeFile(o,`jury_export_${m}_${p}.xlsx`)}const Wt=s=>s.reduce((t,r)=>t+Y.filter(a=>r[a.id]>0).length,0),zt=s=>{const t=H.length*Y.length;return t===0?0:Math.round(Wt(s)/t*100)};function Ot(s){const t={all_submitted:3,group_submitted:2,in_progress:1},r=(s||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:_e(n==null?void 0:n.timestamp)})),a=new Map;for(const n of r){const o=String(n.juryName??"").trim().toLowerCase(),i=String(n.juryDept??"").trim().toLowerCase(),m=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!o||!m)continue;const p=`${o}__${i}__${m}`,u=a.get(p);if(!u){a.set(p,n);continue}if((n.tsMs||0)>(u.tsMs||0)){a.set(p,n);continue}(n.tsMs||0)===(u.tsMs||0)&&(t[n.status]||0)>(t[u.status]||0)&&a.set(p,n)}return[...a.values()].sort((n,o)=>(o.tsMs||0)-(n.tsMs||0))}function Se({status:s,editingFlag:t,variant:r,icon:a,children:n}){return r||a||n?e.jsxs("span",{className:`status-badge${r?` ${r}`:""}`,children:[a,n]}):t==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(Ie,{}),"Editing"]}):s==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Pe,{}),"Submitted"]}):s==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Pe,{}),"Submitted"]}):s==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(Ce,{}),"In Progress"]}):null}const Gt="/senior-design-jury/assets/1st-place-medal-cb397e4c.svg",Kt="/senior-design-jury/assets/2nd-place-medal-9ec5b4d1.svg",Ht="/senior-design-jury/assets/3rd-place-medal-7ad05fc8.svg",Jt=Y.map(s=>({id:s.id,label:s.label,shortLabel:s.shortLabel,max:s.max})),qt=[Gt,Kt,Ht];function Ut({ranked:s,submittedData:t}){const[r,a]=c.useState(new Set);function n(i){a(m=>{const p=new Set(m);return p.has(i)?p.delete(i):p.add(i),p})}if(t.length===0)return e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."});const o={accent:"#c89b2f",tint:"rgba(253, 248, 238, 0.92)"};return e.jsxs("div",{className:"summary-page",children:[e.jsxs("div",{className:"summary-note",children:[e.jsx(Ve,{}),"Rankings include only ",e.jsx("strong",{children:"completed"})," submissions."]}),e.jsx("div",{className:"rank-list",children:s.map((i,m)=>{var M,N;const p=i.id??m+1,u=`summary-${p}-${m}`,l=r.has(u),h=!!i.desc||((M=i.students)==null?void 0:M.length)>0,j=`summary-group-panel-${u}`;return e.jsxs("div",{className:`rank-card${m===0?" top-rank":""} rank-${m+1}`,style:m===0?{background:o.tint}:void 0,children:[m===0&&e.jsx("span",{className:"rank-accent",style:{background:o.accent},"aria-hidden":"true"}),e.jsx("div",{className:`rank-num${m<3?" top-rank":""}`,children:m<3?e.jsx("img",{className:"rank-medal",src:qt[m],alt:`${m+1} place medal`}):m+1}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"group-card-wrap",children:[e.jsxs("button",{className:"group-card-header group-accordion-header",tabIndex:h?0:-1,"aria-expanded":l,"aria-controls":j,type:"button",onClick:()=>{h&&n(u)},onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&h&&(v.preventDefault(),n(u))},style:{cursor:h?"pointer":"default"},children:[e.jsxs("div",{className:"group-card-title",children:[e.jsxs("span",{className:"group-card-name",children:["Group ",p]}),h&&e.jsx("span",{className:`group-accordion-chevron${l?" open":""}`,children:"â–¾"})]}),e.jsxs("div",{className:"group-card-score",children:[e.jsx("small",{className:"group-card-score-label",children:"AVERAGE"}),e.jsx("span",{className:"group-card-score-value",style:m===0?{color:o.accent}:void 0,children:i.totalAvg.toFixed(2)})]})]}),e.jsx("div",{id:j,className:`group-accordion-panel${l?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner group-card-accordion-inner",children:[i.desc&&e.jsxs("div",{className:"group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ss,{})}),e.jsx("span",{className:"group-card-desc-text",children:i.desc})]}),((N=i.students)==null?void 0:N.length)>0&&e.jsxs("div",{className:"group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(Ns,{})}),e.jsx("span",{className:"group-card-students-text",children:i.students.join(" Â· ")})]})]})}),e.jsxs("span",{className:"rank-eval-count",children:["(",i.count," evaluation",i.count!==1?"s":"",")"]})]}),e.jsx("div",{className:"rank-bars",children:Jt.map(v=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:v.shortLabel||v.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(i.avg[v.id]||0)/v.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(i.avg[v.id]||0).toFixed(2)})]},v.id))})]})]},i.id??`${i.name}-${m}`)})})]})}const Vt=["9.1","9.2","1.2","2","3.1","3.2","8.1","8.2"],se=Y.map(s=>({key:s.id,code:s.mudek.join("/"),label:s.shortLabel,max:s.max,color:s.color}));function Ps(s){if(s.length<2)return 0;const t=s.reduce((r,a)=>r+a,0)/s.length;return Math.sqrt(s.reduce((r,a)=>r+(a-t)**2,0)/s.length)}function Xe(s){return s.length?s.reduce((t,r)=>t+r,0)/s.length:0}function Te(s,t){if(!s.length)return 0;const r=(s.length-1)*t,a=Math.floor(r),n=r-a;return s[a+1]===void 0?s[a]:s[a]+n*(s[a+1]-s[a])}function Yt(s,t){return s.map(r=>Number(r[t])).filter(r=>Number.isFinite(r))}function ge({msg:s}){return e.jsx("div",{className:"chart-empty",children:s||"Not enough data yet."})}function Qt({codes:s}){return e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"mudek-table-code",children:"Code"}),e.jsx("th",{children:"Outcome (EN) â€” hover for Turkish"})]})}),e.jsx("tbody",{children:s.map(t=>{const r=et[t];return r?e.jsxs("tr",{title:r.tr,children:[e.jsx("td",{className:"mudek-table-code-cell",children:t}),e.jsx("td",{children:r.en})]},t):null})})]})}function Xt(){return e.jsx("div",{className:"mudek-rubric-list",children:Y.map(s=>{const t=Zs;return e.jsxs("div",{className:"mudek-rubric-criterion",children:[e.jsxs("div",{className:"mudek-rubric-criterion-title",children:[s.label,e.jsxs("span",{className:"mudek-rubric-criterion-meta",children:["(",s.mudek.join(", "),") Â· max ",s.max," pts"]})]}),e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Range"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"Descriptor"})]})}),e.jsx("tbody",{children:s.rubric.map(r=>{const a=t[r.level]||{};return e.jsxs("tr",{children:[e.jsx("td",{children:r.range}),e.jsx("td",{children:e.jsx("span",{className:"mudek-band-badge",style:{background:a.bg,color:a.text},children:r.level})}),e.jsx("td",{children:r.desc})]},r.level)})})]})]},s.id)})})}function Zt({outcomeCodes:s=Vt}){const[t,r]=c.useState(!1),[a,n]=c.useState("outcomes"),o=c.useRef(null),i=c.useRef(null);return c.useEffect(()=>{if(!t)return;function m(p){o.current&&!o.current.contains(p.target)&&r(!1)}return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[t]),c.useEffect(()=>{if(!t)return;function m(p){var u;p.key==="Escape"&&(r(!1),(u=i.current)==null||u.focus())}return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[t]),e.jsxs("div",{className:"mudek-badge-wrap",ref:o,children:[e.jsxs("button",{ref:i,className:"mudek-badge",onClick:()=>r(m=>!m),"aria-label":"MÃœDEK outcome mapping","aria-expanded":t,children:[e.jsx(ft,{}),e.jsx("span",{children:"MÃœDEK"}),e.jsx("span",{className:`mudek-chevron${t?" open":""}`,"aria-hidden":"true",children:e.jsx(Es,{})})]}),t&&e.jsxs("div",{className:"mudek-dropdown",role:"dialog","aria-label":"MÃœDEK outcome mapping",children:[e.jsxs("div",{className:"mudek-dropdown-header",children:[e.jsx("span",{children:"MÃœDEK Outcome Mapping"}),e.jsx("button",{className:"mudek-dropdown-close",onClick:()=>{var m;r(!1),(m=i.current)==null||m.focus()},"aria-label":"Close",children:"âœ•"})]}),e.jsxs("div",{className:"mudek-tabs",children:[e.jsx("button",{className:`mudek-tab-btn${a==="outcomes"?" active":""}`,onClick:()=>n("outcomes"),children:"MÃœDEK Outcomes"}),e.jsx("button",{className:`mudek-tab-btn${a==="rubric"?" active":""}`,onClick:()=>n("rubric"),children:"Rubric Bands"})]}),e.jsxs("div",{className:"mudek-dropdown-body",children:[a==="outcomes"&&e.jsx(Qt,{codes:s}),a==="rubric"&&e.jsx(Xt,{})]}),e.jsx("div",{className:"mudek-dropdown-footer",children:"â„¹ This chart provides evidence for the outcomes above."})]})]})}function en({data:s}){const t=s||[];if(!t.length)return e.jsx(ge,{});const r=se.map(f=>{const C=Yt(t,f.key),g=C.length?Xe(C):0,k=f.max>0?g/f.max*100:0,P=C.length>1?Ps(C)/f.max*100:0;return{...f,avgRaw:g,pct:k,sd:P,n:C.length}}),a=38,n=22,o=34,i=8,m=22,p=20,u=160,l=r.length,h=o+l*a+(l-1)*n+i,j=m+u+p,M=f=>o+f*(a+n),N=f=>M(f)+a/2,v=f=>m+u*(1-Math.max(0,Math.min(100,f))/100);return e.jsxs("div",{className:"chart-card chart-compact-equal chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Programme-Level Outcome Averages"}),e.jsx("div",{className:"chart-note",children:"Grand mean Â±1 SD normalized score per outcome across all groups and jurors."})]})}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${h} ${j}`,preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"100%",display:"block"},children:[[0,25,50,75,100].map(f=>{const C=v(f);return e.jsxs("g",{children:[e.jsx("line",{x1:o,y1:C,x2:h-i,y2:C,stroke:f===0?"#cbd5e1":"#e2e8f0",strokeWidth:f===0?1.2:1}),e.jsx("text",{className:"chart-y-tick",x:o-4,y:C+3.5,textAnchor:"end",fontSize:"7",fill:"#94a3b8",children:f})]},f)}),e.jsx("text",{className:"chart-y-label",x:"10",y:m+u/2,transform:`rotate(-90 10 ${m+u/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((f,C)=>{const g=M(C),k=N(C),P=v(f.pct),$=u-(P-m),w=v(f.pct+f.sd),y=v(Math.max(0,f.pct-f.sd));return e.jsxs("g",{children:[e.jsxs("title",{children:[f.label," (",f.code,")",`
`,"Grand mean: ",f.pct.toFixed(1),"%",`
`,"SD: Â±",f.sd.toFixed(1),"%",`
`,"N evaluations: ",f.n]}),e.jsx("rect",{x:g,y:m,width:a,height:u,rx:"3",fill:"#f1f5f9"}),$>0&&e.jsx("rect",{x:g,y:P,width:a,height:$,rx:"3",fill:f.color}),f.sd>0&&e.jsxs(e.Fragment,{children:[e.jsxs("g",{stroke:"#ffffff",strokeWidth:"3.2",strokeLinecap:"round",opacity:"0.65",children:[e.jsx("line",{x1:k,y1:w,x2:k,y2:y}),e.jsx("line",{x1:k-7,y1:w,x2:k+7,y2:w}),e.jsx("line",{x1:k-7,y1:y,x2:k+7,y2:y})]}),e.jsxs("g",{stroke:"#6b7280",strokeWidth:"1.2",strokeLinecap:"round",opacity:"0.75",children:[e.jsx("line",{x1:k,y1:w,x2:k,y2:y}),e.jsx("line",{x1:k-7,y1:w,x2:k+7,y2:w}),e.jsx("line",{x1:k-7,y1:y,x2:k+7,y2:y}),e.jsx("circle",{cx:k,cy:w,r:"1.6",fill:"#6b7280",stroke:"none"}),e.jsx("circle",{cx:k,cy:y,r:"1.6",fill:"#6b7280",stroke:"none"})]})]}),e.jsx("text",{className:"chart-bar-value",x:k,y:P+$/2+3,textAnchor:"middle",fontSize:"9",fill:"#ffffff",stroke:"rgba(15,23,42,0.35)",strokeWidth:"0.8",fontWeight:"700",style:{paintOrder:"stroke"},children:f.pct.toFixed(1)}),e.jsx("text",{className:"chart-x-label",x:k,y:m+u+13,textAnchor:"middle",fontSize:"8.5",fill:"#374151",fontWeight:"500",children:f.label})]},f.key)})]})})]})}function sn({stats:s}){const t=s.filter(h=>h.count>0);if(!t.length)return e.jsx(ge,{});const r=14,a=4,n=se.length*(r+a)+12,o=8,i=130,m=28,p=t.length*n+m+10,u=i+o,l=o+(i-es/100*i);return e.jsxs("div",{className:"chart-card chart-compact-equal",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Outcome Achievement by Group"}),e.jsx("div",{className:"chart-note",children:"Compares each group's normalized score across all four MÃœDEK-mapped criteria."})]})}),e.jsx("div",{className:"chart-svg-wrap",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${p} ${u+36}`,style:{width:"100%",height:"auto",display:"block"},children:[e.jsx("text",{x:"10",y:o+i/2,transform:`rotate(-90 10 ${o+i/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),[0,25,50,75,100].map(h=>{const j=o+(i-h/100*i);return e.jsxs("g",{children:[e.jsx("line",{x1:m,y1:j,x2:p,y2:j,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:m-4,y:j+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:h})]},h)}),e.jsx("g",{children:e.jsx("line",{x1:m,y1:l,x2:p,y2:l,stroke:"#6B7280",strokeWidth:"1",strokeDasharray:"3,3"})}),t.map((h,j)=>{const M=m+j*n+4;return e.jsxs("g",{children:[se.map((N,v)=>{const f=(h.avg[N.key]||0)/N.max*100,C=f/100*i,g=M+v*(r+a);return e.jsxs("g",{children:[e.jsxs("title",{children:[h.name," Â· ",N.label,": ",f.toFixed(1),"%"]}),e.jsx("rect",{x:g,y:o+(i-C),width:r,height:C,fill:N.color,rx:"2",opacity:"0.85"})]},N.key)}),e.jsx("text",{x:M+se.length*(r+a)/2-a/2,y:o+i+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:h.name})]},h.id)})]})}),e.jsxs("div",{className:"chart-legend",children:[se.map(h=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:h.color}}),h.label]},h.key)),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-line","aria-hidden":"true"}),"Reference (",es,"%)"]})]})]})}function tn({stats:s}){var C;const t=s.filter(g=>g.count>0),[r,a]=c.useState(((C=t[0])==null?void 0:C.id)??null);if(!t.length)return e.jsx(ge,{});const n=t.find(g=>g.id===(r??t[0].id))??t[0],o=se.length,i=130,m=120,p=82,u=g=>Math.PI*2*g/o-Math.PI/2,l=(g,k)=>({x:i+k*Math.cos(u(g)),y:m+k*Math.sin(u(g))}),h=se.map(g=>(n.avg[g.key]||0)/g.max*100),j=se.map(g=>{const k=t.map(P=>(P.avg[g.key]||0)/g.max*100);return Xe(k)}),M=h.map((g,k)=>l(k,g/100*p)),N=j.map((g,k)=>l(k,g/100*p)),v=M.map((g,k)=>`${k===0?"M":"L"}${g.x.toFixed(1)},${g.y.toFixed(1)}`).join(" ")+" Z",f=N.map((g,k)=>`${k===0?"M":"L"}${g.x.toFixed(1)},${g.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Competency Profile per Group"}),e.jsx("div",{className:"chart-note",children:"Shows whether a group's competency development is balanced or skewed across all four outcomes."})]})}),t.length>1&&e.jsx("select",{className:"radar-group-select",value:r??t[0].id,onChange:g=>a(Number(g.target.value)),children:t.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:"0 0 260 240",preserveAspectRatio:"xMidYMid meet",style:{width:"100%",maxWidth:280,height:"100%",display:"block"},children:[[.25,.5,.75,1].map(g=>{const P=se.map(($,w)=>l(w,g*p)).map(($,w)=>`${w===0?"M":"L"}${$.x.toFixed(1)},${$.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:P,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},g)}),[.25,.5,.75,1].map(g=>{const k=l(0,g*p);return e.jsxs("text",{x:k.x.toFixed(1),y:(k.y-6).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:[Math.round(g*100),"%"]},`tick-${g}`)}),se.map((g,k)=>{const P=l(k,p);return e.jsx("line",{x1:i,y1:m,x2:P.x.toFixed(1),y2:P.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},k)}),e.jsx("path",{d:f,fill:"none",stroke:"#9CA3AF",strokeWidth:"1.5",strokeDasharray:"4,3"}),e.jsx("path",{d:v,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.2",strokeLinejoin:"round"}),M.map((g,k)=>e.jsxs("g",{children:[e.jsxs("title",{children:[se[k].label,": ",h[k].toFixed(1),"%",`
`,"Cohort avg: ",j[k].toFixed(1),"%"]}),e.jsx("circle",{cx:g.x.toFixed(1),cy:g.y.toFixed(1),r:"3.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.2"})]},k)),se.map((g,k)=>{const P=l(k,p+16);return e.jsx("text",{x:P.x.toFixed(1),y:P.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"9",fill:"#334155",fontWeight:"700",children:g.label},g.key)})]})}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#3b82f6"}}),n.name]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#9CA3AF"}}),"Cohort Average (dashed)"]})]})]})}function nn({data:s}){const t=s||[];if(!t.length)return e.jsx(ge,{});const r=se.map(y=>{const D=t.map(J=>Number(J[y.key])).filter(J=>Number.isFinite(J)&&J>0).map(J=>J/y.max*100).sort((J,re)=>J-re);if(!D.length)return{...y,empty:!0};const L=Te(D,.25),I=Te(D,.5),b=Te(D,.75),A=b-L,G=L-1.5*A,_=b+1.5*A,ee=D.find(J=>J>=G)??D[0],U=[...D].reverse().find(J=>J<=_)??D[D.length-1],V=D.filter(J=>J<G||J>_);return{...y,q1:L,med:I,q3:b,whiskerMin:ee,whiskerMax:U,outliers:V}}),a=320,n=36,o=10,i=6,m=160,p=m+i+20,u=(a-n-o)/r.length,l=18,h=r.flatMap(y=>y.empty?[]:[y.whiskerMin,y.whiskerMax,...y.outliers]),j=h.length?Math.min(...h):0,M=h.length?Math.max(...h):100,N=Math.max(5,M-j),v=Math.min(10,N*.12),f=Math.max(0,j-v),C=Math.min(100,M+v),g=y=>i+(m-(y-f)/Math.max(1,C-f)*m),k=N<=10?2:N<=20?5:N<=40?10:N<=70?20:25,P=Math.ceil(f/k)*k,$=Math.floor(C/k)*k,w=[];for(let y=P;y<=$;y+=k)w.push(y);return w.length<2&&(w.length=0,w.push(Math.round(f),Math.round((f+C)/2),Math.round(C))),e.jsxs("div",{className:"chart-card chart-equal-bottom",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Score Distribution by Criterion"}),e.jsx("div",{className:"chart-note",children:"Reveals inter-juror spread for each criterion â€” evidence of measurement reliability."})]})}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${a} ${p}`,style:{width:"100%",height:"100%",display:"block"},children:[w.map(y=>{const D=g(y);return e.jsxs("g",{children:[e.jsx("line",{x1:n,y1:D,x2:a-o,y2:D,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:n-4,y:D+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:Math.round(y)})]},y)}),e.jsx("line",{x1:n,y1:i,x2:n,y2:i+m,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:"10",y:i+m/2,transform:`rotate(-90 10 ${i+m/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((y,D)=>{const L=n+D*u+u/2;if(y.empty)return e.jsx("text",{x:L,y:i+m+16,fontSize:"9",textAnchor:"middle",fill:"#94a3b8",children:y.label},y.key);const I=g(y.q1),b=g(y.q3),A=g(y.med);return e.jsxs("g",{children:[e.jsx("rect",{x:L-l/2,y:b,width:l,height:Math.max(2,I-b),fill:"rgba(59,130,246,0.18)",stroke:y.color,strokeWidth:"1.6"}),e.jsx("line",{x1:L-l/2,y1:A,x2:L+l/2,y2:A,stroke:y.color,strokeWidth:"2.2"}),e.jsx("text",{x:L,y:i+m+16,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:y.label})]},y.key)})]})}),e.jsxs("div",{className:"chart-legend boxplot-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-box"}),"IQR band (Q1â€“Q3)"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-median"}),"Median"]})]})]})}function rn({stats:s,data:t}){const r=s.filter(j=>j.count>0),a=t||[];if(!r.length||!a.length)return e.jsx(ge,{});const n=se.map(j=>r.map(M=>{const N=a.filter(C=>C.projectId===M.id).map(C=>Number(C[j.key])).filter(C=>Number.isFinite(C));if(N.length<2)return{cv:null,m:null,sd:null,n:N.length};const v=Xe(N);if(!v)return{cv:null,m:v,sd:null,n:N.length};const f=Ps(N);return{cv:f/v*100,m:v,sd:f,n:N.length}})),o=j=>j===null?{fill:"#f1f5f9",text:"#94a3b8"}:j<10?{fill:"#dcfce7",text:"#166534"}:j<15?{fill:"#bbf7d0",text:"#166534"}:j<25?{fill:"#fef08a",text:"#92400e"}:{fill:"#fecaca",text:"#991b1b"},i=100,m=26,p=96,u=48,l=i+r.length*p,h=m+se.length*u+10;return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Juror Consistency Heatmap"}),e.jsx("div",{className:"chart-note",children:"Identifies which group Ã— criterion combinations have poor juror agreement, guiding rubric improvement."})]})}),e.jsxs("div",{className:"cv-formula-block",children:[e.jsx("span",{className:"cv-formula-pill","aria-label":"CV equals sigma divided by x bar times 100",children:e.jsx("math",{xmlns:"http://www.w3.org/1998/Math/MathML",className:"cv-formula-math",children:e.jsxs("mrow",{children:[e.jsx("mi",{children:"CV"}),e.jsx("mo",{children:"="}),e.jsxs("mrow",{children:[e.jsx("mo",{children:"("}),e.jsxs("mfrac",{children:[e.jsx("mi",{children:"Ïƒ"}),e.jsx("mi",{children:"Î¼"})]}),e.jsx("mo",{children:")"})]}),e.jsx("mo",{children:"Ã—"}),e.jsx("mn",{children:"100"})]})})}),e.jsx("span",{className:"cv-formula-legend",children:"Ïƒ = std. deviation Â Â·Â  Î¼ = mean score Â Â·Â  CV = juror disagreement %"})]}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${l} ${h}`,style:{width:"100%",maxWidth:l,height:"100%",display:"block"},children:[r.map((j,M)=>e.jsx("text",{x:i+M*p+p/2,y:16,textAnchor:"middle",fontSize:"11",fill:"#475569",fontWeight:"600",children:j.name},j.id)),se.map((j,M)=>e.jsxs("g",{children:[e.jsx("text",{x:i-10,y:m+M*u+u/2+6,textAnchor:"end",fontSize:"12",fill:"#475569",fontWeight:"600",children:j.label}),r.map((N,v)=>{const f=n[M][v],C=f.cv,g=i+v*p,k=m+M*u,P=o(C),$=[`${N.name} Â· ${j.label}`,`CV: ${C===null?"N/A":Math.round(C)+"%"}`,f.m!==null?`Mean: ${(f.m/j.max*100).toFixed(1)}%`:"",f.sd!==null?`SD: ${f.sd.toFixed(2)}`:"",`N jurors: ${f.n}`].filter(Boolean).join(`
`);return e.jsxs("g",{children:[e.jsx("title",{children:$}),e.jsx("rect",{x:g+3,y:k+3,width:p-6,height:u-6,rx:"12",fill:P.fill,stroke:"rgba(148,163,184,0.25)"}),e.jsx("text",{x:g+p/2,y:k+u/2+6,textAnchor:"middle",fontSize:"12",fill:P.text,fontWeight:"700",children:C===null?"N/A":`${Math.round(C)}%`})]},`${j.key}-${N.id}`)})]},j.key))]})}),e.jsxs("div",{className:"heatmap-legend",children:[e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#dcfce7",borderColor:"#bbf7d0"}}),"<10% CV (excellent)"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#bbf7d0",borderColor:"#86efac"}}),"10â€“15% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fef08a",borderColor:"#fde047"}}),"15â€“25% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fecaca",borderColor:"#fca5a5"}}),">25% CV (poor)"]})]})]})}function an({data:s}){const t=s||[];if(!t.length)return e.jsx(ge,{});const r=[{key:"insufficient",label:"Insufficient",color:"#ef4444"},{key:"developing",label:"Developing",color:"#f59e0b"},{key:"good",label:"Good",color:"#a3e635"},{key:"excellent",label:"Excellent",color:"#22c55e"}],a=(f,C)=>{if(!Number.isFinite(f))return null;for(const g of C)if(f>=g.min&&f<=g.max)return g.level.toLowerCase();return null},n=se.map(f=>{const C=Y.find(w=>w.id===f.key),g=t.map(w=>Number(w[f.key])).filter(w=>Number.isFinite(w)),k={excellent:0,good:0,developing:0,insufficient:0};g.forEach(w=>{const y=a(w,C.rubric);y&&(k[y]+=1)});const P=g.length||1,$=r.map(w=>({...w,pct:k[w.key]/P*100,count:k[w.key]}));return{...f,pct:$,total:g.length}}),o=r.map(f=>({...f,anyPresent:n.some(C=>{var g;return((g=C.pct.find(k=>k.key===f.key))==null?void 0:g.pct)>0})})),i=340,m=32,p=10,u=8,l=28,h=180,j=u+h+l,M=(i-m-p)/n.length,N=Math.min(44,M*.65),v=f=>f/100*h;return e.jsxs("div",{className:"chart-card chart-equal-bottom",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Achievement Level Distribution"}),e.jsx("div",{className:"chart-note",children:"% of evaluations per rubric band â€” directly maps to MÃœDEK continuous improvement evidence."})]})}),e.jsx("div",{className:"chart-svg-fill rubric-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${i} ${j}`,style:{width:"100%",height:"auto",display:"block"},children:[[0,25,50,75,100].map(f=>{const C=u+h-v(f);return e.jsxs("g",{children:[e.jsx("line",{x1:m,y1:C,x2:i-p,y2:C,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsxs("text",{x:m-4,y:C+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:[f,"%"]})]},f)}),n.map((f,C)=>{const g=m+C*M+M/2,k=g-N/2;let P=0;return e.jsxs("g",{children:[f.pct.map($=>{if($.pct<=0)return null;const w=v($.pct),y=u+h-P-w;P+=w;const D=w>=16;return e.jsxs("g",{children:[e.jsxs("title",{children:[f.label," Â· ",$.label,`
`,"Count: ",$.count," evaluation",$.count!==1?"s":"",`
`,"Share: ",$.pct.toFixed(0),"%"]}),e.jsx("rect",{x:k,y,width:N,height:w,fill:$.color}),D&&e.jsxs("text",{x:g,y:y+w/2+4,textAnchor:"middle",fontSize:"9",fill:"#fff",fontWeight:"700",children:[$.pct.toFixed(0),"%"]})]},$.key)}),e.jsx("text",{x:g,y:u+h+16,textAnchor:"middle",fontSize:"9",fill:"#475569",fontWeight:"600",children:f.label})]},f.key)})]})}),e.jsx("div",{className:"chart-legend rubric-legend",children:[...o].reverse().map(f=>e.jsxs("span",{className:"legend-item",style:f.anyPresent?void 0:{opacity:.35,textDecoration:"line-through"},children:[e.jsx("span",{className:"legend-dot",style:{background:f.color}}),f.label]},f.key))})]})}function on(s){return s?s.toLocaleString("tr-TR",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," Â·"):"â€”"}function ln(){return e.jsxs("div",{className:"dashboard-loading",children:[e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]}),e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]})]})}function cn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#FCA5A5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("p",{className:"dashboard-state-title",children:"Could not load data"}),e.jsx("span",{className:"dashboard-state-sub",children:"Check your connection and refresh the page."})]})}function dn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#D1D5DB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),e.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("p",{className:"dashboard-state-title",children:"No data available"}),e.jsx("span",{className:"dashboard-state-sub",children:"Evaluations will appear here once jurors submit their scores."})]})}function un({dashboardStats:s,submittedData:t,lastRefresh:r,loading:a,error:n}){const o=c.useRef(null),[i,m]=c.useState(!1),p=c.useRef(null);async function u(){if(i||!o.current)return;m(!0);const h=o.current,j=h.querySelector(".dashboard-toolbar"),M=h.querySelector(".print-header"),N=h.querySelectorAll(".mudek-badge-wrap"),v=(j==null?void 0:j.style.display)??"",f=(M==null?void 0:M.style.display)??"",C=[];N.forEach(P=>C.push(P.style.visibility??""));const g=()=>{j&&(j.style.display=v),M&&(M.style.display=f),N.forEach((P,$)=>{P.style.visibility=C[$]||""}),h.classList.remove("print-mode"),m(!1),p.current=null};p.current=g,j&&(j.style.display="none"),M&&(M.style.display="block"),N.forEach(P=>P.style.visibility="hidden"),h.classList.add("print-mode");const k=()=>g();window.addEventListener("afterprint",k,{once:!0}),requestAnimationFrame(()=>{setTimeout(()=>{window.print()},50)})}c.useEffect(()=>()=>{p.current&&p.current()},[]);const l=on(r);return a?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(ln,{})}):n?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(cn,{})}):!t||t.length===0?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(dn,{})}):e.jsxs("div",{className:"dashboard-print-wrap",ref:o,children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:ce.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[ce.courseName," â€” ",ce.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report Â Â·Â  ",l,"Â Â·Â  ",t.length," final submission",t.length!==1?"s":"","Â Â·Â  ",s.length," group",s.length!==1?"s":""]})]}),e.jsxs("div",{className:"dashboard-toolbar no-print",children:[e.jsx("div",{className:"dashboard-toolbar-left",children:e.jsx(Zt,{})}),e.jsx("span",{className:"dashboard-toolbar-divider","aria-hidden":"true"}),e.jsxs("button",{className:"pdf-export-btn",onClick:u,disabled:i,children:[e.jsx(Cs,{}),i?"Preparing PDFâ€¦":"Export PDF"]})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Outcome Distribution"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"1",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-1",children:e.jsx(sn,{stats:s})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Programme Overview"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"2",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-2",children:e.jsx(en,{data:t})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-3",children:e.jsx(tn,{stats:s})})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Juror Consistency"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"3",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-4",children:e.jsx(rn,{stats:s,data:t})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Criterion Analysis"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"4",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-5",children:e.jsx(nn,{data:t})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-6",children:e.jsx(an,{data:t})})]})]})}const ms=H.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]});function ye(s){if(s===""||s===null||s===void 0||typeof s=="string"&&s.trim()==="")return"";const t=Number(s);return Number.isFinite(t)?t:""}const mn=[{key:"in_progress",label:"In Progress"},{key:"editing",label:"Editing"},{key:"submitted",label:"Submitted"}],hn=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}];function hs(s){return s.jurorId?s.jurorId:`${(s.juryName||"").trim().toLowerCase()}__${(s.juryDept||"").trim().toLowerCase()}`}function xn({open:s,anchorRect:t,onClose:r,className:a,contentKey:n,mode:o="anchor",children:i}){const m=c.useRef(null),[p,u]=c.useState({left:0,top:0,visibility:"hidden"});return c.useLayoutEffect(()=>{if(!s||!m.current)return;const l=m.current,h=()=>{if(o==="center"){u({left:"50%",top:"50%",transform:"translate(-50%, -50%)",visibility:"visible"});return}if(!t)return;const j=8,M=l.offsetWidth,N=l.offsetHeight,v=window.innerWidth,f=window.innerHeight;let C=t.left;C=Math.min(C,v-M-j),C=Math.max(j,C);let g=t.bottom+6;if(g+N+j>f){const k=t.top-N-6;k>=j?g=k:g=Math.max(j,f-N-j)}u({left:C,top:g,transform:"none",visibility:"visible"})};return h(),window.addEventListener("resize",h),window.addEventListener("orientationchange",h),()=>{window.removeEventListener("resize",h),window.removeEventListener("orientationchange",h)}},[s,t,n,o]),!s||o!=="center"&&!t?null:ps.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"filter-overlay",onClick:r}),e.jsx("div",{ref:m,className:a,style:p,role:"dialog","aria-modal":"true",onClick:l=>l.stopPropagation(),onPointerDown:l=>l.stopPropagation(),children:i})]}),document.body)}function pn({data:s,jurors:t}){const[r,a]=c.useState("ALL"),[n,o]=c.useState("ALL"),[i,m]=c.useState("ALL"),[p,u]=c.useState(new Set),[l,h]=c.useState(""),[j,M]=c.useState(""),[N,v]=c.useState(""),[f,C]=c.useState("tsMs"),[g,k]=c.useState("desc"),[P,$]=c.useState(null),[w,y]=c.useState(null),[D,L]=c.useState(()=>typeof window<"u"&&window.matchMedia("(max-width: 480px)").matches),I=c.useMemo(()=>ms.map(d=>({id:d.id,label:`Group ${d.id}`,name:d.name})).sort((d,R)=>d.id-R.id),[]),b=c.useMemo(()=>{const d=new Map;return t.forEach(R=>{const x=String((R==null?void 0:R.dept)??"").trim();x&&d.set(x.toLowerCase(),x)}),Array.from(d.entries()).sort((R,x)=>R[1].localeCompare(x[1])).map(([R,x])=>({key:R,label:x}))},[t]);c.useEffect(()=>{if(!D||P!=="timestamp")return;const d=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=d}},[P,D]),c.useEffect(()=>{if(typeof window>"u")return;const d=window.matchMedia("(max-width: 480px)"),R=()=>L(d.matches);return R(),d.addEventListener?d.addEventListener("change",R):d.addListener(R),()=>{d.addEventListener?d.removeEventListener("change",R):d.removeListener(R)}},[]);const A=c.useMemo(()=>{let d=0;return r!=="ALL"&&(d+=1),n!=="ALL"&&(d+=1),i!=="ALL"&&(d+=1),p.size>0&&(d+=1),(l||j)&&(d+=1),N&&(d+=1),d},[r,n,i,p,l,j,N]),G=A>0;function _(){a("ALL"),o("ALL"),m("ALL"),u(new Set),h(""),M(""),v(""),C("tsMs"),k("desc"),$(null),y(null)}function ee(d){u(R=>{const x=new Set(R);return x.has(d)?x.delete(d):x.add(d),x})}function U(){$(null),y(null)}function V(d,R){var S,W;const x=(W=(S=R==null?void 0:R.currentTarget)==null?void 0:S.getBoundingClientRect)==null?void 0:W.call(S);$(z=>{const q=z===d?null:d;return q&&x&&y(x),q||y(null),q})}function J(d){return d===""||d===null||d===void 0||typeof d=="string"&&d.trim()===""?!0:typeof d=="number"?!Number.isFinite(d):!1}const re=c.useMemo(()=>{const d=l?new Date(l).getTime():0,R=j?new Date(j+"T23:59:59").getTime():1/0;let x=s.slice();if(r!=="ALL"&&(x=x.filter(S=>hs(S)===r)),i!=="ALL"&&(x=x.filter(S=>String(S.projectId)===i)),n!=="ALL"){const S=n.toLowerCase();x=x.filter(W=>String(W.juryDept??"").trim().toLowerCase()===S)}if(p.size>0&&(x=x.filter(S=>{const W=S.editingFlag==="editing"||S.status==="editing",z=S.status==="group_submitted"||S.status==="all_submitted",q=S.status==="in_progress";return!!(p.has("editing")&&W||p.has("submitted")&&z||p.has("in_progress")&&q)})),(l||j)&&(x=x.filter(S=>{const W=S.tsMs||_e(S.timestamp);return W>=d&&W<=R})),N){const S=N.toLowerCase();x=x.filter(W=>(W.comments||"").toLowerCase().includes(S))}return x.sort((S,W)=>{const z=S[f],q=W[f],ne=J(z),ae=J(q);return ne&&ae?0:ne?1:ae?-1:g==="asc"?le(z,q):le(q,z)}),x},[s,r,i,n,p,l,j,N,f,g]);function te(d){f===d?k(R=>R==="asc"?"desc":"asc"):(C(d),k("desc"))}const de=d=>f!==d?e.jsx(ze,{}):g==="asc"?e.jsx(Oe,{}):e.jsx(Ge,{}),Q=(()=>P==="juror"?{className:"col-filter-popover col-filter-popover-portal",contentKey:r,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:d=>{a(d.target.value),U()},children:[e.jsx("option",{value:"ALL",children:"All jurors"}),t.map(d=>e.jsxs("option",{value:d.key,children:[d.name,d.dept?` (${d.dept})`:""]},d.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),U()},children:"Clear"})]})}:P==="dept"?{className:"col-filter-popover col-filter-popover-portal",contentKey:n,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:d=>{o(d.target.value),U()},children:[e.jsx("option",{value:"ALL",children:"All departments"}),b.map(d=>e.jsx("option",{value:d.key,children:d.label},d.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{o("ALL"),U()},children:"Clear"})]})}:P==="group"?{className:"col-filter-popover col-filter-popover-portal",contentKey:i,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:i,onChange:d=>{m(d.target.value),U()},children:[e.jsx("option",{value:"ALL",children:"All groups"}),I.map(d=>e.jsx("option",{value:String(d.id),children:d.label},d.id))]}),i!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{m("ALL"),U()},children:"Clear"})]})}:P==="timestamp"?{className:`col-filter-popover col-filter-popover-portal col-filter-popover-timestamp${D?" is-centered":""}`,contentKey:`${l}|${j}`,mode:D?"center":"anchor",content:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",value:l,onChange:d=>h(d.target.value)})]}),e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"To"}),e.jsx("input",{type:"date",value:j,onChange:d=>M(d.target.value)})]}),D?e.jsxs("div",{className:"timestamp-actions",children:[(l||j)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{h(""),M("")},children:"Clear"}),e.jsx("button",{className:"timestamp-done-btn",onClick:U,children:"Done"})]}):(l||j)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{h(""),M("")},children:"Clear"})]})}:P==="status"?{className:"col-filter-popover col-filter-popover-portal col-filter-popover-status",contentKey:Array.from(p).sort().join("|"),content:e.jsxs(e.Fragment,{children:[mn.map(({key:d,label:R})=>e.jsxs("label",{className:"status-option",children:[e.jsx("input",{type:"checkbox",checked:p.has(d),onChange:()=>ee(d)}),R]},d)),p.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{u(new Set),U()},children:"Clear"})]})}:P==="comments"?{className:"col-filter-popover col-filter-popover-portal",contentKey:N,content:e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:"Search commentsâ€¦",value:N,onChange:d=>v(d.target.value)}),N&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{v(""),U()},children:"Clear"})]})}:null)();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:re.length})," row",re.length!==1?"s":""]}),G&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"filters-active-pill",children:["Filters: ",A]}),e.jsx("button",{type:"button",className:"filters-clear-btn",onClick:_,"aria-label":"Clear filters",title:"Clear filters",children:e.jsx(Qe,{})})]}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{Bt(re)},children:[e.jsx(Cs,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]})]}),e.jsx(xn,{open:!!Q,anchorRect:w,onClose:U,className:Q==null?void 0:Q.className,contentKey:Q==null?void 0:Q.contentKey,mode:Q==null?void 0:Q.mode,children:Q==null?void 0:Q.content}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>te("juryName"),children:"Juror"}),e.jsx("div",{className:`col-filter-hotspot${r!=="ALL"?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("juror",d)},title:"Filter by juror",children:e.jsx(he,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>te("juryDept"),children:"Department"}),e.jsx("div",{className:`col-filter-hotspot${n!=="ALL"?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("dept",d)},title:"Filter by department",children:e.jsx(he,{})})]})}),e.jsx("th",{style:{position:"relative",whiteSpace:"nowrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>te("projectId"),children:"Group"}),e.jsx("div",{className:`col-filter-hotspot${i!=="ALL"?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("group",d)},title:"Filter by group",children:e.jsx(he,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>te("tsMs"),children:"Timestamp"}),e.jsx("div",{className:`col-filter-hotspot${l||j?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("timestamp",d)},title:"Filter by date",children:e.jsx(he,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>te("status"),children:"Status"}),e.jsx("div",{className:`col-filter-hotspot${p.size>0?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("status",d)},title:"Filter by status",children:e.jsx(he,{})})]})}),hn.map(({key:d,label:R})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>te(d),children:e.jsxs("span",{className:"col-sort-label",children:[R," ",e.jsx("span",{className:"sort-icon",children:de(d)})]})},d)),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Comments"}),e.jsx("div",{className:`col-filter-hotspot${N?" active":""}`,onPointerDown:d=>{d.preventDefault(),d.stopPropagation(),V("comments",d)},title:"Filter by comments",children:e.jsx(he,{})})]})})]})}),e.jsxs("tbody",{children:[re.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),re.map((d,R)=>{ms.find(S=>S.id===d.projectId);const x=d.status==="in_progress";return e.jsxs("tr",{className:R%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:d.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:d.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsx("div",{className:"cell-group-wrap",title:`Group ${d.projectId}`,style:{cursor:"default"},children:e.jsxs("strong",{className:"cell-group-title",children:["Group ",d.projectId]})})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:Ke(d.timestamp)}),e.jsx("td",{children:e.jsx(Se,{status:d.status,editingFlag:d.editingFlag})}),e.jsx("td",{style:{color:x?"#94a3b8":void 0},children:ye(d.technical)}),e.jsx("td",{style:{color:x?"#94a3b8":void 0},children:ye(d.design)}),e.jsx("td",{style:{color:x?"#94a3b8":void 0},children:ye(d.delivery)}),e.jsx("td",{style:{color:x?"#94a3b8":void 0},children:ye(d.teamwork)}),e.jsx("td",{style:{color:x?"#94a3b8":void 0},children:e.jsx("strong",{children:ye(d.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:d.comments})]},`${hs(d)}-${d.projectId}-${R}`)})]})]})})]})}const xs=H.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]});function jn({jurorStats:s,onPinReset:t}){const[r,a]=c.useState(""),[n,o]=c.useState(""),[i,m]=c.useState(new Set);c.useEffect(()=>{const l=setTimeout(()=>o(r),200);return()=>clearTimeout(l)},[r]);function p(l){m(h=>{const j=new Set(h);return j.has(l)?j.delete(l):j.add(l),j})}const u=c.useMemo(()=>{const l=s.slice().sort((j,M)=>le(j.jury,M.jury)),h=n.trim().toLowerCase();return h?l.filter(j=>{var M;return j.jury.toLowerCase().includes(h)||(j.dept||((M=j.latestRow)==null?void 0:M.juryDept)||"").toLowerCase().includes(h)}):l},[s,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("span",{className:"juror-search-icon","aria-hidden":"true",children:e.jsx(gt,{})}),e.jsx("input",{className:"juror-search-input",value:r,onChange:l=>a(l.target.value),placeholder:"Search by name or departmentâ€¦"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>a(""),"aria-label":"Clear search",title:"Clear search",children:e.jsx(Qe,{})})]})}),u.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:u.map(l=>{const{key:h,jury:j,rows:M,overall:N,latestRow:v}=l,f=zt(M),C=f===100?"#22c55e":f>66?"#84cc16":f>33?"#eab308":f>0?"#f97316":"#e2e8f0",g=M.some(w=>w.editingFlag==="editing"),k=xs.map(w=>{const y=M.find(L=>L.projectId===w.id),D=(y==null?void 0:y.status)==="group_submitted"||(y==null?void 0:y.status)==="all_submitted"?"submitted":(y==null?void 0:y.status)||"not_started";return{id:w.id,status:D}}),P=k.length>0&&k.every(w=>w.status==="submitted"),$=g?"juror-card-editing":N==="all_submitted"?"juror-card-all-submitted":N==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${$}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:[e.jsx("span",{className:"juror-name-icon","aria-hidden":"true",children:e.jsx(ws,{})}),e.jsxs("span",{className:"juror-name-text",children:[j,(v==null?void 0:v.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",v.juryDept,")"]})]})]}),e.jsx("div",{className:"juror-header-actions",children:g?e.jsx(Se,{status:N,editingFlag:"editing"}):P?e.jsx(Se,{variant:"completed",icon:e.jsx(We,{}),children:"Completed"}):e.jsx(Se,{status:N})})]}),e.jsxs("div",{className:"juror-meta",children:[(v==null?void 0:v.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:Ke(v==null?void 0:v.timestamp)})]}),t&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${j}`,onClick:()=>t(j,(v==null?void 0:v.juryDept)||"",(v==null?void 0:v.jurorId)||""),children:"ðŸ”‘ Reset PIN"})]})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${f}%`,background:C}})}),e.jsxs("span",{className:"juror-progress-label",children:[f,"%"]})]}),e.jsx("div",{className:"juror-projects",children:M.slice().sort((w,y)=>w.projectId-y.projectId).map(w=>{var A,G;const y=xs.find(_=>_.id===w.projectId),D=`${h}-${w.projectId}`,L=i.has(D),I=`juror-group-panel-${D}`,b=!!(y!=null&&y.desc)||((A=y==null?void 0:y.students)==null?void 0:A.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:b?0:-1,"aria-expanded":L,"aria-controls":I,onClick:()=>{b&&p(D)},onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&b&&(_.preventDefault(),p(D))},style:{cursor:b?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(y==null?void 0:y.name)||`Group ${w.projectId}`}),b&&e.jsx("span",{className:`group-accordion-chevron${L?" open":""}`,children:"â–¾"})]})}),e.jsxs("div",{className:"juror-row-right",children:[w.timestamp&&e.jsxs("span",{className:"juror-row-ts",children:[e.jsx("span",{className:"juror-row-ts-icon","aria-hidden":"true",children:e.jsx(Ue,{})}),Ke(w.timestamp)]}),e.jsx(Se,{status:w.status,editingFlag:w.editingFlag}),(w.status==="all_submitted"||w.status==="group_submitted")&&e.jsx("span",{className:"juror-score",title:"/ 100","aria-label":`${w.total} / 100`,children:w.total})]})]}),e.jsx("div",{id:I,className:`group-accordion-panel${L?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(y==null?void 0:y.desc)&&e.jsxs("span",{className:"juror-row-desc group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ss,{})}),e.jsx("span",{className:"group-card-desc-text",children:y.desc})]}),((G=y==null?void 0:y.students)==null?void 0:G.length)>0&&e.jsxs("span",{className:"juror-row-students group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(Ns,{})}),e.jsx("span",{className:"group-card-students-text",children:y.students.join(" Â· ")})]})]})})]},D)})})]},h)})})]})}const fn=s=>s?s.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:s.status==="group_submitted"?{background:"#ecfdf3",color:"#16a34a",fontWeight:600}:s.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},gn=s=>s?s.status==="all_submitted"||s.status==="group_submitted"?s.total:s.status==="in_progress"?"":"â€”":"â€”";function vn({data:s,jurors:t,groups:r}){const[a,n]=c.useState(null),[o,i]=c.useState("desc"),[m,p]=c.useState("asc"),[u,l]=c.useState("juror"),[h,j]=c.useState(""),[M,N]=c.useState(null),v=c.useMemo(()=>{const L={};return s.forEach(I=>{const b=I.jurorId?I.jurorId:`${(I.juryName||"").trim().toLowerCase()}__${(I.juryDept||"").trim().toLowerCase()}`;L[b]||(L[b]={}),L[b][I.projectId]={total:I.total,status:I.status,editingFlag:I.editingFlag}}),L},[s]);function f(L){a!==L?(n(L),i("desc"),l("group")):o==="desc"?(i("asc"),l("group")):(n(null),i("desc"),l("group"))}const C=L=>u!=="group"||a!==L?e.jsx(ze,{}):o==="desc"?e.jsx(Ge,{}):e.jsx(Oe,{}),g=()=>u!=="juror"?e.jsx(ze,{}):m==="asc"?e.jsx(Oe,{}):e.jsx(Ge,{});function k(){u!=="juror"?(l("juror"),p("asc")):p(L=>L==="asc"?"desc":"asc")}const P=c.useMemo(()=>{let L=t.slice().sort((I,b)=>le(I.name,b.name));if(h){const I=h.toLowerCase();L=L.filter(b=>b.name.toLowerCase().includes(I))}return u==="juror"&&(L=L.slice().sort((I,b)=>m==="asc"?le(I.name,b.name):le(b.name,I.name))),u==="group"&&a!==null&&(L=[...L].sort((I,b)=>{var V,J;const A=(V=v[I.key])==null?void 0:V[a],G=(J=v[b.key])==null?void 0:J[a],_=(A==null?void 0:A.status)==="all_submitted"?Number(A.total):null,ee=(G==null?void 0:G.status)==="all_submitted"?Number(G.total):null;if(_===null&&ee===null)return le(I.name,b.name);if(_===null)return 1;if(ee===null)return-1;const U=o==="desc"?ee-_:_-ee;return U!==0?U:le(I.name,b.name)})),L},[t,h,a,o,u,m,v]),$=L=>{const I=r.map(b=>{var _;const A=(_=v[L])==null?void 0:_[b.id];return{status:(A==null?void 0:A.status)==="group_submitted"||(A==null?void 0:A.status)==="all_submitted"?"submitted":(A==null?void 0:A.status)||"not_started",editing:(A==null?void 0:A.editingFlag)==="editing"}});return I.every(b=>b.status==="not_started")?"not_started":I.some(b=>b.editing)?"editing":I.every(b=>b.status==="submitted")?"completed":I.some(b=>b.status==="in_progress")?"in_progress":I.some(b=>b.status==="submitted")?"submitted":"not_started"},w={completed:"Completed",submitted:"Submitted",in_progress:"In Progress",editing:"Editing",not_started:"Not Started"},y={completed:e.jsx(We,{}),submitted:e.jsx(Pe,{}),in_progress:e.jsx(Ce,{}),editing:e.jsx(Ie,{}),not_started:e.jsx(ds,{})},D=c.useMemo(()=>r.map(L=>{const I=P.map(b=>{var A;return(A=v[b.key])==null?void 0:A[L.id]}).filter(b=>(b==null?void 0:b.status)==="all_submitted").map(b=>b.total);return I.length?(I.reduce((b,A)=>b+A,0)/I.length).toFixed(2):null}),[P,r,v]);return t.length?e.jsxs("div",{className:"matrix-wrap",children:[e.jsxs("div",{className:"matrix-subtitle",children:[e.jsxs("div",{className:"matrix-legend-row",children:[e.jsx("span",{className:"matrix-legend-label",children:"Cells"}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot completed-dot"}),"Completed"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]}),e.jsxs("div",{className:"matrix-legend-row matrix-icon-legend",children:[e.jsx("span",{className:"matrix-legend-label",children:"Juror"}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon completed",children:e.jsx(We,{})}),"Completed"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon submitted",children:e.jsx(Pe,{})}),"Submitted"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon editing",children:e.jsx(Ie,{})}),"Editing"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon in_progress",children:e.jsx(Ce,{})}),"In Progress"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon not_started",children:e.jsx(ds,{})}),"Not Started"]})]}),P.length<t.length&&e.jsxs("span",{className:"matrix-legend-count",children:["Showing ",P.length,"/",t.length," jurors"]})]}),M!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>N(null)}),e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"matrix-corner",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsxs("span",{className:"col-sort-label",onClick:k,children:["Juror / Group",e.jsx("span",{className:"sort-icon",children:g()})]}),e.jsx("button",{className:`col-filter-hotspot${h?" active":""}`,onClick:L=>{L.stopPropagation(),N(I=>I==="juror"?null:"juror")},title:"Filter jurors",children:e.jsx(he,{})})]}),M==="juror"&&e.jsx("div",{className:"col-filter-popover",onClick:L=>L.stopPropagation(),children:e.jsxs("div",{className:"matrix-filter-input",children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror nameâ€¦",value:h,onChange:L=>j(L.target.value)}),h&&e.jsx("button",{className:"matrix-filter-clear",onClick:()=>j(""),"aria-label":"Clear filter",title:"Clear filter",children:e.jsx(Qe,{})})]})})]}),r.map(L=>{const I=a===L.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${I?" active":""}`,onClick:()=>f(L.id),title:`Sort by ${L.label}`,children:[e.jsx("strong",{children:L.label}),e.jsx("span",{className:"sort-icon",children:C(L.id)})]})},L.id)})]})}),e.jsx("tbody",{children:P.map(L=>e.jsxs("tr",{children:[e.jsx("td",{className:"matrix-juror",children:(()=>{const I=$(L.key),b=L.dept?`${L.name} (${L.dept})`:L.name;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`matrix-status-icon ${I}`,title:w[I],"aria-hidden":"true",children:y[I]}),e.jsxs("span",{className:"matrix-juror-name",title:b,children:[L.name,L.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",L.dept,")"]})]})]})})()}),r.map(I=>{var A;const b=((A=v[L.key])==null?void 0:A[I.id])??null;return e.jsx("td",{style:fn(b),children:gn(b)},I.id)})]},L.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),D.map((L,I)=>e.jsx("td",{className:"matrix-avg-cell",children:L!==null?L:"â€”"},r[I].id))]})})]})}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(Ve,{})," Averages include only ",e.jsx("strong",{children:"completed"})," submissions."]})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const He=H.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]}),bn=Y.map(s=>({id:s.id,label:s.label,shortLabel:s.shortLabel,max:s.max})),Re=He.length;function ke(s){if(s===""||s===null||s===void 0||typeof s=="string"&&s.trim()==="")return"";const t=Number(String(s??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(t)?t:""}const yn=[{id:"summary",label:"Summary",icon:pt},{id:"dashboard",label:"Dashboard",icon:Ls},{id:"detail",label:"Details",icon:Ye},{id:"jurors",label:"Jurors",icon:ws},{id:"matrix",label:"Matrix",icon:jt}];function kn({metrics:s,id:t}){const{completedJurors:r,totalJurors:a,completedEvaluations:n,totalEvaluations:o,inProgressJurors:i,editingJurors:m}=s;return e.jsxs("div",{id:t,className:"results-status-bar",role:"group","aria-label":"Results status metrics",children:[e.jsxs("span",{className:"status-chip status-jurors",children:[e.jsx(ut,{}),e.jsx("span",{className:"status-label",children:"Jurors"}),e.jsx("span",{className:"status-value",children:a}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown",children:[e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(mt,{}),r]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(Ce,{}),i]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"Â·"}),e.jsxs("span",{className:"status-breakdown-item",children:[e.jsx(Ie,{}),m]})]})]}),e.jsxs("span",{className:"status-chip status-evaluated",children:[e.jsx(xt,{}),e.jsx("span",{className:"status-label",children:"Evaluated"}),e.jsxs("span",{className:"status-value",children:[n,"/",o]})]})]})}function Nn({adminPass:s,onBack:t,onAuthError:r,onInitialLoadDone:a}){const[n,o]=c.useState([]),[i,m]=c.useState(!0),[p,u]=c.useState(""),[l,h]=c.useState(""),[j,M]=c.useState(!0),[N,v]=c.useState("summary"),[f,C]=c.useState(null),[g,k]=c.useState(!1),P=c.useRef(null),[$,w]=c.useState(null),[y,D]=c.useState(""),L=c.useRef(!1),I=c.useRef(s);c.useEffect(()=>{I.current=s},[s]);const b=async()=>{m(!0),u("");try{const x=I.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!x){o([]),h("Enter the admin password to load results.");return}const S=await fe({action:"export",pass:x});if((S==null?void 0:S.status)==="unauthorized"){if(o([]),r){r("Invalid password");return}h("Incorrect password.");return}if((S==null?void 0:S.status)!=="ok"||!Array.isArray(S==null?void 0:S.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",x)}catch{}const W=S.rows.map(z=>({juryName:String(z["Juror Name"]??z["Your Name"]??""),juryDept:String(z["Department / Institution"]??z.Department??""),timestamp:z.Timestamp||"",tsMs:_e(z.Timestamp||""),projectId:$t(z["Group No"]),projectName:String(z["Group Name"]??""),jurorId:String(z["Juror ID"]??""),technical:ke(z["Technical (30)"]),design:ke(z["Written (30)"]),delivery:ke(z["Oral (30)"]),teamwork:ke(z["Teamwork (10)"]),total:ke(z["Total (100)"]),comments:z.Comments||"",status:String(z.Status??"all_submitted"),editingFlag:String(z.EditingFlag??"")}));o(Ot(W)),C(new Date),h(""),L.current||(L.current=!0,a==null||a())}catch(x){if(r){r("Connection error â€” try again.");return}u("Could not load data: "+x.message),o([])}finally{m(!1)}};c.useEffect(()=>{b()},[]),c.useEffect(()=>{},[]),c.useEffect(()=>{const x=P.current;if(!x)return;const S=()=>{k(x.scrollWidth>x.clientWidth+2)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[N,j]),c.useEffect(()=>($?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[$]);const A=async(x,S,W)=>{w({juryName:x,juryDept:S}),D("loading");try{const z=I.current||sessionStorage.getItem("ee492_admin_pass")||"",q=await fe({action:"resetPin",jurorId:W.trim(),pass:z});D(q.status==="ok"?"ok":"error")}catch{D("error")}setTimeout(()=>{w(null),D("")},3e3)},G=x=>x.jurorId?x.jurorId:`${(x.juryName||"").trim().toLowerCase()}__${(x.juryDept||"").trim().toLowerCase()}`,_=c.useMemo(()=>{const x=new Map;return n.forEach(S=>{if(!S.juryName)return;const W=G(S);x.has(W)||x.set(W,{key:W,name:S.juryName.trim(),dept:S.juryDept.trim(),jurorId:S.jurorId})}),[...x.values()].sort((S,W)=>le(S.name,W.name))},[n]),ee=c.useMemo(()=>He.map(x=>({id:x.id,label:`Group ${x.id}`,desc:x.desc||""})).sort((x,S)=>x.id-S.id),[]),U=c.useMemo(()=>{const x=new Map;return _.forEach(({key:S,dept:W})=>x.set(S,W)),x},[_]),V=c.useMemo(()=>{const x=new Map;return _.forEach(({key:S,name:W})=>x.set(S,{bg:Tt(W),dot:Rt(W)})),x},[_]),J=c.useMemo(()=>n.filter(x=>x.status==="all_submitted"),[n]),re=c.useMemo(()=>n.filter(x=>x.status==="group_submitted"||x.status==="all_submitted"),[n]),te=c.useMemo(()=>He.map(x=>{const S=J.filter(q=>q.projectId===x.id);if(!S.length)return{id:x.id,name:x.name,desc:x.desc,students:x.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const W={};bn.forEach(q=>{W[q.id]=S.reduce((ne,ae)=>ne+(ae[q.id]||0),0)/S.length});const z=S.map(q=>q.total);return{id:x.id,name:x.name,desc:x.desc,students:x.students,count:S.length,avg:W,totalAvg:z.reduce((q,ne)=>q+ne,0)/z.length,totalMin:Math.min(...z),totalMax:Math.max(...z)}}),[J]),de=c.useMemo(()=>te.map(x=>({...x,name:`Group ${x.id}`})),[te]),Q=c.useMemo(()=>[...te].sort((x,S)=>S.totalAvg-x.totalAvg),[te]),d=c.useMemo(()=>_.map(({key:x,name:S,dept:W,jurorId:z})=>{const q=n.filter(Z=>G(Z)===x),ne=q.filter(Z=>Z.status==="group_submitted"||Z.status==="all_submitted"),ae=q.filter(Z=>Z.status==="all_submitted"),xe=q.filter(Z=>Z.status==="in_progress"),ue=q.reduce((Z,Le)=>Le.tsMs>Z?Le.tsMs:Z,0),X=q.find(Z=>Z.tsMs===ue)||q[0],ie=ae.length===Re?"all_submitted":ne.length>0||xe.length>0?"in_progress":"not_started";return{key:x,jury:S,dept:W,jurorId:z,rows:q,submitted:ne,completed:ne,finalSubmitted:ae,inProgress:xe,latestTs:ue,latestRow:X,overall:ie}}),[_,n]);n.filter(x=>x.status==="in_progress").length,d.filter(x=>x.rows.some(S=>S.editingFlag==="editing")).length;const R=c.useMemo(()=>{const x=_.length,S=re.length,W=x*Re,z=new Map;n.forEach(X=>{if(X.status!=="all_submitted")return;const ie=G(X);z.has(ie)||z.set(ie,new Set),z.get(ie).add(X.projectId)});const q=_.filter(X=>{var ie;return(((ie=z.get(X.key))==null?void 0:ie.size)||0)>=Re}).length,ne=new Set(n.filter(X=>X.status==="editing"||X.editingFlag==="editing").map(X=>G(X))),xe=new Set(n.filter(X=>X.status==="in_progress").map(X=>G(X)).filter(X=>!ne.has(X))).size,ue=ne.size;return{completedJurors:q,totalJurors:x,completedEvaluations:S,totalEvaluations:W,inProgressJurors:xe,editingJurors:ue}},[n,J,re,_,G]);return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("div",{className:"form-header-main",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("button",{className:"back-btn",onClick:t,"aria-label":"Back to home",children:e.jsx(De,{})}),e.jsx("div",{className:"header-title",children:e.jsxs("div",{className:"results-title-row",children:[e.jsx("h2",{children:"Results Panel"}),e.jsx("button",{className:"results-toggle",type:"button","aria-label":j?"Hide status metrics":"Show status metrics","aria-expanded":j,"aria-controls":"results-status-bar",onClick:()=>M(x=>!x),children:e.jsx("span",{className:`results-toggle-icon${j?" open":""}`,"aria-hidden":"true",children:"â–¾"})})]})})]}),e.jsxs("div",{className:"header-right",children:[f&&e.jsxs("span",{className:"last-updated",children:[e.jsx(Ue,{}),f.toLocaleString("en-GB",{timeZone:"Europe/Istanbul",day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})]}),e.jsx("button",{className:`refresh-btn${i?" is-loading":""}`,onClick:b,"aria-label":"Refresh",title:"Refresh",children:e.jsx(vt,{})})]})]}),j&&e.jsx(kn,{id:"results-status-bar",metrics:R}),e.jsxs("div",{className:"tab-bar-wrap",children:[e.jsx("div",{className:"tab-bar",ref:P,children:yn.map(x=>e.jsxs("button",{className:`tab ${N===x.id?"active":""}`,onClick:()=>v(x.id),children:[e.jsx(x.icon,{}),x.label]},x.id))}),g&&e.jsx("span",{className:"tab-scroll-hint","aria-hidden":"true",children:e.jsx(Ms,{})})]})]}),i&&e.jsx("div",{className:"loading",children:"Loading dataâ€¦"}),p&&e.jsx("div",{className:"error-msg",children:p}),l&&e.jsx("div",{className:"error-msg",children:l}),$&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${y}`,children:[y==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"ðŸ”‘"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:$.juryName}),"â€¦"]})]}),y==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon ok",children:"âœ…"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:$.juryName})," will receive a new PIN on next login."]})]}),y==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon error",children:"âŒ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:$.juryName}),"."]})]})]})}),!i&&!p&&!l&&e.jsxs("div",{className:"admin-body",children:[N==="summary"&&e.jsx(Ut,{ranked:Q,submittedData:J}),N==="dashboard"&&e.jsx(un,{dashboardStats:de,submittedData:J,lastRefresh:f,loading:i,error:p}),N==="detail"&&e.jsx(pn,{data:n,jurors:_,jurorColorMap:V}),N==="jurors"&&e.jsx(jn,{jurorStats:d,jurors:_,onPinReset:A}),N==="matrix"&&e.jsx(vn,{data:n,jurors:_,groups:ee,jurorDeptMap:U})]})]})}const wn="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function Sn(){const[s,t]=c.useState("home"),r=c.useRef(""),[a,n]=c.useState(!1),[o,i]=c.useState(!1),[m,p]=c.useState(""),[u,l]=c.useState(""),[h,j]=c.useState(!1);function M(){const v=m.trim();if(!v){l("Please enter the admin password.");return}r.current=v,p(""),l(""),i(!0),n(!0)}function N(v){n(!1),i(!1),r.current="",l(v||"Authentication failed.")}return s==="jury"?e.jsx(It,{onBack:()=>t("home")}):s==="admin"?a?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"admin-checking-overlay",children:e.jsxs("div",{className:"admin-checking-card",children:[e.jsx("div",{className:"admin-checking-icon","aria-hidden":"true",children:e.jsx(bt,{})}),e.jsxs("div",{className:"admin-checking-msg",children:["Checking access",e.jsxs("span",{className:"admin-checking-dots","aria-hidden":"true",children:[e.jsx("span",{children:"."}),e.jsx("span",{children:"."}),e.jsx("span",{children:"."})]})]}),e.jsx("div",{className:"admin-checking-sub",children:"Secure session validation in progress"})]})}),e.jsx(Nn,{adminPass:r.current,onAuthError:N,onInitialLoadDone:()=>i(!1),onBack:()=>{t("home"),n(!1),i(!1),l(""),r.current=""}})]}):e.jsx("div",{className:"lock-screen",children:e.jsxs("div",{className:"lock-card",children:[e.jsx("div",{className:"lock-icon","aria-hidden":"true",children:e.jsx(ys,{})}),e.jsx("h2",{className:"lock-title",children:"Results Panel"}),e.jsx("p",{className:"lock-subtitle",children:"Enter the admin password to view results"}),e.jsxs("div",{className:"lock-input-wrap",children:[e.jsx("input",{type:h?"text":"password",placeholder:"Admin password",value:m,onChange:v=>{p(v.target.value),u&&l("")},onKeyDown:v=>{v.key==="Enter"&&M()},autoComplete:"current-password",autoFocus:!0}),e.jsx("button",{type:"button",className:"lock-toggle",onClick:()=>j(v=>!v),"aria-label":h?"Hide password":"Show password",title:h?"Hide password":"Show password",children:h?e.jsx(dt,{}):e.jsx(ct,{})})]}),u&&e.jsxs("div",{className:"login-error",role:"alert",children:[e.jsx(ks,{}),e.jsx("span",{children:u})]}),e.jsx("button",{className:"btn-primary lock-login-btn",onClick:M,disabled:o,children:"Login"}),e.jsx("button",{className:"lock-back-btn",onClick:()=>{t("home"),l("")},children:"â† Back to Home"}),e.jsx("div",{className:"lock-footnote",children:"Admin Access â€¢ Restricted"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:wn,alt:"TED University",loading:"eager"})}),e.jsx("h1",{children:"Senior Project Jury Portal"}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsxs("div",{className:"home-meta-line",children:[e.jsx("span",{children:"10 Jurors"}),e.jsx("span",{className:"home-meta-sep",children:"Â·"}),e.jsx("span",{children:"6 Groups"}),e.jsx("span",{className:"home-meta-sep",children:"Â·"}),e.jsx("span",{className:"home-meta-icon","aria-hidden":"true",children:e.jsx(Ue,{})}),e.jsx("span",{children:"26 Feb 2026 Â· 14:30"})]}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big home-primary-btn",onClick:()=>t("jury"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx(Ye,{})}),"Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big home-secondary-btn",onClick:()=>t("admin"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx(Ls,{})}),"View Results"]})]}),e.jsxs("div",{className:"home-info",children:[e.jsx("span",{className:"home-info-icon","aria-hidden":"true",children:e.jsx(Ve,{})}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["Â© 2026 Â· Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})," ","Â· v1.0"]})]})]})}Be.createRoot(document.getElementById("root")).render(e.jsx(Js.StrictMode,{children:e.jsx(Sn,{})}));
