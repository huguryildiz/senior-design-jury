import{r as d,a as ws,R as Ys}from"./react-b1791c80.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Ss={exports:{}},Be={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qs=d,Zs=Symbol.for("react.element"),Xs=Symbol.for("react.fragment"),et=Object.prototype.hasOwnProperty,st=Qs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tt={key:!0,ref:!0,__self:!0,__source:!0};function Cs(s,t,r){var a,n={},l=null,o=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)et.call(t,a)&&!tt.hasOwnProperty(a)&&(n[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Zs,type:s,key:l,ref:o,props:n,_owner:st.current}}Be.Fragment=Xs;Be.jsx=Cs;Be.jsxs=Cs;Ss.exports=Be;var e=Ss.exports,Ke={},os=ws;Ke.createRoot=os.createRoot,Ke.hydrateRoot=os.hydrateRoot;const je={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 ‚Äî Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},G=[{id:1,name:"Group 1",desc:"G√∂ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf √únal","Ay√ßa Naz Dedeoƒülu","Onur Mesci","√áaƒüan Erdoƒüan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla √ñzer","Bertan √únver","Ada Tatlƒ±","Nesibe Aydƒ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren Germe√ß"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis ‚Äî Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine √áaylan","Selimhan Kaynar","Abdulkadir Sazlƒ±","Alp Efe ƒ∞pek"]},{id:6,name:"Group 6",desc:"AKKE ‚Äî Smart Command and Control Glove",students:["≈ûevval Kurtulmu≈ü","Abdullah Esin","Berk √áakmak","√ñmer Efe Dikici"]}],ee=[{id:"technical",label:"Technical Content",shortLabel:"Technical",color:"#F59E0B",mudek:["1.2","2","3.1","3.2"],max:30,rubric:[{range:"27‚Äì30",level:"Excellent",min:27,max:30,desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21‚Äì26",level:"Good",min:21,max:26,desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13‚Äì20",level:"Developing",min:13,max:20,desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0‚Äì12",level:"Insufficient",min:0,max:12,desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",color:"#22C55E",mudek:["9.2"],max:30,rubric:[{range:"27‚Äì30",level:"Excellent",min:27,max:30,desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21‚Äì26",level:"Good",min:21,max:26,desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13‚Äì20",level:"Developing",min:13,max:20,desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0‚Äì12",level:"Insufficient",min:0,max:12,desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",color:"#3B82F6",mudek:["9.1"],max:30,rubric:[{range:"27‚Äì30",level:"Excellent",min:27,max:30,desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21‚Äì26",level:"Good",min:21,max:26,desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13‚Äì20",level:"Developing",min:13,max:20,desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0‚Äì12",level:"Insufficient",min:0,max:12,desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",color:"#EF4444",mudek:["8.1","8.2"],max:10,rubric:[{range:"9‚Äì10",level:"Excellent",min:9,max:10,desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7‚Äì8",level:"Good",min:7,max:8,desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4‚Äì6",level:"Developing",min:4,max:6,desc:"Uneven participation. Some members are passive or unprepared."},{range:"0‚Äì3",level:"Insufficient",min:0,max:3,desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}],ls=70,nt={Excellent:{bg:"#DCFCE7",text:"#16A34A"},Good:{bg:"#F7FEE7",text:"#65A30D"},Developing:{bg:"#FEF9C3",text:"#CA8A04"},Insufficient:{bg:"#FEE2E2",text:"#DC2626"}},rt={"1.1":{en:"Knowledge in mathematics, natural sciences, fundamental engineering, computational methods, and discipline-specific topics.",tr:"Matematik, fen bilimleri, temel m√ºhendislik, bilgisayarla hesaplama ve ilgili m√ºhendislik disiplinine √∂zg√º konularda bilgi."},"1.2":{en:"Ability to apply knowledge of mathematics, natural sciences, fundamental engineering, computation, and discipline-specific topics to solve complex engineering problems.",tr:"Matematik, fen bilimleri, temel m√ºhendislik, bilgisayarla hesaplama ve ilgili m√ºhendislik disiplinine √∂zg√º konulardaki bilgileri, karma≈üƒ±k m√ºhendislik problemlerinin √ß√∂z√ºm√ºnde kullanabilme becerisi."},2:{en:"Ability to identify, formulate, and analyse complex engineering problems using fundamental science, mathematics, and engineering knowledge, with consideration of relevant UN Sustainable Development Goals.",tr:"Karma≈üƒ±k m√ºhendislik problemlerini, temel bilim, matematik ve m√ºhendislik bilgilerini kullanarak ve ele alƒ±nan problemle ilgili BM S√ºrd√ºr√ºlebilir Kalkƒ±nma Ama√ßlarƒ±nƒ± g√∂zetarak tanƒ±mlama, form√ºle etme ve analiz becerisi."},"3.1":{en:"Ability to design creative solutions to complex engineering problems.",tr:"Karma≈üƒ±k m√ºhendislik problemlerine yaratƒ±cƒ± √ß√∂z√ºmler tasarlama becerisi."},"3.2":{en:"Ability to design complex systems, processes, devices, or products under realistic constraints and conditions, meeting current and future requirements.",tr:"Karma≈üƒ±k sistemleri, s√ºre√ßleri, cihazlarƒ± veya √ºr√ºnleri ger√ßek√ßi kƒ±sƒ±tlarƒ± ve ko≈üullarƒ± g√∂zetarak, mevcut ve gelecekteki gereksinimleri kar≈üƒ±layacak bi√ßimde tasarlama becerisi."},4:{en:"Ability to select and use appropriate techniques, resources, and modern engineering and IT tools ‚Äî including estimation and modelling ‚Äî for the analysis and solution of complex engineering problems, with awareness of their limitations.",tr:"Karma≈üƒ±k m√ºhendislik problemlerinin analizi ve √ß√∂z√ºm√ºne y√∂nelik, tahmin ve modelleme de dahil olmak √ºzere, uygun teknikleri, kaynaklarƒ± ve modern m√ºhendislik ve bili≈üim ara√ßlarƒ±nƒ±, sƒ±nƒ±rlamalarƒ±nƒ±n da farkƒ±nda olarak se√ßme ve kullanma becerisi."},5:{en:"Ability to use research methods for investigating complex engineering problems, including literature review, experiment design, experimentation, data collection, and analysis and interpretation of results.",tr:"Karma≈üƒ±k m√ºhendislik problemlerinin incelenmesi i√ßin literat√ºr ara≈ütƒ±rmasƒ±, deney tasarlama, deney yapma, veri toplama, sonu√ßlarƒ± analiz etme ve yorumlama dahil, ara≈ütƒ±rma y√∂ntemlerini kullanma becerisi."},"6.1":{en:"Knowledge of the impacts of engineering applications on society, health and safety, economy, sustainability, and the environment within the scope of UN Sustainable Development Goals.",tr:"M√ºhendislik uygulamalarƒ±nƒ±n BM S√ºrd√ºr√ºlebilir Kalkƒ±nma Ama√ßlarƒ± kapsamƒ±nda, topluma, saƒülƒ±k ve g√ºvenliƒüe, ekonomiye, s√ºrd√ºr√ºlebilirlik ve √ßevreye etkileri hakkƒ±nda bilgi."},"6.2":{en:"Awareness of the legal consequences of engineering solutions.",tr:"M√ºhendislik √ß√∂z√ºmlerinin hukuksal sonu√ßlarƒ± konusunda farkƒ±ndalƒ±k."},"7.1":{en:"Knowledge of acting in accordance with engineering professional principles and ethical responsibility.",tr:"M√ºhendislik meslek ilkelerine uygun davranma, etik sorumluluk hakkƒ±nda bilgi."},"7.2":{en:"Awareness of non-discrimination, impartiality, and inclusivity of diversity.",tr:"Hi√ßbir konuda ayrƒ±mcƒ±lƒ±k yapmadan, tarafsƒ±z davranma ve √ße≈üitliliƒüi kapsayƒ±cƒ± olma konularƒ±nda farkƒ±ndalƒ±k."},"8.1":{en:"Ability to work effectively as a team member or leader in intra-disciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak disiplin i√ßi takƒ±m √ßalƒ±≈ümalarƒ±nda (y√ºz y√ºze, uzaktan veya karma) takƒ±m √ºyesi veya lideri olarak etkin bi√ßimde √ßalƒ±≈üabilme becerisi."},"8.2":{en:"Ability to work effectively as a team member or leader in multidisciplinary teams (in-person, remote, or hybrid).",tr:"Bireysel olarak √ßok disiplinli takƒ±mlarda (y√ºz y√ºze, uzaktan veya karma) takƒ±m √ºyesi veya lideri olarak etkin bi√ßimde √ßalƒ±≈üabilme becerisi."},"9.1":{en:"Ability to communicate effectively on technical topics orally, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin √ße≈üitli farklƒ±lƒ±klarƒ±nƒ± (eƒüitim, dil, meslek gibi) dikkate alarak, teknik konularda s√∂zl√º etkin ileti≈üim kurma becerisi."},"9.2":{en:"Ability to communicate effectively on technical topics in writing, adapting to audience differences (education, language, profession, etc.).",tr:"Hedef kitlenin √ße≈üitli farklƒ±lƒ±klarƒ±nƒ± (eƒüitim, dil, meslek gibi) dikkate alarak, teknik konularda yazƒ±lƒ± etkin ileti≈üim kurma becerisi."},"10.1":{en:"Knowledge of business practices such as project management and economic feasibility analysis.",tr:"Proje y√∂netimi ve ekonomik yapƒ±labilirlik analizi gibi i≈ü hayatƒ±ndaki uygulamalar hakkƒ±nda bilgi."},"10.2":{en:"Awareness of entrepreneurship and innovation.",tr:"Giri≈üimcilik ve yenilik√ßilik hakkƒ±nda farkƒ±ndalƒ±k."},11:{en:"Lifelong learning skills including independent and continuous learning, adaptation to new and emerging technologies, and critical thinking about technological change.",tr:"Baƒüƒ±msƒ±z ve s√ºrekli √∂ƒürenebilme, yeni ve geli≈ümekte olan teknolojilere uyum saƒülayabilme ve teknolojik deƒüi≈üimlerle ilgili sorgulayƒ±cƒ± d√º≈ü√ºnebilmeyi kapsayan ya≈üam boyu √∂ƒürenme becerisi."}};ee.reduce((s,t)=>s+(Number(t.max)||0),0);const Ls=je==null?void 0:je.scriptUrl,es=je==null?void 0:je.apiSecret;function cs(s,t){const r=s.trim().toLowerCase()+"__"+t.trim().toLowerCase();let a=5381;for(let n=0;n<r.length;n++)a=(a<<5)+a^r.charCodeAt(n),a=a>>>0;return a.toString(16).padStart(8,"0")}let ss="";function ds(s){ss=s}function $e(){return ss}function us(){ss=""}async function ge(s){const t=$e();try{await fetch(Ls,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,token:t})})}catch{}}async function Ne(s){const t=new URLSearchParams(s).toString(),r=await fetch(`${Ls}?${t}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=(await r.text()).trim();if(a.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script ‚Äî check your deployment URL.");try{return JSON.parse(a)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function Ms(s){return Ne({...s,token:$e()})}function Se(s,t,r,a,n,l,o){var j,x,c,i;return{juryName:s,juryDept:t,jurorId:r,timestamp:new Date().toISOString(),projectId:l.id,projectName:l.name,technical:((j=a[l.id])==null?void 0:j.technical)??"",design:((x=a[l.id])==null?void 0:x.design)??"",delivery:((c=a[l.id])==null?void 0:c.delivery)??"",teamwork:((i=a[l.id])==null?void 0:i.teamwork)??"",total:at(a,l.id),comments:n[l.id]||"",status:o}}function at(s,t){return ee.reduce((r,a)=>{var n;return r+(parseInt((n=s[t])==null?void 0:n[a.id],10)||0)},0)}async function it(s){return Ne({action:"checkPin",jurorId:s,secret:es})}async function ot(s,t,r){return Ne({action:"createPin",jurorId:s,juryName:t.trim(),juryDept:r.trim(),secret:es})}async function lt(s,t){return Ne({action:"verifyPin",jurorId:s,pin:String(t).trim(),secret:es})}async function ms(){const s=await Ms({action:"myscores"});if(s.status==="unauthorized"){const t=new Error("unauthorized");throw t.unauthorized=!0,t}return s.status!=="ok"?null:s.rows||[]}async function hs(){return Ms({action:"ping"})}const ps=1500,Ee=()=>Object.fromEntries(G.map(s=>[s.id,Object.fromEntries(ee.map(t=>[t.id,""]))])),Ie=()=>Object.fromEntries(G.map(s=>[s.id,""])),xs=()=>Object.fromEntries(G.map(s=>[s.id,Object.fromEntries(ee.map(t=>[t.id,!1]))])),ct=()=>Object.fromEntries(G.map(s=>[s.id,Object.fromEntries(ee.map(t=>[t.id,!0]))])),ke=(s,t)=>ee.every(r=>{var a;return((a=s[t])==null?void 0:a[r.id])!==""}),js=s=>G.every(t=>ke(s,t.id)),Es=s=>G.reduce((t,r)=>t+ee.reduce((a,n)=>{var l;return a+(((l=s[r.id])==null?void 0:l[n.id])!==""?1:0)},0),0),dt=(s,t)=>ee.some(r=>{var a;return((a=s[t])==null?void 0:a[r.id])!==""});function Je(s){const t=Ee(),r=Ie();return(s||[]).forEach(a=>{const n=Number(a.projectId);n&&(t[n]={...t[n],technical:a.technical??"",design:a.design??"",delivery:a.delivery??"",teamwork:a.teamwork??""},r[n]=a.comments??"")}),{scores:t,comments:r}}function ut(){const[s,t]=d.useState(""),[r,a]=d.useState(""),n=d.useRef("");d.useEffect(()=>{n.current=s.trim()&&r.trim()?cs(s,r):""},[s,r]);const[l,o]=d.useState("info"),[j,x]=d.useState(0),[c,i]=d.useState(Ee),[p,h]=d.useState(Ie),[C,w]=d.useState(xs),[k,u]=d.useState({}),[N,f]=d.useState(!1),[b,A]=d.useState(null),[T,y]=d.useState(null),[g,D]=d.useState(null),[S,E]=d.useState("idle"),[v,I]=d.useState("idle"),[V,$]=d.useState(""),[X,K]=d.useState(""),[te,q]=d.useState(3),[Y,oe]=d.useState(!1),[fe,ce]=d.useState(""),se=d.useRef(!1),le=d.useRef({});le.current={juryName:s,juryDept:r,scores:c,comments:p,groupSynced:k,current:j};const U=d.useRef(c),m=d.useRef(p),_=d.useCallback(M=>{const{juryName:F,juryDept:W}=le.current,O=n.current,z=U.current,H=m.current;if(!F.trim()||!O||!$e()||!dt(z,M))return;const pe=G.find(Vs=>Vs.id===M);if(!pe)return;const Te=ke(z,M)?"group_submitted":"in_progress",Us=Se(F,W,O,z,H,pe,Te);E("saving"),ge({rows:[Us]}),setTimeout(()=>E("saved"),500),setTimeout(()=>E("idle"),2500)},[]),B=d.useCallback(M=>{var O;const{current:F}=le.current,W=(O=G[F])==null?void 0:O.id;W!==void 0&&_(W),x(M)},[_]);d.useEffect(()=>{if(l!=="eval"||N)return;const M={};G.forEach(F=>{!k[F.id]&&ke(c,F.id)&&(M[F.id]=!0)}),Object.keys(M).length>0&&u(F=>({...F,...M}))},[c,l,k,N]),d.useEffect(()=>{if(l!=="eval"||se.current||N||!G.every(F=>k[F.id]))return;se.current=!0;const M=setTimeout(()=>{const{juryName:F,juryDept:W,scores:O,comments:z}=le.current,H=n.current;ge({rows:G.map(pe=>Se(F,W,H,O,z,pe,"all_submitted"))}),A({...O}),y({...z}),o("done")},800);return()=>clearTimeout(M)},[k,l,N]);const R=d.useCallback((M,F,W)=>{const O={...U.current,[M]:{...U.current[M],[F]:W}};U.current=O,i(O),w(z=>({...z,[M]:{...z[M],[F]:!0}})),W===""&&k[M]&&u(z=>({...z,[M]:!1}))},[k]),re=d.useCallback((M,F)=>{var z;const W=ee.find(H=>H.id===F),O=(z=U.current[M])==null?void 0:z[F];if(w(H=>({...H,[M]:{...H[M],[F]:!0}})),O!==""&&O!==void 0){const H=parseInt(O,10),pe=Number.isFinite(H)?Math.min(Math.max(H,0),W.max):0;if(String(pe)!==String(O)){const Te={...U.current,[M]:{...U.current[M],[F]:pe}};U.current=Te,i(Te)}}_(M)},[_]),me=d.useCallback((M,F)=>{const W={...m.current,[M]:F};m.current=W,h(W)},[]),L=d.useCallback(M=>{_(M)},[_]),P=d.useCallback((M,F)=>{const{juryName:W,juryDept:O}=le.current,z=n.current;ge({rows:G.map(H=>Se(W,O,z,M,F,H,"all_submitted"))}),A({...M}),y({...F}),f(!1),se.current=!0,o("done")},[]),Q=d.useCallback(async()=>{const{juryName:M,juryDept:F}=le.current,W=n.current,O=b||c,z=T||p;W&&ge({action:"resetJuror"}),U.current=O,m.current=z,i(O),h(z),f(!0),se.current=!1,u(Object.fromEntries(G.map(H=>[H.id,!0]))),o("eval"),setTimeout(()=>{W&&ge({rows:G.map(H=>Se(M,F,W,O,z,H,"group_submitted"))})},ps)},[b,T,c,p]),J=d.useCallback(()=>{if(!js(c)){w(ct());const M=G.findIndex(F=>!ke(c,F.id));M>=0&&x(M);return}P(c,p)},[c,p,P]),Z=d.useCallback(M=>{us(),ce(M||"Your session has expired. Please enter your PIN again."),oe(!0)},[]),de=d.useCallback(()=>{oe(!1),ce(""),$(""),I("entering"),o("pin")},[]),ue=d.useCallback(async()=>{D({loading:!0});let M=[];try{M=await ms()||[]}catch(z){if(z.unauthorized){Z("Your session has expired. Please enter your PIN again.");return}}const F=G.length,W=M.filter(z=>z.status==="group_submitted"||z.status==="all_submitted").length,O=M.length>=F&&M.every(z=>z.status==="all_submitted");D({rows:M,filledCount:W,totalCount:F,allSubmitted:O})},[Z]);d.useEffect(()=>{if(l!=="eval")return;const M=setInterval(async()=>{try{(await hs()).status==="unauthorized"&&Z("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(M)},[l,Z]),d.useEffect(()=>{if(l!=="eval")return;async function M(){if(document.visibilityState==="visible")try{(await hs()).status==="unauthorized"&&Z("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",M),()=>document.removeEventListener("visibilitychange",M)},[l,Z]);const be=d.useCallback(()=>{const M=g;if(M){if(D(null),M.allSubmitted){const{scores:F,comments:W}=Je(M.rows);U.current=F,m.current=W,i(F),h(W),A(F),y(W),u(Object.fromEntries(G.map(O=>[O.id,!0]))),se.current=!0,o("done");return}if(M.rows.length>0){const{scores:F,comments:W}=Je(M.rows),O=Object.fromEntries(M.rows.filter(H=>H.status==="group_submitted"||H.status==="all_submitted").map(H=>[Number(H.projectId),!0]));U.current=F,m.current=W,i(F),h(W),u(O);const z=G.findIndex(H=>!ke(F,H.id));x(z>=0?z:0),se.current=!1}o("eval")}},[g]),ye=d.useCallback(()=>{const M=Ee(),F=Ie();U.current=M,m.current=F,D(null),i(M),h(F),u({}),x(0),se.current=!1,f(!1),o("eval")},[]),ne=d.useCallback(async()=>{const{juryName:M,juryDept:F}=le.current,W=n.current;let O=Ee(),z=Ie();try{const H=await ms();if(H!=null&&H.length){const pe=Je(H);O=pe.scores,z=pe.comments}}catch{}W&&ge({action:"resetJuror"}),U.current=O,m.current=z,i(O),h(z),A(O),y(z),f(!0),se.current=!1,u(Object.fromEntries(G.map(H=>[H.id,!0]))),o("eval"),setTimeout(()=>{W&&ge({rows:G.map(H=>Se(M,F,W,O,z,H,"group_submitted"))})},ps)},[]),he=d.useCallback(async()=>{const{juryName:M,juryDept:F}=le.current;if(!M.trim()||!F.trim())return;const W=cs(M,F);if(n.current=W,D({loading:!0}),$e()){await ue();return}try{const O=await it(W);if(O.status!=="ok"){D(null),$("Could not reach the server. Please try again."),I("entering"),o("pin");return}if(O.exists)D(null),I("entering"),$(""),q(3),o("pin");else{const z=await ot(W,M,F);z.status==="ok"?(D(null),ds(z.token),K(z.pin),I("new"),o("pin")):(D(null),$("Could not create a PIN. Please try again."),I("entering"),o("pin"))}}catch{D(null),$("Connection error. Please check your network and try again."),I("entering"),o("pin")}},[ue]),ie=d.useCallback(async M=>{const F=n.current;D({loading:!0});try{const W=await lt(F,M);if(W.locked){D(null),I("locked"),$("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(W.valid){ds(W.token||""),I("idle"),$(""),await ue();return}D(null);const O=typeof W.attemptsLeft=="number"?W.attemptsLeft:te-1;q(O),O<=0?(I("locked"),$("Too many failed attempts. Please contact the admin.")):$(`Incorrect PIN. ${O} attempt${O!==1?"s":""} remaining.`)}catch{D(null),$("Could not verify PIN. Please try again.")}},[te,ue]),De=d.useCallback(async()=>{await ue()},[ue]),Js=d.useCallback(()=>{const M=Ee(),F=Ie();U.current=M,m.current=F,t(""),a(""),o("info"),x(0),i(M),h(F),w(xs()),u({}),D(null),f(!1),A(null),y(null),E("idle"),I("idle"),$(""),K(""),q(3),se.current=!1,n.current="",us()},[]),Gs=G[j],Hs=G.length*ee.length,Ks=Math.round(Es(c)/Hs*100),qs=js(c);return{juryName:s,setJuryName:t,juryDept:r,setJuryDept:a,jurorId:n.current,step:l,setStep:o,current:j,handleNavigate:B,scores:c,comments:p,touched:C,handleScore:R,handleScoreBlur:re,handleCommentChange:me,handleCommentBlur:L,project:Gs,progressPct:Ks,allComplete:qs,groupSynced:k,editMode:N,doneScores:b,doneComments:T,sheetProgress:g,saveStatus:S,pinStep:v,pinError:V,newPin:X,attemptsLeft:te,handlePinSubmit:ie,handlePinAcknowledge:De,sessionKicked:Y,kickedMsg:fe,handleKickedAcknowledge:de,handleStart:he,handleConfirmFromSheet:be,handleStartFresh:ye,handleResubmit:ne,handleEditScores:Q,handleFinalSubmit:J,resetAll:Js}}function We(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),e.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function mt(){return e.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]})}function fs(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function Is(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2"}),e.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}function As(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"9"}),e.jsx("path",{d:"M12 8v4"}),e.jsx("path",{d:"M12 16h.01"})]})}function ht(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7-10-7-10-7z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}function pt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3l18 18"}),e.jsx("path",{d:"M10.6 10.6a3 3 0 0 0 4.2 4.2"}),e.jsx("path",{d:"M9.6 5.5A10.8 10.8 0 0 1 12 5c6.5 0 10 7 10 7a17.2 17.2 0 0 1-3.3 4.4"}),e.jsx("path",{d:"M6.3 6.3C3.4 8.1 2 12 2 12s3.5 7 10 7a11 11 0 0 0 4.7-1"})]})}function qe(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M18 21a8 8 0 0 0-16 0"}),e.jsx("circle",{cx:"10",cy:"8",r:"5"}),e.jsx("path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3"})]})}function Fs(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m16 11 2 2 4-4"}),e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"})]})}function Ds(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"}),e.jsx("path",{d:"M8 10v4"}),e.jsx("path",{d:"M12 10v2"}),e.jsx("path",{d:"M16 10v6"})]})}function xt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.6-.8l-1.2-1.6A2 2 0 0 0 7.5 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"}),e.jsx("path",{d:"m9 13 2 2 4-4"})]})}function Ts(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function jt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function ft(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3.85 8.62a4 4 0 1 1 7.29-5.17"}),e.jsx("path",{d:"M3.85 15.38a4 4 0 1 0 7.29 5.17"}),e.jsx("path",{d:"M20.15 8.62a4 4 0 1 0-7.29-5.17"}),e.jsx("path",{d:"M20.15 15.38a4 4 0 1 1-7.29 5.17"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function Ue(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m9 12 2 2 4-4"})]})}function ts(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 6v6l4 2"})]})}function Fe(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M5 2h14"}),e.jsx("path",{d:"M5 22h14"}),e.jsx("path",{d:"M7 2c0 6 10 6 10 10s-10 4-10 10"}),e.jsx("path",{d:"M17 2c0 6-10 6-10 10s10 4 10 10"})]})}function _e(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7 21H3v-4L17 3z"}),e.jsx("path",{d:"m15 5 4 4"})]})}function gt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m3 6 2 2 4-4"}),e.jsx("path",{d:"m3 12 2 2 4-4"}),e.jsx("path",{d:"m3 18 2 2 4-4"}),e.jsx("path",{d:"M11 6h10"}),e.jsx("path",{d:"M11 12h10"}),e.jsx("path",{d:"M11 18h10"})]})}function ve(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 3H2l8 9v7l4 2v-9l8-9z"})})}function Ps(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 3v12"}),e.jsx("path",{d:"m7 10 5 5 5-5"}),e.jsx("path",{d:"M5 21h14"})]})}function Ve(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]})}function Ye(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"m5 12 7-7 7 7"}),e.jsx("path",{d:"M12 19V5"})]})}function Qe(){return e.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M12 5v14"}),e.jsx("path",{d:"m19 12-7 7-7-7"})]})}function ns(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 16v-4"}),e.jsx("path",{d:"M12 8h.01"})]})}function gs(){return e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("circle",{cx:"12",cy:"12",r:"9"})})}function vt(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978"}),e.jsx("path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978"}),e.jsx("path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18"}),e.jsx("path",{d:"M4 22h16"}),e.jsx("path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"}),e.jsx("path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6"})]})}function $s(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 3v18h18"}),e.jsx("path",{d:"M7 14l4-4 3 3 5-6"})]})}function rs(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"9",y:"2",width:"6",height:"4",rx:"1"}),e.jsx("path",{d:"M9 4H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2h-2"})]})}function bt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})]})}function yt(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 10v6"}),e.jsx("path",{d:"M2 10l10-5 10 5-10 5z"}),e.jsx("path",{d:"M6 12v5c3 3 9 3 12 0v-5"})]})}function _s(){return e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7"}),e.jsx("path",{d:"M20 20l-3.5-3.5"})]})}function as(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 6l12 12M18 6l-12 12"})})}function Re(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M5 12l4 4 10-10"})})}function kt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 2v6h-6"}),e.jsx("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),e.jsx("path",{d:"M3 22v-6h6"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]})}function Nt(){return e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})}function Rs(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function Bs(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function Oe(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function wt({juryName:s,setJuryName:t,juryDept:r,setJuryDept:a,onStart:n,onBack:l}){const o=s.trim().length>0&&r.trim().length>0;return e.jsxs("div",{className:"form-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:l,"aria-label":"Back to home",children:e.jsx(We,{})}),e.jsxs("div",{className:"form-title-wrap",children:[e.jsx("div",{className:"form-title-row",children:e.jsx("h2",{children:"Evaluation Form"})}),e.jsx("p",{children:"EE 492 ‚Äî Senior Project Poster Day"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:"Jury Member Information"}),e.jsxs("div",{className:"identity-warning",children:[e.jsx("span",{className:"warning-icon","aria-hidden":"true",children:e.jsx(As,{})}),e.jsx("span",{children:"Please enter your name and department carefully. Once you begin the evaluation, these cannot be changed."})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:s,onChange:j=>t(j.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department / Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:j=>a(j.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:j=>{j.key==="Enter"&&o&&n()}})]}),e.jsx("p",{className:"draft-device-note",children:"‚ÑπÔ∏è Scores save automatically as you fill each field or switch groups. Next, we‚Äôll authenticate your session and ask for your PIN so you can continue from any device."}),e.jsxs("div",{className:"trust-note",children:[e.jsx(Is,{}),"Authenticating session before PIN verification"]}),e.jsx("button",{className:"btn-primary",disabled:!o,onClick:n,children:"Start Evaluation ‚Üí"})]})]})}function St({onSubmit:s,pinError:t}){const[r,a]=d.useState(["","","",""]),n=[d.useRef(null),d.useRef(null),d.useRef(null),d.useRef(null)];d.useEffect(()=>{t&&(a(["","","",""]),setTimeout(()=>{var i;return(i=n[0].current)==null?void 0:i.focus()},50))},[t]);function l(i,p){var w;const h=p.replace(/\D/g,"").slice(-1),C=[...r];C[i]=h,a(C),h&&i<3&&((w=n[i+1].current)==null||w.focus())}function o(i,p){var h,C,w;if(p.key==="Backspace")if(r[i]===""&&i>0){const k=[...r];k[i-1]="",a(k),(h=n[i-1].current)==null||h.focus()}else{const k=[...r];k[i]="",a(k)}if(p.key==="ArrowLeft"&&i>0&&((C=n[i-1].current)==null||C.focus()),p.key==="ArrowRight"&&i<3&&((w=n[i+1].current)==null||w.focus()),p.key==="Enter"){const k=r.join("");k.length===4&&s(k)}}function j(i){var h;const p=i.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(p.length===4){const C=p.split("");a(C),(h=n[3].current)==null||h.focus()}i.preventDefault()}function x(){const i=r.join("");i.length===4&&s(i)}const c=r.every(i=>i!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((i,p)=>e.jsx("input",{ref:n[p],type:"password",inputMode:"numeric",maxLength:1,value:i,autoFocus:p===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:h=>l(p,h.target.value),onKeyDown:h=>o(p,h),onPaste:p===0?j:void 0,className:"pin-box"},p))}),e.jsx("button",{className:"btn-primary pin-ok-btn",onClick:x,disabled:!c,children:"OK ‚Üí"})]})}function Ct({pinStep:s,pinError:t,newPin:r,attemptsLeft:a,juryName:n,onPinSubmit:l,onPinAcknowledge:o}){return s==="new"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(fs,{})}),e.jsx("h3",{children:"Your Access PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome, ",e.jsx("strong",{children:n}),"! A 4-digit PIN has been assigned to protect your evaluations. Please save it ‚Äî you will need it every time you log in from a new device or browser tab."]}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((j,x)=>e.jsx("span",{className:"pin-digit",children:j},x))}),e.jsx("p",{className:"pin-hint",children:"üîí Keep this PIN private. If you lose it, contact the admin to reset it."}),e.jsx("button",{className:"btn-primary",onClick:o,children:"I've saved my PIN ‚Äî Continue ‚Üí"})]})}):s==="locked"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap lock-icon",children:"üîí"}),e.jsx("h3",{children:"Account Locked"}),e.jsx("p",{className:"pin-error-msg",children:t})]})}):e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(fs,{})}),e.jsx("h3",{children:"Enter Your PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome back, ",e.jsx("strong",{children:n}),". Enter your 4-digit PIN and press OK to continue."]}),e.jsx(St,{onSubmit:l,pinError:t}),t&&e.jsx("div",{className:"pin-error-msg",children:t})]})})}function Lt(s){return s===0?"#e2e8f0":s<34?"linear-gradient(90deg,#ef4444,#f97316)":s<67?"linear-gradient(90deg,#f97316,#eab308)":s<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function Mt({saveStatus:s}){return s==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"‚è≥ Saving‚Ä¶"}):s==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"‚úì Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"‚óè Auto-saving"})}function Et({juryName:s,juryDept:t,current:r,onNavigate:a,scores:n,comments:l,touched:o,groupSynced:j,editMode:x,progressPct:c,allComplete:i,saveStatus:p,handleScore:h,handleScoreBlur:C,handleCommentChange:w,handleCommentBlur:k,handleFinalSubmit:u,onGoHome:N}){var E;const[f,b]=d.useState(!1),[A,T]=d.useState(null),y=G[r],g=(v,I)=>{const V=ee.filter(X=>{var K;return((K=n[v.id])==null?void 0:K[X.id])!==""}).length;return`${ke(n,v.id)?"‚úÖ":"‚ö†Ô∏è"} ${v.name} (${V}/${ee.length})`},D=()=>{r>0&&a(r-1)},S=()=>{r<G.length-1&&a(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"üë§"}),e.jsxs("span",{className:"eval-identity-text",children:[s,t&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",t,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(Mt,{saveStatus:p})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>b(!0),"aria-label":"Home",children:e.jsx(We,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:y.name}),e.jsx("span",{className:"eval-project-name",children:y.desc})]}),((E=y.students)==null?void 0:E.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["üë• ",y.students.join(" ¬∑ ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:D,disabled:r===0,"aria-label":"Previous group",children:e.jsx(Rs,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:v=>a(Number(v.target.value)),children:G.map((v,I)=>e.jsx("option",{value:I,children:g(v)},v.id))}),e.jsx("button",{className:"group-nav-btn",onClick:S,disabled:r===G.length-1,"aria-label":"Next group",children:e.jsx(Bs,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${c}%`,background:Lt(c)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(c),"%"]})]})})]}),f&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"back-menu",onClick:v=>v.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{b(!1),N()},children:"üè† Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>b(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[j[y.id]&&!x&&e.jsx("div",{className:"group-done-banner",children:"‚úÖ All scores saved for this group."}),x&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["‚úèÔ∏è Edit mode ‚Äî adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),ee.map(v=>{var X,K;const I=((X=n[y.id])==null?void 0:X[v.id])??"",V=((K=o[y.id])==null?void 0:K[v.id])&&I==="",$=(parseInt(I,10)||0)/v.max*100;return e.jsxs("div",{className:`crit-card${V?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:v.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",v.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>T(A===v.id?null:v.id),children:A===v.id?"Hide Rubric ‚ñ≤":"Show Rubric ‚ñº"})]}),A===v.id&&e.jsx("div",{className:"rubric-table",children:v.rubric.map(te=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:te.range}),e.jsx("div",{className:"rubric-level",children:te.level}),e.jsx("div",{className:"rubric-desc",children:te.desc})]},te.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:v.max,value:I,onChange:te=>h(y.id,v.id,te.target.value),onBlur:()=>C(y.id,v.id),placeholder:"‚Äî",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${$}%`}})}),e.jsx("span",{className:"score-pct",children:I!==""?`${I} / ${v.max}`:`‚Äî / ${v.max}`})]}),V&&e.jsx("div",{className:"required-hint",children:"Required"})]},v.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:l[y.id]||"",onChange:v=>w(y.id,v.target.value),onBlur:()=>k(y.id),placeholder:"Any additional feedback about this group‚Ä¶",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const v=ee.reduce((I,V)=>{var $;return I+(parseInt(($=n[y.id])==null?void 0:$[V.id],10)||0)},0);return e.jsxs("span",{className:`total-score${v>=80?" high":v>=60?" mid":""}`,children:[v," / 100"]})})()]}),x&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:i?1:.65},onClick:u,children:i?"‚úÖ Submit Final":`‚ö†Ô∏è Submit Final (${Es(n)} / ${G.length*ee.length} filled)`})]})]})}function It(s,t){return ee.reduce((r,a)=>{var n;return r+(parseInt((n=s[t])==null?void 0:n[a.id],10)||0)},0)}function At({doneScores:s,scores:t,onEditScores:r,onBack:a}){const n=s||t,[l,o]=d.useState(new Set);function j(x){o(c=>{const i=new Set(c);return i.has(x)?i.delete(x):i.add(x),i})}return e.jsx("div",{className:"done-screen",children:e.jsxs("div",{className:"done-card",children:[e.jsx("div",{className:"done-icon",children:"üéâ"}),e.jsx("h2",{children:"Thank You!"}),e.jsx("p",{className:"done-subtitle",children:"Your evaluations have been recorded‚Äîthank you for your feedback."}),e.jsx("div",{className:"done-summary",children:G.map(x=>{var h,C;const c=l.has(x.id),i=`done-group-panel-${x.id}`,p=!!x.desc||((h=x.students)==null?void 0:h.length)>0;return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:p?0:-1,"aria-expanded":c,"aria-controls":i,onClick:()=>{p&&j(x.id)},onKeyDown:w=>{(w.key==="Enter"||w.key===" ")&&p&&(w.preventDefault(),j(x.id))},style:{cursor:p?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:x.name}),p&&e.jsx("span",{className:`group-accordion-chevron${c?" open":""}`,children:e.jsx(Oe,{})})]})}),e.jsx("div",{className:"done-row-right",children:e.jsxs("span",{className:"done-score",children:[e.jsx("span",{className:"done-score-main",children:It(n,x.id)}),e.jsx("span",{className:"done-score-max",children:" / 100"})]})})]}),e.jsx("div",{id:i,className:`group-accordion-panel${c?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[x.desc&&e.jsx("span",{className:"done-row-desc",children:x.desc}),((C=x.students)==null?void 0:C.length)>0&&e.jsxs("span",{className:"done-row-students",children:["üë• ",x.students.join(" ¬∑ ")]})]})})]},x.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:r,children:"‚úèÔ∏è Edit Scores"}),e.jsxs("button",{className:"btn-primary",onClick:a,children:[e.jsx(We,{})," Back to Home"]})]})]})})}function Ft(s){return s==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:s==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:s==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"‚Äî",color:"#64748b",bg:"#f1f5f9"}}function Pe({progress:s,onConfirm:t,onFresh:r}){if(!s)return null;if(s.loading)return e.jsx("div",{className:"spd-overlay",children:e.jsx("div",{className:"spd-card",children:e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon spd-icon-animated","aria-hidden":"true",children:e.jsx(Fe,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:"Authenticating your session‚Ä¶"}),e.jsx("div",{className:"spd-sub",children:"Connecting to server"})]})]})})});const{rows:a,filledCount:n,totalCount:l,allSubmitted:o}=s,j=a&&a.length>0;return e.jsx("div",{className:"spd-overlay",children:e.jsxs("div",{className:"spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon spd-icon-state","aria-hidden":"true",children:o?e.jsx(ft,{}):j?e.jsx(mt,{}):e.jsx(rs,{})}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:o?"All evaluations submitted":j?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[n," / ",l," groups completed on server"]})]})]}),j&&e.jsx("div",{className:"spd-list",children:G.map(x=>{const c=a.find(h=>Number(h.projectId)===x.id),i=Ft(c==null?void 0:c.status),p=(c==null?void 0:c.total)??"‚Äî";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:x.name}),e.jsx("span",{className:"spd-row-total",children:p!=="‚Äî"?`${p}/100`:"‚Äî"}),e.jsx("span",{className:"spd-chip",style:{color:i.color,background:i.bg},children:i.label})]},x.id)})}),!j&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"btn-primary",onClick:t,children:o?"View / Edit My Scores":j?"Continue from here":"Start Evaluation"}),j&&!o&&e.jsx("button",{className:"btn-secondary",onClick:r,children:"Start Fresh"})]})]})})}function Dt({onBack:s}){const{step:t,juryName:r,setJuryName:a,juryDept:n,setJuryDept:l,current:o,handleNavigate:j,scores:x,comments:c,touched:i,groupSynced:p,editMode:h,progressPct:C,allComplete:w,doneScores:k,doneComments:u,sheetProgress:N,saveStatus:f,pinStep:b,pinError:A,newPin:T,attemptsLeft:y,handleScore:g,handleScoreBlur:D,handleCommentChange:S,handleCommentBlur:E,handleStart:v,handleConfirmFromSheet:I,handleStartFresh:V,handleResubmit:$,handleEditScores:X,handleFinalSubmit:K,handlePinSubmit:te,handlePinAcknowledge:q,sessionKicked:Y,kickedMsg:oe,handleKickedAcknowledge:fe,resetAll:ce}=ut();return Y?e.jsx("div",{className:"kicked-overlay",children:e.jsxs("div",{className:"kicked-card",children:[e.jsx("div",{className:"kicked-icon",children:"üîê"}),e.jsx("div",{className:"kicked-title",children:"Session Ended"}),e.jsx("div",{className:"kicked-body",children:oe}),e.jsx("button",{className:"btn-primary",onClick:fe,children:"Sign in again"})]})}):t==="done"?e.jsxs(e.Fragment,{children:[e.jsx(At,{doneScores:k,doneComments:u,scores:x,comments:c,onEditScores:X,onBack:()=>{ce(),s()}}),e.jsx(Pe,{progress:N,onConfirm:I,onFresh:V})]}):t==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(Ct,{pinStep:b,pinError:A,newPin:T,attemptsLeft:y,juryName:r,onPinSubmit:te,onPinAcknowledge:q}),e.jsx(Pe,{progress:N,onConfirm:I,onFresh:V})]}):t==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(Et,{juryName:r,juryDept:n,current:o,onNavigate:j,scores:x,comments:c,touched:i,groupSynced:p,editMode:h,progressPct:C,allComplete:w,saveStatus:f,handleScore:g,handleScoreBlur:D,handleCommentChange:S,handleCommentBlur:E,handleFinalSubmit:K,onGoHome:s}),e.jsx(Pe,{progress:N,onConfirm:I,onFresh:V})]}):e.jsxs(e.Fragment,{children:[e.jsx(wt,{juryName:r,setJuryName:a,juryDept:n,setJuryDept:l,onStart:v,onBack:s}),e.jsx(Pe,{progress:N,onConfirm:I,onFresh:V})]})}const Tt="modulepreload",Pt=function(s){return"/senior-design-jury/"+s},vs={},$t=function(t,r,a){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(l=>{if(l=Pt(l),l in vs)return;vs[l]=!0;const o=l.endsWith(".css"),j=o?'[rel="stylesheet"]':"";if(!!a)for(let i=n.length-1;i>=0;i--){const p=n[i];if(p.href===l&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${j}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Tt,o||(c.as="script",c.crossOrigin=""),c.href=l,document.head.appendChild(c),o)return new Promise((i,p)=>{c.addEventListener("load",i),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t()).catch(l=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l})},_t=new Map(G.map((s,t)=>typeof s=="string"?[t+1,{desc:"",students:[]}]:[s.id??t+1,{desc:s.desc??"",students:s.students??[]}]));function Rt(s){const t=Number(String(s??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(t)?t:0}function ze(s){if(!s)return 0;const t=String(s).trim().replace(/\s*,\s*/g,", "),r=Date.parse(t);if(Number.isFinite(r))return r;const a=t.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(a)return new Date(+a[3],+a[2]-1,+a[1],+a[4],+a[5],+(a[6]||0)).getTime()||0;const n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let l=+(n[4]||0);const o=(n[7]||"").toUpperCase();return o==="PM"&&l<12&&(l+=12),o==="AM"&&l===12&&(l=0),new Date(+n[3],+n[1]-1,+n[2],l,+(n[5]||0),+(n[6]||0)).getTime()||0}function Ze(s){if(!s)return"‚Äî";const t=ze(s);if(!t)return String(s);const r=new Date(t),a=n=>String(n).padStart(2,"0");return`${a(r.getDate())}/${a(r.getMonth()+1)}/${r.getFullYear()} ${a(r.getHours())}:${a(r.getMinutes())}`}function xe(s,t){const r=Number(s),a=Number(t);return Number.isFinite(r)&&Number.isFinite(a)?r-a:String(s??"").toLowerCase()<String(t??"").toLowerCase()?-1:1}function Ws(s){let t=2166136261;for(let r=0;r<s.length;r++)t^=s.charCodeAt(r),t=Math.imul(t,16777619);return t>>>0}function Os(s,t,r){t/=100,r/=100;const a=o=>(o+s/30)%12,n=t*Math.min(r,1-r),l=o=>Math.round(255*(r-n*Math.max(-1,Math.min(a(o)-3,Math.min(9-a(o),1))))).toString(16).padStart(2,"0");return`#${l(0)}${l(8)}${l(4)}`}const Bt=s=>Os(Ws(s||"?")%360,55,95),Wt=s=>Os(Ws(s||"?")%360,65,55);function Ce(s){return s===""||s===null||s===void 0||typeof s=="string"&&s.trim()===""||typeof s=="number"&&!Number.isFinite(s)?"":s}async function Ot(s){const t=await $t(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],a=s.map(c=>{const i=_t.get(c.projectId)||{desc:"",students:[]};return[c.juryName??"",c.juryDept??"",c.timestamp??"",c.projectName??"",i.desc,i.students.join(" ¬∑ "),Ce(c.technical),Ce(c.design),Ce(c.delivery),Ce(c.teamwork),Ce(c.total),c.comments??""]}),n=t.utils.aoa_to_sheet([r,...a]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(c=>({wch:c}));const l=t.utils.book_new();t.utils.book_append_sheet(l,n,"Jury Evaluations");const o=new Date,j=o.toISOString().slice(0,10),x=`${String(o.getHours()).padStart(2,"0")}-${String(o.getMinutes()).padStart(2,"0")}`;t.writeFile(l,`jury_export_${j}_${x}.xlsx`)}const zt=s=>s.reduce((t,r)=>t+ee.filter(a=>r[a.id]>0).length,0),Jt=s=>{const t=G.length*ee.length;return t===0?0:Math.round(zt(s)/t*100)};function Gt(s){const t={all_submitted:3,group_submitted:2,in_progress:1},r=(s||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:ze(n==null?void 0:n.timestamp)})),a=new Map;for(const n of r){const l=String(n.juryName??"").trim().toLowerCase(),o=String(n.juryDept??"").trim().toLowerCase(),j=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!l||!j)continue;const x=`${l}__${o}__${j}`,c=a.get(x);if(!c){a.set(x,n);continue}if((n.tsMs||0)>(c.tsMs||0)){a.set(x,n);continue}(n.tsMs||0)===(c.tsMs||0)&&(t[n.status]||0)>(t[c.status]||0)&&a.set(x,n)}return[...a.values()].sort((n,l)=>(l.tsMs||0)-(n.tsMs||0))}function Ae({status:s,editingFlag:t,variant:r,icon:a,children:n}){return r||a||n?e.jsxs("span",{className:`status-badge${r?` ${r}`:""}`,children:[a,n]}):t==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(_e,{}),"Editing"]}):s==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Re,{}),"Submitted"]}):s==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Re,{}),"Submitted"]}):s==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(Fe,{}),"In Progress"]}):null}const Ht="/senior-design-jury/assets/1st-place-medal-cb397e4c.svg",Kt="/senior-design-jury/assets/2nd-place-medal-9ec5b4d1.svg",qt="/senior-design-jury/assets/3rd-place-medal-7ad05fc8.svg",Ut=ee.map(s=>({id:s.id,label:s.label,shortLabel:s.shortLabel,max:s.max})),Vt=[Ht,Kt,qt];function Yt({ranked:s,submittedData:t}){const[r,a]=d.useState(new Set);function n(l){a(o=>{const j=new Set(o);return j.has(l)?j.delete(l):j.add(l),j})}return t.length===0?e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."}):e.jsxs("div",{className:"summary-page",children:[e.jsxs("div",{className:"summary-note",children:[e.jsx(ns,{}),"The scores shown are ",e.jsx("strong",{children:"average (Œ£)"})," group scores from ",e.jsx("strong",{children:"completed"})," evaluations."]}),e.jsx("div",{className:"rank-list",children:s.map((l,o)=>{var T,y;const j=l.id??o+1,x=`Group ${j}`,c=(l.name||"").trim(),i=(l.desc||"").trim(),p=!c||c===x,h=p?i||x:c,w=p?i:i&&i!==h?i:"",k=!p&&h&&h!==x,u=`summary-${j}-${o}`,N=r.has(u),f=k||!!w||((T=l.students)==null?void 0:T.length)>0,b=o<3,A=`summary-group-panel-${u}`;return e.jsxs("div",{className:`rank-card rank-${o+1} ${b?`rank-top${o+1}`:"rank-rest"}`,children:[b&&e.jsx("span",{className:`rank-accent rank-${o+1}`,"aria-hidden":"true"}),b?e.jsxs("div",{className:`rank-badge rank-medal-wrap rank-${o+1}`,"aria-hidden":"true",children:[e.jsx("span",{className:"rank-medal-ring","aria-hidden":"true"}),e.jsx("img",{className:"rank-medal",src:Vt[o],alt:`${o+1} place medal`})]}):e.jsx("div",{className:"rank-badge rank-num",children:o+1}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"group-card-wrap",children:[e.jsxs("div",{className:"group-card-header",children:[e.jsxs("div",{className:"group-card-left",children:[e.jsxs("button",{className:"group-card-toggle group-accordion-header",tabIndex:f?0:-1,"aria-expanded":f?N:void 0,"aria-controls":f?A:void 0,type:"button",onClick:()=>{f&&n(u)},onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&f&&(g.preventDefault(),n(u))},style:{cursor:f?"pointer":"default"},children:[e.jsx("span",{className:"group-card-name",children:x}),f&&e.jsx("span",{className:`group-accordion-chevron${N?" open":""}`,children:e.jsx(Oe,{})})]}),e.jsxs("span",{className:`eval-badge${b?" full":" partial"}`,children:[e.jsx(qe,{}),l.count]})]}),e.jsxs("div",{className:"group-card-score",children:[e.jsx("small",{className:"group-card-score-label sigma",children:"Œ£"}),e.jsx("span",{className:"group-card-score-value avg-score",children:l.totalAvg.toFixed(2)})]})]}),e.jsx("div",{id:A,className:`group-accordion-panel${N?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner group-card-accordion-inner",children:[k&&e.jsx("div",{className:"group-card-full-title",children:h}),w&&e.jsxs("div",{className:"group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ds,{})}),e.jsx("span",{className:"group-card-desc-text",children:w})]}),((y=l.students)==null?void 0:y.length)>0&&e.jsxs("div",{className:"group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(qe,{})}),e.jsx("span",{className:"group-card-students-text",children:l.students.join(" ¬∑ ")})]})]})})]}),e.jsx("div",{className:"rank-bars",children:Ut.map(g=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:g.shortLabel||g.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(l.avg[g.id]||0)/g.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(l.avg[g.id]||0).toFixed(2)})]},g.id))})]})]},l.id??`${l.name}-${o}`)})})]})}const Qt=["9.1","9.2","1.2","2","3.1","3.2","8.1","8.2"],ae=ee.map(s=>({key:s.id,code:s.mudek.join("/"),label:s.shortLabel,max:s.max,color:s.color}));function zs(s){if(s.length<2)return 0;const t=s.reduce((r,a)=>r+a,0)/s.length;return Math.sqrt(s.reduce((r,a)=>r+(a-t)**2,0)/s.length)}function is(s){return s.length?s.reduce((t,r)=>t+r,0)/s.length:0}function Ge(s,t){if(!s.length)return 0;const r=(s.length-1)*t,a=Math.floor(r),n=r-a;return s[a+1]===void 0?s[a]:s[a]+n*(s[a+1]-s[a])}function Zt(s,t){return s.map(r=>Number(r[t])).filter(r=>Number.isFinite(r))}function bs(s){const[t,r]=String(s).split("."),a=parseInt(t,10),n=parseInt(r??"0",10);return{major:Number.isFinite(a)?a:0,minor:Number.isFinite(n)?n:0}}function Xt(s,t){const r=bs(s),a=bs(t);return r.major!==a.major?r.major-a.major:r.minor!==a.minor?r.minor-a.minor:String(s).localeCompare(String(t))}function we({msg:s}){return e.jsx("div",{className:"chart-empty",children:s||"Not enough data yet."})}function en({codes:s}){const[t,r]=d.useState("en"),[a,n]=d.useState(""),l=(s||[]).map(c=>({code:c,...rt[c]||{}})).filter(c=>c.code&&(c.en||c.tr)).sort((c,i)=>Xt(c.code,i.code)),o=a.trim().toLowerCase(),j=o?l.filter(c=>{const i=(c.en||"").toLowerCase(),p=(c.tr||"").toLowerCase();return(c.code||"").toLowerCase().includes(o)||i.includes(o)||p.includes(o)}):l,x=c=>{const i=c.en||"",p=c.tr||"";return t==="tr"?e.jsx("div",{className:"mudek-outcome-text",children:p||i}):e.jsx("div",{className:"mudek-outcome-text",children:i||p})};return e.jsxs("div",{className:"mudek-outcomes",children:[e.jsxs("div",{className:"mudek-outcomes-controls",children:[e.jsxs("label",{className:"mudek-search","aria-label":"Search outcomes",children:[e.jsx("span",{className:"mudek-search-icon","aria-hidden":"true",children:e.jsx(_s,{})}),e.jsx("input",{value:a,onChange:c=>n(c.target.value),placeholder:"Search by code or text"})]}),e.jsx("button",{type:"button",className:"mudek-lang-toggle",onClick:()=>r(c=>c==="en"?"tr":"en"),"aria-label":t==="en"?"Switch to Turkish":"Switch to English",title:t==="en"?"T√ºrk√ße":"English",children:e.jsx("span",{"aria-hidden":"true",children:t==="en"?"üá¨üáß":"üáπüá∑"})}),o&&e.jsxs("span",{className:"mudek-results-count",children:[j.length," results"]})]}),j.length===0&&e.jsx("div",{className:"mudek-empty",children:"No outcomes match your search."}),e.jsx("div",{className:"mudek-table-scroll",children:e.jsxs("div",{className:"mudek-outcomes-table",children:[e.jsxs("div",{className:"mudek-outcomes-head",children:[e.jsx("div",{className:"mudek-col-code",children:t==="tr"?"Kod":"Code"}),e.jsx("div",{className:"mudek-col-outcome",children:t==="tr"?"√áƒ±ktƒ±":"Outcome"})]}),e.jsx("div",{className:"mudek-outcomes-body",children:j.map(c=>e.jsxs("div",{className:"mudek-outcomes-row",children:[e.jsx("div",{className:"mudek-col-code",children:e.jsx("span",{className:"mudek-code",children:c.code})}),e.jsx("div",{className:"mudek-col-outcome",children:x(c)})]},c.code))})]})})]})}function sn(){return e.jsx("div",{className:"mudek-rubric-list",children:ee.map(s=>{const t=nt;return e.jsxs("div",{className:"mudek-rubric-criterion",children:[e.jsxs("div",{className:"mudek-rubric-criterion-title",children:[s.label,e.jsxs("span",{className:"mudek-rubric-criterion-meta",children:["(",s.mudek.join(", "),") ¬∑ max ",s.max," pts"]})]}),e.jsx("div",{className:"mudek-table-scroll",children:e.jsxs("table",{className:"mudek-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Range"}),e.jsx("th",{children:"Level"}),e.jsx("th",{children:"Description"})]})}),e.jsx("tbody",{children:s.rubric.map(r=>{const a=t[r.level]||{};return e.jsxs("tr",{children:[e.jsx("td",{"data-label":"Range",children:r.range}),e.jsx("td",{"data-label":"Level",children:e.jsx("span",{className:"mudek-band-badge",style:{background:a.bg,color:a.text},children:r.level})}),e.jsx("td",{"data-label":"Description",children:r.desc})]},r.level)})})]})})]},s.id)})})}function tn({outcomeCodes:s=Qt}){const[t,r]=d.useState(!1),[a,n]=d.useState("outcomes"),l=d.useRef(null),o=d.useRef(null);return d.useEffect(()=>{if(!t)return;function j(x){l.current&&!l.current.contains(x.target)&&r(!1)}return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[t]),d.useEffect(()=>{if(!t)return;function j(x){var c;x.key==="Escape"&&(r(!1),(c=o.current)==null||c.focus())}return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[t]),e.jsxs("div",{className:"mudek-badge-wrap",ref:l,children:[e.jsxs("button",{ref:o,className:"mudek-badge",onClick:()=>r(j=>!j),"aria-label":"M√úDEK outcome mapping","aria-expanded":t,children:[e.jsx(yt,{}),e.jsx("span",{children:"M√úDEK"}),e.jsx("span",{className:`mudek-chevron${t?" open":""}`,"aria-hidden":"true",children:e.jsx(Oe,{})})]}),t&&e.jsxs("div",{className:"mudek-dropdown",role:"dialog","aria-label":"M√úDEK outcome mapping",children:[e.jsxs("div",{className:"mudek-dropdown-header",children:[e.jsx("span",{children:"M√úDEK Outcome Mapping"}),e.jsx("button",{className:"mudek-dropdown-close",onClick:()=>{var j;r(!1),(j=o.current)==null||j.focus()},"aria-label":"Close",children:"‚úï"})]}),e.jsxs("div",{className:"mudek-tabs",children:[e.jsx("button",{className:`mudek-tab-btn${a==="outcomes"?" active":""}`,onClick:()=>n("outcomes"),children:"M√úDEK Outcomes"}),e.jsx("button",{className:`mudek-tab-btn${a==="rubric"?" active":""}`,onClick:()=>n("rubric"),children:"Rubric Bands"})]}),e.jsxs("div",{className:"mudek-dropdown-body",children:[a==="outcomes"&&e.jsx(en,{codes:s}),a==="rubric"&&e.jsx(sn,{})]}),e.jsx("div",{className:"mudek-dropdown-footer",children:"‚Ñπ This chart provides evidence for the outcomes above."})]})]})}function nn({data:s}){const t=s||[];if(!t.length)return e.jsx(we,{});const r=ae.map(u=>{const N=Zt(t,u.key),f=N.length?is(N):0,b=u.max>0?f/u.max*100:0,A=N.length>1?zs(N)/u.max*100:0;return{...u,avgRaw:f,pct:b,sd:A,n:N.length}}),a=38,n=22,l=34,o=8,j=22,x=20,c=160,i=r.length,p=l+i*a+(i-1)*n+o,h=j+c+x,C=u=>l+u*(a+n),w=u=>C(u)+a/2,k=u=>j+c*(1-Math.max(0,Math.min(100,u))/100);return e.jsxs("div",{className:"chart-card chart-compact-equal chart-fill-card dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Programme-Level Outcome Averages"}),e.jsx("div",{className:"chart-note",children:"Grand mean ¬±1 SD normalized score per outcome across all groups and jurors."})]})}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${p} ${h}`,preserveAspectRatio:"xMidYMid meet",style:{width:"100%",height:"100%",display:"block"},children:[[0,25,50,75,100].map(u=>{const N=k(u);return e.jsxs("g",{children:[e.jsx("line",{x1:l,y1:N,x2:p-o,y2:N,stroke:u===0?"#cbd5e1":"#e2e8f0",strokeWidth:u===0?1.2:1}),e.jsx("text",{className:"chart-y-tick",x:l-4,y:N+3.5,textAnchor:"end",fontSize:"7",fill:"#94a3b8",children:u})]},u)}),e.jsx("text",{className:"chart-y-label",x:"10",y:j+c/2,transform:`rotate(-90 10 ${j+c/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((u,N)=>{const f=C(N),b=w(N),A=k(u.pct),T=c-(A-j),y=k(u.pct+u.sd),g=k(Math.max(0,u.pct-u.sd));return e.jsxs("g",{children:[e.jsxs("title",{children:[u.label," (",u.code,")",`
`,"Grand mean: ",u.pct.toFixed(1),"%",`
`,"SD: ¬±",u.sd.toFixed(1),"%",`
`,"N evaluations: ",u.n]}),e.jsx("rect",{x:f,y:j,width:a,height:c,rx:"3",fill:"#f1f5f9"}),T>0&&e.jsx("rect",{x:f,y:A,width:a,height:T,rx:"3",fill:u.color}),u.sd>0&&e.jsxs(e.Fragment,{children:[e.jsxs("g",{stroke:"#ffffff",strokeWidth:"3.2",strokeLinecap:"round",opacity:"0.65",children:[e.jsx("line",{x1:b,y1:y,x2:b,y2:g}),e.jsx("line",{x1:b-7,y1:y,x2:b+7,y2:y}),e.jsx("line",{x1:b-7,y1:g,x2:b+7,y2:g})]}),e.jsxs("g",{stroke:"#6b7280",strokeWidth:"1.2",strokeLinecap:"round",opacity:"0.75",children:[e.jsx("line",{x1:b,y1:y,x2:b,y2:g}),e.jsx("line",{x1:b-7,y1:y,x2:b+7,y2:y}),e.jsx("line",{x1:b-7,y1:g,x2:b+7,y2:g}),e.jsx("circle",{cx:b,cy:y,r:"1.6",fill:"#6b7280",stroke:"none"}),e.jsx("circle",{cx:b,cy:g,r:"1.6",fill:"#6b7280",stroke:"none"})]})]}),e.jsx("text",{className:"chart-bar-value",x:b,y:A+T/2+3,textAnchor:"middle",fontSize:"9",fill:"#ffffff",stroke:"rgba(15,23,42,0.35)",strokeWidth:"0.8",fontWeight:"700",style:{paintOrder:"stroke"},children:u.pct.toFixed(1)}),e.jsx("text",{className:"chart-x-label",x:b,y:j+c+13,textAnchor:"middle",fontSize:"8.5",fill:"#374151",fontWeight:"500",children:u.label})]},u.key)})]})})]})}function rn({stats:s}){const t=s.filter(p=>p.count>0);if(!t.length)return e.jsx(we,{});const r=14,a=4,n=ae.length*(r+a)+12,l=8,o=130,j=28,x=t.length*n+j+10,c=o+l,i=l+(o-ls/100*o);return e.jsxs("div",{className:"chart-card chart-compact-equal",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Outcome Achievement by Group"}),e.jsx("div",{className:"chart-note",children:"Compares each group's normalized score across all four M√úDEK-mapped criteria."})]})}),e.jsx("div",{className:"chart-svg-wrap",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${x} ${c+36}`,style:{width:"100%",height:"auto",display:"block"},children:[e.jsx("text",{x:"10",y:l+o/2,transform:`rotate(-90 10 ${l+o/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),[0,25,50,75,100].map(p=>{const h=l+(o-p/100*o);return e.jsxs("g",{children:[e.jsx("line",{x1:j,y1:h,x2:x,y2:h,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:j-4,y:h+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:p})]},p)}),e.jsx("g",{children:e.jsx("line",{x1:j,y1:i,x2:x,y2:i,stroke:"#6B7280",strokeWidth:"1",strokeDasharray:"3,3"})}),t.map((p,h)=>{const C=j+h*n+4;return e.jsxs("g",{children:[ae.map((w,k)=>{const u=(p.avg[w.key]||0)/w.max*100,N=u/100*o,f=C+k*(r+a);return e.jsxs("g",{children:[e.jsxs("title",{children:[p.name," ¬∑ ",w.label,": ",u.toFixed(1),"%"]}),e.jsx("rect",{x:f,y:l+(o-N),width:r,height:N,fill:w.color,rx:"2",opacity:"0.85"})]},w.key)}),e.jsx("text",{x:C+ae.length*(r+a)/2-a/2,y:l+o+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:p.name})]},p.id)})]})}),e.jsxs("div",{className:"chart-legend",children:[ae.map(p=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:p.color}}),p.label]},p.key)),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-line","aria-hidden":"true"}),"Reference (",ls,"%)"]})]})]})}function an({stats:s}){var N;const t=s.filter(f=>f.count>0),[r,a]=d.useState(((N=t[0])==null?void 0:N.id)??null);if(!t.length)return e.jsx(we,{});const n=t.find(f=>f.id===(r??t[0].id))??t[0],l=ae.length,o=130,j=120,x=82,c=f=>Math.PI*2*f/l-Math.PI/2,i=(f,b)=>({x:o+b*Math.cos(c(f)),y:j+b*Math.sin(c(f))}),p=ae.map(f=>(n.avg[f.key]||0)/f.max*100),h=ae.map(f=>{const b=t.map(A=>(A.avg[f.key]||0)/f.max*100);return is(b)}),C=p.map((f,b)=>i(b,f/100*x)),w=h.map((f,b)=>i(b,f/100*x)),k=C.map((f,b)=>`${b===0?"M":"L"}${f.x.toFixed(1)},${f.y.toFixed(1)}`).join(" ")+" Z",u=w.map((f,b)=>`${b===0?"M":"L"}${f.x.toFixed(1)},${f.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Competency Profile per Group"}),e.jsx("div",{className:"chart-note",children:"Shows whether a group's competency development is balanced or skewed across all four outcomes."})]})}),t.length>1&&e.jsx("select",{className:"radar-group-select",value:r??t[0].id,onChange:f=>a(Number(f.target.value)),children:t.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))}),e.jsx("div",{className:"chart-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:"0 0 260 240",preserveAspectRatio:"xMidYMid meet",style:{width:"100%",maxWidth:280,height:"100%",display:"block"},children:[[.25,.5,.75,1].map(f=>{const A=ae.map((T,y)=>i(y,f*x)).map((T,y)=>`${y===0?"M":"L"}${T.x.toFixed(1)},${T.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:A,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},f)}),[.25,.5,.75,1].map(f=>{const b=i(0,f*x);return e.jsxs("text",{x:b.x.toFixed(1),y:(b.y-6).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:[Math.round(f*100),"%"]},`tick-${f}`)}),ae.map((f,b)=>{const A=i(b,x);return e.jsx("line",{x1:o,y1:j,x2:A.x.toFixed(1),y2:A.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},b)}),e.jsx("path",{d:u,fill:"none",stroke:"#9CA3AF",strokeWidth:"1.5",strokeDasharray:"4,3"}),e.jsx("path",{d:k,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.2",strokeLinejoin:"round"}),C.map((f,b)=>e.jsxs("g",{children:[e.jsxs("title",{children:[ae[b].label,": ",p[b].toFixed(1),"%",`
`,"Cohort avg: ",h[b].toFixed(1),"%"]}),e.jsx("circle",{cx:f.x.toFixed(1),cy:f.y.toFixed(1),r:"3.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.2"})]},b)),ae.map((f,b)=>{const A=i(b,x+16);return e.jsx("text",{x:A.x.toFixed(1),y:A.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"9",fill:"#334155",fontWeight:"700",children:f.label},f.key)})]})}),e.jsxs("div",{className:"chart-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#3b82f6"}}),n.name]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:"#9CA3AF"}}),"Cohort Average (dashed)"]})]})]})}function on({data:s}){const t=s||[];if(!t.length)return e.jsx(we,{});const r=ae.map(g=>{const D=t.map(q=>Number(q[g.key])).filter(q=>Number.isFinite(q)&&q>0).map(q=>q/g.max*100).sort((q,Y)=>q-Y);if(!D.length)return{...g,empty:!0};const S=Ge(D,.25),E=Ge(D,.5),v=Ge(D,.75),I=v-S,V=S-1.5*I,$=v+1.5*I,X=D.find(q=>q>=V)??D[0],K=[...D].reverse().find(q=>q<=$)??D[D.length-1],te=D.filter(q=>q<V||q>$);return{...g,q1:S,med:E,q3:v,whiskerMin:X,whiskerMax:K,outliers:te}}),a=320,n=36,l=10,o=6,j=160,x=j+o+20,c=(a-n-l)/r.length,i=18,p=r.flatMap(g=>g.empty?[]:[g.whiskerMin,g.whiskerMax,...g.outliers]),h=p.length?Math.min(...p):0,C=p.length?Math.max(...p):100,w=Math.max(5,C-h),k=Math.min(10,w*.12),u=Math.max(0,h-k),N=Math.min(100,C+k),f=g=>o+(j-(g-u)/Math.max(1,N-u)*j),b=w<=10?2:w<=20?5:w<=40?10:w<=70?20:25,A=Math.ceil(u/b)*b,T=Math.floor(N/b)*b,y=[];for(let g=A;g<=T;g+=b)y.push(g);return y.length<2&&(y.length=0,y.push(Math.round(u),Math.round((u+N)/2),Math.round(N))),e.jsxs("div",{className:"chart-card chart-equal-bottom dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Score Distribution by Criterion"}),e.jsx("div",{className:"chart-note",children:"Reveals inter-juror spread for each criterion ‚Äî evidence of measurement reliability."})]})}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${a} ${x}`,style:{width:"100%",height:"100%",display:"block"},children:[y.map(g=>{const D=f(g);return e.jsxs("g",{children:[e.jsx("line",{x1:n,y1:D,x2:a-l,y2:D,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:n-4,y:D+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:Math.round(g)})]},g)}),e.jsx("line",{x1:n,y1:o,x2:n,y2:o+j,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:"10",y:o+j/2,transform:`rotate(-90 10 ${o+j/2})`,fontSize:"8",fill:"#94a3b8",textAnchor:"middle",children:"Normalized (%)"}),r.map((g,D)=>{const S=n+D*c+c/2;if(g.empty)return e.jsx("text",{x:S,y:o+j+16,fontSize:"9",textAnchor:"middle",fill:"#94a3b8",children:g.label},g.key);const E=f(g.q1),v=f(g.q3),I=f(g.med);return e.jsxs("g",{children:[e.jsx("rect",{x:S-i/2,y:v,width:i,height:Math.max(2,E-v),fill:"rgba(59,130,246,0.18)",stroke:g.color,strokeWidth:"1.6"}),e.jsx("line",{x1:S-i/2,y1:I,x2:S+i/2,y2:I,stroke:g.color,strokeWidth:"2.2"}),e.jsx("text",{x:S,y:o+j+16,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:g.label})]},g.key)})]})}),e.jsxs("div",{className:"chart-legend boxplot-legend",children:[e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-box"}),"IQR band (Q1‚ÄìQ3)"]}),e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"boxplot-legend-median"}),"Median"]})]})]})}function ln({stats:s,data:t}){const r=s.filter(h=>h.count>0),a=t||[];if(!r.length||!a.length)return e.jsx(we,{});const n=ae.map(h=>r.map(C=>{const w=a.filter(N=>N.projectId===C.id).map(N=>Number(N[h.key])).filter(N=>Number.isFinite(N));if(w.length<2)return{cv:null,m:null,sd:null,n:w.length};const k=is(w);if(!k)return{cv:null,m:k,sd:null,n:w.length};const u=zs(w);return{cv:u/k*100,m:k,sd:u,n:w.length}})),l=h=>h===null?{fill:"#f1f5f9",text:"#94a3b8"}:h<10?{fill:"#dcfce7",text:"#166534"}:h<15?{fill:"#bbf7d0",text:"#166534"}:h<25?{fill:"#fef08a",text:"#92400e"}:{fill:"#fecaca",text:"#991b1b"},o=100,j=26,x=96,c=48,i=o+r.length*x,p=j+ae.length*c+10;return e.jsxs("div",{className:"chart-card chart-fill-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Juror Consistency Heatmap"}),e.jsx("div",{className:"chart-note",children:"Identifies which group √ó criterion combinations have poor juror agreement, guiding rubric improvement."})]})}),e.jsxs("div",{className:"cv-formula-block",children:[e.jsx("span",{className:"cv-formula-pill","aria-label":"CV equals sigma divided by x bar times 100",children:e.jsx("math",{xmlns:"http://www.w3.org/1998/Math/MathML",className:"cv-formula-math",children:e.jsxs("mrow",{children:[e.jsx("mi",{children:"CV"}),e.jsx("mo",{children:"="}),e.jsxs("mrow",{children:[e.jsx("mo",{children:"("}),e.jsxs("mfrac",{children:[e.jsx("mi",{children:"œÉ"}),e.jsx("mi",{children:"Œº"})]}),e.jsx("mo",{children:")"})]}),e.jsx("mo",{children:"√ó"}),e.jsx("mn",{children:"100"})]})})}),e.jsx("span",{className:"cv-formula-legend",children:"œÉ = std. deviation ¬†¬∑¬† Œº = mean score ¬†¬∑¬† CV = juror disagreement %"})]}),e.jsx("div",{className:"chart-svg-fill heatmap-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${i} ${p}`,style:{width:"100%",maxWidth:i,height:"100%",display:"block"},children:[r.map((h,C)=>e.jsx("text",{x:o+C*x+x/2,y:16,textAnchor:"middle",fontSize:"11",fill:"#475569",fontWeight:"600",children:h.name},h.id)),ae.map((h,C)=>e.jsxs("g",{children:[e.jsx("text",{x:o-10,y:j+C*c+c/2+6,textAnchor:"end",fontSize:"12",fill:"#475569",fontWeight:"600",children:h.label}),r.map((w,k)=>{const u=n[C][k],N=u.cv,f=o+k*x,b=j+C*c,A=l(N),T=[`${w.name} ¬∑ ${h.label}`,`CV: ${N===null?"N/A":Math.round(N)+"%"}`,u.m!==null?`Mean: ${(u.m/h.max*100).toFixed(1)}%`:"",u.sd!==null?`SD: ${u.sd.toFixed(2)}`:"",`N jurors: ${u.n}`].filter(Boolean).join(`
`);return e.jsxs("g",{children:[e.jsx("title",{children:T}),e.jsx("rect",{x:f+3,y:b+3,width:x-6,height:c-6,rx:"12",fill:A.fill,stroke:"rgba(148,163,184,0.25)"}),e.jsx("text",{x:f+x/2,y:b+c/2+6,textAnchor:"middle",fontSize:"12",fill:A.text,fontWeight:"700",children:N===null?"N/A":`${Math.round(N)}%`})]},`${h.key}-${w.id}`)})]},h.key))]})}),e.jsxs("div",{className:"heatmap-legend",children:[e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#dcfce7",borderColor:"#bbf7d0"}}),"<10% CV (excellent)"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#bbf7d0",borderColor:"#86efac"}}),"10‚Äì15% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fef08a",borderColor:"#fde047"}}),"15‚Äì25% CV"]}),e.jsxs("span",{className:"heatmap-legend-item",children:[e.jsx("span",{className:"heatmap-legend-swatch",style:{background:"#fecaca",borderColor:"#fca5a5"}}),">25% CV (poor)"]})]})]})}function cn({data:s}){const t=s||[];if(!t.length)return e.jsx(we,{});const r=[{key:"insufficient",label:"Insufficient",color:"#ef4444"},{key:"developing",label:"Developing",color:"#f59e0b"},{key:"good",label:"Good",color:"#a3e635"},{key:"excellent",label:"Excellent",color:"#22c55e"}],a=(u,N)=>{if(!Number.isFinite(u))return null;for(const f of N)if(u>=f.min&&u<=f.max)return f.level.toLowerCase();return null},n=ae.map(u=>{const N=ee.find(y=>y.id===u.key),f=t.map(y=>Number(y[u.key])).filter(y=>Number.isFinite(y)),b={excellent:0,good:0,developing:0,insufficient:0};f.forEach(y=>{const g=a(y,N.rubric);g&&(b[g]+=1)});const A=f.length||1,T=r.map(y=>({...y,pct:b[y.key]/A*100,count:b[y.key]}));return{...u,pct:T,total:f.length}}),l=r.map(u=>({...u,anyPresent:n.some(N=>{var f;return((f=N.pct.find(b=>b.key===u.key))==null?void 0:f.pct)>0})})),o=340,j=32,x=10,c=8,i=28,p=180,h=c+p+i,C=(o-j-x)/n.length,w=Math.min(44,C*.65),k=u=>u/100*p;return e.jsxs("div",{className:"chart-card chart-equal-bottom dashboard-chart-card",children:[e.jsx("div",{className:"chart-title-row",children:e.jsxs("div",{children:[e.jsx("div",{className:"chart-title",children:"Achievement Level Distribution"}),e.jsx("div",{className:"chart-note",children:"% of evaluations per rubric band ‚Äî directly maps to M√úDEK continuous improvement evidence."})]})}),e.jsx("div",{className:"chart-svg-fill rubric-svg-fill",children:e.jsxs("svg",{className:"chart-main-svg",viewBox:`0 0 ${o} ${h}`,style:{width:"100%",height:"auto",display:"block"},children:[[0,25,50,75,100].map(u=>{const N=c+p-k(u);return e.jsxs("g",{children:[e.jsx("line",{x1:j,y1:N,x2:o-x,y2:N,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsxs("text",{x:j-4,y:N+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:[u,"%"]})]},u)}),n.map((u,N)=>{const f=j+N*C+C/2,b=f-w/2;let A=0;return e.jsxs("g",{children:[u.pct.map(T=>{if(T.pct<=0)return null;const y=k(T.pct),g=c+p-A-y;A+=y;const D=y>=16;return e.jsxs("g",{children:[e.jsxs("title",{children:[u.label," ¬∑ ",T.label,`
`,"Count: ",T.count," evaluation",T.count!==1?"s":"",`
`,"Share: ",T.pct.toFixed(0),"%"]}),e.jsx("rect",{x:b,y:g,width:w,height:y,fill:T.color}),D&&e.jsxs("text",{x:f,y:g+y/2+4,textAnchor:"middle",fontSize:"9",fill:"#fff",fontWeight:"700",children:[T.pct.toFixed(0),"%"]})]},T.key)}),e.jsx("text",{x:f,y:c+p+16,textAnchor:"middle",fontSize:"9",fill:"#475569",fontWeight:"600",children:u.label})]},u.key)})]})}),e.jsx("div",{className:"chart-legend rubric-legend",children:[...l].reverse().map(u=>e.jsxs("span",{className:"legend-item",style:u.anyPresent?void 0:{opacity:.35,textDecoration:"line-through"},children:[e.jsx("span",{className:"legend-dot",style:{background:u.color}}),u.label]},u.key))})]})}function dn(s){return s?s.toLocaleString("tr-TR",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).replace(","," ¬∑"):"‚Äî"}function un(){return e.jsxs("div",{className:"dashboard-loading",children:[e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]}),e.jsx("div",{className:"dashboard-skeleton-row",children:e.jsx("div",{className:"skeleton-card skeleton-wide"})}),e.jsxs("div",{className:"dashboard-skeleton-row",children:[e.jsx("div",{className:"skeleton-card"}),e.jsx("div",{className:"skeleton-card"})]})]})}function mn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#FCA5A5",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e.jsx("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),e.jsx("p",{className:"dashboard-state-title",children:"Could not load data"}),e.jsx("span",{className:"dashboard-state-sub",children:"Check your connection and refresh the page."})]})}function hn(){return e.jsxs("div",{className:"dashboard-state-card",children:[e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"#D1D5DB",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"21 8 21 21 3 21 3 8"}),e.jsx("rect",{x:"1",y:"3",width:"22",height:"5"}),e.jsx("line",{x1:"10",y1:"12",x2:"14",y2:"12"})]}),e.jsx("p",{className:"dashboard-state-title",children:"No data available"}),e.jsx("span",{className:"dashboard-state-sub",children:"Evaluations will appear here once jurors submit their scores."})]})}function pn({dashboardStats:s,submittedData:t,lastRefresh:r,loading:a,error:n}){const l=d.useRef(null),[o,j]=d.useState(!1),x=d.useRef(null);async function c(){if(o||!l.current)return;j(!0);const p=l.current,h=p.querySelector(".dashboard-toolbar"),C=p.querySelector(".print-header"),w=p.querySelectorAll(".mudek-badge-wrap"),k=(h==null?void 0:h.style.display)??"",u=(C==null?void 0:C.style.display)??"",N=[];w.forEach(A=>N.push(A.style.visibility??""));const f=()=>{h&&(h.style.display=k),C&&(C.style.display=u),w.forEach((A,T)=>{A.style.visibility=N[T]||""}),p.classList.remove("print-mode"),j(!1),x.current=null};x.current=f,h&&(h.style.display="none"),C&&(C.style.display="block"),w.forEach(A=>A.style.visibility="hidden"),p.classList.add("print-mode");const b=()=>f();window.addEventListener("afterprint",b,{once:!0}),requestAnimationFrame(()=>{setTimeout(()=>{window.print()},50)})}d.useEffect(()=>()=>{x.current&&x.current()},[]);const i=dn(r);return a?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(un,{})}):n?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(mn,{})}):!t||t.length===0?e.jsx("div",{className:"dashboard-print-wrap",children:e.jsx(hn,{})}):e.jsxs("div",{className:"dashboard-print-wrap",ref:l,children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:je.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[je.courseName," ‚Äî ",je.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report ¬†¬∑¬† ",i,"¬†¬∑¬† ",t.length," final submission",t.length!==1?"s":"","¬†¬∑¬† ",s.length," group",s.length!==1?"s":""]})]}),e.jsxs("div",{className:"dashboard-toolbar no-print",children:[e.jsx("div",{className:"dashboard-toolbar-left",children:e.jsx(tn,{})}),e.jsx("span",{className:"dashboard-toolbar-divider","aria-hidden":"true"}),e.jsxs("button",{className:"pdf-export-btn",onClick:c,disabled:o,children:[e.jsx(Ps,{}),o?"Preparing PDF‚Ä¶":"Export PDF"]})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Outcome Distribution"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"1",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-1",children:e.jsx(rn,{stats:s})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Programme Overview"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"2",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-2",children:e.jsx(nn,{data:t})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-3",children:e.jsx(an,{stats:s})})]}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Juror Consistency"}),e.jsx("div",{className:"dashboard-grid dashboard-row","data-row":"3",children:e.jsx("div",{className:"chart-span-2 chart-card dashboard-card",id:"chart-4",children:e.jsx(ln,{stats:s,data:t})})}),e.jsx("div",{className:"dashboard-section-label",lang:"en",children:"Criterion Analysis"}),e.jsxs("div",{className:"dashboard-grid dashboard-row","data-row":"4",children:[e.jsx("div",{className:"chart-card dashboard-card",id:"chart-5",children:e.jsx(on,{data:t})}),e.jsx("div",{className:"chart-card dashboard-card",id:"chart-6",children:e.jsx(cn,{data:t})})]})]})}const ys=G.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]});function Le(s){if(s===""||s===null||s===void 0||typeof s=="string"&&s.trim()==="")return"";const t=Number(s);return Number.isFinite(t)?t:""}const xn=[{key:"in_progress",label:"In Progress"},{key:"editing",label:"Editing"},{key:"submitted",label:"Submitted"}],jn=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}];function ks(s){return s.jurorId?s.jurorId:`${(s.juryName||"").trim().toLowerCase()}__${(s.juryDept||"").trim().toLowerCase()}`}function fn({open:s,anchorRect:t,onClose:r,className:a,contentKey:n,mode:l="anchor",children:o}){const j=d.useRef(null),[x,c]=d.useState({left:0,top:0,visibility:"hidden"});return d.useLayoutEffect(()=>{if(!s||!j.current)return;const i=j.current,p=()=>{if(l==="center"){c({left:"50%",top:"50%",transform:"translate(-50%, -50%)",visibility:"visible"});return}if(!t)return;const h=8,C=i.offsetWidth,w=i.offsetHeight,k=window.innerWidth,u=window.innerHeight;let N=t.left;N=Math.min(N,k-C-h),N=Math.max(h,N);let f=t.bottom+6;if(f+w+h>u){const b=t.top-w-6;b>=h?f=b:f=Math.max(h,u-w-h)}c({left:N,top:f,transform:"none",visibility:"visible"})};return p(),window.addEventListener("resize",p),window.addEventListener("orientationchange",p),()=>{window.removeEventListener("resize",p),window.removeEventListener("orientationchange",p)}},[s,t,n,l]),!s||l!=="center"&&!t?null:ws.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"filter-overlay",onClick:r}),e.jsx("div",{ref:j,className:a,style:x,role:"dialog","aria-modal":"true",onClick:i=>i.stopPropagation(),onPointerDown:i=>i.stopPropagation(),children:o})]}),document.body)}function gn({data:s,jurors:t}){const[r,a]=d.useState("ALL"),[n,l]=d.useState("ALL"),[o,j]=d.useState("ALL"),[x,c]=d.useState(new Set),[i,p]=d.useState(""),[h,C]=d.useState(""),[w,k]=d.useState(null),[u,N]=d.useState(""),[f,b]=d.useState("tsMs"),[A,T]=d.useState("desc"),[y,g]=d.useState(null),[D,S]=d.useState(null),[E,v]=d.useState(()=>typeof window<"u"&&window.matchMedia("(max-width: 480px)").matches),I=d.useMemo(()=>ys.map(m=>({id:m.id,label:`Group ${m.id}`,name:m.name})).sort((m,_)=>m.id-_.id),[]),V=d.useMemo(()=>{const m=new Map;return t.forEach(_=>{const B=String((_==null?void 0:_.dept)??"").trim();B&&m.set(B.toLowerCase(),B)}),Array.from(m.entries()).sort((_,B)=>_[1].localeCompare(B[1])).map(([_,B])=>({key:_,label:B}))},[t]);d.useEffect(()=>{if(!E||y!=="timestamp")return;const m=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=m}},[y,E]),d.useEffect(()=>{if(typeof window>"u")return;const m=window.matchMedia("(max-width: 480px)"),_=()=>v(m.matches);return _(),m.addEventListener?m.addEventListener("change",_):m.addListener(_),()=>{m.addEventListener?m.removeEventListener("change",_):m.removeListener(_)}},[]);const $=d.useMemo(()=>{if(!i||!h)return!1;const m=new Date(i).getTime(),_=new Date(h).getTime();return!Number.isFinite(m)||!Number.isFinite(_)?!1:m>_},[i,h]);d.useEffect(()=>{k($?"The 'From' date cannot be later than the 'To' date.":null)},[$]);const X=d.useMemo(()=>{let m=0;return r!=="ALL"&&(m+=1),n!=="ALL"&&(m+=1),o!=="ALL"&&(m+=1),x.size>0&&(m+=1),(i||h)&&(m+=1),u&&(m+=1),m},[r,n,o,x,i,h,u]),K=X>0;function te(){a("ALL"),l("ALL"),j("ALL"),c(new Set),p(""),C(""),k(null),N(""),b("tsMs"),T("desc"),g(null),S(null)}function q(m){c(_=>{const B=new Set(_);return B.has(m)?B.delete(m):B.add(m),B})}function Y(){g(null),S(null)}function oe(m,_){var R,re;const B=(re=(R=_==null?void 0:_.currentTarget)==null?void 0:R.getBoundingClientRect)==null?void 0:re.call(R);g(me=>{const L=me===m?null:m;return L&&B&&S(B),L||S(null),L})}function fe(m){return m===""||m===null||m===void 0||typeof m=="string"&&m.trim()===""?!0:typeof m=="number"?!Number.isFinite(m):!1}const ce=d.useMemo(()=>{const m=i?new Date(i).getTime():0,_=h?new Date(h+"T23:59:59").getTime():1/0;let B=s.slice();if(r!=="ALL"&&(B=B.filter(R=>ks(R)===r)),o!=="ALL"&&(B=B.filter(R=>String(R.projectId)===o)),n!=="ALL"){const R=n.toLowerCase();B=B.filter(re=>String(re.juryDept??"").trim().toLowerCase()===R)}if(x.size>0&&(B=B.filter(R=>{const re=R.editingFlag==="editing"||R.status==="editing",me=R.status==="group_submitted"||R.status==="all_submitted",L=R.status==="in_progress";return!!(x.has("editing")&&re||x.has("submitted")&&me||x.has("in_progress")&&L)})),(i||h)&&!$&&(B=B.filter(R=>{const re=R.tsMs||ze(R.timestamp);return re>=m&&re<=_})),u){const R=u.toLowerCase();B=B.filter(re=>(re.comments||"").toLowerCase().includes(R))}return B.sort((R,re)=>{const me=R[f],L=re[f],P=fe(me),Q=fe(L);return P&&Q?0:P?1:Q?-1:A==="asc"?xe(me,L):xe(L,me)}),B},[s,r,o,n,x,i,h,u,f,A]);function se(m){f===m?T(_=>_==="asc"?"desc":"asc"):(b(m),T("desc"))}const le=m=>f!==m?e.jsx(Ve,{}):A==="asc"?e.jsx(Ye,{}):e.jsx(Qe,{}),U=(()=>{if(y==="juror")return{className:"col-filter-popover col-filter-popover-portal",contentKey:r,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:m=>{a(m.target.value),Y()},children:[e.jsx("option",{value:"ALL",children:"All jurors"}),t.map(m=>e.jsxs("option",{value:m.key,children:[m.name,m.dept?` (${m.dept})`:""]},m.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),Y()},children:"Clear"})]})};if(y==="dept")return{className:"col-filter-popover col-filter-popover-portal",contentKey:n,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:m=>{l(m.target.value),Y()},children:[e.jsx("option",{value:"ALL",children:"All departments"}),V.map(m=>e.jsx("option",{value:m.key,children:m.label},m.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{l("ALL"),Y()},children:"Clear"})]})};if(y==="group")return{className:"col-filter-popover col-filter-popover-portal",contentKey:o,content:e.jsxs(e.Fragment,{children:[e.jsxs("select",{autoFocus:!0,value:o,onChange:m=>{j(m.target.value),Y()},children:[e.jsx("option",{value:"ALL",children:"All groups"}),I.map(m=>e.jsx("option",{value:String(m.id),children:m.label},m.id))]}),o!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{j("ALL"),Y()},children:"Clear"})]})};if(y==="timestamp"){const m=R=>{p(R),h&&R&&new Date(R).getTime()>new Date(h).getTime()?k("The 'From' date cannot be later than the 'To' date."):k(null)},_=R=>{C(R),i&&R&&new Date(i).getTime()>new Date(R).getTime()?k("The 'From' date cannot be later than the 'To' date."):k(null)},B=()=>{i&&h&&new Date(i).getTime()>new Date(h).getTime()?k("The 'From' date cannot be later than the 'To' date."):k(null)};return{className:`col-filter-popover col-filter-popover-portal col-filter-popover-timestamp${E?" is-centered":""}`,contentKey:`${i}|${h}`,mode:E?"center":"anchor",content:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",value:i,onChange:R=>m(R.target.value),onBlur:B,className:w?"is-invalid":"","aria-invalid":!!w})]}),e.jsxs("div",{className:"timestamp-field",children:[e.jsx("label",{children:"To"}),e.jsx("input",{type:"date",value:h,onChange:R=>_(R.target.value),onBlur:B,className:w?"is-invalid":"","aria-invalid":!!w})]}),w&&e.jsx("div",{className:"timestamp-error",role:"alert",children:w}),E?e.jsxs("div",{className:"timestamp-actions",children:[(i||h)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{p(""),C("")},children:"Clear"}),e.jsx("button",{className:"timestamp-done-btn",onClick:Y,disabled:!!w,children:"Done"})]}):(i||h)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{p(""),C("")},children:"Clear"})]})}}return y==="status"?{className:"col-filter-popover col-filter-popover-portal col-filter-popover-status",contentKey:Array.from(x).sort().join("|"),content:e.jsxs(e.Fragment,{children:[xn.map(({key:m,label:_})=>e.jsxs("label",{className:"status-option",children:[e.jsx("input",{type:"checkbox",checked:x.has(m),onChange:()=>q(m)}),_]},m)),x.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{c(new Set),Y()},children:"Clear"})]})}:y==="comments"?{className:"col-filter-popover col-filter-popover-portal",contentKey:u,content:e.jsxs(e.Fragment,{children:[e.jsx("input",{autoFocus:!0,placeholder:"Search comments‚Ä¶",value:u,onChange:m=>N(m.target.value)}),u&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{N(""),Y()},children:"Clear"})]})}:null})();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:ce.length})," row",ce.length!==1?"s":""]}),K&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"filters-active-pill",children:["Filters: ",X]}),e.jsx("button",{type:"button",className:"filters-clear-btn",onClick:te,"aria-label":"Clear filters",title:"Clear filters",children:e.jsx(as,{})})]}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{Ot(ce)},children:[e.jsx(Ps,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]})]}),e.jsx(fn,{open:!!U,anchorRect:D,onClose:Y,className:U==null?void 0:U.className,contentKey:U==null?void 0:U.contentKey,mode:U==null?void 0:U.mode,children:U==null?void 0:U.content}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>se("juryName"),children:"Juror"}),e.jsx("div",{className:`col-filter-hotspot${r!=="ALL"?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("juror",m)},title:"Filter by juror",children:e.jsx(ve,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>se("juryDept"),children:"Department"}),e.jsx("div",{className:`col-filter-hotspot${n!=="ALL"?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("dept",m)},title:"Filter by department",children:e.jsx(ve,{})})]})}),e.jsx("th",{style:{position:"relative",whiteSpace:"nowrap"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>se("projectId"),children:"Group"}),e.jsx("div",{className:`col-filter-hotspot${o!=="ALL"?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("group",m)},title:"Filter by group",children:e.jsx(ve,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>se("tsMs"),children:"Timestamp"}),e.jsx("div",{className:`col-filter-hotspot${i||h?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("timestamp",m)},title:"Filter by date",children:e.jsx(ve,{})})]})}),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{className:"col-sort-label",onClick:()=>se("status"),children:"Status"}),e.jsx("div",{className:`col-filter-hotspot${x.size>0?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("status",m)},title:"Filter by status",children:e.jsx(ve,{})})]})}),jn.map(({key:m,label:_})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>se(m),children:e.jsxs("span",{className:"col-sort-label",children:[_," ",e.jsx("span",{className:"sort-icon",children:le(m)})]})},m)),e.jsx("th",{style:{position:"relative"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Comments"}),e.jsx("div",{className:`col-filter-hotspot${u?" active":""}`,onPointerDown:m=>{m.preventDefault(),m.stopPropagation(),oe("comments",m)},title:"Filter by comments",children:e.jsx(ve,{})})]})})]})}),e.jsxs("tbody",{children:[ce.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),ce.map((m,_)=>{ys.find(R=>R.id===m.projectId);const B=m.status==="in_progress";return e.jsxs("tr",{className:_%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:m.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:m.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsx("div",{className:"cell-group-wrap",title:`Group ${m.projectId}`,style:{cursor:"default"},children:e.jsxs("strong",{className:"cell-group-title",children:["Group ",m.projectId]})})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:Ze(m.timestamp)}),e.jsx("td",{children:e.jsx(Ae,{status:m.status,editingFlag:m.editingFlag})}),e.jsx("td",{style:{color:B?"#94a3b8":void 0},children:Le(m.technical)}),e.jsx("td",{style:{color:B?"#94a3b8":void 0},children:Le(m.design)}),e.jsx("td",{style:{color:B?"#94a3b8":void 0},children:Le(m.delivery)}),e.jsx("td",{style:{color:B?"#94a3b8":void 0},children:Le(m.teamwork)}),e.jsx("td",{style:{color:B?"#94a3b8":void 0},children:e.jsx("strong",{children:Le(m.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:m.comments})]},`${ks(m)}-${m.projectId}-${_}`)})]})]})})]})}const Ns=G.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]});function vn({jurorStats:s,onPinReset:t}){const[r,a]=d.useState(""),[n,l]=d.useState(""),[o,j]=d.useState(new Set);d.useEffect(()=>{const i=setTimeout(()=>l(r),200);return()=>clearTimeout(i)},[r]);function x(i){j(p=>{const h=new Set(p);return h.has(i)?h.delete(i):h.add(i),h})}const c=d.useMemo(()=>{const i=s.slice().sort((h,C)=>xe(h.jury,C.jury)),p=n.trim().toLowerCase();return p?i.filter(h=>{var C;return h.jury.toLowerCase().includes(p)||(h.dept||((C=h.latestRow)==null?void 0:C.juryDept)||"").toLowerCase().includes(p)}):i},[s,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("span",{className:"juror-search-icon","aria-hidden":"true",children:e.jsx(_s,{})}),e.jsx("input",{className:"juror-search-input",value:r,onChange:i=>a(i.target.value),placeholder:"Search by name or department‚Ä¶"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>a(""),"aria-label":"Clear search",title:"Clear search",children:e.jsx(as,{})})]})}),c.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:c.map(i=>{const{key:p,jury:h,rows:C,overall:w,latestRow:k}=i,u=Jt(C),N=u===100?"#22c55e":u>66?"#84cc16":u>33?"#eab308":u>0?"#f97316":"#e2e8f0",f=C.some(y=>y.editingFlag==="editing"),b=Ns.map(y=>{const g=C.find(S=>S.projectId===y.id),D=(g==null?void 0:g.status)==="group_submitted"||(g==null?void 0:g.status)==="all_submitted"?"submitted":(g==null?void 0:g.status)||"not_started";return{id:y.id,status:D}}),A=b.length>0&&b.every(y=>y.status==="submitted"),T=f?"juror-card-editing":w==="all_submitted"?"juror-card-all-submitted":w==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${T}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:[e.jsx("span",{className:"juror-name-icon","aria-hidden":"true",children:e.jsx(Fs,{})}),e.jsxs("span",{className:"juror-name-text",children:[h,(k==null?void 0:k.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",k.juryDept,")"]})]})]}),e.jsx("div",{className:"juror-header-actions",children:f?e.jsx(Ae,{status:w,editingFlag:"editing"}):A?e.jsx(Ae,{variant:"completed",icon:e.jsx(Ue,{}),children:"Completed"}):e.jsx(Ae,{status:w})})]}),e.jsxs("div",{className:"juror-meta",children:[(k==null?void 0:k.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:Ze(k==null?void 0:k.timestamp)})]}),t&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${h}`,onClick:()=>t(h,(k==null?void 0:k.juryDept)||"",(k==null?void 0:k.jurorId)||""),children:"üîë Reset PIN"})]})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${u}%`,background:N}})}),e.jsxs("span",{className:"juror-progress-label",children:[u,"%"]})]}),e.jsx("div",{className:"juror-projects",children:C.slice().sort((y,g)=>y.projectId-g.projectId).map(y=>{var I,V;const g=Ns.find($=>$.id===y.projectId),D=`${p}-${y.projectId}`,S=o.has(D),E=`juror-group-panel-${D}`,v=!!(g!=null&&g.desc)||((I=g==null?void 0:g.students)==null?void 0:I.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:v?0:-1,"aria-expanded":S,"aria-controls":E,onClick:()=>{v&&x(D)},onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&v&&($.preventDefault(),x(D))},style:{cursor:v?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(g==null?void 0:g.name)||`Group ${y.projectId}`}),v&&e.jsx("span",{className:`group-accordion-chevron${S?" open":""}`,children:e.jsx(Oe,{})})]})}),e.jsxs("div",{className:"juror-row-right",children:[y.timestamp&&e.jsxs("span",{className:"juror-row-ts",children:[e.jsx("span",{className:"juror-row-ts-icon","aria-hidden":"true",children:e.jsx(ts,{})}),Ze(y.timestamp)]}),e.jsx(Ae,{status:y.status,editingFlag:y.editingFlag}),(y.status==="all_submitted"||y.status==="group_submitted")&&e.jsx("span",{className:"juror-score",title:"/ 100","aria-label":`${y.total} / 100`,children:y.total})]})]}),e.jsx("div",{id:E,className:`group-accordion-panel${S?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(g==null?void 0:g.desc)&&e.jsxs("span",{className:"juror-row-desc group-card-desc",children:[e.jsx("span",{className:"group-card-desc-icon","aria-hidden":"true",children:e.jsx(Ds,{})}),e.jsx("span",{className:"group-card-desc-text",children:g.desc})]}),((V=g==null?void 0:g.students)==null?void 0:V.length)>0&&e.jsxs("span",{className:"juror-row-students group-card-students",children:[e.jsx("span",{className:"group-card-students-icon","aria-hidden":"true",children:e.jsx(qe,{})}),e.jsx("span",{className:"group-card-students-text",children:g.students.join(" ¬∑ ")})]})]})})]},D)})})]},p)})})]})}const bn=s=>s?s.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:s.status==="group_submitted"?{background:"#ecfdf3",color:"#16a34a",fontWeight:600}:s.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},yn=s=>s?s.status==="all_submitted"||s.status==="group_submitted"?s.total:s.status==="in_progress"?"":"‚Äî":"‚Äî";function kn({data:s,jurors:t,groups:r}){const[a,n]=d.useState(null),[l,o]=d.useState("desc"),[j,x]=d.useState("asc"),[c,i]=d.useState("juror"),[p,h]=d.useState(""),[C,w]=d.useState(null),k=d.useMemo(()=>{const S={};return s.forEach(E=>{const v=E.jurorId?E.jurorId:`${(E.juryName||"").trim().toLowerCase()}__${(E.juryDept||"").trim().toLowerCase()}`;S[v]||(S[v]={}),S[v][E.projectId]={total:E.total,status:E.status,editingFlag:E.editingFlag}}),S},[s]);function u(S){a!==S?(n(S),o("desc"),i("group")):l==="desc"?(o("asc"),i("group")):(n(null),o("desc"),i("group"))}const N=S=>c!=="group"||a!==S?e.jsx(Ve,{}):l==="desc"?e.jsx(Qe,{}):e.jsx(Ye,{}),f=()=>c!=="juror"?e.jsx(Ve,{}):j==="asc"?e.jsx(Ye,{}):e.jsx(Qe,{});function b(){c!=="juror"?(i("juror"),x("asc")):x(S=>S==="asc"?"desc":"asc")}const A=d.useMemo(()=>{let S=t.slice().sort((E,v)=>xe(E.name,v.name));if(p){const E=p.toLowerCase();S=S.filter(v=>v.name.toLowerCase().includes(E))}return c==="juror"&&(S=S.slice().sort((E,v)=>j==="asc"?xe(E.name,v.name):xe(v.name,E.name))),c==="group"&&a!==null&&(S=[...S].sort((E,v)=>{var te,q;const I=(te=k[E.key])==null?void 0:te[a],V=(q=k[v.key])==null?void 0:q[a],$=(I==null?void 0:I.status)==="all_submitted"?Number(I.total):null,X=(V==null?void 0:V.status)==="all_submitted"?Number(V.total):null;if($===null&&X===null)return xe(E.name,v.name);if($===null)return 1;if(X===null)return-1;const K=l==="desc"?X-$:$-X;return K!==0?K:xe(E.name,v.name)})),S},[t,p,a,l,c,j,k]),T=S=>{const E=r.map(v=>{var $;const I=($=k[S])==null?void 0:$[v.id];return{status:(I==null?void 0:I.status)==="group_submitted"||(I==null?void 0:I.status)==="all_submitted"?"submitted":(I==null?void 0:I.status)||"not_started",editing:(I==null?void 0:I.editingFlag)==="editing"}});return E.every(v=>v.status==="not_started")?"not_started":E.some(v=>v.editing)?"editing":E.every(v=>v.status==="submitted")?"completed":E.some(v=>v.status==="in_progress")?"in_progress":E.some(v=>v.status==="submitted")?"submitted":"not_started"},y={completed:"Completed",submitted:"Submitted",in_progress:"In Progress",editing:"Editing",not_started:"Not Started"},g={completed:e.jsx(Ue,{}),submitted:e.jsx(Re,{}),in_progress:e.jsx(Fe,{}),editing:e.jsx(_e,{}),not_started:e.jsx(gs,{})},D=d.useMemo(()=>r.map(S=>{const E=A.map(v=>{var I;return(I=k[v.key])==null?void 0:I[S.id]}).filter(v=>(v==null?void 0:v.status)==="all_submitted").map(v=>v.total);return E.length?(E.reduce((v,I)=>v+I,0)/E.length).toFixed(2):null}),[A,r,k]);return t.length?e.jsxs("div",{className:"matrix-wrap",children:[e.jsxs("div",{className:"matrix-subtitle",children:[e.jsx("div",{className:"matrix-legend-row legend-scroll-row",children:e.jsxs("div",{className:"matrix-legend-scroll","aria-label":"Cells legend",children:[e.jsx("span",{className:"matrix-legend-label",children:"Cells"}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot completed-dot"}),"Completed"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]})}),e.jsx("div",{className:"matrix-legend-row matrix-icon-legend legend-scroll-row",children:e.jsxs("div",{className:"matrix-legend-scroll","aria-label":"Juror legend",children:[e.jsx("span",{className:"matrix-legend-label",children:"Juror"}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon completed",children:e.jsx(Ue,{})}),"Completed"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon submitted",children:e.jsx(Re,{})}),"Submitted"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon editing",children:e.jsx(_e,{})}),"Editing"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon in_progress",children:e.jsx(Fe,{})}),"In Progress"]}),e.jsxs("span",{className:"matrix-icon-legend-item",children:[e.jsx("span",{className:"matrix-status-icon not_started",children:e.jsx(gs,{})}),"Not Started"]})]})}),A.length<t.length&&e.jsxs("span",{className:"matrix-legend-count",children:["Showing ",A.length,"/",t.length," jurors"]})]}),C!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>w(null)}),e.jsx("div",{className:"matrix-scroll-wrap",children:e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"matrix-corner",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsxs("span",{className:"col-sort-label",onClick:b,children:["Juror / Group",e.jsx("span",{className:"sort-icon",children:f()})]}),e.jsx("button",{className:`col-filter-hotspot${p?" active":""}`,onClick:S=>{S.stopPropagation(),w(E=>E==="juror"?null:"juror")},title:"Filter jurors",children:e.jsx(ve,{})})]}),C==="juror"&&e.jsx("div",{className:"col-filter-popover",onClick:S=>S.stopPropagation(),children:e.jsxs("div",{className:"matrix-filter-input",children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror name‚Ä¶",value:p,onChange:S=>h(S.target.value)}),p&&e.jsx("button",{className:"matrix-filter-clear",onClick:()=>h(""),"aria-label":"Clear filter",title:"Clear filter",children:e.jsx(as,{})})]})})]}),r.map(S=>{const E=a===S.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${E?" active":""}`,onClick:()=>u(S.id),title:`Sort by ${S.label}`,children:[e.jsx("strong",{children:S.label}),e.jsx("span",{className:"sort-icon",children:N(S.id)})]})},S.id)})]})}),e.jsx("tbody",{children:A.map(S=>e.jsxs("tr",{children:[e.jsx("td",{className:"matrix-juror",children:(()=>{const E=T(S.key),v=S.dept?`${S.name} (${S.dept})`:S.name;return e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`matrix-status-icon ${E}`,title:y[E],"aria-hidden":"true",children:g[E]}),e.jsxs("span",{className:"matrix-juror-name",title:v,children:[S.name,S.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",S.dept,")"]})]})]})})()}),r.map(E=>{var I;const v=((I=k[S.key])==null?void 0:I[E.id])??null;return e.jsx("td",{style:bn(v),children:yn(v)},E.id)})]},S.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),D.map((S,E)=>e.jsx("td",{className:"matrix-avg-cell",children:S!==null?S:"‚Äî"},r[E].id))]})})]})})}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(ns,{})," Averages include only ",e.jsx("strong",{children:"completed"})," submissions."]})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const Xe=G.map((s,t)=>typeof s=="string"?{id:t+1,name:s,desc:"",students:[]}:{id:s.id??t+1,name:s.name??`Group ${t+1}`,desc:s.desc??"",students:s.students??[]}),Nn=ee.map(s=>({id:s.id,label:s.label,shortLabel:s.shortLabel,max:s.max})),He=Xe.length;function Me(s){if(s===""||s===null||s===void 0||typeof s=="string"&&s.trim()==="")return"";const t=Number(String(s??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(t)?t:""}const wn=[{id:"summary",label:"Summary",icon:vt},{id:"dashboard",label:"Dashboard",icon:$s},{id:"detail",label:"Details",icon:rs},{id:"jurors",label:"Jurors",icon:Fs},{id:"matrix",label:"Matrix",icon:bt}];function Sn({metrics:s,id:t}){const{completedJurors:r,totalJurors:a,completedEvaluations:n,totalEvaluations:l,inProgressJurors:o,editingJurors:j}=s,x=Number.isFinite(a)?Math.max(0,a):0,c=Number.isFinite(r)?Math.min(Math.max(0,r),x):0,i=Number.isFinite(o)?Math.max(0,o):0,p=Number.isFinite(j)?Math.max(0,j):0,h=Number.isFinite(l)?Math.max(0,l):0,C=Number.isFinite(n)?Math.min(Math.max(0,n),h):0,w=x===0&&c===0&&i===0&&p===0,k=w?"empty":i===0&&p===0?"completed":"inprogress",u=h===0?"empty":C===h?"completed":"inprogress",N=b=>w?"‚Äî":b,f=h===0?"‚Äî":`${C}/${h}`;return e.jsxs("div",{id:t,className:"results-status-bar",role:"group","aria-label":"Results status metrics",children:[e.jsxs("span",{className:`status-chip status-chip--${k}`,"aria-label":`Jurors: total ${x}, completed ${c}, in progress ${i}, editing ${p}`,children:[e.jsxs("span",{className:"status-block",children:[e.jsx(Ts,{}),e.jsx("span",{className:"status-value",children:N(x)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"¬∑"}),e.jsxs("span",{className:"status-block",children:[e.jsx(jt,{}),e.jsx("span",{className:"status-value",children:N(c)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"¬∑"}),e.jsxs("span",{className:"status-block",children:[e.jsx(Fe,{}),e.jsx("span",{className:"status-value",children:N(i)})]}),e.jsx("span",{className:"status-sep","aria-hidden":"true",children:"¬∑"}),e.jsxs("span",{className:"status-block",children:[e.jsx(_e,{}),e.jsx("span",{className:"status-value",children:N(p)})]})]}),e.jsx("span",{className:`status-chip status-chip--${u}`,"aria-label":`Evaluated: ${C} out of ${h}`,children:e.jsxs("span",{className:"status-block",children:[e.jsx(gt,{}),e.jsx("span",{className:"status-value",children:f})]})})]})}function Cn({adminPass:s,onBack:t,onAuthError:r,onInitialLoadDone:a}){const[n,l]=d.useState([]),[o,j]=d.useState(!0),[x,c]=d.useState(""),[i,p]=d.useState(""),[h,C]=d.useState(!0),[w,k]=d.useState("summary"),[u,N]=d.useState(null),[f,b]=d.useState(!1),[A,T]=d.useState(!1),[y,g]=d.useState(!1),D=d.useRef(null),[S,E]=d.useState(null),[v,I]=d.useState(""),V=d.useRef(!1),$=d.useRef(s);d.useEffect(()=>{$.current=s},[s]);const X=async()=>{j(!0),c("");try{const L=$.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!L){l([]),p("Enter the admin password to load results.");return}const P=await Ne({action:"export",pass:L});if((P==null?void 0:P.status)==="unauthorized"){if(l([]),r){r("Invalid password");return}p("Incorrect password.");return}if((P==null?void 0:P.status)!=="ok"||!Array.isArray(P==null?void 0:P.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",L)}catch{}const Q=P.rows.map(J=>({juryName:String(J["Juror Name"]??J["Your Name"]??""),juryDept:String(J["Department / Institution"]??J.Department??""),timestamp:J.Timestamp||"",tsMs:ze(J.Timestamp||""),projectId:Rt(J["Group No"]),projectName:String(J["Group Name"]??""),jurorId:String(J["Juror ID"]??""),technical:Me(J["Technical (30)"]),design:Me(J["Written (30)"]),delivery:Me(J["Oral (30)"]),teamwork:Me(J["Teamwork (10)"]),total:Me(J["Total (100)"]),comments:J.Comments||"",status:String(J.Status??"all_submitted"),editingFlag:String(J.EditingFlag??"")}));l(Gt(Q)),N(new Date),p(""),V.current||(V.current=!0,a==null||a())}catch(L){if(r){r("Connection error ‚Äî try again.");return}c("Could not load data: "+L.message),l([])}finally{j(!1)}};d.useEffect(()=>{X()},[]),d.useEffect(()=>{},[]);const K=()=>{const L=D.current;if(!L)return;const P=L.scrollWidth-L.clientWidth,Q=P>2;if(b(Q),!Q){T(!1),g(!1);return}const J=L.scrollLeft>4,Z=L.scrollLeft<P-4;T(J),g(Z)};d.useEffect(()=>(K(),window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)),[w,h]),d.useEffect(()=>(S?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[S]);const te=async(L,P,Q)=>{E({juryName:L,juryDept:P}),I("loading");try{const J=$.current||sessionStorage.getItem("ee492_admin_pass")||"",Z=await Ne({action:"resetPin",jurorId:Q.trim(),pass:J});I(Z.status==="ok"?"ok":"error")}catch{I("error")}setTimeout(()=>{E(null),I("")},3e3)},q=L=>L.jurorId?L.jurorId:`${(L.juryName||"").trim().toLowerCase()}__${(L.juryDept||"").trim().toLowerCase()}`,Y=d.useMemo(()=>{const L=new Map;return n.forEach(P=>{if(!P.juryName)return;const Q=q(P);L.has(Q)||L.set(Q,{key:Q,name:P.juryName.trim(),dept:P.juryDept.trim(),jurorId:P.jurorId})}),[...L.values()].sort((P,Q)=>xe(P.name,Q.name))},[n]),oe=d.useMemo(()=>Xe.map(L=>({id:L.id,label:`Group ${L.id}`,desc:L.desc||""})).sort((L,P)=>L.id-P.id),[]),fe=d.useMemo(()=>{const L=new Map;return Y.forEach(({key:P,dept:Q})=>L.set(P,Q)),L},[Y]),ce=d.useMemo(()=>{const L=new Map;return Y.forEach(({key:P,name:Q})=>L.set(P,{bg:Bt(Q),dot:Wt(Q)})),L},[Y]),se=d.useMemo(()=>n.filter(L=>L.status==="all_submitted"),[n]),le=d.useMemo(()=>n.filter(L=>L.status==="group_submitted"||L.status==="all_submitted"),[n]),U=d.useMemo(()=>Xe.map(L=>{const P=se.filter(Z=>Z.projectId===L.id);if(!P.length)return{id:L.id,name:L.name,desc:L.desc,students:L.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const Q={};Nn.forEach(Z=>{Q[Z.id]=P.reduce((de,ue)=>de+(ue[Z.id]||0),0)/P.length});const J=P.map(Z=>Z.total);return{id:L.id,name:L.name,desc:L.desc,students:L.students,count:P.length,avg:Q,totalAvg:J.reduce((Z,de)=>Z+de,0)/J.length,totalMin:Math.min(...J),totalMax:Math.max(...J)}}),[se]),m=d.useMemo(()=>U.map(L=>({...L,name:`Group ${L.id}`})),[U]),_=d.useMemo(()=>[...U].sort((L,P)=>P.totalAvg-L.totalAvg),[U]),B=d.useMemo(()=>Y.map(({key:L,name:P,dept:Q,jurorId:J})=>{const Z=n.filter(ie=>q(ie)===L),de=Z.filter(ie=>ie.status==="group_submitted"||ie.status==="all_submitted"),ue=Z.filter(ie=>ie.status==="all_submitted"),be=Z.filter(ie=>ie.status==="in_progress"),ye=Z.reduce((ie,De)=>De.tsMs>ie?De.tsMs:ie,0),ne=Z.find(ie=>ie.tsMs===ye)||Z[0],he=ue.length===He?"all_submitted":de.length>0||be.length>0?"in_progress":"not_started";return{key:L,jury:P,dept:Q,jurorId:J,rows:Z,submitted:de,completed:de,finalSubmitted:ue,inProgress:be,latestTs:ye,latestRow:ne,overall:he}}),[Y,n]);n.filter(L=>L.status==="in_progress").length,B.filter(L=>L.rows.some(P=>P.editingFlag==="editing")).length;const R=d.useMemo(()=>{const L=Y.length,P=le.length,Q=L*He,J=new Map;n.forEach(ne=>{if(ne.status!=="all_submitted")return;const he=q(ne);J.has(he)||J.set(he,new Set),J.get(he).add(ne.projectId)});const Z=Y.filter(ne=>{var he;return(((he=J.get(ne.key))==null?void 0:he.size)||0)>=He}).length,de=new Set(n.filter(ne=>ne.status==="editing"||ne.editingFlag==="editing").map(ne=>q(ne))),be=new Set(n.filter(ne=>ne.status==="in_progress").map(ne=>q(ne)).filter(ne=>!de.has(ne))).size,ye=de.size;return{completedJurors:Z,totalJurors:L,completedEvaluations:P,totalEvaluations:Q,inProgressJurors:be,editingJurors:ye}},[n,se,le,Y,q]);d.useEffect(()=>{if(u)try{sessionStorage.setItem("ee492_home_meta",JSON.stringify({totalJurors:R.totalJurors,completedJurors:R.completedJurors,lastUpdated:u.toISOString()}))}catch{}},[R.totalJurors,R.completedJurors,u]);const re=u?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",day:"2-digit",month:"2-digit",year:"numeric"}).format(u):"",me=u?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(u):"";return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsxs("div",{className:"form-header-main",children:[e.jsxs("div",{className:"header-left",children:[e.jsx("button",{className:"back-btn",onClick:t,"aria-label":"Back to home",children:e.jsx(We,{})}),e.jsx("div",{className:"header-title",children:e.jsxs("div",{className:"results-title-row",children:[e.jsx("h2",{children:"Results Panel"}),e.jsx("button",{className:"results-toggle",type:"button","aria-label":h?"Hide status metrics":"Show status metrics","aria-expanded":h,"aria-controls":"results-status-bar",onClick:()=>C(L=>!L),children:e.jsx("span",{className:`results-toggle-icon${h?" open":""}`,"aria-hidden":"true",children:"‚ñæ"})})]})})]}),e.jsxs("div",{className:"header-right",children:[u&&e.jsxs("span",{className:"last-updated",children:[e.jsx(ts,{}),e.jsxs("span",{className:"last-updated-text",children:[e.jsx("span",{className:"last-updated-date",children:re}),e.jsx("span",{className:"last-updated-time",children:me})]})]}),e.jsx("button",{className:`refresh-btn${o?" is-loading":""}`,onClick:X,"aria-label":"Refresh",title:"Refresh",children:e.jsx(kt,{})})]})]}),h&&e.jsx(Sn,{id:"results-status-bar",metrics:R}),e.jsxs("div",{className:"tab-bar-wrap",children:[e.jsx("div",{className:"tab-bar",ref:D,onScroll:K,children:wn.map(L=>e.jsxs("button",{className:`tab ${w===L.id?"active":""}`,onClick:()=>k(L.id),children:[e.jsx(L.icon,{}),L.label]},L.id))}),f&&e.jsxs("div",{className:"tab-hints","aria-hidden":"true",children:[e.jsx("span",{className:`tab-fade left${A?"":" is-hidden"}`}),e.jsx("span",{className:`tab-fade right${y?"":" is-hidden"}`}),e.jsx("span",{className:`tab-hint left${A?"":" is-hidden"}`,children:e.jsx(Rs,{})}),e.jsx("span",{className:`tab-hint right${y?"":" is-hidden"}`,children:e.jsx(Bs,{})})]})]})]}),o&&e.jsx("div",{className:"loading",children:"Loading data‚Ä¶"}),x&&e.jsx("div",{className:"error-msg",children:x}),i&&e.jsx("div",{className:"error-msg",children:i}),S&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${v}`,children:[v==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"üîë"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:S.juryName}),"‚Ä¶"]})]}),v==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon ok",children:"‚úÖ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:S.juryName})," will receive a new PIN on next login."]})]}),v==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon error",children:"‚ùå"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:S.juryName}),"."]})]})]})}),!o&&!x&&!i&&e.jsxs("div",{className:"admin-body",children:[w==="summary"&&e.jsx(Yt,{ranked:_,submittedData:se}),w==="dashboard"&&e.jsx(pn,{dashboardStats:m,submittedData:se,lastRefresh:u,loading:o,error:x}),w==="detail"&&e.jsx(gn,{data:n,jurors:Y,jurorColorMap:ce}),w==="jurors"&&e.jsx(vn,{jurorStats:B,jurors:Y,onPinReset:te}),w==="matrix"&&e.jsx(kn,{data:n,jurors:Y,groups:oe,jurorDeptMap:fe})]})]})}const Ln="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function Mn(){const[s,t]=d.useState("home"),r=d.useRef(""),[a,n]=d.useState(!1),[l,o]=d.useState(!1),[j,x]=d.useState(""),[c,i]=d.useState(""),[p,h]=d.useState(!1),[C,w]=d.useState(()=>{try{return JSON.parse(sessionStorage.getItem("ee492_home_meta")||"null")}catch{return null}});d.useEffect(()=>{if(s==="home")try{w(JSON.parse(sessionStorage.getItem("ee492_home_meta")||"null"))}catch{w(null)}},[s]);const k=G.length,u=Number.isFinite(k)?Math.max(0,k):0,N=Number(C==null?void 0:C.totalJurors),f=Number(C==null?void 0:C.completedJurors),b=Number.isFinite(N)?Math.max(0,N):0,A=Number.isFinite(f)?Math.min(Math.max(0,f),b):0,T=b>0,y=T&&A>=b,g=T?y?"completed":"inprogress":"empty",D=C!=null&&C.lastUpdated?new Date(C.lastUpdated):null,S=!!D&&Number.isFinite(D.getTime()),E=S?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",day:"2-digit",month:"short"}).format(D):"‚Äî",v=S?new Intl.DateTimeFormat("en-GB",{timeZone:"Europe/Istanbul",hour:"2-digit",minute:"2-digit",hour12:!1}).format(D):"‚Äî",I=T?`${A}/${b}`:"‚Äî",V=u>0?String(u):"‚Äî";function $(){const K=j.trim();if(!K){i("Please enter the admin password.");return}r.current=K,x(""),i(""),o(!0),n(!0)}function X(K){n(!1),o(!1),r.current="",i(K||"Authentication failed.")}return s==="jury"?e.jsx(Dt,{onBack:()=>t("home")}):s==="admin"?a?e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"admin-checking-overlay",children:e.jsxs("div",{className:"admin-checking-card",children:[e.jsx("div",{className:"admin-checking-icon","aria-hidden":"true",children:e.jsx(Nt,{})}),e.jsxs("div",{className:"admin-checking-msg",children:["Checking access",e.jsxs("span",{className:"admin-checking-dots","aria-hidden":"true",children:[e.jsx("span",{children:"."}),e.jsx("span",{children:"."}),e.jsx("span",{children:"."})]})]}),e.jsx("div",{className:"admin-checking-sub",children:"Secure session validation in progress"})]})}),e.jsx(Cn,{adminPass:r.current,onAuthError:X,onInitialLoadDone:()=>o(!1),onBack:()=>{t("home"),n(!1),o(!1),i(""),r.current=""}})]}):e.jsx("div",{className:"lock-screen",children:e.jsxs("div",{className:"lock-card",children:[e.jsx("div",{className:"lock-icon","aria-hidden":"true",children:e.jsx(Is,{})}),e.jsx("h2",{className:"lock-title",children:"Results Panel"}),e.jsx("p",{className:"lock-subtitle",children:"Enter the admin password to view results"}),e.jsxs("div",{className:"lock-input-wrap",children:[e.jsx("input",{type:p?"text":"password",placeholder:"Admin password",value:j,onChange:K=>{x(K.target.value),c&&i("")},onKeyDown:K=>{K.key==="Enter"&&$()},autoComplete:"current-password",autoFocus:!0}),e.jsx("button",{type:"button",className:"lock-toggle",onClick:()=>h(K=>!K),"aria-label":p?"Hide password":"Show password",title:p?"Hide password":"Show password",children:p?e.jsx(pt,{}):e.jsx(ht,{})})]}),c&&e.jsxs("div",{className:"login-error",role:"alert",children:[e.jsx(As,{}),e.jsx("span",{children:c})]}),e.jsx("button",{className:"btn-primary lock-login-btn",onClick:$,disabled:l,children:"Login"}),e.jsx("button",{className:"lock-back-btn",onClick:()=>{t("home"),i("")},children:"‚Üê Back to Home"}),e.jsx("div",{className:"lock-footnote",children:"Admin Access ‚Ä¢ Restricted"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:Ln,alt:"TED University",loading:"eager"})}),e.jsx("h1",{children:"Senior Project Jury Portal"}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsx("div",{className:"home-meta",children:e.jsxs("span",{className:`home-meta-pill home-meta-pill--${g}`,children:[e.jsxs("span",{className:"home-meta-block",children:[e.jsx("span",{className:"home-meta-icon","aria-hidden":"true",children:e.jsx(Ts,{})}),e.jsx("span",{className:"home-meta-value",children:I})]}),e.jsxs("span",{className:"home-meta-block",children:[e.jsx("span",{className:"home-meta-sep",children:"¬∑"}),e.jsx("span",{className:"home-meta-icon","aria-hidden":"true",children:e.jsx(xt,{})}),e.jsx("span",{className:"home-meta-value",children:V})]}),e.jsxs("span",{className:"home-meta-block",children:[e.jsx("span",{className:"home-meta-sep",children:"¬∑"}),e.jsx("span",{className:"home-meta-icon","aria-hidden":"true",children:e.jsx(ts,{})}),e.jsx("span",{className:"home-meta-time",children:E}),e.jsx("span",{className:"home-meta-sep",children:"¬∑"}),e.jsx("span",{className:"home-meta-time",children:v})]})]})}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big home-primary-btn",onClick:()=>t("jury"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx(rs,{})}),"Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big home-secondary-btn",onClick:()=>t("admin"),children:[e.jsx("span",{className:"home-btn-icon","aria-hidden":"true",children:e.jsx($s,{})}),"View Results"]})]}),e.jsxs("div",{className:"home-info",children:[e.jsx("span",{className:"home-info-icon","aria-hidden":"true",children:e.jsx(ns,{})}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["¬© 2026 ¬∑ Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})," ","¬∑ v1.0"]})]})]})}Ke.createRoot(document.getElementById("root")).render(e.jsx(Ys.StrictMode,{children:e.jsx(Mn,{})}));
