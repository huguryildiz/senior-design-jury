import{r as d,a as St,R as wt}from"./react-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Ze={exports:{}},we={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ct=d,Lt=Symbol.for("react.element"),Et=Symbol.for("react.fragment"),Mt=Object.prototype.hasOwnProperty,Ft=Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,It={key:!0,ref:!0,__self:!0,__source:!0};function et(t,s,r){var a,n={},i=null,u=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(u=s.ref);for(a in s)Mt.call(s,a)&&!It.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:Lt,type:t,key:i,ref:u,props:n,_owner:Ft.current}}we.Fragment=Et;we.jsx=et;we.jsxs=et;Ze.exports=we;var e=Ze.exports,Ae={},$e=St;Ae.createRoot=$e.createRoot,Ae.hydrateRoot=$e.hydrateRoot;const re={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 â€” Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},B=[{id:1,name:"Group 1",desc:"GÃ¶ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf Ãœnal","AyÃ§a Naz DedeoÄŸlu","Onur Mesci","Ã‡aÄŸan ErdoÄŸan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla Ã–zer","Bertan Ãœnver","Ada TatlÄ±","Nesibe AydÄ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren GermeÃ§"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis â€” Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine Ã‡aylan","Selimhan Kaynar","Abdulkadir SazlÄ±","Alp Efe Ä°pek"]},{id:6,name:"Group 6",desc:"AKKE â€” Smart Command and Control Glove",students:["Åževval KurtulmuÅŸ","Abdullah Esin","Berk Ã‡akmak","Ã–mer Efe Dikici"]}],V=[{id:"technical",label:"Technical Content",shortLabel:"Technical",mudek:"1.2 / 2 / 3",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21â€“26",level:"Good",desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13â€“20",level:"Developing",desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0â€“12",level:"Insufficient",desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",mudek:"9.2",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21â€“26",level:"Good",desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13â€“20",level:"Developing",desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0â€“12",level:"Insufficient",desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",mudek:"9.1",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21â€“26",level:"Good",desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13â€“20",level:"Developing",desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0â€“12",level:"Insufficient",desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",mudek:"8.1 / 8.2",max:10,rubric:[{range:"9â€“10",level:"Excellent",desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7â€“8",level:"Good",desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4â€“6",level:"Developing",desc:"Uneven participation. Some members are passive or unprepared."},{range:"0â€“3",level:"Insufficient",desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}];V.reduce((t,s)=>t+(Number(s.max)||0),0);const tt=re==null?void 0:re.scriptUrl,_e=re==null?void 0:re.apiSecret;function Re(t,s){const r=t.trim().toLowerCase()+"__"+s.trim().toLowerCase();let a=5381;for(let n=0;n<r.length;n++)a=(a<<5)+a^r.charCodeAt(n),a=a>>>0;return a.toString(16).padStart(8,"0")}let Te="";function Be(t){Te=t}function Se(){return Te}function Oe(){Te=""}async function ae(t){const s=Se();try{await fetch(tt,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,token:s})})}catch{}}async function ue(t){const s=new URLSearchParams(t).toString(),r=await fetch(`${tt}?${s}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=(await r.text()).trim();if(a.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script â€” check your deployment URL.");try{return JSON.parse(a)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function st(t){return ue({...t,token:Se()})}function he(t,s,r,a,n,i,u){var x,m,l,o;return{juryName:t,juryDept:s,jurorId:r,timestamp:new Date().toISOString(),projectId:i.id,projectName:i.name,technical:((x=a[i.id])==null?void 0:x.technical)??"",design:((m=a[i.id])==null?void 0:m.design)??"",delivery:((l=a[i.id])==null?void 0:l.delivery)??"",teamwork:((o=a[i.id])==null?void 0:o.teamwork)??"",total:At(a,i.id),comments:n[i.id]||"",status:u}}function At(t,s){return V.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}async function Dt(t){return ue({action:"checkPin",jurorId:t,secret:_e})}async function Pt(t,s,r){return ue({action:"createPin",jurorId:t,juryName:s.trim(),juryDept:r.trim(),secret:_e})}async function _t(t,s){return ue({action:"verifyPin",jurorId:t,pin:String(s).trim(),secret:_e})}async function We(){const t=await st({action:"myscores"});if(t.status==="unauthorized"){const s=new Error("unauthorized");throw s.unauthorized=!0,s}return t.status!=="ok"?null:t.rows||[]}async function Ge(){return st({action:"ping"})}const ze=1500,xe=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(V.map(s=>[s.id,""]))])),je=()=>Object.fromEntries(B.map(t=>[t.id,""])),Je=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(V.map(s=>[s.id,!1]))])),Tt=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(V.map(s=>[s.id,!0]))])),de=(t,s)=>V.every(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""}),Ue=t=>B.every(s=>de(t,s.id)),nt=t=>B.reduce((s,r)=>s+V.reduce((a,n)=>{var i;return a+(((i=t[r.id])==null?void 0:i[n.id])!==""?1:0)},0),0),$t=(t,s)=>V.some(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""});function Fe(t){const s=xe(),r=je();return(t||[]).forEach(a=>{const n=Number(a.projectId);n&&(s[n]={...s[n],technical:a.technical??"",design:a.design??"",delivery:a.delivery??"",teamwork:a.teamwork??""},r[n]=a.comments??"")}),{scores:s,comments:r}}function Rt(){const[t,s]=d.useState(""),[r,a]=d.useState(""),n=d.useRef("");d.useEffect(()=>{n.current=t.trim()&&r.trim()?Re(t,r):""},[t,r]);const[i,u]=d.useState("info"),[x,m]=d.useState(0),[l,o]=d.useState(xe),[h,v]=d.useState(je),[I,p]=d.useState(Je),[j,A]=d.useState({}),[b,N]=d.useState(!1),[E,k]=d.useState(null),[S,_]=d.useState(null),[Y,G]=d.useState(null),[z,q]=d.useState("idle"),[w,$]=d.useState("idle"),[U,K]=d.useState(""),[H,c]=d.useState(""),[P,L]=d.useState(3),[J,X]=d.useState(!1),[g,C]=d.useState(""),W=d.useRef(!1),T=d.useRef({});T.current={juryName:t,juryDept:r,scores:l,comments:h,groupSynced:j,current:x};const O=d.useRef(l),Q=d.useRef(h),ee=d.useCallback(f=>{const{juryName:y,juryDept:M}=T.current,F=n.current,D=O.current,R=Q.current;if(!y.trim()||!F||!Se()||!$t(D,f))return;const te=B.find(kt=>kt.id===f);if(!te)return;const ye=de(D,f)?"group_submitted":"in_progress",Nt=he(y,M,F,D,R,te,ye);q("saving"),ae({rows:[Nt]}),setTimeout(()=>q("saved"),500),setTimeout(()=>q("idle"),2500)},[]),ve=d.useCallback(f=>{var F;const{current:y}=T.current,M=(F=B[y])==null?void 0:F.id;M!==void 0&&ee(M),m(f)},[ee]);d.useEffect(()=>{if(i!=="eval"||b)return;const f={};B.forEach(y=>{!j[y.id]&&de(l,y.id)&&(f[y.id]=!0)}),Object.keys(f).length>0&&A(y=>({...y,...f}))},[l,i,j,b]),d.useEffect(()=>{if(i!=="eval"||W.current||b||!B.every(y=>j[y.id]))return;W.current=!0;const f=setTimeout(()=>{const{juryName:y,juryDept:M,scores:F,comments:D}=T.current,R=n.current;ae({rows:B.map(te=>he(y,M,R,F,D,te,"all_submitted"))}),k({...F}),_({...D}),u("done")},800);return()=>clearTimeout(f)},[j,i,b]);const be=d.useCallback((f,y,M)=>{const F={...O.current,[f]:{...O.current[f],[y]:M}};O.current=F,o(F),p(D=>({...D,[f]:{...D[f],[y]:!0}})),M===""&&j[f]&&A(D=>({...D,[f]:!1}))},[j]),Ee=d.useCallback((f,y)=>{var D;const M=V.find(R=>R.id===y),F=(D=O.current[f])==null?void 0:D[y];if(p(R=>({...R,[f]:{...R[f],[y]:!0}})),F!==""&&F!==void 0){const R=parseInt(F,10),te=Number.isFinite(R)?Math.min(Math.max(R,0),M.max):0;if(String(te)!==String(F)){const ye={...O.current,[f]:{...O.current[f],[y]:te}};O.current=ye,o(ye)}}ee(f)},[ee]),Me=d.useCallback((f,y)=>{const M={...Q.current,[f]:y};Q.current=M,v(M)},[]),Z=d.useCallback(f=>{ee(f)},[ee]),me=d.useCallback((f,y)=>{const{juryName:M,juryDept:F}=T.current,D=n.current;ae({rows:B.map(R=>he(M,F,D,f,y,R,"all_submitted"))}),k({...f}),_({...y}),N(!1),W.current=!0,u("done")},[]),lt=d.useCallback(async()=>{const{juryName:f,juryDept:y}=T.current,M=n.current,F=E||l,D=S||h;M&&ae({action:"resetJuror"}),O.current=F,Q.current=D,o(F),v(D),N(!0),W.current=!1,A(Object.fromEntries(B.map(R=>[R.id,!0]))),u("eval"),setTimeout(()=>{M&&ae({rows:B.map(R=>he(f,y,M,F,D,R,"group_submitted"))})},ze)},[E,S,l,h]),ct=d.useCallback(()=>{if(!Ue(l)){p(Tt());const f=B.findIndex(y=>!de(l,y.id));f>=0&&m(f);return}me(l,h)},[l,h,me]),ie=d.useCallback(f=>{Oe(),C(f||"Your session has expired. Please enter your PIN again."),X(!0)},[]),dt=d.useCallback(()=>{X(!1),C(""),K(""),$("entering"),u("pin")},[]),oe=d.useCallback(async()=>{G({loading:!0});let f=[];try{f=await We()||[]}catch(D){if(D.unauthorized){ie("Your session has expired. Please enter your PIN again.");return}}const y=B.length,M=f.filter(D=>D.status==="group_submitted"||D.status==="all_submitted").length,F=f.length>=y&&f.every(D=>D.status==="all_submitted");G({rows:f,filledCount:M,totalCount:y,allSubmitted:F})},[ie]);d.useEffect(()=>{if(i!=="eval")return;const f=setInterval(async()=>{try{(await Ge()).status==="unauthorized"&&ie("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(f)},[i,ie]),d.useEffect(()=>{if(i!=="eval")return;async function f(){if(document.visibilityState==="visible")try{(await Ge()).status==="unauthorized"&&ie("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",f),()=>document.removeEventListener("visibilitychange",f)},[i,ie]);const ut=d.useCallback(()=>{const f=Y;if(f){if(G(null),f.allSubmitted){const{scores:y,comments:M}=Fe(f.rows);O.current=y,Q.current=M,o(y),v(M),k(y),_(M),A(Object.fromEntries(B.map(F=>[F.id,!0]))),W.current=!0,u("done");return}if(f.rows.length>0){const{scores:y,comments:M}=Fe(f.rows),F=Object.fromEntries(f.rows.filter(R=>R.status==="group_submitted"||R.status==="all_submitted").map(R=>[Number(R.projectId),!0]));O.current=y,Q.current=M,o(y),v(M),A(F);const D=B.findIndex(R=>!de(y,R.id));m(D>=0?D:0),W.current=!1}u("eval")}},[Y]),mt=d.useCallback(()=>{const f=xe(),y=je();O.current=f,Q.current=y,G(null),o(f),v(y),A({}),m(0),W.current=!1,N(!1),u("eval")},[]),ht=d.useCallback(async()=>{const{juryName:f,juryDept:y}=T.current,M=n.current;let F=xe(),D=je();try{const R=await We();if(R!=null&&R.length){const te=Fe(R);F=te.scores,D=te.comments}}catch{}M&&ae({action:"resetJuror"}),O.current=F,Q.current=D,o(F),v(D),k(F),_(D),N(!0),W.current=!1,A(Object.fromEntries(B.map(R=>[R.id,!0]))),u("eval"),setTimeout(()=>{M&&ae({rows:B.map(R=>he(f,y,M,F,D,R,"group_submitted"))})},ze)},[]),pt=d.useCallback(async()=>{const{juryName:f,juryDept:y}=T.current;if(!f.trim()||!y.trim())return;const M=Re(f,y);if(n.current=M,G({loading:!0}),Se()){await oe();return}try{const F=await Dt(M);if(F.status!=="ok"){G(null),K("Could not reach the server. Please try again."),$("entering"),u("pin");return}if(F.exists)G(null),$("entering"),K(""),L(3),u("pin");else{const D=await Pt(M,f,y);D.status==="ok"?(G(null),Be(D.token),c(D.pin),$("new"),u("pin")):(G(null),K("Could not create a PIN. Please try again."),$("entering"),u("pin"))}}catch{G(null),K("Connection error. Please check your network and try again."),$("entering"),u("pin")}},[oe]),xt=d.useCallback(async f=>{const y=n.current;G({loading:!0});try{const M=await _t(y,f);if(M.locked){G(null),$("locked"),K("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(M.valid){Be(M.token||""),$("idle"),K(""),await oe();return}G(null);const F=typeof M.attemptsLeft=="number"?M.attemptsLeft:P-1;L(F),F<=0?($("locked"),K("Too many failed attempts. Please contact the admin.")):K(`Incorrect PIN. ${F} attempt${F!==1?"s":""} remaining.`)}catch{G(null),K("Could not verify PIN. Please try again.")}},[P,oe]),jt=d.useCallback(async()=>{await oe()},[oe]),ft=d.useCallback(()=>{const f=xe(),y=je();O.current=f,Q.current=y,s(""),a(""),u("info"),m(0),o(f),v(y),p(Je()),A({}),G(null),N(!1),k(null),_(null),q("idle"),$("idle"),K(""),c(""),L(3),W.current=!1,n.current="",Oe()},[]),gt=B[x],vt=B.length*V.length,bt=Math.round(nt(l)/vt*100),yt=Ue(l);return{juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,jurorId:n.current,step:i,setStep:u,current:x,handleNavigate:ve,scores:l,comments:h,touched:I,handleScore:be,handleScoreBlur:Ee,handleCommentChange:Me,handleCommentBlur:Z,project:gt,progressPct:bt,allComplete:yt,groupSynced:j,editMode:b,doneScores:E,doneComments:S,sheetProgress:Y,saveStatus:z,pinStep:w,pinError:U,newPin:H,attemptsLeft:P,handlePinSubmit:xt,handlePinAcknowledge:jt,sessionKicked:J,kickedMsg:g,handleKickedAcknowledge:dt,handleStart:pt,handleConfirmFromSheet:ut,handleStartFresh:mt,handleResubmit:ht,handleEditScores:lt,handleFinalSubmit:ct,resetAll:ft}}function Ce(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9.5L12 3l9 6.5V20a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9.5z"}),e.jsx("polyline",{points:"9 21 9 12 15 12 15 21"})]})}function Ke(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function Bt(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#FCD34D"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#F59E0B"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#F59E0B"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#FCD34D"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#92400E",fontFamily:"sans-serif",children:"1"})]})}function Ot(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#CBD5E1"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#94A3B8"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#94A3B8"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#CBD5E1"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#334155",fontFamily:"sans-serif",children:"2"})]})}function Wt(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#FDBA74"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#B45309"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#B45309"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#FDBA74"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#7C2D12",fontFamily:"sans-serif",children:"3"})]})}function Gt(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M23 4v6h-6"}),e.jsx("path",{d:"M1 20v-6h6"}),e.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function zt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function Jt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function rt(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function Ut({juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,onStart:n,onBack:i}){const u=t.trim().length>0&&r.trim().length>0;return e.jsxs("div",{className:"form-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:i,"aria-label":"Back to home",children:e.jsx(Ce,{})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Evaluation Form"}),e.jsx("p",{children:"EE 491/492 â€” Senior Project Poster Day"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:"Jury Member Information"}),e.jsx("div",{className:"identity-warning",children:"âš ï¸ Please enter your name and department carefully. Once you begin the evaluation, these cannot be changed."}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:t,onChange:x=>s(x.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department / Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:x=>a(x.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:x=>{x.key==="Enter"&&u&&n()}})]}),e.jsx("p",{className:"draft-device-note",children:"â„¹ï¸ Scores save automatically when you fill in each field or navigate between groups. Your PIN lets you continue from any device."}),e.jsx("button",{className:"btn-primary",disabled:!u,onClick:n,children:"Start Evaluation â†’"})]})]})}function Kt({onSubmit:t,pinError:s}){const[r,a]=d.useState(["","","",""]),n=[d.useRef(null),d.useRef(null),d.useRef(null),d.useRef(null)];d.useEffect(()=>{s&&(a(["","","",""]),setTimeout(()=>{var o;return(o=n[0].current)==null?void 0:o.focus()},50))},[s]);function i(o,h){var p;const v=h.replace(/\D/g,"").slice(-1),I=[...r];I[o]=v,a(I),v&&o<3&&((p=n[o+1].current)==null||p.focus())}function u(o,h){var v,I,p;if(h.key==="Backspace")if(r[o]===""&&o>0){const j=[...r];j[o-1]="",a(j),(v=n[o-1].current)==null||v.focus()}else{const j=[...r];j[o]="",a(j)}if(h.key==="ArrowLeft"&&o>0&&((I=n[o-1].current)==null||I.focus()),h.key==="ArrowRight"&&o<3&&((p=n[o+1].current)==null||p.focus()),h.key==="Enter"){const j=r.join("");j.length===4&&t(j)}}function x(o){var v;const h=o.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(h.length===4){const I=h.split("");a(I),(v=n[3].current)==null||v.focus()}o.preventDefault()}function m(){const o=r.join("");o.length===4&&t(o)}const l=r.every(o=>o!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((o,h)=>e.jsx("input",{ref:n[h],type:"password",inputMode:"numeric",maxLength:1,value:o,autoFocus:h===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:v=>i(h,v.target.value),onKeyDown:v=>u(h,v),onPaste:h===0?x:void 0,className:"pin-box"},h))}),e.jsx("button",{className:"btn-primary pin-ok-btn",onClick:m,disabled:!l,children:"OK â†’"})]})}function Vt({pinStep:t,pinError:s,newPin:r,attemptsLeft:a,juryName:n,onPinSubmit:i,onPinAcknowledge:u}){return t==="new"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Ke,{})}),e.jsx("h3",{children:"Your Access PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome, ",e.jsx("strong",{children:n}),"! A 4-digit PIN has been assigned to protect your evaluations. Please save it â€” you will need it every time you log in from a new device or browser tab."]}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((x,m)=>e.jsx("span",{className:"pin-digit",children:x},m))}),e.jsx("p",{className:"pin-hint",children:"ðŸ”’ Keep this PIN private. If you lose it, contact the admin to reset it."}),e.jsx("button",{className:"btn-primary",onClick:u,children:"I've saved my PIN â€” Continue â†’"})]})}):t==="locked"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap lock-icon",children:"ðŸ”’"}),e.jsx("h3",{children:"Account Locked"}),e.jsx("p",{className:"pin-error-msg",children:s})]})}):e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Ke,{})}),e.jsx("h3",{children:"Enter Your PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome back, ",e.jsx("strong",{children:n}),". Enter your 4-digit PIN and press OK to continue."]}),e.jsx(Kt,{onSubmit:i,pinError:s}),s&&e.jsx("div",{className:"pin-error-msg",children:s})]})})}function Yt(t){return t===0?"#e2e8f0":t<34?"linear-gradient(90deg,#ef4444,#f97316)":t<67?"linear-gradient(90deg,#f97316,#eab308)":t<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function qt({saveStatus:t}){return t==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"â³ Savingâ€¦"}):t==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"âœ“ Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"â— Auto-saving"})}function Ht({juryName:t,juryDept:s,current:r,onNavigate:a,scores:n,comments:i,touched:u,groupSynced:x,editMode:m,progressPct:l,allComplete:o,saveStatus:h,handleScore:v,handleScoreBlur:I,handleCommentChange:p,handleCommentBlur:j,handleFinalSubmit:A,onGoHome:b}){var q;const[N,E]=d.useState(!1),[k,S]=d.useState(null),_=B[r],Y=(w,$)=>{const U=V.filter(H=>{var c;return((c=n[w.id])==null?void 0:c[H.id])!==""}).length;return`${de(n,w.id)?"âœ…":"âš ï¸"} ${w.name} (${U}/${V.length})`},G=()=>{r>0&&a(r-1)},z=()=>{r<B.length-1&&a(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"ðŸ‘¤"}),e.jsxs("span",{className:"eval-identity-text",children:[t,s&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",s,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(qt,{saveStatus:h})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>E(!0),"aria-label":"Home",children:e.jsx(Ce,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:_.name}),e.jsx("span",{className:"eval-project-name",children:_.desc})]}),((q=_.students)==null?void 0:q.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["ðŸ‘¥ ",_.students.join(" Â· ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:G,disabled:r===0,"aria-label":"Previous group",children:e.jsx(zt,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:w=>a(Number(w.target.value)),children:B.map((w,$)=>e.jsx("option",{value:$,children:Y(w)},w.id))}),e.jsx("button",{className:"group-nav-btn",onClick:z,disabled:r===B.length-1,"aria-label":"Next group",children:e.jsx(Jt,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${l}%`,background:Yt(l)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(l),"%"]})]})})]}),N&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>E(!1),children:e.jsxs("div",{className:"back-menu",onClick:w=>w.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{E(!1),b()},children:"ðŸ  Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>E(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[x[_.id]&&!m&&e.jsx("div",{className:"group-done-banner",children:"âœ… All scores saved for this group."}),m&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["âœï¸ Edit mode â€” adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),V.map(w=>{var H,c;const $=((H=n[_.id])==null?void 0:H[w.id])??"",U=((c=u[_.id])==null?void 0:c[w.id])&&$==="",K=(parseInt($,10)||0)/w.max*100;return e.jsxs("div",{className:`crit-card${U?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:w.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",w.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>S(k===w.id?null:w.id),children:k===w.id?"Hide Rubric â–²":"Show Rubric â–¼"})]}),k===w.id&&e.jsx("div",{className:"rubric-table",children:w.rubric.map(P=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:P.range}),e.jsx("div",{className:"rubric-level",children:P.level}),e.jsx("div",{className:"rubric-desc",children:P.desc})]},P.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:w.max,value:$,onChange:P=>v(_.id,w.id,P.target.value),onBlur:()=>I(_.id,w.id),placeholder:"â€”",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${K}%`}})}),e.jsx("span",{className:"score-pct",children:$!==""?`${$} / ${w.max}`:`â€” / ${w.max}`})]}),U&&e.jsx("div",{className:"required-hint",children:"Required"})]},w.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:i[_.id]||"",onChange:w=>p(_.id,w.target.value),onBlur:()=>j(_.id),placeholder:"Any additional feedback about this groupâ€¦",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const w=V.reduce(($,U)=>{var K;return $+(parseInt((K=n[_.id])==null?void 0:K[U.id],10)||0)},0);return e.jsxs("span",{className:`total-score${w>=80?" high":w>=60?" mid":""}`,children:[w," / 100"]})})()]}),m&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:o?1:.65},onClick:A,children:o?"âœ… Submit Final":`âš ï¸ Submit Final (${nt(n)} / ${B.length*V.length} filled)`})]})]})}function Xt(t,s){return V.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}function Qt({doneScores:t,scores:s,onEditScores:r,onBack:a}){const n=t||s,[i,u]=d.useState(new Set);function x(m){u(l=>{const o=new Set(l);return o.has(m)?o.delete(m):o.add(m),o})}return e.jsx("div",{className:"done-screen",children:e.jsxs("div",{className:"done-card",children:[e.jsx("div",{className:"done-icon",children:"ðŸŽ‰"}),e.jsx("h2",{children:"Thank You!"}),e.jsx("p",{className:"done-subtitle",children:"Your evaluations have been recordedâ€”thank you for your feedback."}),e.jsx("div",{className:"done-summary",children:B.map(m=>{var v,I;const l=i.has(m.id),o=`done-group-panel-${m.id}`,h=!!m.desc||((v=m.students)==null?void 0:v.length)>0;return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:h?0:-1,"aria-expanded":l,"aria-controls":o,onClick:()=>{h&&x(m.id)},onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&h&&(p.preventDefault(),x(m.id))},style:{cursor:h?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:m.name}),h&&e.jsx("span",{className:`group-accordion-chevron${l?" open":""}`,children:e.jsx(rt,{})})]})}),e.jsx("div",{className:"done-row-right",children:e.jsxs("span",{className:"done-score",children:[e.jsx("span",{className:"done-score-main",children:Xt(n,m.id)}),e.jsx("span",{className:"done-score-max",children:" / 100"})]})})]}),e.jsx("div",{id:o,className:`group-accordion-panel${l?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[m.desc&&e.jsx("span",{className:"done-row-desc",children:m.desc}),((I=m.students)==null?void 0:I.length)>0&&e.jsxs("span",{className:"done-row-students",children:["ðŸ‘¥ ",m.students.join(" Â· ")]})]})})]},m.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:r,children:"âœï¸ Edit Scores"}),e.jsxs("button",{className:"btn-primary",onClick:a,children:[e.jsx(Ce,{})," Back to Home"]})]})]})})}function Zt(t){return t==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:t==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:t==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"â€”",color:"#64748b",bg:"#f1f5f9"}}function Ne({progress:t,onConfirm:s,onFresh:r}){if(!t)return null;if(t.loading)return e.jsx("div",{className:"spd-overlay",children:e.jsx("div",{className:"spd-card",children:e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:"â³"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:"Checking your progressâ€¦"}),e.jsx("div",{className:"spd-sub",children:"Connecting to server"})]})]})})});const{rows:a,filledCount:n,totalCount:i,allSubmitted:u}=t,x=a&&a.length>0;return e.jsx("div",{className:"spd-overlay",children:e.jsxs("div",{className:"spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:u?"âœ…":x?"â˜ï¸":"ðŸ“‹"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:u?"All evaluations submitted":x?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[n," / ",i," groups completed on server"]})]})]}),x&&e.jsx("div",{className:"spd-list",children:B.map(m=>{const l=a.find(v=>Number(v.projectId)===m.id),o=Zt(l==null?void 0:l.status),h=(l==null?void 0:l.total)??"â€”";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:m.name}),e.jsx("span",{className:"spd-row-total",children:h!=="â€”"?`${h}/100`:"â€”"}),e.jsx("span",{className:"spd-chip",style:{color:o.color,background:o.bg},children:o.label})]},m.id)})}),!x&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"btn-primary",onClick:s,children:u?"View / Edit My Scores":x?"Continue from here":"Start Evaluation"}),x&&!u&&e.jsx("button",{className:"btn-secondary",onClick:r,children:"Start Fresh"})]})]})})}function es({onBack:t}){const{step:s,juryName:r,setJuryName:a,juryDept:n,setJuryDept:i,current:u,handleNavigate:x,scores:m,comments:l,touched:o,groupSynced:h,editMode:v,progressPct:I,allComplete:p,doneScores:j,doneComments:A,sheetProgress:b,saveStatus:N,pinStep:E,pinError:k,newPin:S,attemptsLeft:_,handleScore:Y,handleScoreBlur:G,handleCommentChange:z,handleCommentBlur:q,handleStart:w,handleConfirmFromSheet:$,handleStartFresh:U,handleResubmit:K,handleEditScores:H,handleFinalSubmit:c,handlePinSubmit:P,handlePinAcknowledge:L,sessionKicked:J,kickedMsg:X,handleKickedAcknowledge:g,resetAll:C}=Rt();return J?e.jsx("div",{className:"kicked-overlay",children:e.jsxs("div",{className:"kicked-card",children:[e.jsx("div",{className:"kicked-icon",children:"ðŸ”"}),e.jsx("div",{className:"kicked-title",children:"Session Ended"}),e.jsx("div",{className:"kicked-body",children:X}),e.jsx("button",{className:"btn-primary",onClick:g,children:"Sign in again"})]})}):s==="done"?e.jsxs(e.Fragment,{children:[e.jsx(Qt,{doneScores:j,doneComments:A,scores:m,comments:l,onEditScores:H,onBack:()=>{C(),t()}}),e.jsx(Ne,{progress:b,onConfirm:$,onFresh:U})]}):s==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(Vt,{pinStep:E,pinError:k,newPin:S,attemptsLeft:_,juryName:r,onPinSubmit:P,onPinAcknowledge:L}),e.jsx(Ne,{progress:b,onConfirm:$,onFresh:U})]}):s==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(Ht,{juryName:r,juryDept:n,current:u,onNavigate:x,scores:m,comments:l,touched:o,groupSynced:h,editMode:v,progressPct:I,allComplete:p,saveStatus:N,handleScore:Y,handleScoreBlur:G,handleCommentChange:z,handleCommentBlur:q,handleFinalSubmit:c,onGoHome:t}),e.jsx(Ne,{progress:b,onConfirm:$,onFresh:U})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ut,{juryName:r,setJuryName:a,juryDept:n,setJuryDept:i,onStart:w,onBack:t}),e.jsx(Ne,{progress:b,onConfirm:$,onFresh:U})]})}const ts="modulepreload",ss=function(t){return"/senior-design-jury/"+t},Ve={},ns=function(s,r,a){if(!r||r.length===0)return s();const n=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=ss(i),i in Ve)return;Ve[i]=!0;const u=i.endsWith(".css"),x=u?'[rel="stylesheet"]':"";if(!!a)for(let o=n.length-1;o>=0;o--){const h=n[o];if(h.href===i&&(!u||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${x}`))return;const l=document.createElement("link");if(l.rel=u?"stylesheet":ts,u||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),u)return new Promise((o,h)=>{l.addEventListener("load",o),l.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>s()).catch(i=>{const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=i,window.dispatchEvent(u),!u.defaultPrevented)throw i})},at=new Map(B.map((t,s)=>typeof t=="string"?[s+1,{desc:"",students:[]}]:[t.id??s+1,{desc:t.desc??"",students:t.students??[]}]));function le(t){const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:0}function Le(t){if(!t)return 0;const s=String(t).trim().replace(/\s*,\s*/g,", "),r=Date.parse(s);if(Number.isFinite(r))return r;const a=s.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(a)return new Date(+a[3],+a[2]-1,+a[1],+a[4],+a[5],+(a[6]||0)).getTime()||0;const n=s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let i=+(n[4]||0);const u=(n[7]||"").toUpperCase();return u==="PM"&&i<12&&(i+=12),u==="AM"&&i===12&&(i=0),new Date(+n[3],+n[1]-1,+n[2],i,+(n[5]||0),+(n[6]||0)).getTime()||0}function De(t){if(!t)return"â€”";const s=Le(t);if(!s)return String(t);const r=new Date(s),a=n=>String(n).padStart(2,"0");return`${a(r.getDate())}/${a(r.getMonth()+1)}/${r.getFullYear()} ${a(r.getHours())}:${a(r.getMinutes())}`}function fe(t,s){const r=Number(t),a=Number(s);return Number.isFinite(r)&&Number.isFinite(a)?r-a:String(t??"").toLowerCase()<String(s??"").toLowerCase()?-1:1}function it(t){let s=2166136261;for(let r=0;r<t.length;r++)s^=t.charCodeAt(r),s=Math.imul(s,16777619);return s>>>0}function ot(t,s,r){s/=100,r/=100;const a=u=>(u+t/30)%12,n=s*Math.min(r,1-r),i=u=>Math.round(255*(r-n*Math.max(-1,Math.min(a(u)-3,Math.min(9-a(u),1))))).toString(16).padStart(2,"0");return`#${i(0)}${i(8)}${i(4)}`}const rs=t=>ot(it(t||"?")%360,55,95),as=t=>ot(it(t||"?")%360,65,55);function se(t){return t===""||t===null||t===void 0||typeof t=="string"&&t.trim()===""||typeof t=="number"&&!Number.isFinite(t)?"":t}function is(t){const s=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],r=l=>{const o=String(l??"").replace(/\r\n|\r/g,`
`);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o},a=[s.map(r).join(","),...t.map(l=>{const o=at.get(l.projectId)||{desc:"",students:[]};return[l.juryName,l.juryDept,l.timestamp,l.projectName,o.desc,o.students.join(" Â· "),se(l.technical),se(l.design),se(l.delivery),se(l.teamwork),se(l.total),l.comments].map(r).join(",")})],n=new Date,i=n.toISOString().slice(0,10),u=`${String(n.getHours()).padStart(2,"0")}-${String(n.getMinutes()).padStart(2,"0")}`,x=new Blob(["\uFEFF"+a.join(`
`)],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(x);Object.assign(document.createElement("a"),{href:m,download:`jury_export_${i}_${u}.csv`}).click(),URL.revokeObjectURL(m)}async function os(t){const s=await ns(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],a=t.map(l=>{const o=at.get(l.projectId)||{desc:"",students:[]};return[l.juryName??"",l.juryDept??"",l.timestamp??"",l.projectName??"",o.desc,o.students.join(" Â· "),se(l.technical),se(l.design),se(l.delivery),se(l.teamwork),se(l.total),l.comments??""]}),n=s.utils.aoa_to_sheet([r,...a]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(l=>({wch:l}));const i=s.utils.book_new();s.utils.book_append_sheet(i,n,"Jury Evaluations");const u=new Date,x=u.toISOString().slice(0,10),m=`${String(u.getHours()).padStart(2,"0")}-${String(u.getMinutes()).padStart(2,"0")}`;s.writeFile(i,`jury_export_${x}_${m}.xlsx`)}const ls=t=>t.reduce((s,r)=>s+V.filter(a=>r[a.id]>0).length,0),cs=t=>{const s=B.length*V.length;return s===0?0:Math.round(ls(t)/s*100)};function ds(t){const s={all_submitted:3,group_submitted:2,in_progress:1},r=(t||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:Le(n==null?void 0:n.timestamp)})),a=new Map;for(const n of r){const i=String(n.juryName??"").trim().toLowerCase(),u=String(n.juryDept??"").trim().toLowerCase(),x=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!i||!x)continue;const m=`${i}__${u}__${x}`,l=a.get(m);if(!l){a.set(m,n);continue}if((n.tsMs||0)>(l.tsMs||0)){a.set(m,n);continue}(n.tsMs||0)===(l.tsMs||0)&&(s[n.status]||0)>(s[l.status]||0)&&a.set(m,n)}return[...a.values()].sort((n,i)=>(i.tsMs||0)-(n.tsMs||0))}const us=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M3 9.5L10 2.5L11.5 4L4.5 11H3Z"}),e.jsx("path",{d:"M9.5 3.5L11 5"})]}),Ye=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 7L6 10L11 4"})}),ms=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("circle",{cx:"7",cy:"7",r:"2.5"})});function ke({status:t,editingFlag:s}){return s==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(us,{}),"Editing"]}):t==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Ye,{}),"Submitted"]}):t==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Ye,{}),"Submitted"]}):t==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(ms,{}),"In Progress"]}):null}const hs=V.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Ie=t=>[{bg:"#F59E0B",fg:"#0B1220",ring:"#FCD34D"},{bg:"#94A3B8",fg:"#0B1220",ring:"#CBD5E1"},{bg:"#B45309",fg:"#FFF7ED",ring:"#FDBA74"}][t]??{bg:"#475569",fg:"#F1F5F9",ring:"#94A3B8"},ps=[Bt,Ot,Wt],xs=t=>{const s=ps[t];return s?e.jsx(s,{}):String(t+1)};function js({ranked:t,submittedData:s}){return s.length===0?e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"summary-note",style:{marginBottom:16,padding:"10px 14px",borderRadius:12,background:"#EFF6FF",border:"1px solid #BFDBFE",color:"#1E3A8A",fontSize:13,fontWeight:500},children:["â„¹ï¸ Averages and rankings include only ",e.jsx("strong",{children:"final submissions"}),"."]}),e.jsx("div",{className:"rank-list",children:t.map((r,a)=>{var n;return e.jsxs("div",{className:"rank-card",style:a<3?{background:"#ECFDF5",boxShadow:"0 0 0 1px #BBF7D0, 0 8px 22px rgba(34,197,94,0.18)",border:"1px solid #86EFAC"}:void 0,children:[e.jsx("div",{className:"rank-num",style:{width:52,height:52,borderRadius:999,display:"grid",placeItems:"center",fontSize:a<3?22:18,fontWeight:800,background:a<3?"transparent":Ie(a).bg,color:Ie(a).fg,boxShadow:a<3?"0 0 0 5px rgba(34,197,94,0.25)":"0 6px 18px rgba(15,23,42,0.12)",border:a<3?"none":`3px solid ${Ie(a).ring}`,overflow:"hidden",padding:0},children:xs(a)}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"rank-name-block",children:[e.jsx("span",{className:"rank-group-name",children:r.name}),r.desc&&e.jsx("span",{className:"rank-desc-line",children:r.desc}),((n=r.students)==null?void 0:n.length)>0&&e.jsxs("span",{className:"rank-students-line",children:["ðŸ‘¥ ",r.students.join(" Â· ")]}),e.jsxs("span",{className:"rank-eval-count",children:["(",r.count," evaluation",r.count!==1?"s":"",")"]})]}),e.jsx("div",{className:"rank-bars",children:hs.map(i=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:i.shortLabel||i.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(r.avg[i.id]||0)/i.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(r.avg[i.id]||0).toFixed(2)})]},i.id))})]}),e.jsxs("div",{className:"rank-total",children:[e.jsx("span",{children:r.totalAvg.toFixed(2)}),e.jsx("small",{children:"avg."})]})]},r.id??`${r.name}-${a}`)})})]})}const ne=V.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),qe=["#3b82f6","#10b981","#f59e0b","#ef4444"];function fs(t){if(t.length<2)return 0;const s=t.reduce((r,a)=>r+a,0)/t.length;return Math.sqrt(t.reduce((r,a)=>r+(a-s)**2,0)/t.length)}function ge({msg:t}){return e.jsx("div",{className:"chart-empty",children:t||"Not enough data yet."})}function gs({stats:t}){const s=t.filter(r=>r.count>0);return s.length?e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Group Average Total Score"}),e.jsx("div",{className:"chart-subtitle",children:"Bar = average Â· Ticks = min / max range"}),s.map(r=>{const a=r.totalAvg/100*100,n=r.totalMin/100*100,i=r.totalMax/100*100;return e.jsxs("div",{className:"hbar-row",children:[e.jsx("span",{className:"hbar-label",title:r.desc||r.name,children:r.name}),e.jsxs("div",{className:"hbar-track",children:[e.jsx("div",{className:"hbar-fill",style:{width:`${a}%`}}),e.jsx("div",{className:"hbar-range",style:{left:`${n}%`,width:`${Math.max(i-n,1)}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${n}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${i}%`}})]}),e.jsx("span",{className:"hbar-val",children:r.totalAvg.toFixed(1)})]},r.id)}),e.jsx("div",{className:"hbar-axis",children:[0,20,40,60,80,100].map(r=>e.jsx("span",{style:{left:`${r}%`},children:r},r))})]}):e.jsx(ge,{})}function vs({stats:t}){const s=t.filter(m=>m.count>0);if(!s.length)return e.jsx(ge,{});const r=14,a=4,n=ne.length*(r+a)+12,i=130,u=28,x=s.length*n+u+10;return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Criterion Performance by Group"}),e.jsx("div",{className:"chart-subtitle",children:"Normalized score as % of criterion max"}),e.jsx("div",{style:{overflowX:"auto",WebkitOverflowScrolling:"touch"},children:e.jsxs("svg",{viewBox:`0 0 ${x} ${i+36}`,style:{width:Math.max(x,280),height:i+36,display:"block"},children:[[0,25,50,75,100].map(m=>{const l=i-m/100*i;return e.jsxs("g",{children:[e.jsx("line",{x1:u,y1:l,x2:x,y2:l,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:u-4,y:l+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:m})]},m)}),s.map((m,l)=>{const o=u+l*n+4;return e.jsxs("g",{children:[ne.map((h,v)=>{const I=(m.avg[h.id]||0)/h.max*100,p=I/100*i,j=o+v*(r+a);return e.jsxs("g",{children:[e.jsx("rect",{x:j,y:i-p,width:r,height:p,fill:qe[v],rx:"2",opacity:"0.85"}),e.jsxs("title",{children:[m.name," Â· ",h.shortLabel||h.label,": ",I.toFixed(1),"%"]})]},h.id)}),e.jsx("text",{x:o+ne.length*(r+a)/2-a/2,y:i+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:m.name})]},m.id)})]})}),e.jsx("div",{className:"chart-legend",children:ne.map((m,l)=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:qe[l]}}),m.shortLabel||m.label]},m.id))})]})}function bs({stats:t}){const s=t.filter(p=>p.count>0),[r,a]=d.useState(null),n=ne.length;if(n<3||!s.length)return e.jsx(ge,{});const i=s.find(p=>p.id===(r??s[0].id))??s[0],u=120,x=120,m=85,l=p=>Math.PI*2*p/n-Math.PI/2,o=(p,j)=>({x:u+j*Math.cos(l(p)),y:x+j*Math.sin(l(p))}),h=ne.map(p=>(i.avg[p.id]||0)/p.max*100),v=h.map((p,j)=>o(j,p/100*m)),I=v.map((p,j)=>`${j===0?"M":"L"}${p.x.toFixed(1)},${p.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card radar-chart-card",children:[e.jsx("div",{className:"chart-title",children:"Performance Radar"}),e.jsx("div",{className:"chart-subtitle",children:"Normalized per criterion (% of max)"}),s.length>1&&e.jsx("select",{className:"radar-group-select",value:r??s[0].id,onChange:p=>a(Number(p.target.value)),children:s.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))}),e.jsxs("svg",{viewBox:"0 0 240 240",style:{width:"100%",maxWidth:260,height:"auto"},children:[[.25,.5,.75,1].map(p=>{const A=ne.map((b,N)=>o(N,p*m)).map((b,N)=>`${N===0?"M":"L"}${b.x.toFixed(1)},${b.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:A,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},p)}),ne.map((p,j)=>{const A=o(j,m);return e.jsx("line",{x1:u,y1:x,x2:A.x.toFixed(1),y2:A.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},j)}),e.jsx("path",{d:I,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.5",strokeLinejoin:"round"}),v.map((p,j)=>e.jsx("circle",{cx:p.x.toFixed(1),cy:p.y.toFixed(1),r:"4.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.5"},j)),ne.map((p,j)=>{const A=o(j,m+24);return e.jsx("text",{x:A.x.toFixed(1),y:A.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"10",fill:"#334155",fontWeight:"700",children:p.shortLabel||p.label},j)}),v.map((p,j)=>e.jsxs("text",{x:(p.x+(p.x>u?9:p.x<u-2?-9:0)).toFixed(1),y:(p.y+(p.y>x?11:-11)).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#1e40af",fontWeight:"700",children:[h[j].toFixed(0),"%"]},`v${j}`))]})]})}function ys({data:t}){const s=t.filter(i=>i.status==="all_submitted"),r=[...new Set(s.map(i=>i.juryName).filter(Boolean))];if(r.length<2)return e.jsx(ge,{msg:"Need at least 2 jurors with submitted evaluations."});const a=s.reduce((i,u)=>i+u.total,0)/s.length,n=r.map(i=>{const u=s.filter(l=>l.juryName===i).map(l=>l.total),x=u.reduce((l,o)=>l+o,0)/u.length,m=fs(u);return{name:i,mean:x,sd:m}}).sort((i,u)=>u.mean-i.mean);return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Juror Scoring Tendencies"}),e.jsx("div",{className:"chart-subtitle",children:"Avg total score Â· Bar = Â±1 std dev Â· Dashed = overall mean"}),n.map(i=>{const u=i.mean/100*100,x=Math.max(0,(i.mean-i.sd)/100*100),m=Math.min(100,(i.mean+i.sd)/100*100),l=a/100*100,o=i.name.trim().split(/\s+/).pop();return e.jsxs("div",{className:"hbar-row",children:[e.jsx("span",{className:"hbar-label strictness-label",title:i.name,children:o}),e.jsxs("div",{className:"hbar-track",children:[e.jsx("div",{className:"hbar-fill strictness-fill",style:{width:`${u}%`}}),e.jsx("div",{className:"hbar-range",style:{left:`${x}%`,width:`${Math.max(m-x,1)}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${x}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${m}%`}}),e.jsx("div",{className:"hbar-mean-line",style:{left:`${l}%`}})]}),e.jsxs("span",{className:"hbar-val",children:[i.mean.toFixed(1),e.jsxs("span",{style:{fontSize:9,color:"#94a3b8"},children:["Â±",i.sd.toFixed(1)]})]})]},i.name)}),e.jsx("div",{className:"hbar-axis",children:[0,20,40,60,80,100].map(i=>e.jsx("span",{style:{left:`${i}%`},children:i},i))})]})}function Ns({data:t}){const s=t.filter(l=>l.status==="all_submitted");if(s.length<3)return e.jsx(ge,{msg:"Need at least 3 submitted evaluations."});const r=300,a=90,n=22,i=s.reduce((l,o)=>l+o.total,0)/s.length,u=n+i/100*(r-n*2),x={},m=s.map(l=>{const o=n+l.total/100*(r-n*2),h=Math.round(o);return x[h]=(x[h]||0)+1,{x:o,y:a-10-(x[h]-1)*13,score:l.total,name:l.juryName,group:l.projectName}});return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Score Distribution"}),e.jsxs("div",{className:"chart-subtitle",children:["Each dot = one evaluation Â· Dashed = mean (",i.toFixed(1),")"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("svg",{viewBox:`0 0 ${r} ${a+18}`,style:{width:"100%",minWidth:240,height:"auto"},children:[e.jsx("line",{x1:n,y1:a,x2:r-n,y2:a,stroke:"#e2e8f0",strokeWidth:"1"}),[0,20,40,60,80,100].map(l=>{const o=n+l/100*(r-n*2);return e.jsxs("g",{children:[e.jsx("line",{x1:o,y1:a-2,x2:o,y2:a+2,stroke:"#94a3b8",strokeWidth:"1"}),e.jsx("text",{x:o,y:a+12,textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:l})]},l)}),e.jsx("line",{x1:u,y1:0,x2:u,y2:a,stroke:"#3b82f6",strokeWidth:"1.5",strokeDasharray:"3,3"}),m.map((l,o)=>e.jsx("circle",{cx:l.x,cy:l.y,r:"5",fill:"#3b82f6",opacity:"0.75",stroke:"#fff",strokeWidth:"1.5",children:e.jsxs("title",{children:[l.group," Â· ",l.name," Â· ",l.score]})},o))]})})]})}function ks({dashboardStats:t,submittedData:s}){if(s.length===0)return e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."});const r=new Date().toLocaleString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"dashboard-print-wrap",children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:re.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[re.courseName," â€” ",re.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report Â Â·Â  ",r,"Â Â·Â  ",s.length," final submission",s.length!==1?"s":"","Â Â·Â  ",t.length," group",t.length!==1?"s":""]})]}),e.jsx("div",{className:"dashboard-toolbar no-print",children:e.jsx("button",{className:"pdf-export-btn",onClick:()=>window.print(),children:"â¬‡ Export PDF"})}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx(gs,{stats:t}),e.jsx(ys,{data:s})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx(vs,{stats:t}),e.jsx(bs,{stats:t})]}),e.jsx(Ns,{data:s})]})}const He=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function pe(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(t);return Number.isFinite(s)?s:""}const Ss=[{key:"in_progress",label:"In Progress"},{key:"group_submitted",label:"Completed"},{key:"all_submitted",label:"Final"},{key:"editing",label:"Editing"}],ws=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}],Cs=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:[e.jsx("path",{d:"M3 4.5L6 1.5L9 4.5"}),e.jsx("path",{d:"M3 7.5L6 10.5L9 7.5"})]}),Ls=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M3 7.5L6 4.5L9 7.5"})}),Es=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M3 4.5L6 7.5L9 4.5"})}),ce=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M2.2 3h9.6L8.2 7.2v3.6L5.8 12V7.2L2.2 3z"})}),Ms=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M2 2L10 10M10 2L2 10"})}),Xe=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:[e.jsx("path",{d:"M7 2v7M4 6.5L7 9.5L10 6.5"}),e.jsx("path",{d:"M2 11.5h10"})]});function Qe(t){return t.jurorId?t.jurorId:`${(t.juryName||"").trim().toLowerCase()}__${(t.juryDept||"").trim().toLowerCase()}`}function Fs({data:t,jurors:s}){const[r,a]=d.useState("ALL"),[n,i]=d.useState("ALL"),[u,x]=d.useState("ALL"),[m,l]=d.useState(new Set),[o,h]=d.useState(""),[v,I]=d.useState(""),[p,j]=d.useState(""),[A,b]=d.useState("tsMs"),[N,E]=d.useState("desc"),[k,S]=d.useState(null),_=d.useMemo(()=>He.map(c=>({id:c.id,label:`Group ${c.id}`,name:c.name})).sort((c,P)=>c.id-P.id),[]),Y=d.useMemo(()=>{const c=new Map;return s.forEach(P=>{const L=String((P==null?void 0:P.dept)??"").trim();L&&c.set(L.toLowerCase(),L)}),Array.from(c.entries()).sort((P,L)=>P[1].localeCompare(L[1])).map(([P,L])=>({key:P,label:L}))},[s]),G=d.useMemo(()=>r!=="ALL"||n!=="ALL"||u!=="ALL"||m.size>0||o||v||p,[r,n,u,m,o,v,p]);function z(){a("ALL"),i("ALL"),x("ALL"),l(new Set),h(""),I(""),j(""),b("tsMs"),E("desc"),S(null)}function q(c){l(P=>{const L=new Set(P);return L.has(c)?L.delete(c):L.add(c),L})}function w(c){S(P=>P===c?null:c)}function $(c){return c===""||c===null||c===void 0||typeof c=="string"&&c.trim()===""?!0:typeof c=="number"?!Number.isFinite(c):!1}const U=d.useMemo(()=>{const c=o?new Date(o).getTime():0,P=v?new Date(v+"T23:59:59").getTime():1/0;let L=t.slice();if(r!=="ALL"&&(L=L.filter(J=>Qe(J)===r)),u!=="ALL"&&(L=L.filter(J=>String(J.projectId)===u)),n!=="ALL"){const J=n.toLowerCase();L=L.filter(X=>String(X.juryDept??"").trim().toLowerCase()===J)}if(m.size>0&&(L=L.filter(J=>m.has("editing")&&J.editingFlag==="editing"?!0:m.has(J.status))),(o||v)&&(L=L.filter(J=>{const X=J.tsMs||Le(J.timestamp);return X>=c&&X<=P})),p){const J=p.toLowerCase();L=L.filter(X=>(X.comments||"").toLowerCase().includes(J))}return L.sort((J,X)=>{const g=J[A],C=X[A],W=$(g),T=$(C);return W&&T?0:W?1:T?-1:N==="asc"?fe(g,C):fe(C,g)}),L},[t,r,u,n,m,o,v,p,A,N]);function K(c){A===c?E(P=>P==="asc"?"desc":"asc"):(b(c),E("desc"))}const H=c=>A!==c?e.jsx(Cs,{}):N==="asc"?e.jsx(Ls,{}):e.jsx(Es,{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:U.length})," row",U.length!==1?"s":""]}),G&&e.jsxs("button",{className:"filter-reset",onClick:z,children:[e.jsx(Ms,{})," Clear Filters"]}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{os(U)},children:[e.jsx(Xe,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]}),e.jsxs("button",{className:"csv-export-btn",onClick:()=>is(U),children:[e.jsx(Xe,{}),e.jsx("span",{className:"export-label-long",children:"Export CSV"}),e.jsx("span",{className:"export-label-short",children:"CSV"})]})]}),k!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>S(null)}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("juryName"),children:["Juror ",e.jsx("span",{className:"sort-icon",children:H("juryName")})]}),e.jsx("div",{className:`col-filter-hotspot${r!=="ALL"?" active":""}`,onClick:c=>{c.stopPropagation(),w("juror")},title:"Filter by juror",children:e.jsx(ce,{})})]}),k==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:c=>{a(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All jurors"}),s.map(c=>e.jsxs("option",{value:c.key,children:[c.name,c.dept?` (${c.dept})`:""]},c.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("juryDept"),children:["Department ",e.jsx("span",{className:"sort-icon",children:H("juryDept")})]}),e.jsx("div",{className:`col-filter-hotspot${n?" active":""}`,onClick:c=>{c.stopPropagation(),w("dept")},title:"Filter by department",children:e.jsx(ce,{})})]}),k==="dept"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:c=>{i(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All departments"}),Y.map(c=>e.jsx("option",{value:c.key,children:c.label},c.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{i("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative",whiteSpace:"nowrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("projectId"),children:["Group ",e.jsx("span",{className:"sort-icon",children:H("projectId")})]}),e.jsx("div",{className:`col-filter-hotspot${u!=="ALL"?" active":""}`,onClick:c=>{c.stopPropagation(),w("group")},title:"Filter by group",children:e.jsx(ce,{})})]}),k==="group"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:u,onChange:c=>{x(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All groups"}),_.map(c=>e.jsx("option",{value:String(c.id),children:c.label},c.id))]}),u!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{x("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("tsMs"),children:["Timestamp ",e.jsx("span",{className:"sort-icon",children:H("tsMs")})]}),e.jsx("div",{className:`col-filter-hotspot${o||v?" active":""}`,onClick:c=>{c.stopPropagation(),w("timestamp")},title:"Filter by date",children:e.jsx(ce,{})})]}),k==="timestamp"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsx("label",{style:{fontSize:11},children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",value:o,onChange:c=>h(c.target.value)}),e.jsx("label",{style:{fontSize:11},children:"To"}),e.jsx("input",{type:"date",value:v,onChange:c=>I(c.target.value)}),(o||v)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{h(""),I(""),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Status"}),e.jsx("div",{className:`col-filter-hotspot${m.size>0?" active":""}`,onClick:c=>{c.stopPropagation(),w("status")},title:"Filter by status",children:e.jsx(ce,{})})]}),k==="status"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[Ss.map(({key:c,label:P})=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:m.has(c),onChange:()=>q(c),style:{width:"auto"}}),P]},c)),m.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{l(new Set),S(null)},children:"Clear"})]})]}),ws.map(({key:c,label:P})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>K(c),children:e.jsxs("span",{className:"col-sort-label",children:[P," ",e.jsx("span",{className:"sort-icon",children:H(c)})]})},c)),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Comments"}),e.jsx("div",{className:`col-filter-hotspot${p?" active":""}`,onClick:c=>{c.stopPropagation(),w("comments")},title:"Filter by comments",children:e.jsx(ce,{})})]}),k==="comments"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),style:{left:"auto",right:0},children:[e.jsx("input",{autoFocus:!0,placeholder:"Search commentsâ€¦",value:p,onChange:c=>j(c.target.value)}),p&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{j(""),S(null)},children:"Clear"})]})]})]})}),e.jsxs("tbody",{children:[U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),U.map((c,P)=>{const L=He.find(X=>X.id===c.projectId),J=c.status==="in_progress";return e.jsxs("tr",{className:P%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:c.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:c.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsxs("div",{className:"cell-group-wrap",title:L!=null&&L.desc?`Group ${c.projectId} â€” ${L.desc}`:`Group ${c.projectId}`,style:{cursor:"default"},children:[e.jsxs("strong",{className:"cell-group-title",children:["Group ",c.projectId]}),(L==null?void 0:L.desc)&&e.jsx("span",{className:"cell-group-desc",style:{display:"block",fontSize:11,color:"#94a3b8",fontWeight:400,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:L.desc})]})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:De(c.timestamp)}),e.jsx("td",{children:e.jsx(ke,{status:c.status,editingFlag:c.editingFlag})}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:pe(c.technical)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:pe(c.design)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:pe(c.delivery)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:pe(c.teamwork)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:e.jsx("strong",{children:pe(c.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:c.comments})]},`${Qe(c)}-${c.projectId}-${P}`)})]})]})})]})}const Is=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function As({jurorStats:t,onPinReset:s}){const[r,a]=d.useState(""),[n,i]=d.useState(""),[u,x]=d.useState(new Set);d.useEffect(()=>{const o=setTimeout(()=>i(r),200);return()=>clearTimeout(o)},[r]);function m(o){x(h=>{const v=new Set(h);return v.has(o)?v.delete(o):v.add(o),v})}const l=d.useMemo(()=>{const o=n.trim().toLowerCase();return o?t.filter(h=>{var v;return h.jury.toLowerCase().includes(o)||(h.dept||((v=h.latestRow)==null?void 0:v.juryDept)||"").toLowerCase().includes(o)}):t},[t,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("input",{className:"juror-search-input",value:r,onChange:o=>a(o.target.value),placeholder:"ðŸ” Search by name or departmentâ€¦"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>a(""),children:"âœ•"})]})}),l.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:l.map(o=>{const{key:h,jury:v,rows:I,overall:p,latestRow:j}=o,A=cs(I),b=A===100?"#22c55e":A>66?"#84cc16":A>33?"#eab308":A>0?"#f97316":"#e2e8f0",N=I.some(k=>k.editingFlag==="editing"),E=N?"juror-card-editing":p==="all_submitted"?"juror-card-all-submitted":p==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${E}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:["ðŸ‘¤ ",v,(j==null?void 0:j.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",j.juryDept,")"]})]}),e.jsx("div",{className:"juror-header-actions",children:N?e.jsx(ke,{status:p,editingFlag:"editing"}):e.jsx(ke,{status:p})})]}),e.jsxs("div",{className:"juror-meta",children:[(j==null?void 0:j.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:De(j==null?void 0:j.timestamp)})]}),s&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${v}`,onClick:()=>s(v,(j==null?void 0:j.juryDept)||"",(j==null?void 0:j.jurorId)||""),children:"ðŸ”‘ Reset PIN"})]})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${A}%`,background:b}})}),e.jsxs("span",{className:"juror-progress-label",children:[A,"%"]})]}),e.jsx("div",{className:"juror-projects",children:I.slice().sort((k,S)=>k.projectId-S.projectId).map(k=>{var q,w;const S=Is.find($=>$.id===k.projectId),_=`${h}-${k.projectId}`,Y=u.has(_),G=`juror-group-panel-${_}`,z=!!(S!=null&&S.desc)||((q=S==null?void 0:S.students)==null?void 0:q.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:z?0:-1,"aria-expanded":Y,"aria-controls":G,onClick:()=>{z&&m(_)},onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&z&&($.preventDefault(),m(_))},style:{cursor:z?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(S==null?void 0:S.name)||`Group ${k.projectId}`}),z&&e.jsx("span",{className:`group-accordion-chevron${Y?" open":""}`,children:e.jsx(rt,{})})]})}),e.jsxs("div",{className:"juror-row-right",children:[k.timestamp&&e.jsx("span",{className:"juror-row-ts",children:De(k.timestamp)}),e.jsx(ke,{status:k.status,editingFlag:k.editingFlag}),(k.status==="all_submitted"||k.status==="group_submitted")&&e.jsx("span",{className:"juror-score",title:"/ 100","aria-label":`${k.total} / 100`,children:k.total})]})]}),e.jsx("div",{id:G,className:`group-accordion-panel${Y?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(S==null?void 0:S.desc)&&e.jsx("span",{className:"juror-row-desc",children:S.desc}),((w=S==null?void 0:S.students)==null?void 0:w.length)>0&&e.jsxs("span",{className:"juror-row-students",children:["ðŸ‘¥ ",S.students.join(" Â· ")]})]})})]},_)})})]},h)})})]})}const Ds=()=>e.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M1 2h8M2.5 5h5M4 7.5h2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),Ps=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4 4.5L6 2l2 2.5M4 7.5L6 10l2-2.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.5"})}),_s=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M6 2.5v7M3.5 7L6 9.5l2.5-2.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})}),Ts=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M6 9.5v-7M3.5 5L6 2.5l2.5 2.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})}),$s=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M3 3l6 6M9 3L3 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),Rs=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none","aria-hidden":"true",children:[e.jsx("circle",{cx:"7",cy:"7",r:"5.75",stroke:"currentColor",strokeWidth:"1.2"}),e.jsx("path",{d:"M7 6.5v3.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round"}),e.jsx("circle",{cx:"7",cy:"4.5",r:"0.7",fill:"currentColor"})]}),Bs=t=>t?t.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="group_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},Os=t=>t?t.status==="all_submitted"||t.status==="group_submitted"?t.total:t.status==="in_progress"?"":"â€”":"â€”";function Ws({data:t,jurors:s,groups:r}){const[a,n]=d.useState(null),[i,u]=d.useState("desc"),[x,m]=d.useState(""),[l,o]=d.useState(null),h=d.useMemo(()=>{const b={};return t.forEach(N=>{const E=N.jurorId?N.jurorId:`${(N.juryName||"").trim().toLowerCase()}__${(N.juryDept||"").trim().toLowerCase()}`;b[E]||(b[E]={}),b[E][N.projectId]={total:N.total,status:N.status}}),b},[t]);function v(b){a!==b?(n(b),u("desc")):i==="desc"?u("asc"):(n(null),u("desc"))}const I=b=>a!==b?e.jsx(Ps,{}):i==="desc"?e.jsx(_s,{}):e.jsx(Ts,{});function p(){m(""),o(null)}const j=d.useMemo(()=>{let b=s.slice();if(x){const N=x.toLowerCase();b=b.filter(E=>E.name.toLowerCase().includes(N))}return a!==null&&(b=[...b].sort((N,E)=>{var z,q;const k=(z=h[N.key])==null?void 0:z[a],S=(q=h[E.key])==null?void 0:q[a],_=(k==null?void 0:k.status)==="all_submitted"?Number(k.total):null,Y=(S==null?void 0:S.status)==="all_submitted"?Number(S.total):null;if(_===null&&Y===null)return fe(N.name,E.name);if(_===null)return 1;if(Y===null)return-1;const G=i==="desc"?Y-_:_-Y;return G!==0?G:fe(N.name,E.name)})),b},[s,x,a,i,h]),A=d.useMemo(()=>r.map(b=>{const N=j.map(E=>{var k;return(k=h[E.key])==null?void 0:k[b.id]}).filter(E=>(E==null?void 0:E.status)==="all_submitted").map(E=>E.total);return N.length?(N.reduce((E,k)=>E+k,0)/N.length).toFixed(2):null}),[j,r,h]);return s.length?e.jsxs("div",{className:"matrix-wrap",children:[(x||j.length<s.length)&&e.jsxs("div",{className:"matrix-controls",children:[x&&e.jsxs("button",{className:"matrix-clear-filters",onClick:p,children:[e.jsx($s,{})," Clear Filters"]}),j.length<s.length&&e.jsxs("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:600},children:["Showing ",j.length,"/",s.length," jurors"]})]}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(Rs,{})," ",e.jsx("strong",{children:"Averages include only final submissions."})]}),e.jsxs("p",{className:"matrix-subtitle",children:[e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]}),l!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>o(null)}),e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"matrix-corner",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:["Juror / Group",e.jsx("button",{className:`col-filter-btn${x?" active":""}`,onClick:b=>{b.stopPropagation(),o(N=>N==="juror"?null:"juror")},title:"Filter jurors",children:e.jsx(Ds,{})})]}),l==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:b=>b.stopPropagation(),children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror nameâ€¦",value:x,onChange:b=>m(b.target.value)}),x&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{m(""),o(null)},children:"Clear"})]})]}),r.map(b=>{const N=a===b.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${N?" active":""}`,onClick:()=>v(b.id),title:`Sort by ${b.label}`,children:[e.jsx("strong",{children:b.label}),e.jsx("span",{className:"sort-icon",children:I(b.id)})]})},b.id)})]})}),e.jsx("tbody",{children:j.map(b=>e.jsxs("tr",{children:[e.jsxs("td",{className:"matrix-juror",children:[b.name,b.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",b.dept,")"]})]}),r.map(N=>{var k;const E=((k=h[b.key])==null?void 0:k[N.id])??null;return e.jsx("td",{style:Bs(E),children:Os(E)},N.id)})]},b.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),A.map((b,N)=>e.jsx("td",{className:"matrix-avg-cell",children:b!==null?b:"â€”"},r[N].id))]})})]})})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const Pe=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]}),Gs=V.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),zs=Pe.length,Js=2*60*1e3,Us=[{id:"summary",label:"ðŸ† Summary"},{id:"dashboard",label:"ðŸ“ˆ Dashboard"},{id:"detail",label:"ðŸ“‹ Details"},{id:"jurors",label:"ðŸ‘¤ Jurors"},{id:"matrix",label:"ðŸ”¢ Matrix"}];function Ks({adminPass:t,onBack:s,onAuthError:r,onInitialLoadDone:a}){const[n,i]=d.useState([]),[u,x]=d.useState(!0),[m,l]=d.useState(""),[o,h]=d.useState(""),[v,I]=d.useState("summary"),[p,j]=d.useState(null),[A,b]=d.useState(null),[N,E]=d.useState(""),k=d.useRef(!1),S=d.useRef(t);d.useEffect(()=>{S.current=t},[t]);const _=async()=>{x(!0),l("");try{const g=S.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!g){i([]),h("Enter the admin password to load results.");return}const C=await ue({action:"export",pass:g});if((C==null?void 0:C.status)==="unauthorized"){if(i([]),r){r("Invalid password");return}h("Incorrect password.");return}if((C==null?void 0:C.status)!=="ok"||!Array.isArray(C==null?void 0:C.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",g)}catch{}const W=C.rows.map(T=>({juryName:String(T["Juror Name"]??T["Your Name"]??""),juryDept:String(T["Department / Institution"]??T.Department??""),timestamp:T.Timestamp||"",tsMs:Le(T.Timestamp||""),projectId:le(T["Group No"]),projectName:String(T["Group Name"]??""),jurorId:String(T["Juror ID"]??""),technical:le(T["Technical (30)"]),design:le(T["Written (30)"]),delivery:le(T["Oral (30)"]),teamwork:le(T["Teamwork (10)"]),total:le(T["Total (100)"]),comments:T.Comments||"",status:String(T.Status??"all_submitted"),editingFlag:String(T.EditingFlag??"")}));i(ds(W)),j(new Date),h(""),k.current||(k.current=!0,a==null||a())}catch(g){if(r){r("Connection error â€” try again.");return}l("Could not load data: "+g.message),i([])}finally{x(!1)}};d.useEffect(()=>{_()},[]),d.useEffect(()=>{const g=setInterval(_,Js);return()=>clearInterval(g)},[]),d.useEffect(()=>(A?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[A]);const Y=async(g,C,W)=>{b({juryName:g,juryDept:C}),E("loading");try{const T=S.current||sessionStorage.getItem("ee492_admin_pass")||"",O=await ue({action:"resetPin",jurorId:W.trim(),pass:T});E(O.status==="ok"?"ok":"error")}catch{E("error")}setTimeout(()=>{b(null),E("")},3e3)},G=g=>g.jurorId?g.jurorId:`${(g.juryName||"").trim().toLowerCase()}__${(g.juryDept||"").trim().toLowerCase()}`,z=d.useMemo(()=>{const g=new Map;return n.forEach(C=>{if(!C.juryName)return;const W=G(C);g.has(W)||g.set(W,{key:W,name:C.juryName.trim(),dept:C.juryDept.trim(),jurorId:C.jurorId})}),[...g.values()].sort((C,W)=>fe(C.name,W.name))},[n]),q=d.useMemo(()=>Pe.map(g=>({id:g.id,label:`Group ${g.id}`,desc:g.desc||""})).sort((g,C)=>g.id-C.id),[]),w=d.useMemo(()=>{const g=new Map;return z.forEach(({key:C,dept:W})=>g.set(C,W)),g},[z]),$=d.useMemo(()=>{const g=new Map;return z.forEach(({key:C,name:W})=>g.set(C,{bg:rs(W),dot:as(W)})),g},[z]),U=d.useMemo(()=>n.filter(g=>g.status==="all_submitted"),[n]),K=d.useMemo(()=>n.filter(g=>g.status==="group_submitted"||g.status==="all_submitted"),[n]),H=d.useMemo(()=>Pe.map(g=>{const C=U.filter(O=>O.projectId===g.id);if(!C.length)return{id:g.id,name:g.name,desc:g.desc,students:g.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const W={};Gs.forEach(O=>{W[O.id]=C.reduce((Q,ee)=>Q+(ee[O.id]||0),0)/C.length});const T=C.map(O=>O.total);return{id:g.id,name:g.name,desc:g.desc,students:g.students,count:C.length,avg:W,totalAvg:T.reduce((O,Q)=>O+Q,0)/T.length,totalMin:Math.min(...T),totalMax:Math.max(...T)}}),[U]),c=d.useMemo(()=>H.map(g=>({...g,name:`Group ${g.id}`})),[H]),P=d.useMemo(()=>[...H].sort((g,C)=>C.totalAvg-g.totalAvg),[H]),L=d.useMemo(()=>z.map(({key:g,name:C,dept:W,jurorId:T})=>{const O=n.filter(Z=>G(Z)===g),Q=O.filter(Z=>Z.status==="group_submitted"||Z.status==="all_submitted"),ee=O.filter(Z=>Z.status==="all_submitted"),ve=O.filter(Z=>Z.status==="in_progress"),be=O.reduce((Z,me)=>me.tsMs>Z?me.tsMs:Z,0),Ee=O.find(Z=>Z.tsMs===be)||O[0],Me=ee.length===zs?"all_submitted":Q.length>0||ve.length>0?"in_progress":"not_started";return{key:g,jury:C,dept:W,jurorId:T,rows:O,submitted:Q,completed:Q,finalSubmitted:ee,inProgress:ve,latestTs:be,latestRow:Ee,overall:Me}}),[z,n]),J=n.filter(g=>g.status==="in_progress").length,X=L.filter(g=>g.rows.some(C=>C.editingFlag==="editing")).length;return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:s,"aria-label":"Back to home",children:e.jsx(Ce,{})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Results Panel"}),e.jsxs("p",{children:[z.length," juror",z.length!==1?"s":""," Â· ",K.length," completed"," Â· ",U.length," final",J>0&&e.jsxs("span",{className:"live-indicator",children:[" Â· ",J," in progress"]}),X>0&&e.jsxs("span",{className:"editing-indicator",children:[" Â· ",X," editing"]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:2},children:[e.jsx("button",{className:"refresh-btn",onClick:_,"aria-label":"Refresh",title:"Refresh",children:e.jsx(Gt,{})}),p&&e.jsx("span",{style:{fontSize:10,color:"#94a3b8"},children:p.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsx("div",{className:"tab-bar",children:Us.map(g=>e.jsx("button",{className:`tab ${v===g.id?"active":""}`,onClick:()=>I(g.id),children:g.label},g.id))}),u&&e.jsx("div",{className:"loading",children:"Loading dataâ€¦"}),m&&e.jsx("div",{className:"error-msg",children:m}),o&&e.jsx("div",{className:"error-msg",children:o}),A&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${N}`,children:[N==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"ðŸ”‘"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:A.juryName}),"â€¦"]})]}),N==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"âœ…"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:A.juryName})," will receive a new PIN on next login."]})]}),N==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"âŒ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:A.juryName}),"."]})]})]})}),!u&&!m&&!o&&e.jsxs("div",{className:"admin-body",children:[v==="summary"&&e.jsx(js,{ranked:P,submittedData:U}),v==="dashboard"&&e.jsx(ks,{dashboardStats:c,submittedData:U}),v==="detail"&&e.jsx(Fs,{data:n,jurors:z,jurorColorMap:$}),v==="jurors"&&e.jsx(As,{jurorStats:L,jurors:z,onPinReset:Y}),v==="matrix"&&e.jsx(Ws,{data:n,jurors:z,groups:q,jurorDeptMap:w})]})]})}const Vs="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function Ys(){const[t,s]=d.useState("home"),r=d.useRef(""),[a,n]=d.useState(!1),[i,u]=d.useState(!1),[x,m]=d.useState(""),[l,o]=d.useState("");function h(){const I=x.trim();if(!I){o("Please enter the admin password.");return}r.current=I,m(""),o(""),u(!0),n(!0)}function v(I){n(!1),u(!1),r.current="",o(I||"Authentication failed.")}return t==="jury"?e.jsx(es,{onBack:()=>s("home")}):t==="admin"?a?e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"admin-checking-overlay",children:e.jsxs("div",{className:"admin-checking-card",children:[e.jsx("div",{className:"admin-checking-icon",children:"ðŸ”„"}),e.jsx("div",{className:"admin-checking-msg",children:"Checkingâ€¦"})]})}),e.jsx(Ks,{adminPass:r.current,onAuthError:v,onInitialLoadDone:()=>u(!1),onBack:()=>{s("home"),n(!1),u(!1),o(""),r.current=""}})]}):e.jsx("div",{className:"lock-screen",children:e.jsxs("div",{className:"lock-card",children:[e.jsx("div",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("h2",{children:"Results Panel"}),e.jsx("p",{children:"Enter the admin password to view results"}),l&&e.jsx("div",{className:"login-error",children:l}),e.jsx("input",{type:"password",placeholder:"Password",value:x,onChange:I=>{m(I.target.value),l&&o("")},onKeyDown:I=>{I.key==="Enter"&&h()},autoFocus:!0}),e.jsx("button",{className:"btn-primary",onClick:h,disabled:i,children:"Login"}),e.jsx("button",{className:"btn-ghost",onClick:()=>{s("home"),o("")},children:"â† Back"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:Vs,alt:"TED University",loading:"eager"})}),e.jsxs("h1",{children:["Senior Project",e.jsx("br",{}),"Jury Portal"]}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big",onClick:()=>s("jury"),children:[e.jsx("span",{children:"ðŸ“‹"})," Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big",onClick:()=>s("admin"),children:[e.jsx("span",{children:"ðŸ“Š"})," View Results"]})]}),e.jsxs("p",{className:"home-hint",children:[e.jsx("span",{className:"home-hint-ico",children:"â„¹ï¸"}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["Â© 2026 Â· Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})]})]})]})}Ae.createRoot(document.getElementById("root")).render(e.jsx(wt.StrictMode,{children:e.jsx(Ys,{})}));
