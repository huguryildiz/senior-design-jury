import{r as u,a as Nt,R as kt}from"./react-b1791c80.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Xe={exports:{}},ke={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St=u,wt=Symbol.for("react.element"),Ct=Symbol.for("react.fragment"),Lt=Object.prototype.hasOwnProperty,Et=St.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mt={key:!0,ref:!0,__self:!0,__source:!0};function Qe(t,s,r){var a,n={},i=null,d=null;r!==void 0&&(i=""+r),s.key!==void 0&&(i=""+s.key),s.ref!==void 0&&(d=s.ref);for(a in s)Lt.call(s,a)&&!Mt.hasOwnProperty(a)&&(n[a]=s[a]);if(t&&t.defaultProps)for(a in s=t.defaultProps,s)n[a]===void 0&&(n[a]=s[a]);return{$$typeof:wt,type:t,key:i,ref:d,props:n,_owner:Et.current}}ke.Fragment=Ct;ke.jsx=Qe;ke.jsxs=Qe;Xe.exports=ke;var e=Xe.exports,Ie={},_e=Nt;Ie.createRoot=_e.createRoot,Ie.hydrateRoot=_e.hydrateRoot;const ne={appTitle:"Senior Project Jury Portal",courseName:"EE 491 / EE 492 â€” Senior Project",department:"Electrical & Electronics Engineering",university:"TED University",scriptUrl:"https://script.google.com/macros/s/AKfycbyQK792Cd5-3X7mpqd-LwOuFlvB8MbreTXDqY9KLgTTl7hw9GBCzNtZ3C1aS89R9lARCA/exec",apiSecret:"1feadbeca9e48b24f89ceaef7fa52e7a6d44f90e6167f549",showStudents:!0},B=[{id:1,name:"Group 1",desc:"GÃ¶ksiper Hava Savunma Sistemi",students:["Mustafa Yusuf Ãœnal","AyÃ§a Naz DedeoÄŸlu","Onur Mesci","Ã‡aÄŸan ErdoÄŸan"]},{id:2,name:"Group 2",desc:"Radome and Radar-Absorbing Material Electromagnetic Design Software (REMDET)",students:["Niyazi Atilla Ã–zer","Bertan Ãœnver","Ada TatlÄ±","Nesibe AydÄ±n"]},{id:3,name:"Group 3",desc:"Smart Crosswalk",students:["Sami Eren GermeÃ§"]},{id:4,name:"Group 4",desc:"Radar Cross Section (RCS) Analysis â€” Supporting Multi-Purpose Ray Tracing Algorithm",students:["Ahmet Melih Yavuz","Yasemin Erciyas"]},{id:5,name:"Group 5",desc:"Monitoring Pilots' Health Status and Cognitive Abilities During Flight",students:["Aysel Mine Ã‡aylan","Selimhan Kaynar","Abdulkadir SazlÄ±","Alp Efe Ä°pek"]},{id:6,name:"Group 6",desc:"AKKE â€” Smart Command and Control Glove",students:["Åževval KurtulmuÅŸ","Abdullah Esin","Berk Ã‡akmak","Ã–mer Efe Dikici"]}],Y=[{id:"technical",label:"Technical Content",shortLabel:"Technical",mudek:"1.2 / 2 / 3",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Problem is clearly defined with strong motivation. Design decisions are well-justified with engineering depth. Originality and mastery of relevant tools or methods are evident."},{range:"21â€“26",level:"Good",desc:"Design is mostly clear and technically justified. Engineering decisions are largely supported."},{range:"13â€“20",level:"Developing",desc:"Problem is stated but motivation or technical justification is insufficient."},{range:"0â€“12",level:"Insufficient",desc:"Vague problem definition and unjustified decisions. Superficial technical content."}]},{id:"design",label:"Written Communication",shortLabel:"Written",mudek:"9.2",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Poster layout is intuitive with clear information flow. Visuals are fully labelled and high quality. Technical content is presented in a way that is accessible to both technical and non-technical readers."},{range:"21â€“26",level:"Good",desc:"Layout is mostly logical. Visuals are readable with minor gaps. Technical content is largely clear with small areas for improvement."},{range:"13â€“20",level:"Developing",desc:"Occasional gaps in information flow. Some visuals are missing labels or captions. Technical content is only partially communicated."},{range:"0â€“12",level:"Insufficient",desc:"Confusing layout. Low-quality or unlabelled visuals. Technical content is unclear or missing."}]},{id:"delivery",label:"Oral Communication",shortLabel:"Oral",mudek:"9.1",max:30,rubric:[{range:"27â€“30",level:"Excellent",desc:"Presentation is consciously adapted for both technical and non-technical jury members. Q&A responses are accurate, clear, and audience-appropriate."},{range:"21â€“26",level:"Good",desc:"Presentation is mostly clear and well-paced. Most questions answered correctly. Audience adaptation is generally evident."},{range:"13â€“20",level:"Developing",desc:"Understandable but inconsistent. Limited audience adaptation. Time management or Q&A depth needs improvement."},{range:"0â€“12",level:"Insufficient",desc:"Unclear or disorganised presentation. Most questions answered incorrectly or not at all."}]},{id:"teamwork",label:"Teamwork",shortLabel:"Teamwork",mudek:"8.1 / 8.2",max:10,rubric:[{range:"9â€“10",level:"Excellent",desc:"All members participate actively and equally. Professional and ethical conduct observed throughout."},{range:"7â€“8",level:"Good",desc:"Most members contribute. Minor knowledge gaps. Professionalism mostly observed."},{range:"4â€“6",level:"Developing",desc:"Uneven participation. Some members are passive or unprepared."},{range:"0â€“3",level:"Insufficient",desc:"Very low participation or dominated by one person. Lack of professionalism observed."}]}];Y.reduce((t,s)=>t+(Number(s.max)||0),0);const Ze=ne==null?void 0:ne.scriptUrl,Pe=ne==null?void 0:ne.apiSecret;function Te(t,s){const r=t.trim().toLowerCase()+"__"+s.trim().toLowerCase();let a=5381;for(let n=0;n<r.length;n++)a=(a<<5)+a^r.charCodeAt(n),a=a>>>0;return a.toString(16).padStart(8,"0")}let De="";function $e(t){De=t}function Ne(){return De}function Re(){De=""}async function re(t){const s=Ne();try{await fetch(Ze,{method:"POST",mode:"no-cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,token:s})})}catch{}}async function ce(t){const s=new URLSearchParams(t).toString(),r=await fetch(`${Ze}?${s}`,{cache:"no-store"});if(!r.ok)throw new Error(`HTTP ${r.status}`);const a=(await r.text()).trim();if(a.toLowerCase().startsWith("<html"))throw new Error("Received HTML from Apps Script â€” check your deployment URL.");try{return JSON.parse(a)}catch{throw new Error("Apps Script returned invalid JSON.")}}async function et(t){return ce({...t,token:Ne()})}function ue(t,s,r,a,n,i,d){var p,h,l,o;return{juryName:t,juryDept:s,jurorId:r,timestamp:new Date().toISOString(),projectId:i.id,projectName:i.name,technical:((p=a[i.id])==null?void 0:p.technical)??"",design:((h=a[i.id])==null?void 0:h.design)??"",delivery:((l=a[i.id])==null?void 0:l.delivery)??"",teamwork:((o=a[i.id])==null?void 0:o.teamwork)??"",total:It(a,i.id),comments:n[i.id]||"",status:d}}function It(t,s){return Y.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}async function Ft(t){return ce({action:"checkPin",jurorId:t,secret:Pe})}async function At(t,s,r){return ce({action:"createPin",jurorId:t,juryName:s.trim(),juryDept:r.trim(),secret:Pe})}async function Pt(t,s){return ce({action:"verifyPin",jurorId:t,pin:String(s).trim(),secret:Pe})}async function Be(){const t=await et({action:"myscores"});if(t.status==="unauthorized"){const s=new Error("unauthorized");throw s.unauthorized=!0,s}return t.status!=="ok"?null:t.rows||[]}async function Oe(){return et({action:"ping"})}const We=1500,he=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,""]))])),pe=()=>Object.fromEntries(B.map(t=>[t.id,""])),Ge=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,!1]))])),Dt=()=>Object.fromEntries(B.map(t=>[t.id,Object.fromEntries(Y.map(s=>[s.id,!0]))])),le=(t,s)=>Y.every(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""}),ze=t=>B.every(s=>le(t,s.id)),tt=t=>B.reduce((s,r)=>s+Y.reduce((a,n)=>{var i;return a+(((i=t[r.id])==null?void 0:i[n.id])!==""?1:0)},0),0),_t=(t,s)=>Y.some(r=>{var a;return((a=t[s])==null?void 0:a[r.id])!==""});function Ee(t){const s=he(),r=pe();return(t||[]).forEach(a=>{const n=Number(a.projectId);n&&(s[n]={...s[n],technical:a.technical??"",design:a.design??"",delivery:a.delivery??"",teamwork:a.teamwork??""},r[n]=a.comments??"")}),{scores:s,comments:r}}function Tt(){const[t,s]=u.useState(""),[r,a]=u.useState(""),n=u.useRef("");u.useEffect(()=>{n.current=t.trim()&&r.trim()?Te(t,r):""},[t,r]);const[i,d]=u.useState("info"),[p,h]=u.useState(0),[l,o]=u.useState(he),[m,f]=u.useState(pe),[L,x]=u.useState(Ge),[j,C]=u.useState({}),[b,k]=u.useState(!1),[E,N]=u.useState(null),[S,P]=u.useState(null),[q,G]=u.useState(null),[z,V]=u.useState("idle"),[w,$]=u.useState("idle"),[U,K]=u.useState(""),[H,c]=u.useState(""),[_,I]=u.useState(3),[J,X]=u.useState(!1),[v,M]=u.useState(""),W=u.useRef(!1),T=u.useRef({});T.current={juryName:t,juryDept:r,scores:l,comments:m,groupSynced:j,current:p};const O=u.useRef(l),Q=u.useRef(m),ee=u.useCallback(g=>{const{juryName:y,juryDept:F}=T.current,A=n.current,D=O.current,R=Q.current;if(!y.trim()||!A||!Ne()||!_t(D,g))return;const te=B.find(yt=>yt.id===g);if(!te)return;const ve=le(D,g)?"group_submitted":"in_progress",bt=ue(y,F,A,D,R,te,ve);V("saving"),re({rows:[bt]}),setTimeout(()=>V("saved"),500),setTimeout(()=>V("idle"),2500)},[]),fe=u.useCallback(g=>{var A;const{current:y}=T.current,F=(A=B[y])==null?void 0:A.id;F!==void 0&&ee(F),h(g)},[ee]);u.useEffect(()=>{if(i!=="eval"||b)return;const g={};B.forEach(y=>{!j[y.id]&&le(l,y.id)&&(g[y.id]=!0)}),Object.keys(g).length>0&&C(y=>({...y,...g}))},[l,i,j,b]),u.useEffect(()=>{if(i!=="eval"||W.current||b||!B.every(y=>j[y.id]))return;W.current=!0;const g=setTimeout(()=>{const{juryName:y,juryDept:F,scores:A,comments:D}=T.current,R=n.current;re({rows:B.map(te=>ue(y,F,R,A,D,te,"all_submitted"))}),N({...A}),P({...D}),d("done")},800);return()=>clearTimeout(g)},[j,i,b]);const ge=u.useCallback((g,y,F)=>{const A={...O.current,[g]:{...O.current[g],[y]:F}};O.current=A,o(A),x(D=>({...D,[g]:{...D[g],[y]:!0}})),F===""&&j[g]&&C(D=>({...D,[g]:!1}))},[j]),Ce=u.useCallback((g,y)=>{var D;const F=Y.find(R=>R.id===y),A=(D=O.current[g])==null?void 0:D[y];if(x(R=>({...R,[g]:{...R[g],[y]:!0}})),A!==""&&A!==void 0){const R=parseInt(A,10),te=Number.isFinite(R)?Math.min(Math.max(R,0),F.max):0;if(String(te)!==String(A)){const ve={...O.current,[g]:{...O.current[g],[y]:te}};O.current=ve,o(ve)}}ee(g)},[ee]),Le=u.useCallback((g,y)=>{const F={...Q.current,[g]:y};Q.current=F,f(F)},[]),Z=u.useCallback(g=>{ee(g)},[ee]),de=u.useCallback((g,y)=>{const{juryName:F,juryDept:A}=T.current,D=n.current;re({rows:B.map(R=>ue(F,A,D,g,y,R,"all_submitted"))}),N({...g}),P({...y}),k(!1),W.current=!0,d("done")},[]),it=u.useCallback(async()=>{const{juryName:g,juryDept:y}=T.current,F=n.current,A=E||l,D=S||m;F&&re({action:"resetJuror"}),O.current=A,Q.current=D,o(A),f(D),k(!0),W.current=!1,C(Object.fromEntries(B.map(R=>[R.id,!0]))),d("eval"),setTimeout(()=>{F&&re({rows:B.map(R=>ue(g,y,F,A,D,R,"group_submitted"))})},We)},[E,S,l,m]),ot=u.useCallback(()=>{if(!ze(l)){x(Dt());const g=B.findIndex(y=>!le(l,y.id));g>=0&&h(g);return}de(l,m)},[l,m,de]),ae=u.useCallback(g=>{Re(),M(g||"Your session has expired. Please enter your PIN again."),X(!0)},[]),lt=u.useCallback(()=>{X(!1),M(""),K(""),$("entering"),d("pin")},[]),ie=u.useCallback(async()=>{G({loading:!0});let g=[];try{g=await Be()||[]}catch(D){if(D.unauthorized){ae("Your session has expired. Please enter your PIN again.");return}}const y=B.length,F=g.filter(D=>D.status==="group_submitted"||D.status==="all_submitted").length,A=g.length>=y&&g.every(D=>D.status==="all_submitted");G({rows:g,filledCount:F,totalCount:y,allSubmitted:A})},[ae]);u.useEffect(()=>{if(i!=="eval")return;const g=setInterval(async()=>{try{(await Oe()).status==="unauthorized"&&ae("Your session was ended because you signed in from another device.")}catch{}},15e3);return()=>clearInterval(g)},[i,ae]),u.useEffect(()=>{if(i!=="eval")return;async function g(){if(document.visibilityState==="visible")try{(await Oe()).status==="unauthorized"&&ae("Your session was ended because you signed in from another device.")}catch{}}return document.addEventListener("visibilitychange",g),()=>document.removeEventListener("visibilitychange",g)},[i,ae]);const ct=u.useCallback(()=>{const g=q;if(g){if(G(null),g.allSubmitted){const{scores:y,comments:F}=Ee(g.rows);O.current=y,Q.current=F,o(y),f(F),N(y),P(F),C(Object.fromEntries(B.map(A=>[A.id,!0]))),W.current=!0,d("done");return}if(g.rows.length>0){const{scores:y,comments:F}=Ee(g.rows),A=Object.fromEntries(g.rows.filter(R=>R.status==="group_submitted"||R.status==="all_submitted").map(R=>[Number(R.projectId),!0]));O.current=y,Q.current=F,o(y),f(F),C(A);const D=B.findIndex(R=>!le(y,R.id));h(D>=0?D:0),W.current=!1}d("eval")}},[q]),dt=u.useCallback(()=>{const g=he(),y=pe();O.current=g,Q.current=y,G(null),o(g),f(y),C({}),h(0),W.current=!1,k(!1),d("eval")},[]),ut=u.useCallback(async()=>{const{juryName:g,juryDept:y}=T.current,F=n.current;let A=he(),D=pe();try{const R=await Be();if(R!=null&&R.length){const te=Ee(R);A=te.scores,D=te.comments}}catch{}F&&re({action:"resetJuror"}),O.current=A,Q.current=D,o(A),f(D),N(A),P(D),k(!0),W.current=!1,C(Object.fromEntries(B.map(R=>[R.id,!0]))),d("eval"),setTimeout(()=>{F&&re({rows:B.map(R=>ue(g,y,F,A,D,R,"group_submitted"))})},We)},[]),mt=u.useCallback(async()=>{const{juryName:g,juryDept:y}=T.current;if(!g.trim()||!y.trim())return;const F=Te(g,y);if(n.current=F,G({loading:!0}),Ne()){await ie();return}try{const A=await Ft(F);if(A.status!=="ok"){G(null),K("Could not reach the server. Please try again."),$("entering"),d("pin");return}if(A.exists)G(null),$("entering"),K(""),I(3),d("pin");else{const D=await At(F,g,y);D.status==="ok"?(G(null),$e(D.token),c(D.pin),$("new"),d("pin")):(G(null),K("Could not create a PIN. Please try again."),$("entering"),d("pin"))}}catch{G(null),K("Connection error. Please check your network and try again."),$("entering"),d("pin")}},[ie]),ht=u.useCallback(async g=>{const y=n.current;G({loading:!0});try{const F=await Pt(y,g);if(F.locked){G(null),$("locked"),K("Too many failed attempts. Please contact the admin to reset your PIN.");return}if(F.valid){$e(F.token||""),$("idle"),K(""),await ie();return}G(null);const A=typeof F.attemptsLeft=="number"?F.attemptsLeft:_-1;I(A),A<=0?($("locked"),K("Too many failed attempts. Please contact the admin.")):K(`Incorrect PIN. ${A} attempt${A!==1?"s":""} remaining.`)}catch{G(null),K("Could not verify PIN. Please try again.")}},[_,ie]),pt=u.useCallback(async()=>{await ie()},[ie]),xt=u.useCallback(()=>{const g=he(),y=pe();O.current=g,Q.current=y,s(""),a(""),d("info"),h(0),o(g),f(y),x(Ge()),C({}),G(null),k(!1),N(null),P(null),V("idle"),$("idle"),K(""),c(""),I(3),W.current=!1,n.current="",Re()},[]),jt=B[p],ft=B.length*Y.length,gt=Math.round(tt(l)/ft*100),vt=ze(l);return{juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,jurorId:n.current,step:i,setStep:d,current:p,handleNavigate:fe,scores:l,comments:m,touched:L,handleScore:ge,handleScoreBlur:Ce,handleCommentChange:Le,handleCommentBlur:Z,project:jt,progressPct:gt,allComplete:vt,groupSynced:j,editMode:b,doneScores:E,doneComments:S,sheetProgress:q,saveStatus:z,pinStep:w,pinError:U,newPin:H,attemptsLeft:_,handlePinSubmit:ht,handlePinAcknowledge:pt,sessionKicked:J,kickedMsg:v,handleKickedAcknowledge:lt,handleStart:mt,handleConfirmFromSheet:ct,handleStartFresh:dt,handleResubmit:ut,handleEditScores:it,handleFinalSubmit:ot,resetAll:xt}}function Se(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 9.5L12 3l9 6.5V20a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9.5z"}),e.jsx("polyline",{points:"9 21 9 12 15 12 15 21"})]})}function Je(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"7.5",cy:"15.5",r:"5.5"}),e.jsx("path",{d:"M21 2l-9.6 9.6"}),e.jsx("path",{d:"M15.5 7.5l3 3L22 7l-3-3"})]})}function $t(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#FCD34D"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#F59E0B"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#F59E0B"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#FCD34D"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#92400E",fontFamily:"sans-serif",children:"1"})]})}function Rt(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#CBD5E1"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#94A3B8"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#94A3B8"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#CBD5E1"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#334155",fontFamily:"sans-serif",children:"2"})]})}function Bt(){return e.jsxs("svg",{width:"52",height:"52",viewBox:"0 0 52 52",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"19",y:"2",width:"14",height:"14",rx:"3",fill:"#FDBA74"}),e.jsx("rect",{x:"22",y:"2",width:"8",height:"18",rx:"2",fill:"#B45309"}),e.jsx("circle",{cx:"26",cy:"34",r:"16",fill:"#B45309"}),e.jsx("circle",{cx:"26",cy:"34",r:"12",fill:"#FDBA74"}),e.jsx("text",{x:"26",y:"39",textAnchor:"middle",fontSize:"13",fontWeight:"800",fill:"#7C2D12",fontFamily:"sans-serif",children:"3"})]})}function Ot(){return e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M23 4v6h-6"}),e.jsx("path",{d:"M1 20v-6h6"}),e.jsx("path",{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"})]})}function Wt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"15 18 9 12 15 6"})})}function Gt(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})})}function st(){return e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 5l4 4 4-4"})})}function zt({juryName:t,setJuryName:s,juryDept:r,setJuryDept:a,onStart:n,onBack:i}){const d=t.trim().length>0&&r.trim().length>0;return e.jsxs("div",{className:"form-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:i,"aria-label":"Back to home",children:e.jsx(Se,{})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Evaluation Form"}),e.jsx("p",{children:"EE 491/492 â€” Senior Project Poster Day"})]})]}),e.jsxs("div",{className:"info-card",children:[e.jsx("h3",{children:"Jury Member Information"}),e.jsx("div",{className:"identity-warning",children:"âš ï¸ Please enter your name and department carefully. Once you begin the evaluation, these cannot be changed."}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-name",children:["Full Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-name",value:t,onChange:p=>s(p.target.value),placeholder:"e.g. Prof. Dr. Jane Smith",autoComplete:"name",autoFocus:!0})]}),e.jsxs("div",{className:"field",children:[e.jsxs("label",{htmlFor:"jury-dept",children:["Department / Institution ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{id:"jury-dept",value:r,onChange:p=>a(p.target.value),placeholder:"e.g. EEE Dept. / TED University",onKeyDown:p=>{p.key==="Enter"&&d&&n()}})]}),e.jsx("p",{className:"draft-device-note",children:"â„¹ï¸ Scores save automatically when you fill in each field or navigate between groups. Your PIN lets you continue from any device."}),e.jsx("button",{className:"btn-primary",disabled:!d,onClick:n,children:"Start Evaluation â†’"})]})]})}function Jt({onSubmit:t,pinError:s}){const[r,a]=u.useState(["","","",""]),n=[u.useRef(null),u.useRef(null),u.useRef(null),u.useRef(null)];u.useEffect(()=>{s&&(a(["","","",""]),setTimeout(()=>{var o;return(o=n[0].current)==null?void 0:o.focus()},50))},[s]);function i(o,m){var x;const f=m.replace(/\D/g,"").slice(-1),L=[...r];L[o]=f,a(L),f&&o<3&&((x=n[o+1].current)==null||x.focus())}function d(o,m){var f,L,x;if(m.key==="Backspace")if(r[o]===""&&o>0){const j=[...r];j[o-1]="",a(j),(f=n[o-1].current)==null||f.focus()}else{const j=[...r];j[o]="",a(j)}if(m.key==="ArrowLeft"&&o>0&&((L=n[o-1].current)==null||L.focus()),m.key==="ArrowRight"&&o<3&&((x=n[o+1].current)==null||x.focus()),m.key==="Enter"){const j=r.join("");j.length===4&&t(j)}}function p(o){var f;const m=o.clipboardData.getData("text").replace(/\D/g,"").slice(0,4);if(m.length===4){const L=m.split("");a(L),(f=n[3].current)==null||f.focus()}o.preventDefault()}function h(){const o=r.join("");o.length===4&&t(o)}const l=r.every(o=>o!=="");return e.jsxs("div",{className:"pin-input-group",children:[e.jsx("div",{className:"pin-boxes-row",children:r.map((o,m)=>e.jsx("input",{ref:n[m],type:"password",inputMode:"numeric",maxLength:1,value:o,autoFocus:m===0,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,"data-lpignore":"true","data-form-type":"other",onChange:f=>i(m,f.target.value),onKeyDown:f=>d(m,f),onPaste:m===0?p:void 0,className:"pin-box"},m))}),e.jsx("button",{className:"btn-primary pin-ok-btn",onClick:h,disabled:!l,children:"OK â†’"})]})}function Ut({pinStep:t,pinError:s,newPin:r,attemptsLeft:a,juryName:n,onPinSubmit:i,onPinAcknowledge:d}){return t==="new"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Je,{})}),e.jsx("h3",{children:"Your Access PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome, ",e.jsx("strong",{children:n}),"! A 4-digit PIN has been assigned to protect your evaluations. Please save it â€” you will need it every time you log in from a new device or browser tab."]}),e.jsx("div",{className:"pin-display","aria-label":"Your PIN",children:String(r).split("").map((p,h)=>e.jsx("span",{className:"pin-digit",children:p},h))}),e.jsx("p",{className:"pin-hint",children:"ðŸ”’ Keep this PIN private. If you lose it, contact the admin to reset it."}),e.jsx("button",{className:"btn-primary",onClick:d,children:"I've saved my PIN â€” Continue â†’"})]})}):t==="locked"?e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap lock-icon",children:"ðŸ”’"}),e.jsx("h3",{children:"Account Locked"}),e.jsx("p",{className:"pin-error-msg",children:s})]})}):e.jsx("div",{className:"form-screen",children:e.jsxs("div",{className:"info-card pin-card",children:[e.jsx("div",{className:"pin-icon-wrap",children:e.jsx(Je,{})}),e.jsx("h3",{children:"Enter Your PIN"}),e.jsxs("p",{className:"pin-intro",children:["Welcome back, ",e.jsx("strong",{children:n}),". Enter your 4-digit PIN and press OK to continue."]}),e.jsx(Jt,{onSubmit:i,pinError:s}),s&&e.jsx("div",{className:"pin-error-msg",children:s})]})})}function Kt(t){return t===0?"#e2e8f0":t<34?"linear-gradient(90deg,#ef4444,#f97316)":t<67?"linear-gradient(90deg,#f97316,#eab308)":t<100?"linear-gradient(90deg,#eab308,#84cc16)":"linear-gradient(90deg,#84cc16,#22c55e)"}function Yt({saveStatus:t}){return t==="saving"?e.jsx("span",{className:"autosave-dot saving",children:"â³ Savingâ€¦"}):t==="saved"?e.jsx("span",{className:"autosave-dot saved",children:"âœ“ Saved"}):e.jsx("span",{className:"autosave-dot idle",children:"â— Auto-saving"})}function qt({juryName:t,juryDept:s,current:r,onNavigate:a,scores:n,comments:i,touched:d,groupSynced:p,editMode:h,progressPct:l,allComplete:o,saveStatus:m,handleScore:f,handleScoreBlur:L,handleCommentChange:x,handleCommentBlur:j,handleFinalSubmit:C,onGoHome:b}){var V;const[k,E]=u.useState(!1),[N,S]=u.useState(null),P=B[r],q=(w,$)=>{const U=Y.filter(H=>{var c;return((c=n[w.id])==null?void 0:c[H.id])!==""}).length;return`${le(n,w.id)?"âœ…":"âš ï¸"} ${w.name} (${U}/${Y.length})`},G=()=>{r>0&&a(r-1)},z=()=>{r<B.length-1&&a(r+1)};return e.jsxs("div",{className:"form-screen eval-screen",children:[e.jsxs("div",{className:"eval-sticky-header",children:[e.jsxs("div",{className:"eval-identity-bar",children:[e.jsx("span",{className:"eval-identity-icon",children:"ðŸ‘¤"}),e.jsxs("span",{className:"eval-identity-text",children:[t,s&&e.jsxs("span",{className:"eval-identity-dept",children:[" (",s,")"]})]}),e.jsx("span",{className:"eval-identity-save",children:e.jsx(Yt,{saveStatus:m})}),e.jsx("button",{className:"eval-home-btn-icon",onClick:()=>E(!0),"aria-label":"Home",children:e.jsx(Se,{})})]}),e.jsxs("div",{className:"eval-project-card",children:[e.jsxs("div",{className:"eval-project-line1",children:[e.jsx("span",{className:"eval-group-label",children:P.name}),e.jsx("span",{className:"eval-project-name",children:P.desc})]}),((V=P.students)==null?void 0:V.length)>0&&e.jsxs("div",{className:"eval-project-line2",children:["ðŸ‘¥ ",P.students.join(" Â· ")]})]}),e.jsxs("div",{className:"eval-nav-row",children:[e.jsx("button",{className:"group-nav-btn",onClick:G,disabled:r===0,"aria-label":"Previous group",children:e.jsx(Wt,{})}),e.jsx("select",{className:"group-nav-select",value:r,onChange:w=>a(Number(w.target.value)),children:B.map((w,$)=>e.jsx("option",{value:$,children:q(w)},w.id))}),e.jsx("button",{className:"group-nav-btn",onClick:z,disabled:r===B.length-1,"aria-label":"Next group",children:e.jsx(Gt,{})})]}),e.jsx("div",{className:"eval-progress-row",children:e.jsxs("div",{className:"eval-progress-track",children:[e.jsx("div",{className:"eval-progress-fill",style:{width:`${l}%`,background:Kt(l)}}),e.jsxs("span",{className:"eval-progress-label",children:[Math.round(l),"%"]})]})})]}),k&&e.jsx("div",{className:"back-menu-overlay",onClick:()=>E(!1),children:e.jsxs("div",{className:"back-menu",onClick:w=>w.stopPropagation(),children:[e.jsx("p",{className:"back-menu-title",children:"Leave evaluation?"}),e.jsx("p",{className:"back-menu-sub",children:"Your progress is saved. You can continue any time."}),e.jsx("button",{className:"back-menu-btn primary",onClick:()=>{E(!1),b()},children:"ðŸ  Go to Home"}),e.jsx("button",{className:"back-menu-btn ghost",onClick:()=>E(!1),children:"Cancel"})]})}),e.jsxs("div",{className:"eval-body",children:[p[P.id]&&!h&&e.jsx("div",{className:"group-done-banner",children:"âœ… All scores saved for this group."}),h&&e.jsxs("div",{className:"group-done-banner edit-mode-banner",children:["âœï¸ Edit mode â€” adjust scores then click ",e.jsx("strong",{children:"Submit Final"}),"."]}),Y.map(w=>{var H,c;const $=((H=n[P.id])==null?void 0:H[w.id])??"",U=((c=d[P.id])==null?void 0:c[w.id])&&$==="",K=(parseInt($,10)||0)/w.max*100;return e.jsxs("div",{className:`crit-card${U?" invalid":""}`,children:[e.jsxs("div",{className:"crit-header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"crit-label",children:w.label}),e.jsxs("div",{className:"crit-max",children:["Maximum: ",w.max," pts"]})]}),e.jsx("button",{className:"rubric-btn",onClick:()=>S(N===w.id?null:w.id),children:N===w.id?"Hide Rubric â–²":"Show Rubric â–¼"})]}),N===w.id&&e.jsx("div",{className:"rubric-table",children:w.rubric.map(_=>e.jsxs("div",{className:"rubric-row",children:[e.jsx("div",{className:"rubric-range",children:_.range}),e.jsx("div",{className:"rubric-level",children:_.level}),e.jsx("div",{className:"rubric-desc",children:_.desc})]},_.range))}),e.jsxs("div",{className:"score-input-row",children:[e.jsx("input",{type:"number",inputMode:"numeric",min:"0",max:w.max,value:$,onChange:_=>f(P.id,w.id,_.target.value),onBlur:()=>L(P.id,w.id),placeholder:"â€”",className:"score-input"}),e.jsx("span",{className:"score-bar-wrap",children:e.jsx("span",{className:"score-bar",style:{width:`${K}%`}})}),e.jsx("span",{className:"score-pct",children:$!==""?`${$} / ${w.max}`:`â€” / ${w.max}`})]}),U&&e.jsx("div",{className:"required-hint",children:"Required"})]},w.id)}),e.jsxs("div",{className:"crit-card comment-card",children:[e.jsx("div",{className:"crit-label",children:"Comments (Optional)"}),e.jsx("textarea",{value:i[P.id]||"",onChange:w=>x(P.id,w.target.value),onBlur:()=>j(P.id),placeholder:"Any additional feedback about this groupâ€¦",rows:3})]}),e.jsxs("div",{className:"total-bar",children:[e.jsx("span",{children:"Total"}),(()=>{const w=Y.reduce(($,U)=>{var K;return $+(parseInt((K=n[P.id])==null?void 0:K[U.id],10)||0)},0);return e.jsxs("span",{className:`total-score${w>=80?" high":w>=60?" mid":""}`,children:[w," / 100"]})})()]}),h&&e.jsx("button",{className:"btn-primary",style:{width:"100%",marginTop:8,opacity:o?1:.65},onClick:C,children:o?"âœ… Submit Final":`âš ï¸ Submit Final (${tt(n)} / ${B.length*Y.length} filled)`})]})]})}function Vt(t,s){return Y.reduce((r,a)=>{var n;return r+(parseInt((n=t[s])==null?void 0:n[a.id],10)||0)},0)}function Ht({doneScores:t,doneComments:s,scores:r,comments:a,onEditScores:n,onBack:i}){const d=t||r,p=s||a,[h,l]=u.useState(new Set);function o(m){l(f=>{const L=new Set(f);return L.has(m)?L.delete(m):L.add(m),L})}return e.jsx("div",{className:"done-screen",children:e.jsxs("div",{className:"done-card",children:[e.jsx("div",{className:"done-icon",children:"ðŸŽ‰"}),e.jsx("h2",{children:"Thank You!"}),e.jsx("p",{className:"done-subtitle",children:"Your evaluations have been recordedâ€”thank you for your feedback."}),e.jsx("div",{className:"done-summary",children:B.map(m=>{var k,E;const f=h.has(m.id),L=`done-group-panel-${m.id}`,x=!!m.desc||((k=m.students)==null?void 0:k.length)>0||!!(p!=null&&p[m.id]),j=Y.filter(N=>{var P;const S=(P=d[m.id])==null?void 0:P[N.id];return S!=null&&S!==""}).length,C=Math.round(j/Y.length*100),b=C===100?"#22c55e":C>66?"#84cc16":C>33?"#eab308":C>0?"#f97316":"#e2e8f0";return e.jsxs("div",{className:"done-row-wrap",children:[e.jsxs("div",{className:"done-row group-accordion-header",role:"button",tabIndex:x?0:-1,"aria-expanded":f,"aria-controls":L,onClick:()=>{x&&o(m.id)},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&x&&(N.preventDefault(),o(m.id))},style:{cursor:x?"pointer":"default"},children:[e.jsx("div",{className:"done-row-left",children:e.jsxs("div",{className:"done-row-header-line",children:[e.jsx("span",{className:"done-row-name",children:m.name}),x&&e.jsx("span",{className:`group-accordion-chevron${f?" open":""}`,children:e.jsx(st,{})})]})}),e.jsxs("div",{className:"done-row-right",children:[e.jsxs("span",{className:"done-score",children:[Vt(d,m.id)," / 100"]}),e.jsx("div",{className:"done-row-mini-progress-wrap",children:e.jsx("div",{className:"done-row-mini-progress-fill",style:{width:`${C}%`,background:b}})})]})]}),e.jsx("div",{id:L,className:`group-accordion-panel${f?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner done-accordion-inner",children:[m.desc&&e.jsx("span",{className:"done-row-desc",children:m.desc}),((E=m.students)==null?void 0:E.length)>0&&e.jsxs("span",{className:"done-row-students",children:["ðŸ‘¥ ",m.students.join(" Â· ")]}),(p==null?void 0:p[m.id])&&e.jsxs("div",{className:"done-comment",children:["ðŸ’¬ ",p[m.id]]})]})})]},m.id)})}),e.jsxs("div",{className:"done-actions",children:[e.jsx("button",{className:"btn-secondary",onClick:n,children:"âœï¸ Edit Scores"}),e.jsxs("button",{className:"btn-primary",onClick:i,children:[e.jsx(Se,{})," Back to Home"]})]})]})})}function Xt(t){return t==="all_submitted"?{label:"Submitted",color:"#166534",bg:"#dcfce7"}:t==="group_submitted"?{label:"Complete",color:"#1e40af",bg:"#dbeafe"}:t==="in_progress"?{label:"In progress",color:"#92400e",bg:"#fef9c3"}:{label:"â€”",color:"#64748b",bg:"#f1f5f9"}}function be({progress:t,onConfirm:s,onFresh:r}){if(!t)return null;if(t.loading)return e.jsx("div",{className:"spd-overlay",children:e.jsx("div",{className:"spd-card",children:e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:"â³"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:"Checking your progressâ€¦"}),e.jsx("div",{className:"spd-sub",children:"Connecting to server"})]})]})})});const{rows:a,filledCount:n,totalCount:i,allSubmitted:d}=t,p=a&&a.length>0;return e.jsx("div",{className:"spd-overlay",children:e.jsxs("div",{className:"spd-card",children:[e.jsxs("div",{className:"spd-header",children:[e.jsx("div",{className:"spd-icon",children:d?"âœ…":p?"â˜ï¸":"ðŸ“‹"}),e.jsxs("div",{children:[e.jsx("div",{className:"spd-title",children:d?"All evaluations submitted":p?"Saved progress found":"No saved data found"}),e.jsxs("div",{className:"spd-sub",children:[n," / ",i," groups completed on server"]})]})]}),p&&e.jsx("div",{className:"spd-list",children:B.map(h=>{const l=a.find(f=>Number(f.projectId)===h.id),o=Xt(l==null?void 0:l.status),m=(l==null?void 0:l.total)??"â€”";return e.jsxs("div",{className:"spd-row",children:[e.jsx("span",{className:"spd-row-name",children:h.name}),e.jsx("span",{className:"spd-row-total",children:m!=="â€”"?`${m}/100`:"â€”"}),e.jsx("span",{className:"spd-chip",style:{color:o.color,background:o.bg},children:o.label})]},h.id)})}),!p&&e.jsxs("p",{className:"spd-empty",children:["No evaluations were found on the server for your account."," ","You can start a fresh evaluation below."]}),e.jsxs("div",{className:"spd-actions",children:[e.jsx("button",{className:"btn-primary",onClick:s,children:d?"View / Edit My Scores":p?"Continue from here":"Start Evaluation"}),p&&!d&&e.jsx("button",{className:"btn-secondary",onClick:r,children:"Start Fresh"})]})]})})}function Qt({onBack:t}){const{step:s,juryName:r,setJuryName:a,juryDept:n,setJuryDept:i,current:d,handleNavigate:p,scores:h,comments:l,touched:o,groupSynced:m,editMode:f,progressPct:L,allComplete:x,doneScores:j,doneComments:C,sheetProgress:b,saveStatus:k,pinStep:E,pinError:N,newPin:S,attemptsLeft:P,handleScore:q,handleScoreBlur:G,handleCommentChange:z,handleCommentBlur:V,handleStart:w,handleConfirmFromSheet:$,handleStartFresh:U,handleResubmit:K,handleEditScores:H,handleFinalSubmit:c,handlePinSubmit:_,handlePinAcknowledge:I,sessionKicked:J,kickedMsg:X,handleKickedAcknowledge:v,resetAll:M}=Tt();return J?e.jsx("div",{className:"kicked-overlay",children:e.jsxs("div",{className:"kicked-card",children:[e.jsx("div",{className:"kicked-icon",children:"ðŸ”"}),e.jsx("div",{className:"kicked-title",children:"Session Ended"}),e.jsx("div",{className:"kicked-body",children:X}),e.jsx("button",{className:"btn-primary",onClick:v,children:"Sign in again"})]})}):s==="done"?e.jsxs(e.Fragment,{children:[e.jsx(Ht,{doneScores:j,doneComments:C,scores:h,comments:l,onEditScores:H,onBack:()=>{M(),t()}}),e.jsx(be,{progress:b,onConfirm:$,onFresh:U})]}):s==="pin"?e.jsxs(e.Fragment,{children:[e.jsx(Ut,{pinStep:E,pinError:N,newPin:S,attemptsLeft:P,juryName:r,onPinSubmit:_,onPinAcknowledge:I}),e.jsx(be,{progress:b,onConfirm:$,onFresh:U})]}):s==="eval"?e.jsxs(e.Fragment,{children:[e.jsx(qt,{juryName:r,juryDept:n,current:d,onNavigate:p,scores:h,comments:l,touched:o,groupSynced:m,editMode:f,progressPct:L,allComplete:x,saveStatus:k,handleScore:q,handleScoreBlur:G,handleCommentChange:z,handleCommentBlur:V,handleFinalSubmit:c,onGoHome:t}),e.jsx(be,{progress:b,onConfirm:$,onFresh:U})]}):e.jsxs(e.Fragment,{children:[e.jsx(zt,{juryName:r,setJuryName:a,juryDept:n,setJuryDept:i,onStart:w,onBack:t}),e.jsx(be,{progress:b,onConfirm:$,onFresh:U})]})}const Zt="modulepreload",es=function(t){return"/senior-design-jury/"+t},Ue={},ts=function(s,r,a){if(!r||r.length===0)return s();const n=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=es(i),i in Ue)return;Ue[i]=!0;const d=i.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(!!a)for(let o=n.length-1;o>=0;o--){const m=n[o];if(m.href===i&&(!d||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${p}`))return;const l=document.createElement("link");if(l.rel=d?"stylesheet":Zt,d||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),d)return new Promise((o,m)=>{l.addEventListener("load",o),l.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>s()).catch(i=>{const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=i,window.dispatchEvent(d),!d.defaultPrevented)throw i})},nt=new Map(B.map((t,s)=>typeof t=="string"?[s+1,{desc:"",students:[]}]:[t.id??s+1,{desc:t.desc??"",students:t.students??[]}]));function oe(t){const s=Number(String(t??"").trim().replace(/^"+|"+$/g,"").replace(",","."));return Number.isFinite(s)?s:0}function we(t){if(!t)return 0;const s=String(t).trim().replace(/\s*,\s*/g,", "),r=Date.parse(s);if(Number.isFinite(r))return r;const a=s.match(/^([0-3]?\d)\/([0-1]?\d)\/(\d{4}),?\s*([0-2]?\d):([0-5]\d)(?::([0-5]\d))?$/);if(a)return new Date(+a[3],+a[2]-1,+a[1],+a[4],+a[5],+(a[6]||0)).getTime()||0;const n=s.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})(?:\s+(\d{1,2}):(\d{2})(?::(\d{2}))?\s*(AM|PM)?)?$/i);if(!n)return 0;let i=+(n[4]||0);const d=(n[7]||"").toUpperCase();return d==="PM"&&i<12&&(i+=12),d==="AM"&&i===12&&(i=0),new Date(+n[3],+n[1]-1,+n[2],i,+(n[5]||0),+(n[6]||0)).getTime()||0}function Fe(t){if(!t)return"â€”";const s=we(t);if(!s)return String(t);const r=new Date(s),a=n=>String(n).padStart(2,"0");return`${a(r.getDate())}/${a(r.getMonth()+1)}/${r.getFullYear()} ${a(r.getHours())}:${a(r.getMinutes())}`}function xe(t,s){const r=Number(t),a=Number(s);return Number.isFinite(r)&&Number.isFinite(a)?r-a:String(t??"").toLowerCase()<String(s??"").toLowerCase()?-1:1}function rt(t){let s=2166136261;for(let r=0;r<t.length;r++)s^=t.charCodeAt(r),s=Math.imul(s,16777619);return s>>>0}function at(t,s,r){s/=100,r/=100;const a=d=>(d+t/30)%12,n=s*Math.min(r,1-r),i=d=>Math.round(255*(r-n*Math.max(-1,Math.min(a(d)-3,Math.min(9-a(d),1))))).toString(16).padStart(2,"0");return`#${i(0)}${i(8)}${i(4)}`}const ss=t=>at(rt(t||"?")%360,55,95),ns=t=>at(rt(t||"?")%360,65,55);function rs(t){const s=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],r=l=>{const o=String(l??"").replace(/\r\n|\r/g,`
`);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o},a=[s.map(r).join(","),...t.map(l=>{const o=nt.get(l.projectId)||{desc:"",students:[]};return[l.juryName,l.juryDept,l.timestamp,l.projectName,o.desc,o.students.join(" Â· "),l.technical,l.design,l.delivery,l.teamwork,l.total,l.comments].map(r).join(",")})],n=new Date,i=n.toISOString().slice(0,10),d=`${String(n.getHours()).padStart(2,"0")}-${String(n.getMinutes()).padStart(2,"0")}`,p=new Blob(["\uFEFF"+a.join(`
`)],{type:"text/csv;charset=utf-8;"}),h=URL.createObjectURL(p);Object.assign(document.createElement("a"),{href:h,download:`jury_export_${i}_${d}.csv`}).click(),URL.revokeObjectURL(h)}async function as(t){const s=await ts(()=>import("./xlsx-6ed613d4.js"),[]),r=["Juror Name","Department / Institution","Timestamp","Group Name","Group Desc","Students","Technical (30)","Written (30)","Oral (30)","Teamwork (10)","Total (100)","Comments"],a=t.map(l=>{const o=nt.get(l.projectId)||{desc:"",students:[]};return[l.juryName??"",l.juryDept??"",l.timestamp??"",l.projectName??"",o.desc,o.students.join(" Â· "),l.technical??"",l.design??"",l.delivery??"",l.teamwork??"",l.total??"",l.comments??""]}),n=s.utils.aoa_to_sheet([r,...a]);n["!cols"]=[20,22,18,20,24,28,14,12,10,13,10,30].map(l=>({wch:l}));const i=s.utils.book_new();s.utils.book_append_sheet(i,n,"Jury Evaluations");const d=new Date,p=d.toISOString().slice(0,10),h=`${String(d.getHours()).padStart(2,"0")}-${String(d.getMinutes()).padStart(2,"0")}`;s.writeFile(i,`jury_export_${p}_${h}.xlsx`)}const is=t=>t.reduce((s,r)=>s+Y.filter(a=>r[a.id]>0).length,0),os=t=>{const s=B.length*Y.length;return s===0?0:Math.round(is(t)/s*100)};function ls(t){const s={all_submitted:3,group_submitted:2,in_progress:1},r=(t||[]).filter(n=>(n==null?void 0:n.juryName)||(n==null?void 0:n.projectName)||((n==null?void 0:n.total)??0)>0).map(n=>({...n,tsMs:Number.isFinite(n==null?void 0:n.tsMs)?n.tsMs:we(n==null?void 0:n.timestamp)})),a=new Map;for(const n of r){const i=String(n.juryName??"").trim().toLowerCase(),d=String(n.juryDept??"").trim().toLowerCase(),p=n.projectId?String(n.projectId).trim():String(n.projectName??"").trim().toLowerCase();if(!i||!p)continue;const h=`${i}__${d}__${p}`,l=a.get(h);if(!l){a.set(h,n);continue}if((n.tsMs||0)>(l.tsMs||0)){a.set(h,n);continue}(n.tsMs||0)===(l.tsMs||0)&&(s[n.status]||0)>(s[l.status]||0)&&a.set(h,n)}return[...a.values()].sort((n,i)=>(i.tsMs||0)-(n.tsMs||0))}const cs=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[e.jsx("path",{d:"M3 9.5L10 2.5L11.5 4L4.5 11H3Z"}),e.jsx("path",{d:"M9.5 3.5L11 5"})]}),Ke=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("path",{d:"M3 7L6 10L11 4"})}),ds=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:e.jsx("circle",{cx:"7",cy:"7",r:"2.5"})});function ye({status:t,editingFlag:s}){return s==="editing"?e.jsxs("span",{className:"status-badge editing",children:[e.jsx(cs,{}),"Editing"]}):t==="all_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Ke,{}),"Submitted"]}):t==="group_submitted"?e.jsxs("span",{className:"status-badge submitted",children:[e.jsx(Ke,{}),"Submitted"]}):t==="in_progress"?e.jsxs("span",{className:"status-badge in-progress",children:[e.jsx(ds,{}),"In Progress"]}):null}const us=Y.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Me=t=>[{bg:"#F59E0B",fg:"#0B1220",ring:"#FCD34D"},{bg:"#94A3B8",fg:"#0B1220",ring:"#CBD5E1"},{bg:"#B45309",fg:"#FFF7ED",ring:"#FDBA74"}][t]??{bg:"#475569",fg:"#F1F5F9",ring:"#94A3B8"},ms=[$t,Rt,Bt],hs=t=>{const s=ms[t];return s?e.jsx(s,{}):String(t+1)};function ps({ranked:t,submittedData:s}){return s.length===0?e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"summary-note",style:{marginBottom:16,padding:"10px 14px",borderRadius:12,background:"#EFF6FF",border:"1px solid #BFDBFE",color:"#1E3A8A",fontSize:13,fontWeight:500},children:["â„¹ï¸ Averages and rankings include only ",e.jsx("strong",{children:"final submissions"}),"."]}),e.jsx("div",{className:"rank-list",children:t.map((r,a)=>{var n;return e.jsxs("div",{className:"rank-card",style:a<3?{background:"#ECFDF5",boxShadow:"0 0 0 1px #BBF7D0, 0 8px 22px rgba(34,197,94,0.18)",border:"1px solid #86EFAC"}:void 0,children:[e.jsx("div",{className:"rank-num",style:{width:52,height:52,borderRadius:999,display:"grid",placeItems:"center",fontSize:a<3?22:18,fontWeight:800,background:a<3?"transparent":Me(a).bg,color:Me(a).fg,boxShadow:a<3?"0 0 0 5px rgba(34,197,94,0.25)":"0 6px 18px rgba(15,23,42,0.12)",border:a<3?"none":`3px solid ${Me(a).ring}`,overflow:"hidden",padding:0},children:hs(a)}),e.jsxs("div",{className:"rank-info",children:[e.jsxs("div",{className:"rank-name-block",children:[e.jsx("span",{className:"rank-group-name",children:r.name}),r.desc&&e.jsx("span",{className:"rank-desc-line",children:r.desc}),((n=r.students)==null?void 0:n.length)>0&&e.jsxs("span",{className:"rank-students-line",children:["ðŸ‘¥ ",r.students.join(" Â· ")]}),e.jsxs("span",{className:"rank-eval-count",children:["(",r.count," evaluation",r.count!==1?"s":"",")"]})]}),e.jsx("div",{className:"rank-bars",children:us.map(i=>e.jsxs("div",{className:"mini-bar-row",children:[e.jsx("span",{className:"mini-label",children:i.shortLabel||i.label}),e.jsx("div",{className:"mini-bar-track",children:e.jsx("div",{className:"mini-bar-fill",style:{width:`${(r.avg[i.id]||0)/i.max*100}%`}})}),e.jsx("span",{className:"mini-val",children:(r.avg[i.id]||0).toFixed(2)})]},i.id))})]}),e.jsxs("div",{className:"rank-total",children:[e.jsx("span",{children:r.totalAvg.toFixed(2)}),e.jsx("small",{children:"avg."})]})]},r.id??`${r.name}-${a}`)})})]})}const se=Y.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Ye=["#3b82f6","#10b981","#f59e0b","#ef4444"];function xs(t){if(t.length<2)return 0;const s=t.reduce((r,a)=>r+a,0)/t.length;return Math.sqrt(t.reduce((r,a)=>r+(a-s)**2,0)/t.length)}function je({msg:t}){return e.jsx("div",{className:"chart-empty",children:t||"Not enough data yet."})}function js({stats:t}){const s=t.filter(r=>r.count>0);return s.length?e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Group Average Total Score"}),e.jsx("div",{className:"chart-subtitle",children:"Bar = average Â· Ticks = min / max range"}),s.map(r=>{const a=r.totalAvg/100*100,n=r.totalMin/100*100,i=r.totalMax/100*100;return e.jsxs("div",{className:"hbar-row",children:[e.jsx("span",{className:"hbar-label",title:r.desc||r.name,children:r.name}),e.jsxs("div",{className:"hbar-track",children:[e.jsx("div",{className:"hbar-fill",style:{width:`${a}%`}}),e.jsx("div",{className:"hbar-range",style:{left:`${n}%`,width:`${Math.max(i-n,1)}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${n}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${i}%`}})]}),e.jsx("span",{className:"hbar-val",children:r.totalAvg.toFixed(1)})]},r.id)}),e.jsx("div",{className:"hbar-axis",children:[0,20,40,60,80,100].map(r=>e.jsx("span",{style:{left:`${r}%`},children:r},r))})]}):e.jsx(je,{})}function fs({stats:t}){const s=t.filter(h=>h.count>0);if(!s.length)return e.jsx(je,{});const r=14,a=4,n=se.length*(r+a)+12,i=130,d=28,p=s.length*n+d+10;return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Criterion Performance by Group"}),e.jsx("div",{className:"chart-subtitle",children:"Normalized score as % of criterion max"}),e.jsx("div",{style:{overflowX:"auto",WebkitOverflowScrolling:"touch"},children:e.jsxs("svg",{viewBox:`0 0 ${p} ${i+36}`,style:{width:Math.max(p,280),height:i+36,display:"block"},children:[[0,25,50,75,100].map(h=>{const l=i-h/100*i;return e.jsxs("g",{children:[e.jsx("line",{x1:d,y1:l,x2:p,y2:l,stroke:"#e2e8f0",strokeWidth:"1"}),e.jsx("text",{x:d-4,y:l+4,fontSize:"8",textAnchor:"end",fill:"#94a3b8",children:h})]},h)}),s.map((h,l)=>{const o=d+l*n+4;return e.jsxs("g",{children:[se.map((m,f)=>{const L=(h.avg[m.id]||0)/m.max*100,x=L/100*i,j=o+f*(r+a);return e.jsxs("g",{children:[e.jsx("rect",{x:j,y:i-x,width:r,height:x,fill:Ye[f],rx:"2",opacity:"0.85"}),e.jsxs("title",{children:[h.name," Â· ",m.shortLabel||m.label,": ",L.toFixed(1),"%"]})]},m.id)}),e.jsx("text",{x:o+se.length*(r+a)/2-a/2,y:i+14,fontSize:"9",textAnchor:"middle",fill:"#475569",fontWeight:"600",children:h.name})]},h.id)})]})}),e.jsx("div",{className:"chart-legend",children:se.map((h,l)=>e.jsxs("span",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot",style:{background:Ye[l]}}),h.shortLabel||h.label]},h.id))})]})}function gs({stats:t}){const s=t.filter(x=>x.count>0),[r,a]=u.useState(null),n=se.length;if(n<3||!s.length)return e.jsx(je,{});const i=s.find(x=>x.id===(r??s[0].id))??s[0],d=120,p=120,h=85,l=x=>Math.PI*2*x/n-Math.PI/2,o=(x,j)=>({x:d+j*Math.cos(l(x)),y:p+j*Math.sin(l(x))}),m=se.map(x=>(i.avg[x.id]||0)/x.max*100),f=m.map((x,j)=>o(j,x/100*h)),L=f.map((x,j)=>`${j===0?"M":"L"}${x.x.toFixed(1)},${x.y.toFixed(1)}`).join(" ")+" Z";return e.jsxs("div",{className:"chart-card radar-chart-card",children:[e.jsx("div",{className:"chart-title",children:"Performance Radar"}),e.jsx("div",{className:"chart-subtitle",children:"Normalized per criterion (% of max)"}),s.length>1&&e.jsx("select",{className:"radar-group-select",value:r??s[0].id,onChange:x=>a(Number(x.target.value)),children:s.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))}),e.jsxs("svg",{viewBox:"0 0 240 240",style:{width:"100%",maxWidth:260,height:"auto"},children:[[.25,.5,.75,1].map(x=>{const C=se.map((b,k)=>o(k,x*h)).map((b,k)=>`${k===0?"M":"L"}${b.x.toFixed(1)},${b.y.toFixed(1)}`).join(" ")+" Z";return e.jsx("path",{d:C,fill:"none",stroke:"#e2e8f0",strokeWidth:"1"},x)}),se.map((x,j)=>{const C=o(j,h);return e.jsx("line",{x1:d,y1:p,x2:C.x.toFixed(1),y2:C.y.toFixed(1),stroke:"#cbd5e1",strokeWidth:"1"},j)}),e.jsx("path",{d:L,fill:"rgba(59,130,246,0.18)",stroke:"#3b82f6",strokeWidth:"2.5",strokeLinejoin:"round"}),f.map((x,j)=>e.jsx("circle",{cx:x.x.toFixed(1),cy:x.y.toFixed(1),r:"4.5",fill:"#3b82f6",stroke:"#fff",strokeWidth:"1.5"},j)),se.map((x,j)=>{const C=o(j,h+24);return e.jsx("text",{x:C.x.toFixed(1),y:C.y.toFixed(1),textAnchor:"middle",dominantBaseline:"middle",fontSize:"10",fill:"#334155",fontWeight:"700",children:x.shortLabel||x.label},j)}),f.map((x,j)=>e.jsxs("text",{x:(x.x+(x.x>d?9:x.x<d-2?-9:0)).toFixed(1),y:(x.y+(x.y>p?11:-11)).toFixed(1),textAnchor:"middle",fontSize:"8",fill:"#1e40af",fontWeight:"700",children:[m[j].toFixed(0),"%"]},`v${j}`))]})]})}function vs({data:t}){const s=t.filter(i=>i.status==="all_submitted"),r=[...new Set(s.map(i=>i.juryName).filter(Boolean))];if(r.length<2)return e.jsx(je,{msg:"Need at least 2 jurors with submitted evaluations."});const a=s.reduce((i,d)=>i+d.total,0)/s.length,n=r.map(i=>{const d=s.filter(l=>l.juryName===i).map(l=>l.total),p=d.reduce((l,o)=>l+o,0)/d.length,h=xs(d);return{name:i,mean:p,sd:h}}).sort((i,d)=>d.mean-i.mean);return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Juror Scoring Tendencies"}),e.jsx("div",{className:"chart-subtitle",children:"Avg total score Â· Bar = Â±1 std dev Â· Dashed = overall mean"}),n.map(i=>{const d=i.mean/100*100,p=Math.max(0,(i.mean-i.sd)/100*100),h=Math.min(100,(i.mean+i.sd)/100*100),l=a/100*100,o=i.name.trim().split(/\s+/).pop();return e.jsxs("div",{className:"hbar-row",children:[e.jsx("span",{className:"hbar-label strictness-label",title:i.name,children:o}),e.jsxs("div",{className:"hbar-track",children:[e.jsx("div",{className:"hbar-fill strictness-fill",style:{width:`${d}%`}}),e.jsx("div",{className:"hbar-range",style:{left:`${p}%`,width:`${Math.max(h-p,1)}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${p}%`}}),e.jsx("div",{className:"hbar-tick",style:{left:`${h}%`}}),e.jsx("div",{className:"hbar-mean-line",style:{left:`${l}%`}})]}),e.jsxs("span",{className:"hbar-val",children:[i.mean.toFixed(1),e.jsxs("span",{style:{fontSize:9,color:"#94a3b8"},children:["Â±",i.sd.toFixed(1)]})]})]},i.name)}),e.jsx("div",{className:"hbar-axis",children:[0,20,40,60,80,100].map(i=>e.jsx("span",{style:{left:`${i}%`},children:i},i))})]})}function bs({data:t}){const s=t.filter(l=>l.status==="all_submitted");if(s.length<3)return e.jsx(je,{msg:"Need at least 3 submitted evaluations."});const r=300,a=90,n=22,i=s.reduce((l,o)=>l+o.total,0)/s.length,d=n+i/100*(r-n*2),p={},h=s.map(l=>{const o=n+l.total/100*(r-n*2),m=Math.round(o);return p[m]=(p[m]||0)+1,{x:o,y:a-10-(p[m]-1)*13,score:l.total,name:l.juryName,group:l.projectName}});return e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"chart-title",children:"Score Distribution"}),e.jsxs("div",{className:"chart-subtitle",children:["Each dot = one evaluation Â· Dashed = mean (",i.toFixed(1),")"]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("svg",{viewBox:`0 0 ${r} ${a+18}`,style:{width:"100%",minWidth:240,height:"auto"},children:[e.jsx("line",{x1:n,y1:a,x2:r-n,y2:a,stroke:"#e2e8f0",strokeWidth:"1"}),[0,20,40,60,80,100].map(l=>{const o=n+l/100*(r-n*2);return e.jsxs("g",{children:[e.jsx("line",{x1:o,y1:a-2,x2:o,y2:a+2,stroke:"#94a3b8",strokeWidth:"1"}),e.jsx("text",{x:o,y:a+12,textAnchor:"middle",fontSize:"8",fill:"#94a3b8",children:l})]},l)}),e.jsx("line",{x1:d,y1:0,x2:d,y2:a,stroke:"#3b82f6",strokeWidth:"1.5",strokeDasharray:"3,3"}),h.map((l,o)=>e.jsx("circle",{cx:l.x,cy:l.y,r:"5",fill:"#3b82f6",opacity:"0.75",stroke:"#fff",strokeWidth:"1.5",children:e.jsxs("title",{children:[l.group," Â· ",l.name," Â· ",l.score]})},o))]})})]})}function ys({dashboardStats:t,submittedData:s}){if(s.length===0)return e.jsx("div",{className:"empty-msg",children:"No submitted evaluations yet."});const r=new Date().toLocaleString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"dashboard-print-wrap",children:[e.jsxs("div",{className:"print-header",children:[e.jsx("div",{className:"print-header-title",children:ne.appTitle}),e.jsxs("div",{className:"print-header-sub",children:[ne.courseName," â€” ",ne.university]}),e.jsxs("div",{className:"print-header-meta",children:["Dashboard Report Â Â·Â  ",r,"Â Â·Â  ",s.length," final submission",s.length!==1?"s":"","Â Â·Â  ",t.length," group",t.length!==1?"s":""]})]}),e.jsx("div",{className:"dashboard-toolbar no-print",children:e.jsx("button",{className:"pdf-export-btn",onClick:()=>window.print(),children:"â¬‡ Export PDF"})}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx(js,{stats:t}),e.jsx(vs,{data:s})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsx(fs,{stats:t}),e.jsx(gs,{stats:t})]}),e.jsx(bs,{data:s})]})}const qe=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function me(t){if(t===""||t===null||t===void 0||typeof t=="string"&&t.trim()==="")return"";const s=Number(t);return Number.isFinite(s)?s:""}const Ns=[{key:"in_progress",label:"In Progress"},{key:"group_submitted",label:"Completed"},{key:"all_submitted",label:"Final"},{key:"editing",label:"Editing"}],ks=[{key:"technical",label:"Technical /30"},{key:"design",label:"Written /30"},{key:"delivery",label:"Oral /30"},{key:"teamwork",label:"Teamwork /10"},{key:"total",label:"Total"}],Ss=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:[e.jsx("path",{d:"M3 4.5L6 1.5L9 4.5"}),e.jsx("path",{d:"M3 7.5L6 10.5L9 7.5"})]}),ws=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M3 7.5L6 4.5L9 7.5"})}),Cs=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M3 4.5L6 7.5L9 4.5"})}),Ls=()=>e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",style:{display:"inline-block",verticalAlign:"middle"},children:e.jsx("path",{d:"M2 2L10 10M10 2L2 10"})}),Ve=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block",verticalAlign:"middle"},children:[e.jsx("path",{d:"M7 2v7M4 6.5L7 9.5L10 6.5"}),e.jsx("path",{d:"M2 11.5h10"})]});function He(t){return t.jurorId?t.jurorId:`${(t.juryName||"").trim().toLowerCase()}__${(t.juryDept||"").trim().toLowerCase()}`}function Es({data:t,jurors:s}){const[r,a]=u.useState("ALL"),[n,i]=u.useState("ALL"),[d,p]=u.useState("ALL"),[h,l]=u.useState(new Set),[o,m]=u.useState(""),[f,L]=u.useState(""),[x,j]=u.useState(""),[C,b]=u.useState("tsMs"),[k,E]=u.useState("desc"),[N,S]=u.useState(null),P=u.useMemo(()=>qe.map(c=>({id:c.id,label:`Group ${c.id}`,name:c.name})).sort((c,_)=>c.id-_.id),[]),q=u.useMemo(()=>{const c=new Map;return s.forEach(_=>{const I=String((_==null?void 0:_.dept)??"").trim();I&&c.set(I.toLowerCase(),I)}),Array.from(c.entries()).sort((_,I)=>_[1].localeCompare(I[1])).map(([_,I])=>({key:_,label:I}))},[s]),G=u.useMemo(()=>r!=="ALL"||n!=="ALL"||d!=="ALL"||h.size>0||o||f||x,[r,n,d,h,o,f,x]);function z(){a("ALL"),i("ALL"),p("ALL"),l(new Set),m(""),L(""),j(""),b("tsMs"),E("desc"),S(null)}function V(c){l(_=>{const I=new Set(_);return I.has(c)?I.delete(c):I.add(c),I})}function w(c){S(_=>_===c?null:c)}function $(c){return c===""||c===null||c===void 0||typeof c=="string"&&c.trim()===""?!0:typeof c=="number"?!Number.isFinite(c):!1}const U=u.useMemo(()=>{const c=o?new Date(o).getTime():0,_=f?new Date(f+"T23:59:59").getTime():1/0;let I=t.slice();if(r!=="ALL"&&(I=I.filter(J=>He(J)===r)),d!=="ALL"&&(I=I.filter(J=>String(J.projectId)===d)),n!=="ALL"){const J=n.toLowerCase();I=I.filter(X=>String(X.juryDept??"").trim().toLowerCase()===J)}if(h.size>0&&(I=I.filter(J=>h.has("editing")&&J.editingFlag==="editing"?!0:h.has(J.status))),(o||f)&&(I=I.filter(J=>{const X=J.tsMs||we(J.timestamp);return X>=c&&X<=_})),x){const J=x.toLowerCase();I=I.filter(X=>(X.comments||"").toLowerCase().includes(J))}return I.sort((J,X)=>{const v=J[C],M=X[C],W=$(v),T=$(M);return W&&T?0:W?1:T?-1:k==="asc"?xe(v,M):xe(M,v)}),I},[t,r,d,n,h,o,f,x,C,k]);function K(c){C===c?E(_=>_==="asc"?"desc":"asc"):(b(c),E("desc"))}const H=c=>C!==c?e.jsx(Ss,{}):k==="asc"?e.jsx(ws,{}):e.jsx(Cs,{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"detail-table-toolbar",children:[e.jsxs("span",{className:"filter-count",children:["Showing ",e.jsx("strong",{children:U.length})," row",U.length!==1?"s":""]}),G&&e.jsxs("button",{className:"filter-reset",onClick:z,children:[e.jsx(Ls,{})," Clear Filters"]}),e.jsxs("button",{className:"xlsx-export-btn",onClick:()=>{as(U)},children:[e.jsx(Ve,{}),e.jsx("span",{className:"export-label-long",children:"Export Excel"}),e.jsx("span",{className:"export-label-short",children:"Excel"})]}),e.jsxs("button",{className:"csv-export-btn",onClick:()=>rs(U),children:[e.jsx(Ve,{}),e.jsx("span",{className:"export-label-long",children:"Export CSV"}),e.jsx("span",{className:"export-label-short",children:"CSV"})]})]}),N!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>S(null)}),e.jsx("div",{className:"detail-table-wrap",children:e.jsxs("table",{className:"detail-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("juryName"),children:["Juror ",e.jsx("span",{className:"sort-icon",children:H("juryName")})]}),e.jsx("div",{className:`col-filter-hotspot${r!=="ALL"?" active":""}`,onClick:c=>{c.stopPropagation(),w("juror")},title:"Filter by juror"})]}),N==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:r,onChange:c=>{a(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All jurors"}),s.map(c=>e.jsxs("option",{value:c.key,children:[c.name,c.dept?` (${c.dept})`:""]},c.key))]}),r!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{a("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("juryDept"),children:["Department ",e.jsx("span",{className:"sort-icon",children:H("juryDept")})]}),e.jsx("div",{className:`col-filter-hotspot${n?" active":""}`,onClick:c=>{c.stopPropagation(),w("dept")},title:"Filter by department"})]}),N==="dept"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:n,onChange:c=>{i(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All departments"}),q.map(c=>e.jsx("option",{value:c.key,children:c.label},c.key))]}),n!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{i("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative",whiteSpace:"nowrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("projectId"),children:["Group ",e.jsx("span",{className:"sort-icon",children:H("projectId")})]}),e.jsx("div",{className:`col-filter-hotspot${d!=="ALL"?" active":""}`,onClick:c=>{c.stopPropagation(),w("group")},title:"Filter by group"})]}),N==="group"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsxs("select",{autoFocus:!0,value:d,onChange:c=>{p(c.target.value),S(null)},children:[e.jsx("option",{value:"ALL",children:"All groups"}),P.map(c=>e.jsx("option",{value:String(c.id),children:c.label},c.id))]}),d!=="ALL"&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{p("ALL"),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs("span",{className:"col-sort-label",onClick:()=>K("tsMs"),children:["Timestamp ",e.jsx("span",{className:"sort-icon",children:H("tsMs")})]}),e.jsx("div",{className:`col-filter-hotspot${o||f?" active":""}`,onClick:c=>{c.stopPropagation(),w("timestamp")},title:"Filter by date"})]}),N==="timestamp"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[e.jsx("label",{style:{fontSize:11},children:"From"}),e.jsx("input",{autoFocus:!0,type:"date",value:o,onChange:c=>m(c.target.value)}),e.jsx("label",{style:{fontSize:11},children:"To"}),e.jsx("input",{type:"date",value:f,onChange:c=>L(c.target.value)}),(o||f)&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{m(""),L(""),S(null)},children:"Clear"})]})]}),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Status"}),e.jsx("div",{className:`col-filter-hotspot${h.size>0?" active":""}`,onClick:c=>{c.stopPropagation(),w("status")},title:"Filter by status"})]}),N==="status"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),children:[Ns.map(({key:c,label:_})=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:h.has(c),onChange:()=>V(c),style:{width:"auto"}}),_]},c)),h.size>0&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{l(new Set),S(null)},children:"Clear"})]})]}),ks.map(({key:c,label:_})=>e.jsx("th",{style:{cursor:"pointer",whiteSpace:"nowrap"},onClick:()=>K(c),children:e.jsxs("span",{className:"col-sort-label",children:[_," ",e.jsx("span",{className:"sort-icon",children:H(c)})]})},c)),e.jsxs("th",{style:{position:"relative"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2},children:[e.jsx("span",{children:"Comments"}),e.jsx("div",{className:`col-filter-hotspot${x?" active":""}`,onClick:c=>{c.stopPropagation(),w("comments")},title:"Filter by comments"})]}),N==="comments"&&e.jsxs("div",{className:"col-filter-popover",onClick:c=>c.stopPropagation(),style:{left:"auto",right:0},children:[e.jsx("input",{autoFocus:!0,placeholder:"Search commentsâ€¦",value:x,onChange:c=>j(c.target.value)}),x&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{j(""),S(null)},children:"Clear"})]})]})]})}),e.jsxs("tbody",{children:[U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:11,style:{textAlign:"center",padding:32,color:"#64748b"},children:"No matching rows."})}),U.map((c,_)=>{const I=qe.find(X=>X.id===c.projectId),J=c.status==="in_progress";return e.jsxs("tr",{className:_%2===1?"row-even":"",children:[e.jsx("td",{className:"cell-juror",children:c.juryName}),e.jsx("td",{className:"cell-dept",style:{fontSize:12,color:"#475569"},children:c.juryDept}),e.jsx("td",{className:"cell-group",style:{whiteSpace:"nowrap"},children:e.jsxs("div",{className:"cell-group-wrap",title:I!=null&&I.desc?`Group ${c.projectId} â€” ${I.desc}`:`Group ${c.projectId}`,style:{cursor:"default"},children:[e.jsxs("strong",{className:"cell-group-title",children:["Group ",c.projectId]}),(I==null?void 0:I.desc)&&e.jsx("span",{className:"cell-group-desc",style:{display:"block",fontSize:11,color:"#94a3b8",fontWeight:400,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:I.desc})]})}),e.jsx("td",{style:{fontSize:12,color:"#475569",whiteSpace:"nowrap"},children:Fe(c.timestamp)}),e.jsx("td",{children:e.jsx(ye,{status:c.status,editingFlag:c.editingFlag})}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:me(c.technical)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:me(c.design)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:me(c.delivery)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:me(c.teamwork)}),e.jsx("td",{style:{color:J?"#94a3b8":void 0},children:e.jsx("strong",{children:me(c.total)})}),e.jsx("td",{className:"comment-cell cell-comment",children:c.comments})]},`${He(c)}-${c.projectId}-${_}`)})]})]})})]})}const Ms=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]});function Is({jurorStats:t,onPinReset:s}){const[r,a]=u.useState(""),[n,i]=u.useState(""),[d,p]=u.useState(new Set);u.useEffect(()=>{const o=setTimeout(()=>i(r),200);return()=>clearTimeout(o)},[r]);function h(o){p(m=>{const f=new Set(m);return f.has(o)?f.delete(o):f.add(o),f})}const l=u.useMemo(()=>{const o=n.trim().toLowerCase();return o?t.filter(m=>{var f;return m.jury.toLowerCase().includes(o)||(m.dept||((f=m.latestRow)==null?void 0:f.juryDept)||"").toLowerCase().includes(o)}):t},[t,n]);return e.jsxs("div",{className:"jurors-tab-wrap",children:[e.jsx("div",{className:"juror-filter-bar",children:e.jsxs("div",{className:"juror-search-wrap",children:[e.jsx("input",{className:"juror-search-input",value:r,onChange:o=>a(o.target.value),placeholder:"ðŸ” Search by name or departmentâ€¦"}),r&&e.jsx("button",{className:"juror-search-clear",onClick:()=>a(""),children:"âœ•"})]})}),l.length===0&&e.jsx("div",{className:"empty-msg",children:"No jurors match the current filter."}),e.jsx("div",{className:"jurors-grid jurors-grid-full",children:l.map(o=>{const{key:m,jury:f,rows:L,overall:x,latestRow:j}=o,C=os(L),b=C===100?"#22c55e":C>66?"#84cc16":C>33?"#eab308":C>0?"#f97316":"#e2e8f0",k=L.some(N=>N.editingFlag==="editing"),E=k?"juror-card-editing":x==="all_submitted"?"juror-card-all-submitted":x==="in_progress"?"juror-card-in-progress":"";return e.jsxs("div",{className:`juror-card ${E}`,children:[e.jsxs("div",{className:"juror-card-header",children:[e.jsxs("div",{style:{minWidth:0,flex:1},children:[e.jsxs("div",{className:"juror-name",style:{wordBreak:"break-word"},children:["ðŸ‘¤ ",f,(j==null?void 0:j.juryDept)&&e.jsxs("span",{className:"juror-dept-inline",children:[" (",j.juryDept,")"]})]}),k?e.jsx(ye,{status:x,editingFlag:"editing"}):e.jsx(ye,{status:x}),s&&e.jsx("button",{className:"pin-reset-btn",title:`Reset PIN for ${f}`,onClick:()=>s(f,(j==null?void 0:j.juryDept)||"",(j==null?void 0:j.jurorId)||""),children:"ðŸ”‘ Reset PIN"})]}),e.jsx("div",{className:"juror-meta",children:(j==null?void 0:j.timestamp)&&e.jsxs("div",{className:"juror-last-submit",children:[e.jsx("span",{className:"juror-last-submit-label",children:"Last activity"}),e.jsx("span",{className:"juror-last-submit-time",children:Fe(j==null?void 0:j.timestamp)})]})})]}),e.jsxs("div",{className:"juror-progress-wrap",children:[e.jsx("div",{className:"juror-progress-bar-bg",children:e.jsx("div",{className:"juror-progress-bar-fill",style:{width:`${C}%`,background:b}})}),e.jsxs("span",{className:"juror-progress-label",children:[C,"%"]})]}),e.jsx("div",{className:"juror-projects",children:L.slice().sort((N,S)=>N.projectId-S.projectId).map(N=>{var V,w;const S=Ms.find($=>$.id===N.projectId),P=`${m}-${N.projectId}`,q=d.has(P),G=`juror-group-panel-${P}`,z=!!(S!=null&&S.desc)||((V=S==null?void 0:S.students)==null?void 0:V.length)>0;return e.jsxs("div",{className:"juror-row-wrap",children:[e.jsxs("div",{className:"juror-row group-accordion-header",role:"button",tabIndex:z?0:-1,"aria-expanded":q,"aria-controls":G,onClick:()=>{z&&h(P)},onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&z&&($.preventDefault(),h(P))},style:{cursor:z?"pointer":"default"},children:[e.jsx("div",{className:"juror-row-left",children:e.jsxs("div",{className:"juror-row-header-line",children:[e.jsx("span",{className:"juror-row-name",children:(S==null?void 0:S.name)||`Group ${N.projectId}`}),z&&e.jsx("span",{className:`group-accordion-chevron${q?" open":""}`,children:e.jsx(st,{})})]})}),e.jsxs("div",{className:"juror-row-right",children:[N.timestamp&&e.jsx("span",{className:"juror-row-ts",children:Fe(N.timestamp)}),e.jsx(ye,{status:N.status,editingFlag:N.editingFlag}),(N.status==="all_submitted"||N.status==="group_submitted")&&e.jsxs("span",{className:"juror-score",children:[N.total," / 100"]})]})]}),e.jsx("div",{id:G,className:`group-accordion-panel${q?" open":""}`,children:e.jsxs("div",{className:"group-accordion-panel-inner juror-accordion-inner",children:[(S==null?void 0:S.desc)&&e.jsx("span",{className:"juror-row-desc",children:S.desc}),((w=S==null?void 0:S.students)==null?void 0:w.length)>0&&e.jsxs("span",{className:"juror-row-students",children:["ðŸ‘¥ ",S.students.join(" Â· ")]})]})})]},P)})})]},m)})})]})}const Fs=()=>e.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M1 2h8M2.5 5h5M4 7.5h2",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),As=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M4 4.5L6 2l2 2.5M4 7.5L6 10l2-2.5",stroke:"currentColor",strokeWidth:"1.3",strokeLinecap:"round",strokeLinejoin:"round",opacity:"0.5"})}),Ps=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M6 2.5v7M3.5 7L6 9.5l2.5-2.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})}),Ds=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M6 9.5v-7M3.5 5L6 2.5l2.5 2.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round",strokeLinejoin:"round"})}),_s=()=>e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true",children:e.jsx("path",{d:"M3 3l6 6M9 3L3 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})}),Ts=()=>e.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none","aria-hidden":"true",children:[e.jsx("circle",{cx:"7",cy:"7",r:"5.75",stroke:"currentColor",strokeWidth:"1.2"}),e.jsx("path",{d:"M7 6.5v3.5",stroke:"currentColor",strokeWidth:"1.4",strokeLinecap:"round"}),e.jsx("circle",{cx:"7",cy:"4.5",r:"0.7",fill:"currentColor"})]}),$s=t=>t?t.status==="all_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="group_submitted"?{background:"#dcfce7",color:"#166534",fontWeight:700}:t.status==="in_progress"?{background:"#fef9c3",color:"#92400e"}:{background:"#f8fafc",color:"#94a3b8"}:{background:"#f8fafc",color:"#94a3b8"},Rs=t=>t?t.status==="all_submitted"||t.status==="group_submitted"?t.total:t.status==="in_progress"?"":"â€”":"â€”";function Bs({data:t,jurors:s,groups:r}){const[a,n]=u.useState(null),[i,d]=u.useState("desc"),[p,h]=u.useState(""),[l,o]=u.useState(null),m=u.useMemo(()=>{const b={};return t.forEach(k=>{const E=k.jurorId?k.jurorId:`${(k.juryName||"").trim().toLowerCase()}__${(k.juryDept||"").trim().toLowerCase()}`;b[E]||(b[E]={}),b[E][k.projectId]={total:k.total,status:k.status}}),b},[t]);function f(b){a!==b?(n(b),d("desc")):i==="desc"?d("asc"):(n(null),d("desc"))}const L=b=>a!==b?e.jsx(As,{}):i==="desc"?e.jsx(Ps,{}):e.jsx(Ds,{});function x(){h(""),o(null)}const j=u.useMemo(()=>{let b=s.slice();if(p){const k=p.toLowerCase();b=b.filter(E=>E.name.toLowerCase().includes(k))}return a!==null&&(b=[...b].sort((k,E)=>{var z,V;const N=(z=m[k.key])==null?void 0:z[a],S=(V=m[E.key])==null?void 0:V[a],P=(N==null?void 0:N.status)==="all_submitted"?Number(N.total):null,q=(S==null?void 0:S.status)==="all_submitted"?Number(S.total):null;if(P===null&&q===null)return xe(k.name,E.name);if(P===null)return 1;if(q===null)return-1;const G=i==="desc"?q-P:P-q;return G!==0?G:xe(k.name,E.name)})),b},[s,p,a,i,m]),C=u.useMemo(()=>r.map(b=>{const k=j.map(E=>{var N;return(N=m[E.key])==null?void 0:N[b.id]}).filter(E=>(E==null?void 0:E.status)==="all_submitted").map(E=>E.total);return k.length?(k.reduce((E,N)=>E+N,0)/k.length).toFixed(2):null}),[j,r,m]);return s.length?e.jsxs("div",{className:"matrix-wrap",children:[(p||j.length<s.length)&&e.jsxs("div",{className:"matrix-controls",children:[p&&e.jsxs("button",{className:"matrix-clear-filters",onClick:x,children:[e.jsx(_s,{})," Clear Filters"]}),j.length<s.length&&e.jsxs("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:600},children:["Showing ",j.length,"/",s.length," jurors"]})]}),e.jsxs("p",{className:"matrix-info-note",children:[e.jsx(Ts,{})," ",e.jsx("strong",{children:"Averages include only final submissions."})]}),e.jsxs("p",{className:"matrix-subtitle",children:[e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot submitted-dot"}),"Submitted"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot progress-dot"}),"In Progress"]}),e.jsxs("span",{className:"matrix-legend-item",children:[e.jsx("span",{className:"matrix-legend-dot empty-dot"}),"Not Started"]})]}),l!==null&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:50},onClick:()=>o(null)}),e.jsx("div",{className:"matrix-scroll",children:e.jsxs("table",{className:"matrix-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"matrix-corner",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:["Juror / Group",e.jsx("button",{className:`col-filter-btn${p?" active":""}`,onClick:b=>{b.stopPropagation(),o(k=>k==="juror"?null:"juror")},title:"Filter jurors",children:e.jsx(Fs,{})})]}),l==="juror"&&e.jsxs("div",{className:"col-filter-popover",onClick:b=>b.stopPropagation(),children:[e.jsx("input",{autoFocus:!0,placeholder:"Filter juror nameâ€¦",value:p,onChange:b=>h(b.target.value)}),p&&e.jsx("button",{className:"col-filter-clear",onClick:()=>{h(""),o(null)},children:"Clear"})]})]}),r.map(b=>{const k=a===b.id;return e.jsx("th",{children:e.jsxs("button",{className:`matrix-col-sort${k?" active":""}`,onClick:()=>f(b.id),title:`Sort by ${b.label}`,children:[e.jsx("strong",{children:b.label}),e.jsx("span",{className:"sort-icon",children:L(b.id)})]})},b.id)})]})}),e.jsx("tbody",{children:j.map(b=>e.jsxs("tr",{children:[e.jsxs("td",{className:"matrix-juror",children:[b.name,b.dept&&e.jsxs("span",{className:"matrix-juror-dept",children:[" (",b.dept,")"]})]}),r.map(k=>{var N;const E=((N=m[b.key])==null?void 0:N[k.id])??null;return e.jsx("td",{style:$s(E),children:Rs(E)},k.id)})]},b.key))}),e.jsx("tfoot",{children:e.jsxs("tr",{className:"matrix-avg-row",children:[e.jsx("td",{className:"matrix-juror matrix-avg-label",children:"Average"}),C.map((b,k)=>e.jsx("td",{className:"matrix-avg-cell",children:b!==null?b:"â€”"},r[k].id))]})})]})})]}):e.jsx("div",{className:"empty-msg",children:"No data yet."})}const Ae=B.map((t,s)=>typeof t=="string"?{id:s+1,name:t,desc:"",students:[]}:{id:t.id??s+1,name:t.name??`Group ${s+1}`,desc:t.desc??"",students:t.students??[]}),Os=Y.map(t=>({id:t.id,label:t.label,shortLabel:t.shortLabel,max:t.max})),Ws=Ae.length,Gs=2*60*1e3,zs=[{id:"summary",label:"ðŸ† Summary"},{id:"dashboard",label:"ðŸ“ˆ Dashboard"},{id:"detail",label:"ðŸ“‹ Details"},{id:"jurors",label:"ðŸ‘¤ Jurors"},{id:"matrix",label:"ðŸ”¢ Matrix"}];function Js({adminPass:t,onBack:s,onAuthError:r,onInitialLoadDone:a}){const[n,i]=u.useState([]),[d,p]=u.useState(!0),[h,l]=u.useState(""),[o,m]=u.useState(""),[f,L]=u.useState("summary"),[x,j]=u.useState(null),[C,b]=u.useState(null),[k,E]=u.useState(""),N=u.useRef(!1),S=u.useRef(t);u.useEffect(()=>{S.current=t},[t]);const P=async()=>{p(!0),l("");try{const v=S.current||sessionStorage.getItem("ee492_admin_pass")||"";if(!v){i([]),m("Enter the admin password to load results.");return}const M=await ce({action:"export",pass:v});if((M==null?void 0:M.status)==="unauthorized"){if(i([]),r){r("Invalid password");return}m("Incorrect password.");return}if((M==null?void 0:M.status)!=="ok"||!Array.isArray(M==null?void 0:M.rows))throw new Error("Unexpected response format.");try{sessionStorage.setItem("ee492_admin_pass",v)}catch{}const W=M.rows.map(T=>({juryName:String(T["Juror Name"]??T["Your Name"]??""),juryDept:String(T["Department / Institution"]??T.Department??""),timestamp:T.Timestamp||"",tsMs:we(T.Timestamp||""),projectId:oe(T["Group No"]),projectName:String(T["Group Name"]??""),jurorId:String(T["Juror ID"]??""),technical:oe(T["Technical (30)"]),design:oe(T["Written (30)"]),delivery:oe(T["Oral (30)"]),teamwork:oe(T["Teamwork (10)"]),total:oe(T["Total (100)"]),comments:T.Comments||"",status:String(T.Status??"all_submitted"),editingFlag:String(T.EditingFlag??"")}));i(ls(W)),j(new Date),m(""),N.current||(N.current=!0,a==null||a())}catch(v){if(r){r("Connection error â€” try again.");return}l("Could not load data: "+v.message),i([])}finally{p(!1)}};u.useEffect(()=>{P()},[]),u.useEffect(()=>{const v=setInterval(P,Gs);return()=>clearInterval(v)},[]),u.useEffect(()=>(C?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[C]);const q=async(v,M,W)=>{b({juryName:v,juryDept:M}),E("loading");try{const T=S.current||sessionStorage.getItem("ee492_admin_pass")||"",O=await ce({action:"resetPin",jurorId:W.trim(),pass:T});E(O.status==="ok"?"ok":"error")}catch{E("error")}setTimeout(()=>{b(null),E("")},3e3)},G=v=>v.jurorId?v.jurorId:`${(v.juryName||"").trim().toLowerCase()}__${(v.juryDept||"").trim().toLowerCase()}`,z=u.useMemo(()=>{const v=new Map;return n.forEach(M=>{if(!M.juryName)return;const W=G(M);v.has(W)||v.set(W,{key:W,name:M.juryName.trim(),dept:M.juryDept.trim(),jurorId:M.jurorId})}),[...v.values()].sort((M,W)=>xe(M.name,W.name))},[n]),V=u.useMemo(()=>Ae.map(v=>({id:v.id,label:`Group ${v.id}`,desc:v.desc||""})).sort((v,M)=>v.id-M.id),[]),w=u.useMemo(()=>{const v=new Map;return z.forEach(({key:M,dept:W})=>v.set(M,W)),v},[z]),$=u.useMemo(()=>{const v=new Map;return z.forEach(({key:M,name:W})=>v.set(M,{bg:ss(W),dot:ns(W)})),v},[z]),U=u.useMemo(()=>n.filter(v=>v.status==="all_submitted"),[n]),K=u.useMemo(()=>n.filter(v=>v.status==="group_submitted"||v.status==="all_submitted"),[n]),H=u.useMemo(()=>Ae.map(v=>{const M=U.filter(O=>O.projectId===v.id);if(!M.length)return{id:v.id,name:v.name,desc:v.desc,students:v.students,count:0,avg:{},totalAvg:0,totalMin:0,totalMax:0};const W={};Os.forEach(O=>{W[O.id]=M.reduce((Q,ee)=>Q+(ee[O.id]||0),0)/M.length});const T=M.map(O=>O.total);return{id:v.id,name:v.name,desc:v.desc,students:v.students,count:M.length,avg:W,totalAvg:T.reduce((O,Q)=>O+Q,0)/T.length,totalMin:Math.min(...T),totalMax:Math.max(...T)}}),[U]),c=u.useMemo(()=>H.map(v=>({...v,name:`Group ${v.id}`})),[H]),_=u.useMemo(()=>[...H].sort((v,M)=>M.totalAvg-v.totalAvg),[H]),I=u.useMemo(()=>z.map(({key:v,name:M,dept:W,jurorId:T})=>{const O=n.filter(Z=>G(Z)===v),Q=O.filter(Z=>Z.status==="group_submitted"||Z.status==="all_submitted"),ee=O.filter(Z=>Z.status==="all_submitted"),fe=O.filter(Z=>Z.status==="in_progress"),ge=O.reduce((Z,de)=>de.tsMs>Z?de.tsMs:Z,0),Ce=O.find(Z=>Z.tsMs===ge)||O[0],Le=ee.length===Ws?"all_submitted":Q.length>0||fe.length>0?"in_progress":"not_started";return{key:v,jury:M,dept:W,jurorId:T,rows:O,submitted:Q,completed:Q,finalSubmitted:ee,inProgress:fe,latestTs:ge,latestRow:Ce,overall:Le}}),[z,n]),J=n.filter(v=>v.status==="in_progress").length,X=I.filter(v=>v.rows.some(M=>M.editingFlag==="editing")).length;return e.jsxs("div",{className:"admin-screen",children:[e.jsxs("div",{className:"form-header",children:[e.jsx("button",{className:"back-btn",onClick:s,"aria-label":"Back to home",children:e.jsx(Se,{})}),e.jsxs("div",{children:[e.jsx("h2",{children:"Results Panel"}),e.jsxs("p",{children:[z.length," juror",z.length!==1?"s":""," Â· ",K.length," completed"," Â· ",U.length," final",J>0&&e.jsxs("span",{className:"live-indicator",children:[" Â· ",J," in progress"]}),X>0&&e.jsxs("span",{className:"editing-indicator",children:[" Â· ",X," editing"]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:2},children:[e.jsx("button",{className:"refresh-btn",onClick:P,"aria-label":"Refresh",title:"Refresh",children:e.jsx(Ot,{})}),x&&e.jsx("span",{style:{fontSize:10,color:"#94a3b8"},children:x.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsx("div",{className:"tab-bar",children:zs.map(v=>e.jsx("button",{className:`tab ${f===v.id?"active":""}`,onClick:()=>L(v.id),children:v.label},v.id))}),d&&e.jsx("div",{className:"loading",children:"Loading dataâ€¦"}),h&&e.jsx("div",{className:"error-msg",children:h}),o&&e.jsx("div",{className:"error-msg",children:o}),C&&e.jsx("div",{className:"pin-reset-modal-overlay",children:e.jsxs("div",{className:`pin-reset-modal-card ${k}`,children:[k==="loading"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"ðŸ”‘"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Resetting PIN for ",e.jsx("strong",{children:C.juryName}),"â€¦"]})]}),k==="ok"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"âœ…"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["PIN reset. ",e.jsx("strong",{children:C.juryName})," will receive a new PIN on next login."]})]}),k==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pin-reset-modal-icon",children:"âŒ"}),e.jsxs("div",{className:"pin-reset-modal-msg",children:["Could not reset PIN for ",e.jsx("strong",{children:C.juryName}),"."]})]})]})}),!d&&!h&&!o&&e.jsxs("div",{className:"admin-body",children:[f==="summary"&&e.jsx(ps,{ranked:_,submittedData:U}),f==="dashboard"&&e.jsx(ys,{dashboardStats:c,submittedData:U}),f==="detail"&&e.jsx(Es,{data:n,jurors:z,jurorColorMap:$}),f==="jurors"&&e.jsx(Is,{jurorStats:I,jurors:z,onPinReset:q}),f==="matrix"&&e.jsx(Bs,{data:n,jurors:z,groups:V,jurorDeptMap:w})]})]})}const Us="/senior-design-jury/assets/tedu-logo-c1977d2a.png";function Ks(){const[t,s]=u.useState("home"),r=u.useRef(""),[a,n]=u.useState(!1),[i,d]=u.useState(!1),[p,h]=u.useState(""),[l,o]=u.useState("");function m(){const L=p.trim();if(!L){o("Please enter the admin password.");return}r.current=L,h(""),o(""),d(!0),n(!0)}function f(L){n(!1),d(!1),r.current="",o(L||"Authentication failed.")}return t==="jury"?e.jsx(Qt,{onBack:()=>s("home")}):t==="admin"?a?e.jsxs(e.Fragment,{children:[i&&e.jsx("div",{className:"admin-checking-overlay",children:e.jsxs("div",{className:"admin-checking-card",children:[e.jsx("div",{className:"admin-checking-icon",children:"ðŸ”„"}),e.jsx("div",{className:"admin-checking-msg",children:"Checkingâ€¦"})]})}),e.jsx(Js,{adminPass:r.current,onAuthError:f,onInitialLoadDone:()=>d(!1),onBack:()=>{s("home"),n(!1),d(!1),o(""),r.current=""}})]}):e.jsx("div",{className:"lock-screen",children:e.jsxs("div",{className:"lock-card",children:[e.jsx("div",{className:"lock-icon",children:"ðŸ”’"}),e.jsx("h2",{children:"Results Panel"}),e.jsx("p",{children:"Enter the admin password to view results"}),l&&e.jsx("div",{className:"login-error",children:l}),e.jsx("input",{type:"password",placeholder:"Password",value:p,onChange:L=>{h(L.target.value),l&&o("")},onKeyDown:L=>{L.key==="Enter"&&m()},autoFocus:!0}),e.jsx("button",{className:"btn-primary",onClick:m,disabled:i,children:"Login"}),e.jsx("button",{className:"btn-ghost",onClick:()=>{s("home"),o("")},children:"â† Back"})]})}):e.jsxs("div",{className:"home",children:[e.jsx("div",{className:"home-bg"}),e.jsxs("div",{className:"home-card",children:[e.jsx("div",{className:"home-logo-wrap",children:e.jsx("img",{className:"home-logo",src:Us,alt:"TED University",loading:"eager"})}),e.jsxs("h1",{children:["Senior Project",e.jsx("br",{}),"Jury Portal"]}),e.jsxs("p",{className:"home-sub",children:["TED University ",e.jsx("br",{}),"Dept. of Electrical & Electronics Engineering"]}),e.jsxs("div",{className:"home-buttons",children:[e.jsxs("button",{className:"btn-primary big",onClick:()=>s("jury"),children:[e.jsx("span",{children:"ðŸ“‹"})," Evaluation Form"]}),e.jsxs("button",{className:"btn-outline big",onClick:()=>s("admin"),children:[e.jsx("span",{children:"ðŸ“Š"})," View Results"]})]}),e.jsxs("p",{className:"home-hint",children:[e.jsx("span",{className:"home-hint-ico",children:"â„¹ï¸"}),e.jsxs("span",{children:["Use the ",e.jsx("strong",{children:"Evaluation Form"})," to score each project group."]})]}),e.jsxs("div",{className:"home-footer",children:["Â© 2026 Â· Developed by"," ",e.jsx("a",{className:"home-footer-link",href:"https://huguryildiz.com",target:"_blank",rel:"noopener noreferrer",children:"Huseyin Ugur Yildiz"})]})]})]})}Ie.createRoot(document.getElementById("root")).render(e.jsx(kt.StrictMode,{children:e.jsx(Ks,{})}));
